import{d as F,j as e,f as O}from"./manager-dashboard-BSBEKJka.js";import{r as d}from"./react-vendor-z5qVsTvS.js";import{u as C,T as S,a as E,S as A}from"./shared-ui-DksRfdM8.js";import{L as I}from"./LoadingButton-BtGitHou.js";import"./clients-Dg_kG3rU.js";import"./supabase-vendor-D6KV1zBy.js";import"./auth-out34swX.js";import"./employees-C0R0oL0z.js";import"./forms-F81hZsoD.js";function z({applicationId:s,onSuccess:o,onCancel:m}){const{supabase:n}=F(),{showToast:c}=C(),[p,g]=d.useState(null),[j,u]=d.useState(!0),[y,_]=d.useState(!1),[r,b]=d.useState({bankAccountNumber:"",ifscCode:"",accountHolderName:"",upiId:"",preferredMethod:"bank_transfer",panNumber:"",additionalNotes:""});d.useEffect(()=>{k()},[s]);const k=async()=>{try{if(u(!0),!n){g({id:s,employee_name:"John Doe",incentive_type_name:"Hiring Recommendation",incentive_amount:3e3,status:"approved"}),u(!1);return}const{data:a,error:f}=await n.from("hr_incentive_approvals").select("*").eq("id",s).eq("status","approved").single();if(f){console.error("Error loading application:",f),c("Failed to load application details","error");return}if(!a){c("Application not found or not approved","error");return}g(a)}catch(a){console.error("Error loading application:",a),c("Failed to load application","error")}finally{u(!1)}},x=async a=>{if(a.preventDefault(),!p){c("Application data not available","error");return}if(r.preferredMethod==="bank_transfer"){if(!r.bankAccountNumber||!r.ifscCode||!r.accountHolderName){c("Please fill all required bank details","error");return}}else if(r.preferredMethod==="upi"&&!r.upiId){c("Please provide UPI ID","error");return}if(!r.panNumber){c("PAN number is required for tax purposes","error");return}try{_(!0);const f={application_id:s,employee_name:p.employee_name,incentive_type:p.incentive_type_name,amount:p.incentive_amount,payment_method:r.preferredMethod,bank_account_number:r.preferredMethod==="bank_transfer"?r.bankAccountNumber:null,ifsc_code:r.preferredMethod==="bank_transfer"?r.ifscCode:null,account_holder_name:r.preferredMethod==="bank_transfer"?r.accountHolderName:null,upi_id:r.preferredMethod==="upi"?r.upiId:null,pan_number:r.panNumber,additional_notes:r.additionalNotes,submission_date:new Date().toISOString(),status:"submitted"};if(n){const{error:w}=await n.from("incentive_applications").update({razorpay_form_submitted:!0,razorpay_submission_date:new Date().toISOString(),status:"processing_payment"}).eq("id",s);if(w){console.error("Error updating application:",w),c("Failed to update application status","error");return}const{error:D}=await n.from("razorpay_reimbursements").insert([f]);D&&console.error("Error storing reimbursement data:",D)}else{console.log("Razorpay reimbursement form submitted:",f);const w=JSON.parse(localStorage.getItem("razorpay_submissions")||"[]");w.push({...f,id:Date.now().toString()}),localStorage.setItem("razorpay_submissions",JSON.stringify(w))}c("Reimbursement form submitted successfully! Payment will be processed within 3-5 business days.","success"),o&&o()}catch(f){console.error("Error submitting reimbursement form:",f),c("Failed to submit reimbursement form","error")}finally{_(!1)}};return j?e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading application details..."})]}):p?e.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"💰"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Razorpay Reimbursement Form"}),e.jsx("p",{className:"text-gray-600",children:"Submit your payment details for incentive reimbursement"})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"font-medium text-green-900 mb-2",children:"✅ Approved Incentive"}),e.jsxs("div",{className:"text-sm text-green-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Employee:"})," ",p.employee_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Incentive Type:"})," ",p.incentive_type_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amount:"})," ₹",p.incentive_amount]})]})]}),e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Payment Method *"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"bank_transfer",checked:r.preferredMethod==="bank_transfer",onChange:a=>b({...r,preferredMethod:a.target.value}),className:"mr-2"}),e.jsx("span",{children:"Bank Transfer (NEFT/RTGS)"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"upi",checked:r.preferredMethod==="upi",onChange:a=>b({...r,preferredMethod:a.target.value}),className:"mr-2"}),e.jsx("span",{children:"UPI Transfer"})]})]})]}),r.preferredMethod==="bank_transfer"&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Bank Account Details"}),e.jsx(S,{label:"Account Holder Name *",value:r.accountHolderName,onChange:a=>b({...r,accountHolderName:a}),placeholder:"Enter account holder name as per bank records",required:!0}),e.jsx(S,{label:"Bank Account Number *",value:r.bankAccountNumber,onChange:a=>b({...r,bankAccountNumber:a}),placeholder:"Enter bank account number",required:!0}),e.jsx(S,{label:"IFSC Code *",value:r.ifscCode,onChange:a=>b({...r,ifscCode:a.toUpperCase()}),placeholder:"Enter IFSC code (e.g., SBIN0001234)",required:!0})]}),r.preferredMethod==="upi"&&e.jsxs("div",{className:"space-y-4 p-4 bg-purple-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-purple-900",children:"UPI Details"}),e.jsx(S,{label:"UPI ID *",value:r.upiId,onChange:a=>b({...r,upiId:a}),placeholder:"Enter UPI ID (e.g., yourname@paytm, yourname@gpay)",required:!0})]}),e.jsx(S,{label:"PAN Number *",value:r.panNumber,onChange:a=>b({...r,panNumber:a.toUpperCase()}),placeholder:"Enter PAN number (required for tax purposes)",required:!0}),e.jsx(E,{label:"Additional Notes",value:r.additionalNotes,onChange:a=>b({...r,additionalNotes:a}),placeholder:"Any additional information or special instructions...",rows:3}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-yellow-900 mb-2",children:"⚠️ Important Notice"}),e.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[e.jsx("li",{children:"• Payment will be processed within 3-5 business days"}),e.jsx("li",{children:"• Ensure all details are accurate to avoid delays"}),e.jsx("li",{children:"• TDS will be deducted as per applicable tax rates"}),e.jsx("li",{children:"• You will receive a confirmation email once payment is processed"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(I,{type:"button",variant:"secondary",onClick:m,disabled:y,children:"Cancel"}),e.jsx(I,{type:"submit",loading:y,variant:"success",loadingText:"Submitting...",children:"Submit Reimbursement Form"})]})]})]}):e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"text-red-600 mb-4",children:"❌"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Application Not Found"}),e.jsx("p",{className:"text-gray-600",children:"The incentive application could not be found or is not approved."})]})}const N={PENDING:"pending",APPROVED:"approved",REJECTED:"rejected",DISBURSED:"disbursed"},U={[N.PENDING]:"bg-yellow-100 text-yellow-800 border-yellow-200",[N.APPROVED]:"bg-green-100 text-green-800 border-green-200",[N.REJECTED]:"bg-red-100 text-red-800 border-red-200",[N.DISBURSED]:"bg-blue-100 text-blue-800 border-blue-200"},R={[N.PENDING]:"⏳",[N.APPROVED]:"✅",[N.REJECTED]:"❌",[N.DISBURSED]:"💰"},T={hiring_recommendation:{name:"Hiring Recommendation",amount:3e3,icon:"👥",color:"bg-blue-50 border-blue-200"},client_testimonial:{name:"Client Testimonial",amount:1e3,icon:"🎥",color:"bg-green-50 border-green-200"},promotional_video:{name:"Promotional Video",amount:500,icon:"📹",color:"bg-purple-50 border-purple-200"}};function X(){const{supabase:s}=F(),{notify:o}=C(),{openModal:m,closeModal:n}=O(),[c,p]=d.useState([]),[g,j]=d.useState(!0),[u,y]=d.useState(""),[_,r]=d.useState("all"),[b,k]=d.useState("all"),x=d.useCallback(async()=>{try{if(j(!0),s){const{data:t,error:i}=await s.from("hr_incentive_approvals").select("*").order("application_date",{ascending:!1});if(i)throw i;p(t||[])}else{const t=JSON.parse(localStorage.getItem("incentive_applications")||"[]");p(t.filter(i=>i.status==="pending"))}}catch(t){console.error("Error loading incentive applications:",t),o("Failed to load incentive applications","error")}finally{j(!1)}},[s,o]);d.useEffect(()=>{x()},[x]);const a=c.filter(t=>{const i=_==="all"||t.status===_,l=b==="all"||t.incentive_type_name.toLowerCase().includes(b.toLowerCase()),v=!u||t.employee_name.toLowerCase().includes(u.toLowerCase())||t.employee_email.toLowerCase().includes(u.toLowerCase())||t.department.toLowerCase().includes(u.toLowerCase());return i&&l&&v}),f=d.useCallback(async t=>{m({title:"✅ Approve Incentive Application",content:e.jsx(P,{application:t,action:"approve",onSubmit:async i=>{try{if(s){const{error:l}=await s.rpc("approve_incentive_application",{application_id:t.id,reviewer_id:"hr-user",approval_status:"approved",review_notes:i.reviewNotes});if(l)throw l}else{const v=JSON.parse(localStorage.getItem("incentive_applications")||"[]").map(h=>h.id===t.id?{...h,status:"approved",review_notes:i.reviewNotes,reviewed_at:new Date().toISOString()}:h);localStorage.setItem("incentive_applications",JSON.stringify(v))}await x(),n(),o(`${t.employee_name}'s incentive application has been approved`,"success")}catch(l){console.error("Error approving application:",l),o("Failed to approve application","error")}}})})},[s,m,n,o,x]),w=d.useCallback(async t=>{m({title:"❌ Reject Incentive Application",content:e.jsx(P,{application:t,action:"reject",onSubmit:async i=>{try{if(s){const{error:l}=await s.rpc("approve_incentive_application",{application_id:t.id,reviewer_id:"hr-user",approval_status:"rejected",review_notes:i.reviewNotes});if(l)throw l}else{const v=JSON.parse(localStorage.getItem("incentive_applications")||"[]").map(h=>h.id===t.id?{...h,status:"rejected",review_notes:i.reviewNotes,reviewed_at:new Date().toISOString()}:h);localStorage.setItem("incentive_applications",JSON.stringify(v))}await x(),n(),o(`${t.employee_name}'s incentive application has been rejected`,"info")}catch(l){console.error("Error rejecting application:",l),o("Failed to reject application","error")}}})})},[s,m,n,o,x]),D=d.useCallback(t=>{m({title:`📋 Incentive Application Details - ${t.employee_name}`,content:e.jsx(q,{application:t}),size:"large"})},[m]),M=d.useCallback(t=>{m({title:"💰 Razorpay Reimbursement Form",content:e.jsx(z,{applicationId:t.id,onSuccess:()=>{n(),x(),o("Reimbursement form submitted successfully","success")},onCancel:n}),size:"large"})},[m,n,x,o]),L=d.useCallback(async t=>{m({title:"💰 Mark as Disbursed",content:e.jsx(J,{application:t,onSubmit:async i=>{try{if(s){const{error:l}=await s.rpc("mark_incentive_disbursed",{application_id:t.id,disbursement_reference:i.reference,disbursement_notes:i.notes});if(l)throw l}else{const v=JSON.parse(localStorage.getItem("incentive_applications")||"[]").map(h=>h.id===t.id?{...h,status:"disbursed",disbursement_reference:i.reference,disbursement_notes:i.notes,disbursement_date:new Date().toISOString()}:h);localStorage.setItem("incentive_applications",JSON.stringify(v))}await x(),n(),o(`Incentive marked as disbursed for ${t.employee_name}`,"success")}catch(l){console.error("Error marking as disbursed:",l),o("Failed to mark as disbursed","error")}}})})},[s,m,n,o,x]);return g?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading incentive applications..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"HR Incentive Approval"}),e.jsx("p",{className:"text-gray-600",children:"Review and manage employee incentive applications"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("button",{onClick:x,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"🔄 Refresh"})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(S,{label:"Search Applications",value:u,onChange:y,placeholder:"Search by name, email, or department..."})}),e.jsxs("div",{className:"w-full sm:w-48",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:_,onChange:t=>r(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"disbursed",children:"Disbursed"})]})]}),e.jsxs("div",{className:"w-full sm:w-48",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{value:b,onChange:t=>k(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"hiring",children:"Hiring Recommendation"}),e.jsx("option",{value:"testimonial",children:"Client Testimonial"}),e.jsx("option",{value:"promotional",children:"Promotional Video"})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:Object.entries(N).map(([t,i])=>{const l=c.filter(v=>v.status===i).length;return e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:R[i]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 capitalize",children:i.replace("_"," ")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l})]})]})},i)})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Incentive Applications (",a.length,")"]})}),a.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📋"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No applications found"}),e.jsx("p",{className:"text-gray-600",children:"No incentive applications match your current filters."})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:a.map(t=>{var l;const i=T[(l=t.incentive_type_name)==null?void 0:l.toLowerCase().replace(" ","_")]||T.hiring_recommendation;return e.jsx("div",{className:"p-6 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("span",{className:"text-2xl",children:i.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:t.employee_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.employee_email," • ",t.department]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Incentive Type"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.incentive_type_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Amount"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["₹",t.incentive_amount]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Application Date"}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(t.application_date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Eligible Date"}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(t.eligible_date).toLocaleDateString()})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Proof Details"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.proof_details})]}),!t.is_eligible_now&&e.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["⚠️ Not eligible yet. Eligible from ",new Date(t.eligible_date).toLocaleDateString()]})})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2 ml-4",children:[e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${U[t.status]}`,children:[R[t.status]," ",t.status.charAt(0).toUpperCase()+t.status.slice(1)]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>D(t),className:"px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"View Details"}),t.status==="pending"&&t.is_eligible_now&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>f(t),className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200",children:"✅ Approve"}),e.jsx("button",{onClick:()=>w(t),className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200",children:"❌ Reject"})]}),t.status==="approved"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>M(t),className:"px-3 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"💳 Razorpay Form"}),e.jsx("button",{onClick:()=>L(t),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"💰 Mark Disbursed"})]})]})]})]})},t.id)})})]})]})}function P({application:s,action:o,onSubmit:m}){const{notify:n}=C(),[c,p]=d.useState({reviewNotes:""}),[g,j]=d.useState(!1),u=async y=>{if(y.preventDefault(),!c.reviewNotes.trim()){n("Please provide review notes","error");return}j(!0);try{await m(c)}catch(_){console.error("Error submitting form:",_),n("Failed to submit form","error")}finally{j(!1)}};return e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Application Summary"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Employee:"})," ",s.employee_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",s.incentive_type_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amount:"})," ₹",s.incentive_amount]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Proof:"})," ",s.proof_details]})]})]}),e.jsx(E,{label:`${o==="approve"?"Approval":"Rejection"} Notes`,value:c.reviewNotes,onChange:y=>p({...c,reviewNotes:y}),placeholder:`Enter ${o==="approve"?"approval":"rejection"} notes and feedback...`,rows:4,required:!0}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g,className:`px-4 py-2 text-white rounded-md ${o==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"} disabled:opacity-50`,children:g?"Processing...":`${o==="approve"?"Approve":"Reject"} Application`})]})]})}function q({application:s}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx(A,{title:"Employee Information",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.employee_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.employee_email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Department"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.department})]})]})}),e.jsx(A,{title:"Incentive Details",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.incentive_type_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount"}),e.jsxs("p",{className:"text-sm text-gray-900",children:["₹",s.incentive_amount]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Application Date"}),e.jsx("p",{className:"text-sm text-gray-900",children:new Date(s.application_date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Eligible Date"}),e.jsx("p",{className:"text-sm text-gray-900",children:new Date(s.eligible_date).toLocaleDateString()})]})]})}),e.jsx(A,{title:"Proof Details",children:e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-900",children:s.proof_details})})}),e.jsx(A,{title:"Eligibility Status",children:e.jsx("div",{className:`p-4 rounded-lg ${s.is_eligible_now?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:e.jsx("p",{className:`text-sm ${s.is_eligible_now?"text-green-800":"text-yellow-800"}`,children:s.is_eligible_now?"✅ Eligible for approval":`⚠️ Not eligible until ${new Date(s.eligible_date).toLocaleDateString()}`})})})]})}function J({application:s,onSubmit:o}){const{notify:m}=C(),[n,c]=d.useState({reference:"",notes:""}),[p,g]=d.useState(!1),j=async u=>{if(u.preventDefault(),!n.reference.trim()){m("Please provide disbursement reference","error");return}g(!0);try{await o(n)}catch(y){console.error("Error submitting form:",y),m("Failed to submit form","error")}finally{g(!1)}};return e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Disbursement Details"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Employee:"})," ",s.employee_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amount:"})," ₹",s.incentive_amount]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",s.incentive_type_name]})]})]}),e.jsx(S,{label:"Disbursement Reference",value:n.reference,onChange:u=>c({...n,reference:u}),placeholder:"Enter Razorpay transaction ID or reference number",required:!0}),e.jsx(E,{label:"Disbursement Notes",value:n.notes,onChange:u=>c({...n,notes:u}),placeholder:"Enter any additional notes about the disbursement...",rows:3}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:p,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:p?"Processing...":"Mark as Disbursed"})]})]})}export{X as default};
