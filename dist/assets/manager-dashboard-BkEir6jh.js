const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-BxvMfToA.js","assets/react-vendor-z5qVsTvS.js","assets/auth-vNnhMft6.js","assets/supabase-vendor-DJqG3OLk.js"])))=>i.map(i=>d[i]);
var xx=Object.defineProperty;var vx=(r,e,t)=>e in r?xx(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var er=(r,e,t)=>vx(r,typeof e!="symbol"?e+"":e,t);import{r as E,R as ar,a as Jh}from"./react-vendor-z5qVsTvS.js";import{u as Fa}from"./auth-vNnhMft6.js";import{c as xp,_ as zs}from"./supabase-vendor-DJqG3OLk.js";var vp={exports:{}},f0={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yx=E,bx=Symbol.for("react.element"),wx=Symbol.for("react.fragment"),_x=Object.prototype.hasOwnProperty,Nx=yx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Sx={key:!0,ref:!0,__self:!0,__source:!0};function yp(r,e,t){var n,a={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)_x.call(e,n)&&!Sx.hasOwnProperty(n)&&(a[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:bx,type:r,key:s,ref:o,props:a,_owner:Nx.current}}f0.Fragment=wx;f0.jsx=yp;f0.jsxs=yp;vp.exports=f0;var i=vp.exports;let rl=null,sc=null;const Mc="https://igwgryykglsetfvomhdj.supabase.co",Yu="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlnd2dyeXlrZ2xzZXRmdm9taGRqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3NTcxMDgsImV4cCI6MjA3MDMzMzEwOH0.yL1hK263qf9msp7K4vUtF4Lvb7x7yxPcyvgkPiLokqA",bp="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlnd2dyeXlrZ2xzZXRmdm9taGRqIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NDc1NzEwOCwiZXhwIjoyMDcwMzMzMTA4fQ.VaKzl0eCysR9Vao5SeMD8w9RQHU7Aga8hnSmT2Vyld4";rl||console.log("üîß Supabase Client Initialization:",{SUPABASE_URL:"‚úÖ Set",SUPABASE_ANON_KEY:"‚úÖ Set",ADMIN_ACCESS_TOKEN:"‚úÖ Set"});const Ex=Mc.includes("placeholder")||Yu.includes("placeholder")&&bp.includes("placeholder");function Ax(){if(rl)return rl;if(Ex||!Mc||!Yu)return console.log("üîß Running in LOCAL MODE - Supabase credentials not configured"),null;try{return console.log("üîë Creating Supabase client with ANON key"),rl=xp(Mc,Yu,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},db:{schema:"public"},global:{headers:{"x-client-info":"bptm-dashboard"}},realtime:{params:{eventsPerSecond:10}}}),console.log("‚úÖ Supabase client created successfully"),rl}catch(r){return console.error("‚ùå Failed to create Supabase client:",r),null}}function Cx(){if(sc)return sc;try{return console.log("üîë Creating Admin Supabase client"),sc=xp(Mc,bp,{auth:{autoRefreshToken:!0,persistSession:!0},db:{schema:"public"},global:{headers:{"x-client-info":"bptm-dashboard-admin"}}}),console.log("‚úÖ Admin Supabase client created successfully"),sc}catch(r){return console.error("‚ùå Failed to create Admin Supabase client:",r),null}}const dt=Ax();Cx();console.log("üì¶ SupabaseProvider using centralized client");const wp=E.createContext(dt),AC=({children:r})=>i.jsx(wp.Provider,{value:dt,children:r}),ha=()=>{const r=E.useContext(wp);if(r===void 0)throw new Error("useSupabase must be used within a SupabaseProvider");return{supabase:r}};var jx=Object.defineProperty,kx=(r,e,t)=>e in r?jx(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,uu=(r,e,t)=>(kx(r,typeof e!="symbol"?e+"":e,t),t);let Tx=class{constructor(){uu(this,"current",this.detect()),uu(this,"handoffState","pending"),uu(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Cc=new Tx,fl=(r,e)=>{Cc.isServer?E.useEffect(r,e):E.useLayoutEffect(r,e)};function ao(r){let e=E.useRef(r);return fl(()=>{e.current=r},[r]),e}let xs=function(r){let e=ao(r);return ar.useCallback((...t)=>e.current(...t),[e])};function Lx(r){typeof queueMicrotask=="function"?queueMicrotask(r):Promise.resolve().then(r).catch(e=>setTimeout(()=>{throw e}))}function El(){let r=[],e={addEventListener(t,n,a,s){return t.addEventListener(n,a,s),e.add(()=>t.removeEventListener(n,a,s))},requestAnimationFrame(...t){let n=requestAnimationFrame(...t);return e.add(()=>cancelAnimationFrame(n))},nextFrame(...t){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...t))},setTimeout(...t){let n=setTimeout(...t);return e.add(()=>clearTimeout(n))},microTask(...t){let n={current:!0};return Lx(()=>{n.current&&t[0]()}),e.add(()=>{n.current=!1})},style(t,n,a){let s=t.style.getPropertyValue(n);return Object.assign(t.style,{[n]:a}),this.add(()=>{Object.assign(t.style,{[n]:s})})},group(t){let n=El();return t(n),this.add(()=>n.dispose())},add(t){return r.push(t),()=>{let n=r.indexOf(t);if(n>=0)for(let a of r.splice(n,1))a()}},dispose(){for(let t of r.splice(0))t()}};return e}function _p(){let[r]=E.useState(El);return E.useEffect(()=>()=>r.dispose(),[r]),r}function Fx(){let r=typeof document>"u";return"useSyncExternalStore"in Jh?(e=>e.useSyncExternalStore)(Jh)(()=>()=>{},()=>!1,()=>!r):!1}function Np(){let r=Fx(),[e,t]=E.useState(Cc.isHandoffComplete);return e&&Cc.isHandoffComplete===!1&&t(!1),E.useEffect(()=>{e!==!0&&t(!0)},[e]),E.useEffect(()=>Cc.handoff(),[]),r?!1:e}function Ja(r,e,...t){if(r in e){let a=e[r];return typeof a=="function"?a(...t):a}let n=new Error(`Tried to handle "${r}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(a=>`"${a}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Ja),n}let Px=Symbol();function Sp(...r){let e=E.useRef(r);E.useEffect(()=>{e.current=r},[r]);let t=xs(n=>{for(let a of e.current)a!=null&&(typeof a=="function"?a(n):a.current=n)});return r.every(n=>n==null||(n==null?void 0:n[Px]))?void 0:t}function Bc(...r){return Array.from(new Set(r.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}var Ep=(r=>(r[r.None=0]="None",r[r.RenderStrategy=1]="RenderStrategy",r[r.Static=2]="Static",r))(Ep||{}),Vs=(r=>(r[r.Unmount=0]="Unmount",r[r.Hidden=1]="Hidden",r))(Vs||{});function Ap({ourProps:r,theirProps:e,slot:t,defaultTag:n,features:a,visible:s=!0,name:o,mergeRefs:l}){l=l??Rx;let c=Cp(e,r);if(s)return ic(c,t,n,o,l);let u=a??0;if(u&2){let{static:d=!1,...p}=c;if(d)return ic(p,t,n,o,l)}if(u&1){let{unmount:d=!0,...p}=c;return Ja(d?0:1,{0(){return null},1(){return ic({...p,hidden:!0,style:{display:"none"}},t,n,o,l)}})}return ic(c,t,n,o,l)}function ic(r,e={},t,n,a){let{as:s=t,children:o,refName:l="ref",...c}=du(r,["unmount","static"]),u=r.ref!==void 0?{[l]:r.ref}:{},d=typeof o=="function"?o(e):o;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(e));let p={};if(e){let g=!1,h=[];for(let[b,x]of Object.entries(e))typeof x=="boolean"&&(g=!0),x===!0&&h.push(b);g&&(p["data-headlessui-state"]=h.join(" "))}if(s===E.Fragment&&Object.keys(Zh(c)).length>0){if(!E.isValidElement(d)||Array.isArray(d)&&d.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(c).map(x=>`  - ${x}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(x=>`  - ${x}`).join(`
`)].join(`
`));let g=d.props,h=typeof(g==null?void 0:g.className)=="function"?(...x)=>Bc(g==null?void 0:g.className(...x),c.className):Bc(g==null?void 0:g.className,c.className),b=h?{className:h}:{};return E.cloneElement(d,Object.assign({},Cp(d.props,Zh(du(c,["ref"]))),p,u,{ref:a(d.ref,u.ref)},b))}return E.createElement(s,Object.assign({},du(c,["ref"]),s!==E.Fragment&&u,s!==E.Fragment&&p),d)}function Rx(...r){return r.every(e=>e==null)?void 0:e=>{for(let t of r)t!=null&&(typeof t=="function"?t(e):t.current=e)}}function Cp(...r){if(r.length===0)return{};if(r.length===1)return r[0];let e={},t={};for(let n of r)for(let a in n)a.startsWith("on")&&typeof n[a]=="function"?(t[a]!=null||(t[a]=[]),t[a].push(n[a])):e[a]=n[a];if(e.disabled||e["aria-disabled"])return Object.assign(e,Object.fromEntries(Object.keys(t).map(n=>[n,void 0])));for(let n in t)Object.assign(e,{[n](a,...s){let o=t[n];for(let l of o){if((a instanceof Event||(a==null?void 0:a.nativeEvent)instanceof Event)&&a.defaultPrevented)return;l(a,...s)}}});return e}function md(r){var e;return Object.assign(E.forwardRef(r),{displayName:(e=r.displayName)!=null?e:r.name})}function Zh(r){let e=Object.assign({},r);for(let t in e)e[t]===void 0&&delete e[t];return e}function du(r,e=[]){let t=Object.assign({},r);for(let n of e)n in t&&delete t[n];return t}let pd=E.createContext(null);pd.displayName="OpenClosedContext";var ps=(r=>(r[r.Open=1]="Open",r[r.Closed=2]="Closed",r[r.Closing=4]="Closing",r[r.Opening=8]="Opening",r))(ps||{});function jp(){return E.useContext(pd)}function Dx({value:r,children:e}){return ar.createElement(pd.Provider,{value:r},e)}function gd(){let r=E.useRef(!1);return fl(()=>(r.current=!0,()=>{r.current=!1}),[]),r}function Ox(r=0){let[e,t]=E.useState(r),n=gd(),a=E.useCallback(c=>{n.current&&t(u=>u|c)},[e,n]),s=E.useCallback(c=>!!(e&c),[e]),o=E.useCallback(c=>{n.current&&t(u=>u&~c)},[t,n]),l=E.useCallback(c=>{n.current&&t(u=>u^c)},[t]);return{flags:e,addFlag:a,hasFlag:s,removeFlag:o,toggleFlag:l}}function Ix(r){let e={called:!1};return(...t)=>{if(!e.called)return e.called=!0,r(...t)}}function hu(r,...e){r&&e.length>0&&r.classList.add(...e)}function fu(r,...e){r&&e.length>0&&r.classList.remove(...e)}function Mx(r,e){let t=El();if(!r)return t.dispose;let{transitionDuration:n,transitionDelay:a}=getComputedStyle(r),[s,o]=[n,a].map(c=>{let[u=0]=c.split(",").filter(Boolean).map(d=>d.includes("ms")?parseFloat(d):parseFloat(d)*1e3).sort((d,p)=>p-d);return u}),l=s+o;if(l!==0){t.group(u=>{u.setTimeout(()=>{e(),u.dispose()},l),u.addEventListener(r,"transitionrun",d=>{d.target===d.currentTarget&&u.dispose()})});let c=t.addEventListener(r,"transitionend",u=>{u.target===u.currentTarget&&(e(),c())})}else e();return t.add(()=>e()),t.dispose}function Bx(r,e,t,n){let a=t?"enter":"leave",s=El(),o=n!==void 0?Ix(n):()=>{};a==="enter"&&(r.removeAttribute("hidden"),r.style.display="");let l=Ja(a,{enter:()=>e.enter,leave:()=>e.leave}),c=Ja(a,{enter:()=>e.enterTo,leave:()=>e.leaveTo}),u=Ja(a,{enter:()=>e.enterFrom,leave:()=>e.leaveFrom});return fu(r,...e.base,...e.enter,...e.enterTo,...e.enterFrom,...e.leave,...e.leaveFrom,...e.leaveTo,...e.entered),hu(r,...e.base,...l,...u),s.nextFrame(()=>{fu(r,...e.base,...l,...u),hu(r,...e.base,...l,...c),Mx(r,()=>(fu(r,...e.base,...l),hu(r,...e.base,...e.entered),o()))}),s.dispose}function Ux({immediate:r,container:e,direction:t,classes:n,onStart:a,onStop:s}){let o=gd(),l=_p(),c=ao(t);fl(()=>{r&&(c.current="enter")},[r]),fl(()=>{let u=El();l.add(u.dispose);let d=e.current;if(d&&c.current!=="idle"&&o.current)return u.dispose(),a.current(c.current),u.add(Bx(d,n.current,c.current==="enter",()=>{u.dispose(),s.current(c.current)})),u.dispose},[t])}function Hs(r=""){return r.split(/\s+/).filter(e=>e.length>1)}let m0=E.createContext(null);m0.displayName="TransitionContext";var Hx=(r=>(r.Visible="visible",r.Hidden="hidden",r))(Hx||{});function $x(){let r=E.useContext(m0);if(r===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return r}function qx(){let r=E.useContext(p0);if(r===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return r}let p0=E.createContext(null);p0.displayName="NestingContext";function g0(r){return"children"in r?g0(r.children):r.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function kp(r,e){let t=ao(r),n=E.useRef([]),a=gd(),s=_p(),o=xs((h,b=Vs.Hidden)=>{let x=n.current.findIndex(({el:y})=>y===h);x!==-1&&(Ja(b,{[Vs.Unmount](){n.current.splice(x,1)},[Vs.Hidden](){n.current[x].state="hidden"}}),s.microTask(()=>{var y;!g0(n)&&a.current&&((y=t.current)==null||y.call(t))}))}),l=xs(h=>{let b=n.current.find(({el:x})=>x===h);return b?b.state!=="visible"&&(b.state="visible"):n.current.push({el:h,state:"visible"}),()=>o(h,Vs.Unmount)}),c=E.useRef([]),u=E.useRef(Promise.resolve()),d=E.useRef({enter:[],leave:[],idle:[]}),p=xs((h,b,x)=>{c.current.splice(0),e&&(e.chains.current[b]=e.chains.current[b].filter(([y])=>y!==h)),e==null||e.chains.current[b].push([h,new Promise(y=>{c.current.push(y)})]),e==null||e.chains.current[b].push([h,new Promise(y=>{Promise.all(d.current[b].map(([v,_])=>_)).then(()=>y())})]),b==="enter"?u.current=u.current.then(()=>e==null?void 0:e.wait.current).then(()=>x(b)):x(b)}),g=xs((h,b,x)=>{Promise.all(d.current[b].splice(0).map(([y,v])=>v)).then(()=>{var y;(y=c.current.shift())==null||y()}).then(()=>x(b))});return E.useMemo(()=>({children:n,register:l,unregister:o,onStart:p,onStop:g,wait:u,chains:d}),[l,o,n,p,g,d,u])}function Wx(){}let zx=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function Qh(r){var e;let t={};for(let n of zx)t[n]=(e=r[n])!=null?e:Wx;return t}function Vx(r){let e=E.useRef(Qh(r));return E.useEffect(()=>{e.current=Qh(r)},[r]),e}let Gx="div",Tp=Ep.RenderStrategy;function Kx(r,e){var t,n;let{beforeEnter:a,afterEnter:s,beforeLeave:o,afterLeave:l,enter:c,enterFrom:u,enterTo:d,entered:p,leave:g,leaveFrom:h,leaveTo:b,...x}=r,y=E.useRef(null),v=Sp(y,e),_=(t=x.unmount)==null||t?Vs.Unmount:Vs.Hidden,{show:S,appear:j,initial:I}=$x(),[J,k]=E.useState(S?"visible":"hidden"),F=qx(),{register:T,unregister:R}=F;E.useEffect(()=>T(y),[T,y]),E.useEffect(()=>{if(_===Vs.Hidden&&y.current){if(S&&J!=="visible"){k("visible");return}return Ja(J,{hidden:()=>R(y),visible:()=>T(y)})}},[J,y,T,R,S,_]);let A=ao({base:Hs(x.className),enter:Hs(c),enterFrom:Hs(u),enterTo:Hs(d),entered:Hs(p),leave:Hs(g),leaveFrom:Hs(h),leaveTo:Hs(b)}),P=Vx({beforeEnter:a,afterEnter:s,beforeLeave:o,afterLeave:l}),H=Np();E.useEffect(()=>{if(H&&J==="visible"&&y.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[y,J,H]);let K=I&&!j,ce=j&&S&&I,me=!H||K?"idle":S?"enter":"leave",le=Ox(0),xe=xs(D=>Ja(D,{enter:()=>{le.addFlag(ps.Opening),P.current.beforeEnter()},leave:()=>{le.addFlag(ps.Closing),P.current.beforeLeave()},idle:()=>{}})),we=xs(D=>Ja(D,{enter:()=>{le.removeFlag(ps.Opening),P.current.afterEnter()},leave:()=>{le.removeFlag(ps.Closing),P.current.afterLeave()},idle:()=>{}})),Oe=kp(()=>{k("hidden"),R(y)},F),ge=E.useRef(!1);Ux({immediate:ce,container:y,classes:A,direction:me,onStart:ao(D=>{ge.current=!0,Oe.onStart(y,D,xe)}),onStop:ao(D=>{ge.current=!1,Oe.onStop(y,D,we),D==="leave"&&!g0(Oe)&&(k("hidden"),R(y))})});let C=x,O={ref:v};return ce?C={...C,className:Bc(x.className,...A.current.enter,...A.current.enterFrom)}:ge.current&&(C.className=Bc(x.className,(n=y.current)==null?void 0:n.className),C.className===""&&delete C.className),ar.createElement(p0.Provider,{value:Oe},ar.createElement(Dx,{value:Ja(J,{visible:ps.Open,hidden:ps.Closed})|le.flags},Ap({ourProps:O,theirProps:C,defaultTag:Gx,features:Tp,visible:J==="visible",name:"Transition.Child"})))}function Yx(r,e){let{show:t,appear:n=!1,unmount:a=!0,...s}=r,o=E.useRef(null),l=Sp(o,e);Np();let c=jp();if(t===void 0&&c!==null&&(t=(c&ps.Open)===ps.Open),![!0,!1].includes(t))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[u,d]=E.useState(t?"visible":"hidden"),p=kp(()=>{d("hidden")}),[g,h]=E.useState(!0),b=E.useRef([t]);fl(()=>{g!==!1&&b.current[b.current.length-1]!==t&&(b.current.push(t),h(!1))},[b,t]);let x=E.useMemo(()=>({show:t,appear:n,initial:g}),[t,n,g]);E.useEffect(()=>{if(t)d("visible");else if(!g0(p))d("hidden");else{let S=o.current;if(!S)return;let j=S.getBoundingClientRect();j.x===0&&j.y===0&&j.width===0&&j.height===0&&d("hidden")}},[t,p]);let y={unmount:a},v=xs(()=>{var S;g&&h(!1),(S=r.beforeEnter)==null||S.call(r)}),_=xs(()=>{var S;g&&h(!1),(S=r.beforeLeave)==null||S.call(r)});return ar.createElement(p0.Provider,{value:p},ar.createElement(m0.Provider,{value:x},Ap({ourProps:{...y,as:E.Fragment,children:ar.createElement(Lp,{ref:l,...y,...s,beforeEnter:v,beforeLeave:_})},theirProps:{},defaultTag:E.Fragment,features:Tp,visible:u==="visible",name:"Transition"})))}function Xx(r,e){let t=E.useContext(m0)!==null,n=jp()!==null;return ar.createElement(ar.Fragment,null,!t&&n?ar.createElement(Xu,{ref:e,...r}):ar.createElement(Lp,{ref:e,...r}))}let Xu=md(Yx),Lp=md(Kx),Jx=md(Xx),Zx=Object.assign(Xu,{Child:Jx,Root:Xu});function Qx({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.26 10.147a60.438 60.438 0 0 0-.491 6.347A48.62 48.62 0 0 1 12 20.904a48.62 48.62 0 0 1 8.232-4.41 60.46 60.46 0 0 0-.491-6.347m-15.482 0a50.636 50.636 0 0 0-2.658-.813A59.906 59.906 0 0 1 12 3.493a59.903 59.903 0 0 1 10.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.717 50.717 0 0 1 12 13.489a50.702 50.702 0 0 1 7.74-3.342M6.75 15a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm0 0v-3.675A55.378 55.378 0 0 1 12 8.443m-7.007 11.55A5.981 5.981 0 0 0 6.75 15.75v-1.5"}))}const jC=E.forwardRef(Qx);function ev({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const kC=E.forwardRef(ev);function tv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"}))}const TC=E.forwardRef(tv);function rv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const LC=E.forwardRef(rv);function nv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const FC=E.forwardRef(nv);function av({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"}))}const PC=E.forwardRef(av);function sv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const RC=E.forwardRef(sv);function iv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const DC=E.forwardRef(iv);function ov({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const OC=E.forwardRef(ov);function lv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const IC=E.forwardRef(lv);function cv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const MC=E.forwardRef(cv);function uv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const BC=E.forwardRef(uv);function dv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"}))}const UC=E.forwardRef(dv);function hv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))}const HC=E.forwardRef(hv);function fv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const $C=E.forwardRef(fv);function mv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const qC=E.forwardRef(mv);function pv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const WC=E.forwardRef(pv);function gv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const zC=E.forwardRef(gv);function xv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v1.5M3 21v-6m0 0 2.77-.693a9 9 0 0 1 6.208.682l.108.054a9 9 0 0 0 6.086.71l3.114-.732a48.524 48.524 0 0 1-.005-10.499l-3.11.732a9 9 0 0 1-6.085-.711l-.108-.054a9 9 0 0 0-6.208-.682L3 4.5M3 15V4.5"}))}const VC=E.forwardRef(xv);function vv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const GC=E.forwardRef(vv);function yv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const KC=E.forwardRef(yv);function bv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"}))}const YC=E.forwardRef(bv);function wv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const XC=E.forwardRef(wv);function _v({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"}))}const JC=E.forwardRef(_v);function Nv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"}))}const ZC=E.forwardRef(Nv);function Sv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const QC=E.forwardRef(Sv);function Ev({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const ej=E.forwardRef(Ev);function Av({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const tj=E.forwardRef(Av);function Cv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const rj=E.forwardRef(Cv);function jv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const nj=E.forwardRef(jv);function kv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0 1 18 16.5h-2.25m-7.5 0h7.5m-7.5 0-1 3m8.5-3 1 3m0 0 .5 1.5m-.5-1.5h-9.5m0 0-.5 1.5m.75-9 3-3 2.148 2.148A12.061 12.061 0 0 1 16.5 7.605"}))}const aj=E.forwardRef(kv);function Tv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"}))}const sj=E.forwardRef(Tv);function Lv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const ij=E.forwardRef(Lv);function Fv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))}const oj=E.forwardRef(Fv);function Pv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"}))}const lj=E.forwardRef(Pv);function Rv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const cj=E.forwardRef(Rv);function Dv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 0 1 2.916.52 6.003 6.003 0 0 1-5.395 4.972m0 0a6.726 6.726 0 0 1-2.749 1.35m0 0a6.772 6.772 0 0 1-3.044 0"}))}const uj=E.forwardRef(Dv);function Ov({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const dj=E.forwardRef(Ov);function Iv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const hj=E.forwardRef(Iv);function Mv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const fj=E.forwardRef(Mv);function Bv({title:r,titleId:e,...t},n){return E.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},t),r?E.createElement("title",{id:e},r):null,E.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const mj=E.forwardRef(Bv),Uv=ar.createContext({notify:()=>{}}),Fn=()=>ar.useContext(Uv),Fp=E.createContext(),pj=({children:r})=>{const{supabase:e}=ha(),{notify:t}=Fn(),[n,a]=E.useState([]),[s,o]=E.useState([]),[l,c]=E.useState(!0),u=async()=>{if(!e){console.log("No Supabase client - loading clients from localStorage");const _=JSON.parse(localStorage.getItem("clients")||"[]");a(_);return}try{const{data:_,error:S}=await e.from("client_onboarding").select("*").order("created_at",{ascending:!1});if(S)throw S;const j=(_||[]).map(I=>({id:I.id,name:I.company_name||I.business_name||"Unnamed Client",description:I.business_description||I.company_description||"No description available",type:I.business_type||"Standard",industry:I.industry,services:I.services_selected?Array.isArray(I.services_selected)?I.services_selected:[I.services_selected]:[],status:I.submission_status==="submitted"?"active":"pending",assigned_employee:I.assigned_team,contact_person:I.contact_person,email:I.email,phone:I.phone,website:I.website,location:I.location||`${I.city||""}, ${I.state||""}`.trim().replace(/^,\s*|,\s*$/g,""),created_at:I.created_at,updated_at:I.updated_at,target_audience:I.target_audience,business_goals:I.business_goals,marketing_budget:I.marketing_budget,current_challenges:I.current_challenges}));a(j)}catch(_){console.error("Error fetching clients from client_onboarding:",_),t("Failed to fetch clients","error")}},d=async()=>{if(!e){console.log("No Supabase client - loading employees from localStorage");const _=JSON.parse(localStorage.getItem("employees")||"[]");o(_);return}try{const{data:_,error:S}=await e.from("employees").select("*").order("created_at",{ascending:!1});if(S)throw S;o(_||[])}catch(_){console.error("Error fetching employees:",_),t("Failed to fetch employees","error")}},p=_=>{a(S=>[_,...S])},g=(_,S)=>{a(j=>j.map(I=>I.id===_?{...I,...S}:I))},h=_=>{a(S=>S.filter(j=>j.id!==_))},b=_=>{o(S=>[_,...S])},x=(_,S)=>{o(j=>j.map(I=>I.id===_?{...I,...S}:I))},y=_=>{o(S=>S.filter(j=>j.id!==_))};E.useEffect(()=>{if((async()=>{c(!0),await Promise.all([u(),d()]),c(!1)})(),e){const S=e.channel("client_onboarding_changes").on("postgres_changes",{event:"*",schema:"public",table:"client_onboarding"},I=>{console.log("Client onboarding change detected:",I),u()}).subscribe(),j=e.channel("employees_changes").on("postgres_changes",{event:"*",schema:"public",table:"employees"},I=>{console.log("Employee change detected:",I),d()}).subscribe();return()=>{e.removeChannel(S),e.removeChannel(j)}}},[e]);const v={clients:n,employees:s,loading:l,fetchClients:u,fetchEmployees:d,addClient:p,updateClient:g,removeClient:h,addEmployee:b,updateEmployee:x,removeEmployee:y};return i.jsx(Fp.Provider,{value:v,children:r})},go=()=>{const r=E.useContext(Fp);if(!r)throw new Error("useDataSync must be used within a DataSyncProvider");return r};async function Hv(r){if(!r)return console.log("No Supabase client available"),!1;try{const{data:e,error:t}=await r.from("employees").select("count").limit(1);return t?t.code==="PGRST205"?(console.log("‚ö†Ô∏è  Employees table does not exist in the database."),console.log("üìã Please create the employees table manually in your Supabase dashboard."),console.log("üí° You can use the SQL from database/schemas/create_employees_table.sql"),[]):(console.error("Unexpected error checking employees table:",t),[]):(console.log("Employees table already exists"),!0)}catch(e){return console.error("Error in ensureEmployeesTableExists:",e),[]}}async function $v(r,e){if(!r)return console.log("No Supabase client available - running in local mode"),e;try{const{name:t,phone:n,department:a,role:s}=e;if(!t||!n)throw new Error("Employee name and phone are required");const{data:o,error:l}=await r.from("employees").select("*").eq("name",t).eq("phone",n).single();if(l&&l.code!=="PGRST116")throw l;if(o){if(o.department!==a||JSON.stringify(o.role)!==JSON.stringify(s)){const{data:p,error:g}=await r.from("employees").update({department:a,role:s,updated_at:new Date().toISOString()}).eq("id",o.id).select("*").single();if(g)throw g;return console.log("‚úÖ Employee updated:",p.name),p}return console.log("‚úÖ Employee found:",o.name),o}const{data:c,error:u}=await r.from("employees").insert({name:t,phone:n,email:`${n}@company.com`,department:a,role:s,status:"Active"}).select("*").single();if(u)throw u;return console.log("‚úÖ Employee created:",c.name),c}catch(t){return console.error("Error in getOrCreateEmployee:",t),e}}async function qv(r){if(!r)return console.log("No Supabase client available - running in local mode"),[];try{const{data:e,error:t}=await r.from("employees").select("*").eq("status","Active").order("name");if(t){if(t.code==="PGRST205")return console.log("Employees table does not exist"),[];throw t}return e||[]}catch(e){return console.error("Error fetching employees:",e),[]}}class Pp{constructor(e,t){this.supabase=e,this.notify=t,this.tableChecks=new Map,this.retryAttempts=new Map}async handleError(e,t="database operation",n={}){const a=`err_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,s=new Date().toISOString();console.group(`üö® Database Error [${a}]`),console.error(`Operation: ${t}`),console.error(`Timestamp: ${s}`),console.error("Error:",e),console.error("Context:",n),console.groupEnd();const o=this.parseError(e);o.errorId=a,o.timestamp=s,o.operation=t,o.context=n;const l=n.retryAttempt||0,c=n.maxRetries||3,u=this.shouldRetry(e,t,l);this.logError(o);let d;switch(o.type){case"TABLE_NOT_FOUND":d=await this.handleTableNotFound(o,t,n);break;case"COLUMN_NOT_FOUND":d=await this.handleColumnNotFound(o,t,n);break;case"CONNECTION_ERROR":d=await this.handleConnectionError(o,t,n);break;case"VALIDATION_ERROR":d=await this.handleValidationError(o,t,n);break;case"PERMISSION_ERROR":d=await this.handlePermissionError(o,t,n);break;case"TIMEOUT_ERROR":d=await this.handleTimeoutError(o,t,n);break;case"RATE_LIMIT_ERROR":d=await this.handleRateLimitError(o,t,n);break;default:d=await this.handleGenericError(o,t,n)}if(u&&l<c&&d.retry){console.log(`üîÑ Retrying operation '${t}' (attempt ${l+1}/${c})`);const p=Math.min(1e3*Math.pow(2,l),1e4);return await new Promise(g=>setTimeout(g,p)),{...d,retry:!0,retryDelay:p,retryAttempt:l+1}}return d}parseError(e){const t=e==null?void 0:e.code,n=(e==null?void 0:e.message)||(e==null?void 0:e.toString())||"Unknown error";if(t==="PGRST205"||n.includes("relation")&&n.includes("does not exist")){const a=this.extractTableName(n);return{type:"TABLE_NOT_FOUND",code:t,message:n,tableName:a,userMessage:`Database table '${a}' is not set up yet.`}}if(t==="42703"||n.includes("column")&&n.includes("does not exist")){const a=this.extractColumnName(n);return{type:"COLUMN_NOT_FOUND",code:t,message:n,columnName:a,userMessage:`Database structure needs to be updated (missing column: ${a}).`}}return n.includes("network")||n.includes("connection")||n.includes("timeout")?{type:"CONNECTION_ERROR",code:t,message:n,userMessage:"Unable to connect to the database. Please check your internet connection."}:t==="23505"||n.includes("duplicate")||n.includes("unique constraint")?{type:"VALIDATION_ERROR",code:t,message:n,userMessage:"This record already exists or conflicts with existing data."}:t==="42501"||n.includes("permission")||n.includes("access")?{type:"PERMISSION_ERROR",code:t,message:n,userMessage:"You do not have permission to perform this action."}:n.includes("timeout")||n.includes("timed out")||e.name==="AbortError"?{type:"TIMEOUT_ERROR",code:t,message:n,userMessage:"The operation timed out. Please check your connection and try again."}:t==="429"||n.includes("rate limit")||n.includes("too many requests")?{type:"RATE_LIMIT_ERROR",code:t,message:n,userMessage:"Too many requests. Please wait a moment and try again."}:t>="500"&&t<"600"?{type:"SERVER_ERROR",code:t,message:n,userMessage:"Server error occurred. Please try again in a few moments."}:{type:"GENERIC_ERROR",code:t,message:n,userMessage:"An unexpected error occurred. Please try again."}}async handleTableNotFound(e,t,n){const{tableName:a}=e;return this.notify({type:"error",title:"Database Setup Required",message:`The ${a} table needs to be set up. Please contact your administrator or check the database setup guide.`,duration:8e3}),t.includes("fetch")||t.includes("load")?{data:[],error:null,fallback:!0}:{data:null,error:e,fallback:!0}}async handleColumnNotFound(e,t,n){const{columnName:a}=e;return this.notify({type:"warning",title:"Database Update Needed",message:`The database structure is outdated (missing: ${a}). Some features may not work properly.`,duration:6e3}),{data:null,error:e,fallback:!0}}async handleConnectionError(e,t,n){const a=`${t}_${Date.now()}`,s=this.retryAttempts.get(a)||0;return s<2?(this.retryAttempts.set(a,s+1),this.notify({type:"warning",title:"Connection Issue",message:`Retrying ${t}... (Attempt ${s+1}/3)`,duration:3e3}),await new Promise(o=>setTimeout(o,1e3*(s+1))),{retry:!0,attempt:s+1}):(this.notify({type:"error",title:"Connection Failed",message:"Unable to connect to the database after multiple attempts. Please check your internet connection and try again.",duration:8e3}),{data:null,error:e,fallback:!0})}async handleValidationError(e,t,n){return this.notify({type:"error",title:"Validation Error",message:e.userMessage,duration:5e3}),{data:null,error:e,fallback:!1}}async handlePermissionError(e,t,n){return this.notify({type:"error",title:"Access Denied",message:e.userMessage,duration:6e3}),{data:null,error:e,fallback:!1}}async handleTimeoutError(e,t,n){return this.notify({type:"warning",title:"Operation Timed Out",message:e.userMessage,duration:6e3}),{data:null,error:e,fallback:!0,retry:!0}}async handleRateLimitError(e,t,n){return this.notify({type:"warning",title:"Rate Limit Exceeded",message:e.userMessage,duration:8e3}),await new Promise(a=>setTimeout(a,5e3)),{data:null,error:e,fallback:!0,retry:!0}}async handleGenericError(e,t,n){return this.notify({type:"error",title:"Operation Failed",message:`${t} failed: ${e.userMessage}`,duration:5e3}),{data:null,error:e,fallback:!1}}extractTableName(e){const t=e.match(/relation "([^"]+)" does not exist/)||e.match(/table "([^"]+)" does not exist/)||e.match(/from "([^"]+)"/);return t?t[1]:"unknown"}extractColumnName(e){const t=e.match(/column "([^"]+)" does not exist/)||e.match(/column ([^\s]+) does not exist/);return t?t[1]:"unknown"}shouldRetry(e,t,n=0){const a=this.parseError(e);return a.type==="TABLE_NOT_FOUND"||a.type==="COLUMN_NOT_FOUND"||a.type==="VALIDATION_ERROR"||a.type==="PERMISSION_ERROR"?!1:a.type==="CONNECTION_ERROR"&&n<3||a.type==="TIMEOUT_ERROR"&&n<2||a.type==="RATE_LIMIT_ERROR"&&n<2}logError(e){try{const t=JSON.parse(localStorage.getItem("errorLog")||"[]");t.push({...e,userAgent:navigator.userAgent,url:window.location.href}),t.length>50&&t.splice(0,t.length-50),localStorage.setItem("errorLog",JSON.stringify(t))}catch(t){console.warn("Failed to log error:",t)}}}class Wv{constructor(e,t,n){this.supabase=e,this.notify=t,this.openModal=n,this.errorHandler=new Pp(e,t)}async submitForm(e,t={}){const{tableName:n="submissions",operation:a="insert",validationRules:s={},onSuccess:o=null,onError:l=null,showSuccessModal:c=!0}=t;try{const u=this.validateFormData(e,s);if(!u.isValid)return this.handleValidationFailure(u.errors),{success:!1,errors:u.errors};let d;if(a==="update"&&e.id?d=await this.supabase.from(n).update(e).eq("id",e.id).select().single():d=await this.supabase.from(n).insert([e]).select().single(),d.error)throw d.error;return c&&this.showSuccessModal(a,d.data),o&&await o(d.data),{success:!0,data:d.data}}catch(u){const d=await this.errorHandler.handleError(u,`form submission to ${n}`,{formData:e});return d.retry?this.submitForm(e,{...t,_retryAttempt:(t._retryAttempt||0)+1}):(l&&await l(d),{success:!1,error:d})}}validateFormData(e,t){const n=[];return t.required&&t.required.forEach(a=>{const s=this.getNestedValue(e,a);(!s||typeof s=="string"&&!s.trim())&&n.push(`${a} is required`)}),t.custom&&t.custom.forEach(a=>{const s=a(e);s!==!0&&n.push(s)}),{isValid:n.length===0,errors:n}}getNestedValue(e,t){return t.split(".").reduce((n,a)=>n==null?void 0:n[a],e)}handleValidationFailure(e){this.notify({type:"error",title:"Validation Failed",message:`Please fix the following issues:
${e.map((t,n)=>`${n+1}. ${t}`).join(`
`)}`,duration:8e3})}showSuccessModal(e,t){const n=e==="update"?"Updated Successfully":"Submitted Successfully",a=e==="update"?"Your changes have been saved.":"Your form has been submitted successfully.";this.openModal?this.openModal({title:n,content:a,actions:[{label:"OK",onClick:()=>{},variant:"primary"}]}):this.notify({type:"success",title:n,message:a,duration:5e3})}}function zv(r,e,t=null){return{database:new Pp(r,e),form:new Wv(r,e,t)}}const Rp=E.createContext(null),Al=()=>{const r=E.useContext(Rp);if(!r)throw new Error("useEmployeeSync must be used within an EmployeeSyncProvider");return r},gj=ar.memo(({children:r})=>{const{supabase:e}=ha(),{notify:t}=Fn(),[n,a]=E.useState([]),[s,o]=E.useState(!0),[l,c]=E.useState(Date.now()),[u,d]=E.useState(null);E.useEffect(()=>{e&&t&&d(zv(e,t))},[e,t]);const p=E.useCallback(async(F=!1,T=0)=>{if(!e)try{const R=localStorage.getItem("codex_employees")||"[]";let A=JSON.parse(R);if(A.length===0){console.log("No employees found in localStorage, populating with test data...");const P=[{id:"emp_001",full_name:"Jessica Martinez",name:"Jessica Martinez",phone:"5551234567",email:"jessica.martinez@company.com",department:"Web",role:["Developer","Designer"],status:"Active",hire_date:"2023-01-15",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"emp_002",full_name:"David Thompson",name:"David Thompson",phone:"5551234568",email:"david.thompson@company.com",department:"Marketing",role:["Marketing Manager","Content Creator"],status:"Active",hire_date:"2023-02-20",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"emp_003",full_name:"Sarah Chen",name:"Sarah Chen",phone:"5551234569",email:"sarah.chen@company.com",department:"Sales",role:["Sales Executive","Client Manager"],status:"Active",hire_date:"2023-03-10",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"emp_004",full_name:"Michael Rodriguez",name:"Michael Rodriguez",phone:"5551234570",email:"michael.rodriguez@company.com",department:"HR",role:["HR Manager"],status:"Active",hire_date:"2023-04-05",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"emp_005",full_name:"Emily Johnson",name:"Emily Johnson",phone:"5551234571",email:"emily.johnson@company.com",department:"Web",role:["Full Stack Developer"],status:"Active",hire_date:"2023-05-12",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"emp_006",full_name:"Alex Williams",name:"Alex Williams",phone:"5551234572",email:"alex.williams@company.com",department:"Marketing",role:["Digital Marketing Specialist"],status:"Active",hire_date:"2023-06-18",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}];localStorage.setItem("codex_employees",JSON.stringify(P)),A=P,console.log("‚úÖ Populated localStorage with",P.length,"test employees")}return a(A),o(!1),A}catch(R){return console.error("Error loading local employees:",R),a([]),o(!1),[]}try{F&&o(!0);const R=await Hv(e);if(Array.isArray(R))return a(R),o(!1),R;const A=await qv(e);return a(A||[]),c(Date.now()),o(!1),A||[]}catch(R){return console.error("Error fetching employees in sync context:",R),u?await u.database.handleError(R,"fetch employees"):console.warn("Error handler not available, using fallback"),a([]),o(!1),[]}},[e]);E.useEffect(()=>{if(!e){p(!0);return}console.log("üë• Setting up real-time employee subscriptions...");const F=e.channel("employees_changes").on("postgres_changes",{event:"*",schema:"public",table:"employees"},T=>{console.log("üë• Real-time employees update:",T.eventType),p(!0)}).subscribe();return p(!0),()=>{console.log("üë• Cleaning up employee subscriptions..."),F.unsubscribe()}},[e,p]);const g=E.useCallback(async F=>{if(!e)try{const T=localStorage.getItem("codex_employees")||"[]",R=JSON.parse(T),A={id:`local_${Date.now()}`,...F,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},P=[A,...R];return localStorage.setItem("codex_employees",JSON.stringify(P)),a(P),A}catch(T){return console.error("Error saving employee to local storage:",T),null}try{const T=await $v(e,F);return a(R=>R.find(P=>P.id===T.id)?R.map(P=>P.id===T.id?T:P):[T,...R]),T}catch(T){return console.error("Error adding employee:",T),u?await u.database.handleError(T,"add employee",{employeeData:F}):t({type:"error",title:"Failed to Add Employee",message:"Unable to add employee. Please try again.",duration:5e3}),null}},[e]),h=E.useCallback(async F=>{if(!e)try{const T=localStorage.getItem("codex_employees")||"[]",A=JSON.parse(T).map(P=>P.id===F.id?{...P,...F,updated_at:new Date().toISOString()}:P);return localStorage.setItem("codex_employees",JSON.stringify(A)),a(A),F}catch(T){return console.error("Error updating employee in local storage:",T),null}try{const{data:T,error:R}=await e.from("employees").update(F).eq("id",F.id).select("*").single();if(R)throw R;return a(A=>A.map(P=>P.id===T.id?T:P)),T}catch(T){return console.error("Error updating employee:",T),u?await u.database.handleError(T,"update employee",{employeeData:F}):t({type:"error",title:"Failed to Update Employee",message:"Unable to update employee. Please try again.",duration:5e3}),null}},[e]),b=E.useCallback(async F=>{if(!e)try{const T=localStorage.getItem("codex_employees")||"[]",A=JSON.parse(T).filter(P=>P.id!==F);return localStorage.setItem("codex_employees",JSON.stringify(A)),a(A),!0}catch(T){return console.error("Error removing employee from local storage:",T),!1}try{const{error:T}=await e.from("employees").update({status:"Inactive"}).eq("id",F);if(T)throw T;return a(R=>R.filter(A=>A.id!==F)),!0}catch(T){return console.error("Error removing employee:",T),!1}},[e]),x=E.useCallback(()=>p(!0),[p]),y=E.useCallback(F=>F==="All"?n:n.filter(T=>T.department===F),[n]),v=E.useCallback(F=>F==="All"?n:n.filter(T=>T.status===F),[n]),_=E.useCallback(()=>n.filter(F=>F.status==="Active"),[n]),S=E.useCallback(()=>_().map(T=>({value:`${T.name}|${T.phone}`,label:`${T.name} (${T.department})`,name:T.name,phone:T.phone,department:T.department,role:T.role,id:T.id})),[_]),j=E.useCallback((F,T)=>{if(!F||!T)return!1;const R=T.trim().replace(/^\+91-?/,"");return n.some(A=>{const P=A.phone.trim().replace(/^\+91-?/,"");return A.name.trim().toLowerCase()===F.trim().toLowerCase()&&(P===R||A.phone.trim()===T.trim())})},[n]),I=E.useCallback((F,T)=>{if(!F||!T)return null;const R=T.trim().replace(/^\+91-?/,"");return n.find(A=>{const P=A.phone.trim().replace(/^\+91-?/,"");return A.name.trim().toLowerCase()===F.trim().toLowerCase()&&(P===R||A.phone.trim()===T.trim())})},[n]),J=E.useCallback(async(F,T)=>{const R=I(F,T);if(R)return R;if(e)try{const A=await J(e,F,T);return A&&a(P=>P.find(K=>K.id===A.id)?P:[A,...P]),A}catch(A){return console.error("Error fetching employee by identity:",A),null}return null},[e,I]),k=E.useMemo(()=>({employees:n,loading:s,lastRefresh:l,addEmployee:g,updateEmployee:h,removeEmployee:b,refreshEmployees:x,getEmployeesByDepartment:y,getEmployeesByStatus:v,getActiveEmployees:_,getEmployeeOptions:S,employeeExists:j,findEmployeeByIdentity:I,getEmployeeByIdentity:J}),[n,s,l,g,h,b,x,y,v,_,S,j,I,J]);return i.jsx(Rp.Provider,{value:k,children:r})}),Vv=ar.createContext({toast:()=>{},showToast:()=>{},notify:()=>{}}),x0=()=>{const r=ar.useContext(Vv);return r||{toast:e=>{console.log("Toast:",e),e.title&&console.log(`${e.title}: ${e.description||""}`)},showToast:e=>{console.log("ShowToast:",e)},notify:e=>{console.log("Notify:",e)}}},Dp=E.createContext(),xj=({children:r})=>{const[e,t]=E.useState({notifications:[],updates:[],lastSync:null}),{toast:n}=x0(),a=E.useCallback((u,d="info")=>{const p={id:Date.now(),message:u,type:d,timestamp:new Date().toISOString()};t(g=>({...g,notifications:[...g.notifications,p],lastSync:new Date().toISOString()})),n({title:u,variant:d==="error"?"destructive":"default"})},[n]),s=E.useCallback(u=>{t(d=>({...d,updates:[...d.updates,{id:Date.now(),data:u,timestamp:new Date().toISOString()}],lastSync:new Date().toISOString()}))},[]),o=E.useCallback(()=>{t(u=>({...u,notifications:[]}))},[]),l=E.useCallback((u=10)=>e.updates.sort((d,p)=>new Date(p.timestamp)-new Date(d.timestamp)).slice(0,u),[e.updates]),c={syncData:e,notify:a,syncUpdate:s,clearNotifications:o,getLatestUpdates:l};return i.jsx(Dp.Provider,{value:c,children:r})},Op=()=>{const r=E.useContext(Dp);if(!r)throw new Error("useCrossDashboardSync must be used within a CrossDashboardSyncProvider");return r},Ip=E.createContext(),Mp=()=>{const r=E.useContext(Ip);if(!r)throw new Error("useRBAC must be used within an RBACProvider");return r},vj=({children:r})=>{const[e,t]=E.useState(null),[n,a]=E.useState(!0),[s,o]=E.useState({admin:{id:"admin",name:"Administrator",description:"Full system access and management capabilities",permissions:{manager:["read","write","delete","configure"],employee:["read","write","delete","configure"],agency:["read","write","delete","configure"],intern:["read","write","delete","configure"],system:["read","write","delete","configure","audit"]},dashboardAccess:["manager","employee","agency","intern"],features:{controlPanel:!0,analytics:!0,configuration:!0,reporting:!0,userManagement:!0,auditLogs:!0}},manager:{id:"manager",name:"Manager",description:"Management oversight and control capabilities",permissions:{manager:["read","write","configure"],employee:["read","write"],agency:["read","write"],intern:["read","write"],system:["read"]},dashboardAccess:["manager","employee","agency","intern"],features:{controlPanel:!0,analytics:!0,configuration:!0,reporting:!0,userManagement:!1,auditLogs:!1}},supervisor:{id:"supervisor",name:"Supervisor",description:"Team supervision and limited management access",permissions:{manager:["read"],employee:["read","write"],agency:["read"],intern:["read","write"],system:["read"]},dashboardAccess:["employee","intern"],features:{controlPanel:!1,analytics:!0,configuration:!1,reporting:!0,userManagement:!1,auditLogs:!1}},employee:{id:"employee",name:"Employee",description:"Standard employee access to personal dashboard",permissions:{manager:[],employee:["read","write"],agency:[],intern:[],system:[]},dashboardAccess:["employee"],features:{controlPanel:!1,analytics:!1,configuration:!1,reporting:!1,userManagement:!1,auditLogs:!1}},intern:{id:"intern",name:"Intern",description:"Intern access to learning and task management",permissions:{manager:[],employee:[],agency:[],intern:["read","write"],system:[]},dashboardAccess:["intern"],features:{controlPanel:!1,analytics:!1,configuration:!1,reporting:!1,userManagement:!1,auditLogs:!1}},agency:{id:"agency",name:"Agency User",description:"Agency dashboard access for client management",permissions:{manager:[],employee:["read"],agency:["read","write"],intern:[],system:[]},dashboardAccess:["agency"],features:{controlPanel:!1,analytics:!1,configuration:!1,reporting:!1,userManagement:!1,auditLogs:!1}}}),[l,c]=E.useState([{id:1,name:"John Manager",email:"john@company.com",role:"manager",active:!0},{id:2,name:"Jane Supervisor",email:"jane@company.com",role:"supervisor",active:!0},{id:3,name:"Bob Employee",email:"bob@company.com",role:"employee",active:!0},{id:4,name:"Alice Intern",email:"alice@company.com",role:"intern",active:!0},{id:5,name:"Carol Agency",email:"carol@agency.com",role:"agency",active:!0}]),{authState:u}=Fa(),{user:d,isLoading:p}=u;E.useEffect(()=>{const I=setTimeout(()=>{if(!p&&d){const J={id:d.id||Date.now(),name:d.full_name||"Unknown User",email:d.email||`${d.full_name}@company.com`,role:d.role||"employee",active:d.is_active!==!1};t(J),localStorage.setItem("currentUser",JSON.stringify(J)),a(!1)}else!p&&!d&&(n||(t(null),localStorage.removeItem("currentUser")),a(!1))},n?1e3:0);return()=>clearTimeout(I)},[p,d,n]),E.useEffect(()=>{if(!d&&!e&&n){const I=localStorage.getItem("currentUser");if(I)try{t(JSON.parse(I)),a(!1)}catch(J){console.warn("Failed to parse saved user from localStorage:",J),localStorage.removeItem("currentUser"),a(!1)}else setTimeout(()=>a(!1),1e3)}},[d,e,n]);const j={currentUser:e,setCurrentUser:t,isInitializing:n,roles:s,users:l,hasPermission:(I,J)=>{var F;return!e||!s[e.role]?!1:((F=s[e.role].permissions[I])==null?void 0:F.includes(J))||!1},hasDashboardAccess:I=>!e||!s[e.role]?!1:s[e.role].dashboardAccess.includes(I),hasFeatureAccess:I=>!e||!s[e.role]?!1:s[e.role].features[I]||!1,updateUserRole:(I,J)=>{c(k=>k.map(F=>F.id===I?{...F,role:J}:F))},toggleUserStatus:I=>{c(J=>J.map(k=>k.id===I?{...k,active:!k.active}:k))},addUser:I=>{const J={id:Date.now(),...I,active:!0};c(k=>[...k,J])},removeUser:I=>{c(J=>J.filter(k=>k.id!==I))},updateRole:(I,J)=>{o(k=>({...k,[I]:{...k[I],...J}}))}};return i.jsx(Ip.Provider,{value:j,children:r})},Bp=E.createContext(),yj=({children:r})=>{const e=ha(),[t,n]=E.useState([]),[a,s]=E.useState([]),[o,l]=E.useState(!1),h={systemNotifications:t,userNotifications:a,loading:o,addSystemNotification:async b=>{try{const x={...b,id:Date.now().toString(),timestamp:new Date().toISOString(),read:!1};n(y=>[x,...y]),e&&await e.from("system_notifications").insert([x])}catch(x){console.error("Error adding system notification:",x)}},addUserNotification:async b=>{try{const x={...b,id:Date.now().toString(),timestamp:new Date().toISOString(),read:!1};s(y=>[x,...y]),e&&await e.from("user_notifications").insert([x])}catch(x){console.error("Error adding user notification:",x)}},markAsRead:(b,x=!1)=>{x?n(y=>y.map(v=>v.id===b?{...v,read:!0}:v)):s(y=>y.map(v=>v.id===b?{...v,read:!0}:v))},clearNotifications:(b=!1)=>{b?n([]):s([])},getUnreadCount:(b=!1)=>(b?t:a).filter(y=>!y.read).length};return i.jsx(Bp.Provider,{value:h,children:r})},xd=()=>{const r=E.useContext(Bp);if(!r)throw new Error("useNotificationSystem must be used within a NotificationProvider");return r},Gv=({className:r=""})=>{const{systemNotifications:e,markAsRead:t,clearNotifications:n}=xd(),[a,s]=E.useState(!1),o=e.filter(l=>!l.read).length;return i.jsxs("div",{className:`relative ${r}`,children:[i.jsxs("button",{onClick:()=>s(!a),className:"relative p-2 text-gray-600 hover:text-gray-900 transition-colors",children:["üîî",o>0&&i.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:o})]}),a&&i.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[i.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),i.jsx("button",{onClick:()=>n(!0),className:"text-sm text-blue-600 hover:text-blue-800",children:"Clear All"})]}),i.jsx("div",{className:"max-h-96 overflow-y-auto",children:e.length===0?i.jsx("div",{className:"p-4 text-center text-gray-500",children:"No notifications"}):e.map(l=>i.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer ${l.read?"":"bg-blue-50"}`,onClick:()=>t(l.id,!0),children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:l.title}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.message}),i.jsx("p",{className:"text-xs text-gray-400 mt-2",children:new Date(l.timestamp).toLocaleString()})]}),!l.read&&i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full ml-2 mt-1"})]})},l.id))})]})]})},Up=E.createContext(),bj=({children:r})=>{const[e,t]=E.useState([]),{toast:n}=x0(),a=E.useCallback((c,u={})=>{const d={id:Date.now(),action:c,details:u,timestamp:new Date().toISOString(),user:u.user||"Unknown User"};t(p=>[d,...p].slice(0,1e3))},[]),s=E.useCallback((c={})=>{let u=e;return c.action&&(u=u.filter(d=>d.action.toLowerCase().includes(c.action.toLowerCase()))),c.user&&(u=u.filter(d=>d.user.toLowerCase().includes(c.user.toLowerCase()))),c.dateFrom&&(u=u.filter(d=>new Date(d.timestamp)>=new Date(c.dateFrom))),c.dateTo&&(u=u.filter(d=>new Date(d.timestamp)<=new Date(c.dateTo))),u},[e]),o=E.useCallback(()=>{t([]),n({title:"Audit logs cleared",variant:"default"})},[n]),l={auditLogs:e,logUserAction:a,getAuditLogs:s,clearAuditLogs:o};return i.jsx(Up.Provider,{value:l,children:r})},Hp=()=>{const r=E.useContext(Up);if(!r)throw new Error("useAuditLogging must be used within an AuditProvider");return r},Kv=()=>{const{auditLogs:r,getAuditLogs:e,clearAuditLogs:t}=Hp(),[n,a]=E.useState(""),s=e({action:n});return i.jsxs("div",{className:"card-brand p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-brand-text",children:"Audit Logs"}),i.jsx("button",{onClick:t,className:"btn-brand-secondary text-sm",children:"Clear Logs"})]}),i.jsx("div",{className:"mb-4",children:i.jsx("input",{type:"text",placeholder:"Filter by action...",value:n,onChange:o=>a(o.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),i.jsx("div",{className:"max-h-96 overflow-y-auto",children:s.length===0?i.jsx("p",{className:"text-brand-text-secondary text-center py-8",children:"No audit logs found"}):i.jsx("div",{className:"space-y-2",children:s.map(o=>i.jsx("div",{className:"bg-slate-50 dark:bg-slate-700 p-3 rounded-lg",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-brand-text",children:o.action}),i.jsxs("p",{className:"text-sm text-brand-text-secondary",children:["User: ",o.user]}),o.details&&Object.keys(o.details).length>0&&i.jsxs("p",{className:"text-xs text-brand-text-secondary mt-1",children:["Details: ",JSON.stringify(o.details,null,2)]})]}),i.jsx("span",{className:"text-xs text-brand-text-secondary",children:new Date(o.timestamp).toLocaleString()})]})},o.id))})})]})};/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var ef="popstate";function Yv(r={}){function e(n,a){let{pathname:s,search:o,hash:l}=n.location;return Ju("",{pathname:s,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(n,a){return typeof a=="string"?a:ml(a)}return Jv(e,t,null,r)}function br(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function Ta(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Xv(){return Math.random().toString(36).substring(2,10)}function tf(r,e){return{usr:r.state,key:r.key,idx:e}}function Ju(r,e,t=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?xo(e):e,state:t,key:e&&e.key||n||Xv()}}function ml({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function xo(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substring(n),r=r.substring(0,n)),r&&(e.pathname=r)}return e}function Jv(r,e,t,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,o=a.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function p(){l="POP";let y=d(),v=y==null?null:y-u;u=y,c&&c({action:l,location:x.location,delta:v})}function g(y,v){l="PUSH";let _=Ju(x.location,y,v);u=d()+1;let S=tf(_,u),j=x.createHref(_);try{o.pushState(S,"",j)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;a.location.assign(j)}s&&c&&c({action:l,location:x.location,delta:1})}function h(y,v){l="REPLACE";let _=Ju(x.location,y,v);u=d();let S=tf(_,u),j=x.createHref(_);o.replaceState(S,"",j),s&&c&&c({action:l,location:x.location,delta:0})}function b(y){return Zv(y)}let x={get action(){return l},get location(){return r(a,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(ef,p),c=y,()=>{a.removeEventListener(ef,p),c=null}},createHref(y){return e(a,y)},createURL:b,encodeLocation(y){let v=b(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:g,replace:h,go(y){return o.go(y)}};return x}function Zv(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),br(t,"No window.location.(origin|href) available to create URL");let n=typeof r=="string"?r:ml(r);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function $p(r,e,t="/"){return Qv(r,e,t,!1)}function Qv(r,e,t,n){let a=typeof e=="string"?xo(e):e,s=Ns(a.pathname||"/",t);if(s==null)return null;let o=qp(r);e5(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=d5(s);l=c5(o[c],u,n)}return l}function qp(r,e=[],t=[],n="",a=!1){let s=(o,l,c=a,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&c)return;br(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let p=ys([n,d.relativePath]),g=t.concat(d);o.children&&o.children.length>0&&(br(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),qp(o.children,e,g,p,c)),!(o.path==null&&!o.index)&&e.push({path:p,score:o5(p,o.index),routesMeta:g})};return r.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,l);else for(let u of Wp(o.path))s(o,l,!0,u)}),e}function Wp(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,a=t.endsWith("?"),s=t.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let o=Wp(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),a&&l.push(...o),l.map(c=>r.startsWith("/")&&c===""?"/":c)}function e5(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:l5(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var t5=/^:[\w-]+$/,r5=3,n5=2,a5=1,s5=10,i5=-2,rf=r=>r==="*";function o5(r,e){let t=r.split("/"),n=t.length;return t.some(rf)&&(n+=i5),e&&(n+=n5),t.filter(a=>!rf(a)).reduce((a,s)=>a+(t5.test(s)?r5:s===""?a5:s5),n)}function l5(r,e){return r.length===e.length&&r.slice(0,-1).every((n,a)=>n===e[a])?r[r.length-1]-e[e.length-1]:0}function c5(r,e,t=!1){let{routesMeta:n}=r,a={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",p=Uc({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),g=c.route;if(!p&&u&&t&&!n[n.length-1].route.index&&(p=Uc({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!p)return null;Object.assign(a,p.params),o.push({params:a,pathname:ys([s,p.pathname]),pathnameBase:p5(ys([s,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(s=ys([s,p.pathnameBase]))}return o}function Uc(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=u5(r.path,r.caseSensitive,r.end),a=e.match(t);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:p},g)=>{if(d==="*"){let b=l[g]||"";o=s.slice(0,s.length-b.length).replace(/(.)\/+$/,"$1")}const h=l[g];return p&&!h?u[d]=void 0:u[d]=(h||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:r}}function u5(r,e=!1,t=!0){Ta(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function d5(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ta(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function Ns(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function h5(r,e="/"){let{pathname:t,search:n="",hash:a=""}=typeof r=="string"?xo(r):r;return{pathname:t?t.startsWith("/")?t:f5(t,e):e,search:g5(n),hash:x5(a)}}function f5(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function mu(r,e,t,n){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function m5(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function vd(r){let e=m5(r);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function yd(r,e,t,n=!1){let a;typeof r=="string"?a=xo(r):(a={...r},br(!a.pathname||!a.pathname.includes("?"),mu("?","pathname","search",a)),br(!a.pathname||!a.pathname.includes("#"),mu("#","pathname","hash",a)),br(!a.search||!a.search.includes("#"),mu("#","search","hash",a)));let s=r===""||a.pathname==="",o=s?"/":a.pathname,l;if(o==null)l=t;else{let p=e.length-1;if(!n&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;a.pathname=g.join("/")}l=p>=0?e[p]:"/"}let c=h5(a,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var ys=r=>r.join("/").replace(/\/\/+/g,"/"),p5=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),g5=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,x5=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function v5(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var zp=["POST","PUT","PATCH","DELETE"];new Set(zp);var y5=["GET",...zp];new Set(y5);var vo=E.createContext(null);vo.displayName="DataRouter";var v0=E.createContext(null);v0.displayName="DataRouterState";E.createContext(!1);var Vp=E.createContext({isTransitioning:!1});Vp.displayName="ViewTransition";var b5=E.createContext(new Map);b5.displayName="Fetchers";var w5=E.createContext(null);w5.displayName="Await";var Pa=E.createContext(null);Pa.displayName="Navigation";var Cl=E.createContext(null);Cl.displayName="Location";var es=E.createContext({outlet:null,matches:[],isDataRoute:!1});es.displayName="Route";var bd=E.createContext(null);bd.displayName="RouteError";function _5(r,{relative:e}={}){br(yo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=E.useContext(Pa),{hash:a,pathname:s,search:o}=jl(r,{relative:e}),l=s;return t!=="/"&&(l=s==="/"?t:ys([t,s])),n.createHref({pathname:l,search:o,hash:a})}function yo(){return E.useContext(Cl)!=null}function ti(){return br(yo(),"useLocation() may be used only in the context of a <Router> component."),E.useContext(Cl).location}var Gp="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Kp(r){E.useContext(Pa).static||E.useLayoutEffect(r)}function wd(){let{isDataRoute:r}=E.useContext(es);return r?D5():N5()}function N5(){br(yo(),"useNavigate() may be used only in the context of a <Router> component.");let r=E.useContext(vo),{basename:e,navigator:t}=E.useContext(Pa),{matches:n}=E.useContext(es),{pathname:a}=ti(),s=JSON.stringify(vd(n)),o=E.useRef(!1);return Kp(()=>{o.current=!0}),E.useCallback((c,u={})=>{if(Ta(o.current,Gp),!o.current)return;if(typeof c=="number"){t.go(c);return}let d=yd(c,JSON.parse(s),a,u.relative==="path");r==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:ys([e,d.pathname])),(u.replace?t.replace:t.push)(d,u.state,u)},[e,t,s,a,r])}E.createContext(null);function jl(r,{relative:e}={}){let{matches:t}=E.useContext(es),{pathname:n}=ti(),a=JSON.stringify(vd(t));return E.useMemo(()=>yd(r,JSON.parse(a),n,e==="path"),[r,a,n,e])}function S5(r,e){return Yp(r,e)}function Yp(r,e,t,n,a){var _;br(yo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=E.useContext(Pa),{matches:o}=E.useContext(es),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",p=l&&l.route;{let S=p&&p.path||"";Xp(u,!p||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let g=ti(),h;if(e){let S=typeof e=="string"?xo(e):e;br(d==="/"||((_=S.pathname)==null?void 0:_.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${S.pathname}" was given in the \`location\` prop.`),h=S}else h=g;let b=h.pathname||"/",x=b;if(d!=="/"){let S=d.replace(/^\//,"").split("/");x="/"+b.replace(/^\//,"").split("/").slice(S.length).join("/")}let y=$p(r,{pathname:x});Ta(p||y!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),Ta(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=k5(y&&y.map(S=>Object.assign({},S,{params:Object.assign({},c,S.params),pathname:ys([d,s.encodeLocation?s.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?d:ys([d,s.encodeLocation?s.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),o,t,n,a);return e&&v?E.createElement(Cl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},v):v}function E5(){let r=R5(),e=v5(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",r),o=E.createElement(E.Fragment,null,E.createElement("p",null,"üíø Hey developer üëã"),E.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",E.createElement("code",{style:s},"ErrorBoundary")," or"," ",E.createElement("code",{style:s},"errorElement")," prop on your route.")),E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),t?E.createElement("pre",{style:a},t):null,o)}var A5=E.createElement(E5,null),C5=class extends E.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){this.props.unstable_onError?this.props.unstable_onError(r,e):console.error("React Router caught the following error during render",r)}render(){return this.state.error!==void 0?E.createElement(es.Provider,{value:this.props.routeContext},E.createElement(bd.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function j5({routeContext:r,match:e,children:t}){let n=E.useContext(vo);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),E.createElement(es.Provider,{value:r},t)}function k5(r,e=[],t=null,n=null,a=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let s=r,o=t==null?void 0:t.errors;if(o!=null){let u=s.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);br(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,u+1))}let l=!1,c=-1;if(t)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:p,errors:g}=t,h=d.route.loader&&!p.hasOwnProperty(d.route.id)&&(!g||g[d.route.id]===void 0);if(d.route.lazy||h){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,d,p)=>{let g,h=!1,b=null,x=null;t&&(g=o&&d.route.id?o[d.route.id]:void 0,b=d.route.errorElement||A5,l&&(c<0&&p===0?(Xp("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,x=null):c===p&&(h=!0,x=d.route.hydrateFallbackElement||null)));let y=e.concat(s.slice(0,p+1)),v=()=>{let _;return g?_=b:h?_=x:d.route.Component?_=E.createElement(d.route.Component,null):d.route.element?_=d.route.element:_=u,E.createElement(j5,{match:d,routeContext:{outlet:u,matches:y,isDataRoute:t!=null},children:_})};return t&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?E.createElement(C5,{location:t.location,revalidation:t.revalidation,component:b,error:g,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0},unstable_onError:n}):v()},null)}function _d(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function T5(r){let e=E.useContext(vo);return br(e,_d(r)),e}function L5(r){let e=E.useContext(v0);return br(e,_d(r)),e}function F5(r){let e=E.useContext(es);return br(e,_d(r)),e}function Nd(r){let e=F5(r),t=e.matches[e.matches.length-1];return br(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function P5(){return Nd("useRouteId")}function R5(){var n;let r=E.useContext(bd),e=L5("useRouteError"),t=Nd("useRouteError");return r!==void 0?r:(n=e.errors)==null?void 0:n[t]}function D5(){let{router:r}=T5("useNavigate"),e=Nd("useNavigate"),t=E.useRef(!1);return Kp(()=>{t.current=!0}),E.useCallback(async(a,s={})=>{Ta(t.current,Gp),t.current&&(typeof a=="number"?r.navigate(a):await r.navigate(a,{fromRouteId:e,...s}))},[r,e])}var nf={};function Xp(r,e,t){!e&&!nf[r]&&(nf[r]=!0,Ta(!1,t))}E.memo(O5);function O5({routes:r,future:e,state:t,unstable_onError:n}){return Yp(r,void 0,t,n,e)}function wj({to:r,replace:e,state:t,relative:n}){br(yo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=E.useContext(Pa);Ta(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=E.useContext(es),{pathname:o}=ti(),l=wd(),c=yd(r,vd(s),o,n==="path"),u=JSON.stringify(c);return E.useEffect(()=>{l(JSON.parse(u),{replace:e,state:t,relative:n})},[l,u,n,e,t]),null}function I5(r){br(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function M5({basename:r="/",children:e=null,location:t,navigationType:n="POP",navigator:a,static:s=!1}){br(!yo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=r.replace(/^\/*/,"/"),l=E.useMemo(()=>({basename:o,navigator:a,static:s,future:{}}),[o,a,s]);typeof t=="string"&&(t=xo(t));let{pathname:c="/",search:u="",hash:d="",state:p=null,key:g="default"}=t,h=E.useMemo(()=>{let b=Ns(c,o);return b==null?null:{location:{pathname:b,search:u,hash:d,state:p,key:g},navigationType:n}},[o,c,u,d,p,g,n]);return Ta(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:E.createElement(Pa.Provider,{value:l},E.createElement(Cl.Provider,{children:e,value:h}))}function _j({children:r,location:e}){return S5(Zu(r),e)}function Zu(r,e=[]){let t=[];return E.Children.forEach(r,(n,a)=>{if(!E.isValidElement(n))return;let s=[...e,a];if(n.type===E.Fragment){t.push.apply(t,Zu(n.props.children,s));return}br(n.type===I5,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),br(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Zu(n.props.children,s)),t.push(o)}),t}var jc="get",kc="application/x-www-form-urlencoded";function y0(r){return r!=null&&typeof r.tagName=="string"}function B5(r){return y0(r)&&r.tagName.toLowerCase()==="button"}function U5(r){return y0(r)&&r.tagName.toLowerCase()==="form"}function H5(r){return y0(r)&&r.tagName.toLowerCase()==="input"}function $5(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function q5(r,e){return r.button===0&&(!e||e==="_self")&&!$5(r)}var oc=null;function W5(){if(oc===null)try{new FormData(document.createElement("form"),0),oc=!1}catch{oc=!0}return oc}var z5=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function pu(r){return r!=null&&!z5.has(r)?(Ta(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${kc}"`),null):r}function V5(r,e){let t,n,a,s,o;if(U5(r)){let l=r.getAttribute("action");n=l?Ns(l,e):null,t=r.getAttribute("method")||jc,a=pu(r.getAttribute("enctype"))||kc,s=new FormData(r)}else if(B5(r)||H5(r)&&(r.type==="submit"||r.type==="image")){let l=r.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=r.getAttribute("formaction")||l.getAttribute("action");if(n=c?Ns(c,e):null,t=r.getAttribute("formmethod")||l.getAttribute("method")||jc,a=pu(r.getAttribute("formenctype"))||pu(l.getAttribute("enctype"))||kc,s=new FormData(l,r),!W5()){let{name:u,type:d,value:p}=r;if(d==="image"){let g=u?`${u}.`:"";s.append(`${g}x`,"0"),s.append(`${g}y`,"0")}else u&&s.append(u,p)}}else{if(y0(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=jc,n=null,a=kc,o=r}return s&&a==="text/plain"&&(o=s,s=void 0),{action:n,method:t.toLowerCase(),encType:a,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Sd(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function G5(r,e,t){let n=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return n.pathname==="/"?n.pathname=`_root.${t}`:e&&Ns(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${t}`,n}async function K5(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Y5(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function X5(r,e,t){let n=await Promise.all(r.map(async a=>{let s=e.routes[a.route.id];if(s){let o=await K5(s,t);return o.links?o.links():[]}return[]}));return ey(n.flat(1).filter(Y5).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function af(r,e,t,n,a,s){let o=(c,u)=>t[u]?c.route.id!==t[u].route.id:!0,l=(c,u)=>{var d;return t[u].pathname!==c.pathname||((d=t[u].route.path)==null?void 0:d.endsWith("*"))&&t[u].params["*"]!==c.params["*"]};return s==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):s==="data"?e.filter((c,u)=>{var p;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let g=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((p=t[0])==null?void 0:p.params)||{},nextUrl:new URL(r,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function J5(r,e,{includeHydrateFallback:t}={}){return Z5(r.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function Z5(r){return[...new Set(r)]}function Q5(r){let e={},t=Object.keys(r).sort();for(let n of t)e[n]=r[n];return e}function ey(r,e){let t=new Set;return new Set(e),r.reduce((n,a)=>{let s=JSON.stringify(Q5(a));return t.has(s)||(t.add(s),n.push({key:s,link:a})),n},[])}function Jp(){let r=E.useContext(vo);return Sd(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function ty(){let r=E.useContext(v0);return Sd(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var Ed=E.createContext(void 0);Ed.displayName="FrameworkContext";function Zp(){let r=E.useContext(Ed);return Sd(r,"You must render this element inside a <HydratedRouter> element"),r}function ry(r,e){let t=E.useContext(Ed),[n,a]=E.useState(!1),[s,o]=E.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:p}=e,g=E.useRef(null);E.useEffect(()=>{if(r==="render"&&o(!0),r==="viewport"){let x=v=>{v.forEach(_=>{o(_.isIntersecting)})},y=new IntersectionObserver(x,{threshold:.5});return g.current&&y.observe(g.current),()=>{y.disconnect()}}},[r]),E.useEffect(()=>{if(n){let x=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(x)}}},[n]);let h=()=>{a(!0)},b=()=>{a(!1),o(!1)};return t?r!=="intent"?[s,g,{}]:[s,g,{onFocus:Jo(l,h),onBlur:Jo(c,b),onMouseEnter:Jo(u,h),onMouseLeave:Jo(d,b),onTouchStart:Jo(p,h)}]:[!1,g,{}]}function Jo(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function ny({page:r,...e}){let{router:t}=Jp(),n=E.useMemo(()=>$p(t.routes,r,t.basename),[t.routes,r,t.basename]);return n?E.createElement(sy,{page:r,matches:n,...e}):null}function ay(r){let{manifest:e,routeModules:t}=Zp(),[n,a]=E.useState([]);return E.useEffect(()=>{let s=!1;return X5(r,e,t).then(o=>{s||a(o)}),()=>{s=!0}},[r,e,t]),n}function sy({page:r,matches:e,...t}){let n=ti(),{manifest:a,routeModules:s}=Zp(),{basename:o}=Jp(),{loaderData:l,matches:c}=ty(),u=E.useMemo(()=>af(r,e,c,a,n,"data"),[r,e,c,a,n]),d=E.useMemo(()=>af(r,e,c,a,n,"assets"),[r,e,c,a,n]),p=E.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let b=new Set,x=!1;if(e.forEach(v=>{var S;let _=a.routes[v.route.id];!_||!_.hasLoader||(!u.some(j=>j.route.id===v.route.id)&&v.route.id in l&&((S=s[v.route.id])!=null&&S.shouldRevalidate)||_.hasClientLoader?x=!0:b.add(v.route.id))}),b.size===0)return[];let y=G5(r,o,"data");return x&&b.size>0&&y.searchParams.set("_routes",e.filter(v=>b.has(v.route.id)).map(v=>v.route.id).join(",")),[y.pathname+y.search]},[o,l,n,a,u,e,r,s]),g=E.useMemo(()=>J5(d,a),[d,a]),h=ay(d);return E.createElement(E.Fragment,null,p.map(b=>E.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...t})),g.map(b=>E.createElement("link",{key:b,rel:"modulepreload",href:b,...t})),h.map(({key:b,link:x})=>E.createElement("link",{key:b,nonce:t.nonce,...x})))}function iy(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Qp=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Qp&&(window.__reactRouterVersion="7.8.2")}catch{}function Nj({basename:r,children:e,window:t}){let n=E.useRef();n.current==null&&(n.current=Yv({window:t,v5Compat:!0}));let a=n.current,[s,o]=E.useState({action:a.action,location:a.location}),l=E.useCallback(c=>{E.startTransition(()=>o(c))},[o]);return E.useLayoutEffect(()=>a.listen(l),[a,l]),E.createElement(M5,{basename:r,children:e,location:s.location,navigationType:s.action,navigator:a})}var e1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,t1=E.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:a,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:p,...g},h){let{basename:b}=E.useContext(Pa),x=typeof u=="string"&&e1.test(u),y,v=!1;if(typeof u=="string"&&x&&(y=u,Qp))try{let T=new URL(window.location.href),R=u.startsWith("//")?new URL(T.protocol+u):new URL(u),A=Ns(R.pathname,b);R.origin===T.origin&&A!=null?u=A+R.search+R.hash:v=!0}catch{Ta(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=_5(u,{relative:a}),[S,j,I]=ry(n,g),J=uy(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:p});function k(T){e&&e(T),T.defaultPrevented||J(T)}let F=E.createElement("a",{...g,...I,href:y||_,onClick:v||s?e:k,ref:iy(h,j),target:c,"data-discover":!x&&t==="render"?"true":void 0});return S&&!x?E.createElement(E.Fragment,null,F,E.createElement(ny,{page:_})):F});t1.displayName="Link";var oy=E.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:a=!1,style:s,to:o,viewTransition:l,children:c,...u},d){let p=jl(o,{relative:u.relative}),g=ti(),h=E.useContext(v0),{navigator:b,basename:x}=E.useContext(Pa),y=h!=null&&py(p)&&l===!0,v=b.encodeLocation?b.encodeLocation(p).pathname:p.pathname,_=g.pathname,S=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;t||(_=_.toLowerCase(),S=S?S.toLowerCase():null,v=v.toLowerCase()),S&&x&&(S=Ns(S,x)||S);const j=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let I=_===v||!a&&_.startsWith(v)&&_.charAt(j)==="/",J=S!=null&&(S===v||!a&&S.startsWith(v)&&S.charAt(v.length)==="/"),k={isActive:I,isPending:J,isTransitioning:y},F=I?e:void 0,T;typeof n=="function"?T=n(k):T=[n,I?"active":null,J?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let R=typeof s=="function"?s(k):s;return E.createElement(t1,{...u,"aria-current":F,className:T,ref:d,style:R,to:o,viewTransition:l},typeof c=="function"?c(k):c)});oy.displayName="NavLink";var ly=E.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:a,state:s,method:o=jc,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:p,...g},h)=>{let b=fy(),x=my(l,{relative:u}),y=o.toLowerCase()==="get"?"get":"post",v=typeof l=="string"&&e1.test(l),_=S=>{if(c&&c(S),S.defaultPrevented)return;S.preventDefault();let j=S.nativeEvent.submitter,I=(j==null?void 0:j.getAttribute("formmethod"))||o;b(j||S.currentTarget,{fetcherKey:e,method:I,navigate:t,replace:a,state:s,relative:u,preventScrollReset:d,viewTransition:p})};return E.createElement("form",{ref:h,method:y,action:x,onSubmit:n?c:_,...g,"data-discover":!v&&r==="render"?"true":void 0})});ly.displayName="Form";function cy(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function r1(r){let e=E.useContext(vo);return br(e,cy(r)),e}function uy(r,{target:e,replace:t,state:n,preventScrollReset:a,relative:s,viewTransition:o}={}){let l=wd(),c=ti(),u=jl(r,{relative:s});return E.useCallback(d=>{if(q5(d,e)){d.preventDefault();let p=t!==void 0?t:ml(c)===ml(u);l(r,{replace:p,state:n,preventScrollReset:a,relative:s,viewTransition:o})}},[c,l,u,t,n,e,r,a,s,o])}var dy=0,hy=()=>`__${String(++dy)}__`;function fy(){let{router:r}=r1("useSubmit"),{basename:e}=E.useContext(Pa),t=P5();return E.useCallback(async(n,a={})=>{let{action:s,method:o,encType:l,formData:c,body:u}=V5(n,e);if(a.navigate===!1){let d=a.fetcherKey||hy();await r.fetch(d,t,a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await r.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,e,t])}function my(r,{relative:e}={}){let{basename:t}=E.useContext(Pa),n=E.useContext(es);br(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...jl(r||".",{relative:e})},o=ti();if(r==null){s.search=o.search;let l=new URLSearchParams(s.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(p=>p).forEach(p=>l.append("index",p));let d=l.toString();s.search=d?`?${d}`:""}}return(!r||r===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:ys([t,s.pathname])),ml(s)}function py(r,{relative:e}={}){let t=E.useContext(Vp);br(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=r1("useViewTransitionState"),a=jl(r,{relative:e});if(!t.isTransitioning)return!1;let s=Ns(t.currentLocation.pathname,n)||t.currentLocation.pathname,o=Ns(t.nextLocation.pathname,n)||t.nextLocation.pathname;return Uc(a.pathname,o)!=null||Uc(a.pathname,s)!=null}const gy=({size:r="medium",color:e="blue",className:t="",showText:n=!1,text:a="Loading..."})=>{const s={small:"w-4 h-4",medium:"w-8 h-8",large:"w-12 h-12",xl:"w-16 h-16"},o={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",gray:"border-gray-600",purple:"border-purple-600"},l=s[r]||s.medium,c=o[e]||o.blue;return i.jsxs("div",{className:`flex items-center gap-3 ${t}`,children:[i.jsx("div",{className:`${l} ${c} border-2 border-t-transparent rounded-full animate-spin`,role:"status","aria-label":"Loading"}),n&&i.jsx("span",{className:"text-gray-600 text-sm animate-pulse",children:a})]})},lc=({className:r=""})=>i.jsx("div",{className:`bg-white rounded-lg border p-6 ${r}`,children:i.jsxs("div",{className:"animate-pulse",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-3 bg-gray-200 rounded"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-4/6"})]})]})}),xy=({rows:r=5,columns:e=4,className:t=""})=>i.jsx("div",{className:`bg-white rounded-lg border overflow-hidden ${t}`,children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b",children:i.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${e}, 1fr)`},children:Array.from({length:e}).map((n,a)=>i.jsx("div",{className:"h-4 bg-gray-200 rounded"},a))})}),Array.from({length:r}).map((n,a)=>i.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:i.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${e}, 1fr)`},children:Array.from({length:e}).map((s,o)=>i.jsx("div",{className:`h-4 bg-gray-200 rounded ${o===0?"w-3/4":"w-full"}`},o))})},a))]})}),vy=()=>{const[r,e]=E.useState([]),[t,n]=E.useState([]),[a,s]=E.useState(!0),[o,l]=E.useState(null),{supabase:c}=ha(),{notify:u}=Fn(),d=E.useCallback(async()=>{if(c)try{s(!0),l(null);const[y,v]=await Promise.all([c.from("submissions").select("*").order("created_at",{ascending:!1}),c.from("employees").select("id, name, email, role, department, phone")]);if(y.error)throw y.error;v.error&&console.warn("Could not fetch employees:",v.error.message);const _=y.data||[],S=v.data||[],I=_.map(J=>{const k=S.find(F=>F.name===J.employee_name&&F.phone===J.employee_phone);return{...J,employees:k||{id:null,name:J.employee_name,email:null,role:J.role,department:J.department,phone:J.employee_phone}}});e(I||[]),n(I||[])}catch(y){console.error("Error fetching submissions:",y),l(y.message),u({title:"Error fetching submissions",message:y.message,type:"error"})}finally{s(!1)}},[c,u]),p=E.useCallback(()=>{d()},[d]),g=E.useCallback(async y=>{if(!c)return null;try{if(y.paymentStatus&&y.paymentProofUrl){const S=[];if(Object.keys(y.paymentStatus).forEach(j=>{const I=y.paymentStatus[j],J=y.paymentProofUrl[j]||"";(I==="completed"||I==="partial")&&(J.trim()?/https?:\/\/(drive|docs)\.google\.com\//i.test(J)||S.push(`Client ${j}: Payment proof must be a valid Google Drive URL`):S.push(`Client ${j}: Payment proof URL is required for ${I} status`))}),S.length>0)throw new Error(`Payment validation failed: ${S.join(", ")}`)}const{data:v,error:_}=await c.from("submissions").insert([y]).select(`
          *,
          employees (
            id,
            name,
            email,
            role,
            department
          )
        `).single();if(_)throw _;return e(S=>[v,...S]),n(S=>[v,...S]),u({title:"Submission added successfully",variant:"default"}),v}catch(v){throw console.error("Error adding submission:",v),u({title:"Error adding submission",description:v.message,variant:"destructive"}),v}},[c,u]),h=E.useCallback(async(y,v)=>{if(!c)return null;try{if(v.paymentStatus&&v.paymentProofUrl){const j=[];if(Object.keys(v.paymentStatus).forEach(I=>{const J=v.paymentStatus[I],k=v.paymentProofUrl[I]||"";(J==="completed"||J==="partial")&&(k.trim()?/https?:\/\/(drive|docs)\.google\.com\//i.test(k)||j.push(`Client ${I}: Payment proof must be a valid Google Drive URL`):j.push(`Client ${I}: Payment proof URL is required for ${J} status`))}),j.length>0)throw new Error(`Payment validation failed: ${j.join(", ")}`)}const{data:_,error:S}=await c.from("submissions").update(v).eq("id",y).select(`
          *,
          employees (
            id,
            name,
            email,
            role,
            department
          )
        `).single();if(S)throw S;return e(j=>j.map(I=>I.id===y?_:I)),n(j=>j.map(I=>I.id===y?_:I)),u({title:"Submission updated successfully",variant:"default"}),_}catch(_){throw console.error("Error updating submission:",_),u({title:"Error updating submission",description:_.message,variant:"destructive"}),_}},[c,u]),b=E.useCallback(async y=>{if(c)try{const{error:v}=await c.from("submissions").delete().eq("id",y);if(v)throw v;e(_=>_.filter(S=>S.id!==y)),n(_=>_.filter(S=>S.id!==y)),u({title:"Submission deleted successfully",variant:"default"})}catch(v){throw console.error("Error deleting submission:",v),u({title:"Error deleting submission",description:v.message,variant:"destructive"}),v}},[c,u]),x=E.useCallback(y=>{let v=r;y.employeeId&&(v=v.filter(_=>_.employee_id===y.employeeId)),y.status&&(v=v.filter(_=>_.status===y.status)),y.dateFrom&&(v=v.filter(_=>new Date(_.created_at)>=new Date(y.dateFrom))),y.dateTo&&(v=v.filter(_=>new Date(_.created_at)<=new Date(y.dateTo))),n(v)},[r]);return E.useEffect(()=>{d()},[d]),{allSubmissions:r,submissions:t,loading:a,error:o,refreshSubmissions:p,addSubmission:g,updateSubmission:h,deleteSubmission:b,filterSubmissions:x}};function Ad(){const r=wd(),{authState:e}=Fa(),{isLoggedIn:t,role:n,userCategory:a,user:s}=e,o=(ge=n)=>{switch(console.log("üöÄ navigateToRoleDashboard called with role:",ge),console.log("üöÄ Current user:",s),ge){case"Super Admin":r("/super-admin");break;case"Operations Head":r("/operations-head");break;case"HR":r("/hr");break;case"Manager":r("/manager");break;case"Intern":r("/intern");break;case"SEO":case"Ads":case"Social Media":case"YouTube SEO":case"Web Developer":case"Graphic Designer":r("/employee");break;case"Freelancer":r("/freelancer");break;default:r("/profile")}};return{navigate:r,navigateToRoleDashboard:o,navigateToForm:()=>r("/form"),navigateToMonthlyForm:()=>r("/monthly-form"),navigateToTools:()=>r("/master-tools"),navigateToProfile:()=>r("/profile"),navigateToProfileSettings:()=>r("/profile-settings"),navigateToEmployeeDirectory:()=>r("/employee-directory"),navigateToClientDirectory:()=>r("/client-directory"),navigateToDirectory:()=>r("/directory"),navigateToOrganizationChart:()=>r("/organization-chart"),navigateToReports:()=>r("/monthly-reports"),navigateToHome:()=>r("/"),navigateToDashboard:()=>{t&&n?o(n):r("/")},navigateToArcade:()=>r("/arcade"),navigateToArcadeEarn:()=>r("/arcade-earn"),navigateToArcadeRedeem:()=>r("/arcade-redeem"),navigateToArcadeHistory:()=>r("/arcade-history"),navigateToArcadeAdmin:()=>r("/arcade-admin"),navigateToEmployeeIncentives:()=>r("/employee-incentives"),navigateToHRIncentiveApproval:()=>r("/hr-incentive-approval"),navigateToManagerIncentiveReporting:()=>r("/manager-incentive-reporting"),navigateToPerformanceConcerns:()=>r("/performance-concerns"),navigateToPerformanceScoring:()=>r("/performance-scoring"),navigateToEmployeeOnboarding:()=>r("/employee-onboarding"),navigateToClientOnboarding:()=>r("/client-onboarding"),navigateToInteractiveForms:()=>r("/interactive-forms"),navigateToFormTracking:()=>r("/form-tracking"),navigateToLeaveForm:()=>r("/leave-form"),navigateToAddClient:()=>r("/add-client"),navigateToLogin:()=>r("/login"),navigateToPolicies:()=>r("/policies")}}class yy{static sanitizeHtml(e){return typeof e!="string"?e:e.replace(/<script[^>]*>.*?<\/script>/gi,"").replace(/on\w+\s*=\s*["'][^"']*["']/gi,"").replace(/javascript:/gi,"").replace(/data:/gi,"").replace(/vbscript:/gi,"").trim()}static sanitizeInput(e){return typeof e!="string"?e:e.replace(/[';"\\]/g,"").replace(/--/g,"").replace(/\/\*/g,"").replace(/\*\//g,"").trim()}static sanitizePhone(e){if(!e)return"";const t=e.replace(/\D/g,"");if(t.length===10)return t;throw new Error("Invalid phone number format")}static sanitizeEmail(e){if(!e)return"";const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,n=e.toLowerCase().trim();if(!t.test(n))throw new Error("Invalid email format");return n}static sanitizeUrl(e){if(!e)return"";try{const t=new URL(e);if(!["http:","https:"].includes(t.protocol))throw new Error("Invalid URL protocol");return t.toString()}catch{throw new Error("Invalid URL format")}}}class by{static generateSecureToken(e=32){const t=new Uint8Array(e);return crypto.getRandomValues(t),Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}static async hashData(e){const n=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map(o=>o.toString(16).padStart(2,"0")).join("")}static validatePasswordStrength(e){const n=/[A-Z]/.test(e),a=/[a-z]/.test(e),s=/\d/.test(e),o=/[!@#$%^&*(),.?":{}|<>]/.test(e),l=[];return e.length<8&&l.push("Password must be at least 8 characters long"),n||l.push("Password must contain at least one uppercase letter"),a||l.push("Password must contain at least one lowercase letter"),s||l.push("Password must contain at least one number"),o||l.push("Password must contain at least one special character"),{isValid:l.length===0,errors:l,strength:this.calculatePasswordStrength(e)}}static calculatePasswordStrength(e){let t=0;return t+=Math.min(e.length*2,20),/[a-z]/.test(e)&&(t+=5),/[A-Z]/.test(e)&&(t+=5),/\d/.test(e)&&(t+=5),/[!@#$%^&*(),.?":{}|<>]/.test(e)&&(t+=10),/123|abc|qwe/i.test(e)&&(t-=10),/password|admin|user/i.test(e)&&(t-=20),Math.max(0,Math.min(100,t))}}const wy={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_ADMIN_ACCESS_TOKEN:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlnd2dyeXlrZ2xzZXRmdm9taGRqIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NDc1NzEwOCwiZXhwIjoyMDcwMzMzMTA4fQ.VaKzl0eCysR9Vao5SeMD8w9RQHU7Aga8hnSmT2Vyld4",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlnd2dyeXlrZ2xzZXRmdm9taGRqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3NTcxMDgsImV4cCI6MjA3MDMzMzEwOH0.yL1hK263qf9msp7K4vUtF4Lvb7x7yxPcyvgkPiLokqA",VITE_SUPABASE_URL:"https://igwgryykglsetfvomhdj.supabase.co"};class _y{constructor(){this.config=new Map,this.initialized=!1,this.initializeConfig()}initializeConfig(){try{this.validateEnvironment(),this.setupSecureConfig(),this.initialized=!0}catch(e){console.error("Failed to initialize secure configuration:",e),this.initialized=!1}}validateEnvironment(){const t=["VITE_SUPABASE_URL","VITE_SUPABASE_ANON_KEY"].filter(n=>!wy[n]);if(t.length>0)throw new Error(`Missing required environment variables: ${t.join(", ")}`);try{new URL("https://igwgryykglsetfvomhdj.supabase.co")}catch{throw new Error("Invalid VITE_SUPABASE_URL format")}}setupSecureConfig(){this.config.set("supabase",{url:"https://igwgryykglsetfvomhdj.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlnd2dyeXlrZ2xzZXRmdm9taGRqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3NTcxMDgsImV4cCI6MjA3MDMzMzEwOH0.yL1hK263qf9msp7K4vUtF4Lvb7x7yxPcyvgkPiLokqA"}),this.config.set("security",{maxLoginAttempts:5,loginCooldownMs:15*60*1e3,sessionTimeoutMs:24*60*60*1e3,tokenExpiryMs:60*60*1e3,passwordPolicy:{minLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSpecialChars:!0}}),this.config.set("admin",{token:this.getSecureAdminToken(),permissions:["read","write","delete","manage_users"],sessionDuration:8*60*60*1e3}),this.config.set("api",{timeout:3e4,retryAttempts:3,rateLimitWindow:60*1e3,rateLimitMax:100}),this.config.set("csp",{allowedDomains:["supabase.co","supabase.com","googleapis.com","gstatic.com","google.com","genspark.ai"],allowedProtocols:["https:","http:"],blockInlineScripts:!0,blockInlineStyles:!1})}getSecureAdminToken(){const e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlnd2dyeXlrZ2xzZXRmdm9taGRqIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NDc1NzEwOCwiZXhwIjoyMDcwMzMzMTA4fQ.VaKzl0eCysR9Vao5SeMD8w9RQHU7Aga8hnSmT2Vyld4";return e.length>=16?e:(console.warn("No secure admin token found in environment. Using generated token."),console.warn("Please set VITE_ADMIN_ACCESS_TOKEN to a secure value in production."),by.generateSecureToken(32))}get(e,t=null){if(!this.initialized)throw new Error("Configuration not initialized");const n=this.config.get(e);if(!n)throw new Error(`Configuration key '${e}' not found`);if(t){if(!(t in n))throw new Error(`Configuration subkey '${e}.${t}' not found`);return n[t]}return n}isInitialized(){return this.initialized}getSanitizedConfig(){const e={};for(const[t,n]of this.config.entries())t==="supabase"?e[t]={url:n.url,anonKey:"***REDACTED***"}:t==="admin"?e[t]={token:"***REDACTED***",permissions:n.permissions,sessionDuration:n.sessionDuration}:e[t]=n;return e}validateAdminToken(e){if(!e||typeof e!="string")return!1;const t=this.get("admin");return e===t.token}getSecurityHeaders(){return{"Content-Type":"application/json","X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","X-XSS-Protection":"1; mode=block","Referrer-Policy":"strict-origin-when-cross-origin"}}}const Ny=new _y;Ny.get("admin","token");const Sy=["Web","Social Media","Ads","SEO","HR","Accounts","Sales","Blended (HR + Sales)","Operations Head","Web Head"],Sj={Web:["Web Designer/Developer","Graphic Designer (Web)"],"Social Media":["Client Servicing","Graphic Designer","YouTube Manager","LinkedIn Manager","Meta (Facebook/Instagram) Manager"],Ads:["Google Ads","Meta Ads"],SEO:["SEO Executive/Manager"],HR:["HR"],Accounts:["Accounts"],Sales:["Sales"],"Blended (HR + Sales)":["HR (80%) + Sales (20%)"],"Operations Head":["Operations Head"],"Web Head":["Web Head"]},n1=()=>{const r=new Date;return`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`},Ey=r=>{if(!r)return"";const[e,t]=r.split("-").map(Number),n=new Date(e,t-2,1);return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`},Ej=r=>{if(!r)return"";const[e,t]=r.split("-").map(Number);return new Date(e,t-1,1).toLocaleString(void 0,{month:"short",year:"numeric"})},Gs=r=>Math.round(r*10)/10,Ay=r=>/https?:\/\/(drive|docs)\.google\.com\//i.test(r||""),Aj=r=>/https?:\/\/(www\.)?genspark\.ai/i.test(r||"");function a1(r){const[e,t]=(r||"").split("-").map(Number);return!e||!t?31:new Date(e,t,0).getDate()}const Cy={"01-26":"Republic Day","08-15":"Independence Day","10-02":"Gandhi Jayanti","12-25":"Christmas Day","01-14":"Makar Sankranti","03-08":"Holi (approx)","04-14":"Ram Navami (approx)","05-01":"Labour Day","08-19":"Janmashtami (approx)","09-02":"Ganesh Chaturthi (approx)","10-24":"Dussehra (approx)","11-12":"Diwali (approx)","11-19":"Guru Nanak Jayanti (approx)"};function jy(r){const[e,t]=(r||"").split("-").map(Number);if(!e||!t)return 22;const n=new Date(e,t,0).getDate();let a=0,s=0;for(let o=1;o<=n;o++){const c=new Date(e,t-1,o).getDay();if(c===0||c===6&&(s++,s===2||s===4))continue;const u=`${String(t).padStart(2,"0")}-${String(o).padStart(2,"0")}`;Cy[u]||a++}return a}const Cj={monthKey:Ey(n1()),isDraft:!0,employee:{name:"",department:"Web",role:[],phone:"",photoUrl:"",joiningDate:"",dob:"",education:"",certifications:"",skills:""},meta:{attendance:{wfo:0,wfh:0},tasks:{count:0,aiTableLink:"",aiTableScreenshot:""}},clients:[],learning:[],aiUsageNotes:"",feedback:{company:"",hr:"",challenges:""},flags:{missingLearningHours:!1,hasEscalations:!1,missingReports:!1},manager:{verified:!1,comments:"",score:0,hiddenDataFlag:!1},scores:{kpiScore:0,learningScore:0,relationshipScore:0,overall:0}},Tc=["Website Development","Website Maintenance","SEO","Google Ads","Meta Ads","Social Media Management","Content Creation","Graphic Design","Video Production","Email Marketing","Analytics & Reporting","Lead Generation","E-commerce Management","Technical Support","Consulting","AI Tools"],ky={Web:["Website Development","Website Maintenance","AI Tools","Technical Support","E-commerce Management","SEO","Analytics & Reporting"],Marketing:["Website Development","SEO","Google Ads","Meta Ads","Social Media Management","Content Creation","Graphic Design","Video Production","Email Marketing","Analytics & Reporting","Lead Generation"],Website:["Website Development","Website Maintenance","Technical Support"]},Ty=r=>ky[r]||Tc,Ly=["Daily","Weekly","Bi-weekly","Monthly","Quarterly","As needed","One-time","Project-based"],Lc={"Website Development":"Project-based","Website Maintenance":"Monthly",SEO:"Monthly","Google Ads":"Weekly","Meta Ads":"Weekly","Social Media Management":"Daily","Content Creation":"Weekly","Graphic Design":"As needed","Video Production":"Monthly","Email Marketing":"Weekly","Analytics & Reporting":"Monthly","Lead Generation":"Weekly","E-commerce Management":"Daily","Technical Support":"As needed",Consulting:"As needed","AI Tools":"Monthly"},vs={name:"",team:"Web",status:"Active",client_type:"Standard",services:[],contact_email:"",contact_phone:"",start_date:"",scope_notes:"",logo_url:"",brand_colors:"",created_at:"",updated_at:""},sf=(r,e=null,t="")=>({service:r,frequency:e||Lc[r]||"Monthly",notes:t,added_date:new Date().toISOString()}),b0=({content:r})=>{const[e,t]=E.useState(!1);return i.jsxs("div",{className:"relative inline-block ml-2",children:[i.jsx("button",{type:"button",className:"text-blue-500 hover:text-blue-700 transition-colors duration-200",onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),onClick:()=>t(!e),children:i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})}),e&&i.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-48 sm:w-64 p-2 sm:p-3 bg-gray-900 text-white text-xs sm:text-sm rounded-lg shadow-lg z-10",children:[i.jsx("div",{className:"whitespace-pre-wrap",children:r}),i.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]})},Fy=ar.createContext({openModal:()=>{},closeModal:()=>{}}),bo=()=>ar.useContext(Fy);function en({title:r,children:e,number:t,info:n}){return i.jsxs("section",{className:"my-6 sm:my-8",children:[i.jsxs("h2",{className:"text-lg sm:text-xl font-semibold mb-4 flex items-center gap-2 text-gray-800",children:[t&&i.jsx("span",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:t}),!t&&i.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full"}),r,n&&i.jsx(b0,{content:n})]}),i.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl p-4 sm:p-6 shadow-lg shadow-blue-100/50 hover:shadow-xl hover:shadow-blue-100/60 transition-shadow duration-300",children:e})]})}const xi=ar.memo(function({label:e,value:t,onChange:n,placeholder:a,className:s,info:o,disabled:l=!1,onBlur:c,error:u,warning:d,validateOnChange:p=!1,required:g=!1,id:h}){const[b,x]=E.useState(!1),[y,v]=E.useState(!1),[_,S]=E.useState(null),j=h||`textfield-${Math.random().toString(36).substr(2,9)}`,I=`${j}-error`,J=o?`${j}-description`:void 0,k=()=>{x(!0)},F=H=>{x(!1),v(!0),c&&c(H)},T=H=>{const K=H.target.value;v(!0),n(K),p&&K.trim()&&S(null)},R=u||_,A=R&&y,P=d&&y&&!R;return i.jsxs("div",{className:`space-y-2 ${s||""}`,children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("label",{htmlFor:j,className:"block text-sm font-medium text-gray-700",children:[e,g&&i.jsx("span",{className:"text-red-500 ml-1","aria-label":"required",children:"*"})]}),o&&i.jsx(b0,{content:o,id:J})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",id:j,value:t||"",onChange:T,onFocus:k,onBlur:F,placeholder:a,disabled:l,required:g,"aria-invalid":A?"true":"false","aria-describedby":`${A?I:""} ${J||""}`.trim()||void 0,className:`
            w-full px-4 py-3 border rounded-xl transition-all duration-200
            ${l?"bg-gray-50 border-gray-200 text-gray-500 cursor-not-allowed":b?"border-blue-500 ring-2 ring-blue-100 bg-white":A?"border-red-500 bg-red-50":P?"border-amber-500 bg-amber-50":"border-gray-300 bg-white hover:border-gray-400"}
            focus:outline-none
          `}),y&&i.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:A?i.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold animate-pulse shadow-lg shadow-red-500/30 hover:shadow-red-500/50 transition-all duration-200 hover:scale-110","aria-hidden":"true",children:"!"}):P?i.jsx("div",{className:"w-5 h-5 bg-amber-500 rounded-full flex items-center justify-center text-white text-xs font-bold animate-pulse shadow-lg shadow-amber-500/30 hover:shadow-amber-500/50 transition-all duration-200 hover:scale-110","aria-hidden":"true",children:"‚ö†"}):t&&t.trim()?i.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center text-white text-xs font-bold shadow-lg shadow-green-500/30 hover:shadow-green-500/50 transition-all duration-200 hover:scale-110",children:"‚úì"}):null})]}),A&&i.jsx("div",{className:"mt-2 p-2 bg-red-100 border border-red-200 rounded-lg animate-in slide-in-from-top-2",children:i.jsxs("p",{id:I,className:"text-sm text-red-700 flex items-start gap-2",role:"alert","aria-live":"polite",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mt-2 flex-shrink-0","aria-hidden":"true"}),u]})}),P&&i.jsx("div",{className:"mt-2 p-2 bg-amber-100 border border-amber-200 rounded-lg animate-in slide-in-from-top-2",children:i.jsxs("p",{className:"text-sm text-amber-700 flex items-start gap-2",role:"alert","aria-live":"polite",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mt-2 flex-shrink-0","aria-hidden":"true"}),d]})}),i.jsx("div",{id:J,className:"sr-only",children:"Text input field. Enter your information here."})]})});ar.memo(function({label:e,value:t,onChange:n,className:a,info:s,disabled:o=!1,onBlur:l,error:c,warning:u,validateOnChange:d=!1,min:p,max:g,required:h=!1,id:b}){const[x,y]=E.useState(!1),[v,_]=E.useState(!1),[S,j]=E.useState(null),I=b||`numfield-${Math.random().toString(36).substr(2,9)}`,J=`${I}-error`,k=s?`${I}-description`:void 0,F=()=>{y(!0)},T=K=>{y(!1),_(!0),l&&l(K)},R=K=>{const ce=K.target.value;if(e&&e.includes("Work From Office")&&ce==="3"){console.log('üö® NumField WFO Debug - User typed "3":',{val:ce,type:typeof ce});debugger}if(ce===""||/^\d*\.?\d*$/.test(ce)){if(_(!0),d&&ce!==""){const me=Number(ce);p!==void 0&&me<p?j(`Value must be at least ${p}`):g!==void 0&&me>g?j(`Value must be at most ${g}`):j(null)}if(e&&e.includes("Work From Office")){const me=ce===""?"":ce;if(console.log("üö® NumField WFO onChange call:",{originalVal:ce,finalValue:me,type:typeof me,numericValue:Number(me)}),ce==="3"&&Number(me)===30){console.error("üö®üö®üö® MULTIPLICATION BUG DETECTED in NumField!"),console.error('Input "3" became 30!'),console.trace("Stack trace for multiplication bug");debugger}}n(ce===""?"":ce)}},A=c||S,P=A&&v,H=u&&v&&!A;return i.jsxs("div",{className:`space-y-2 ${a||""}`,children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("label",{htmlFor:I,className:"block text-sm font-medium text-gray-700",children:[e,h&&i.jsx("span",{className:"text-red-500 ml-1","aria-label":"required",children:"*"})]}),s&&i.jsx(b0,{content:s,id:k})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",inputMode:"numeric",id:I,value:t||"",onChange:R,onFocus:F,onBlur:T,disabled:o,required:h,min:p,max:g,"aria-invalid":P?"true":"false","aria-describedby":`${P?J:""} ${k||""}`.trim()||void 0,className:`
            w-full px-4 py-3 border rounded-xl transition-all duration-200
            ${o?"bg-gray-50 border-gray-200 text-gray-500 cursor-not-allowed":x?"border-blue-500 ring-2 ring-blue-100 bg-white":P?"border-red-500 bg-red-50":H?"border-amber-500 bg-amber-50":"border-gray-300 bg-white hover:border-gray-400"}
            focus:outline-none
          `}),v&&i.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:P?i.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold animate-pulse shadow-lg shadow-red-500/30 hover:shadow-red-500/50 transition-all duration-200 hover:scale-110",children:"!"}):H?i.jsx("div",{className:"w-5 h-5 bg-amber-500 rounded-full flex items-center justify-center text-white text-xs font-bold animate-pulse shadow-lg shadow-amber-500/30 hover:shadow-amber-500/50 transition-all duration-200 hover:scale-110",children:"‚ö†"}):t&&t.toString().trim()?i.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center text-white text-xs font-bold shadow-lg shadow-green-500/30 hover:shadow-green-500/50 transition-all duration-200 hover:scale-110",children:"‚úì"}):null})]}),P&&i.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg animate-in slide-in-from-top-2",children:[i.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold mt-0.5 flex-shrink-0",children:"!"}),i.jsx("div",{id:J,className:"text-sm text-red-700 leading-relaxed",role:"alert","aria-live":"polite",children:A})]}),H&&i.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg animate-in slide-in-from-top-2",children:[i.jsx("div",{className:"w-4 h-4 bg-amber-500 rounded-full flex items-center justify-center text-white text-xs font-bold mt-0.5 flex-shrink-0",children:"‚ö†"}),i.jsx("div",{className:"text-sm text-amber-700 leading-relaxed",role:"alert","aria-live":"polite",children:u})]}),i.jsxs("div",{id:k,className:"sr-only",children:["Numeric input field. Enter numbers only.",p!==void 0&&` Minimum value: ${p}.`,g!==void 0&&` Maximum value: ${g}.`]})]})});const la=ar.memo(function({label:e,value:t,onChange:n,rows:a=4,className:s,placeholder:o,disabled:l=!1,onBlur:c,error:u,warning:d,required:p=!1,id:g}){const[h,b]=E.useState(!1),x=!!u,y=!!d&&!x,v=g||`textarea-${Math.random().toString(36).substr(2,9)}`,_=`${v}-error`,S=`${v}-description`;return i.jsxs("div",{className:`transition-all duration-200 ${s||""}`,children:[e&&i.jsxs("label",{htmlFor:v,className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e,p&&i.jsx("span",{className:"text-red-500 ml-1","aria-label":"required",children:"*"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("textarea",{id:v,className:`w-full border rounded-xl p-3 text-base resize-y touch-manipulation transition-all duration-200 focus:outline-none focus:ring-2 ${x?"border-red-300 focus:ring-red-500 focus:border-red-500 bg-red-50 shadow-sm":y?"border-amber-300 focus:ring-amber-500 focus:border-amber-500 bg-amber-50 shadow-sm":l?"bg-gray-100 text-gray-500 cursor-not-allowed border-gray-300":h?"border-blue-500 focus:ring-blue-500 focus:border-blue-500 shadow-md bg-white":"border-gray-300 hover:border-gray-400 bg-white focus:ring-blue-500 focus:border-blue-500"}`,rows:a,placeholder:o||"",value:t||"",onChange:j=>l?null:n(j.target.value),onFocus:()=>b(!0),onBlur:j=>{b(!1),c&&c(j)},disabled:l,required:p,autoComplete:"off","aria-invalid":x?"true":"false","aria-describedby":`${x?_:""} ${S}`.trim()||void 0}),x&&i.jsx("div",{className:"absolute top-3 right-3 w-4 h-4 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold pointer-events-none","aria-hidden":"true",children:"!"}),y&&!x&&i.jsx("div",{className:"absolute top-3 right-3 w-4 h-4 bg-amber-500 rounded-full flex items-center justify-center text-white text-xs font-bold pointer-events-none","aria-hidden":"true",children:"‚ö†"})]}),x&&i.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg animate-in slide-in-from-top-2",children:i.jsxs("p",{id:_,className:"text-sm text-red-700 flex items-start gap-2",role:"alert","aria-live":"polite",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mt-2 flex-shrink-0","aria-hidden":"true"}),u]})}),y&&i.jsx("div",{className:"mt-2 p-3 bg-amber-50 border border-amber-200 rounded-lg animate-in slide-in-from-top-2",children:i.jsxs("p",{className:"text-sm text-amber-700 flex items-start gap-2",role:"alert","aria-live":"polite",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mt-2 flex-shrink-0","aria-hidden":"true"}),d]})}),i.jsx("div",{id:S,className:"sr-only",children:"Text area input field. Enter multiple lines of text here."})]})});function Py({options:r=[],selected:e=[],onChange:t,placeholder:n="Select options",disabled:a=!1,error:s=null,warning:o=null,label:l=null,validateOnChange:c=!1,required:u=!1,id:d,allowCustom:p=!1,customPlaceholder:g="Add custom option..."}){const[h,b]=E.useState(!1),[x,y]=E.useState(!1),[v,_]=E.useState(!1),[S,j]=E.useState(-1),[I,J]=E.useState(""),[k,F]=E.useState(!1),T=ar.useRef(null),R=ar.useRef(null),A=Array.isArray(e)?e:[],P=Array.isArray(r)?r:[],H=d||`multiselect-${Math.random().toString(36).substr(2,9)}`,K=`${H}-error`,ce=`${H}-description`,me=s&&v,le=o&&v&&!s,xe=e&&e.length>0,we=()=>{a||(b(!h),y(!h),_(!0),j(-1))},Oe=M=>{a||(_(!0),A.includes(M)?t(A.filter(V=>V!==M)):t([...A,M]))},ge=()=>{if(!I.trim()||a)return;const M=I.trim();if(P.includes(M)||A.includes(M)){J(""),F(!1);return}t([...A,M]),J(""),F(!1),_(!0)},C=M=>{M.key==="Enter"?(M.preventDefault(),ge()):M.key==="Escape"&&(J(""),F(!1))},O=M=>{var V;if(!a)switch(M.key){case"Enter":case" ":M.preventDefault(),h?S>=0&&S<P.length&&Oe(P[S]):we();break;case"Escape":h&&(b(!1),j(-1),(V=R.current)==null||V.focus());break;case"ArrowDown":M.preventDefault(),h?j(oe=>oe<P.length-1?oe+1:0):we();break;case"ArrowUp":M.preventDefault(),h&&j(oe=>oe>0?oe-1:P.length-1);break}};E.useEffect(()=>{function M(V){T.current&&!T.current.contains(V.target)&&(b(!1),y(!1))}return document.addEventListener("mousedown",M),()=>{document.removeEventListener("mousedown",M)}},[T]);const D=A.length>0?A.join(", "):n;return i.jsxs("div",{className:"transition-all duration-200",children:[l&&i.jsxs("label",{htmlFor:H,className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[l,u&&i.jsx("span",{className:"text-red-500 ml-1","aria-label":"required",children:"*"}),me&&i.jsxs("span",{className:"ml-2 flex items-center gap-1 text-red-600 text-xs font-medium animate-in slide-in-from-right-2",children:[i.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold","aria-hidden":"true",children:"!"}),"Required"]}),le&&i.jsxs("span",{className:"ml-2 flex items-center gap-1 text-amber-600 text-xs font-medium animate-in slide-in-from-right-2",children:[i.jsx("div",{className:"w-3 h-3 bg-amber-500 rounded-full flex items-center justify-center text-white text-xs font-bold","aria-hidden":"true",children:"‚ö†"}),"Warning"]})]}),i.jsxs("div",{className:"relative",ref:T,children:[i.jsx("button",{type:"button",ref:R,id:H,className:`w-full border rounded-xl p-3 text-left focus:ring-2 transition-all duration-200 touch-manipulation ${me?"border-red-300 focus:ring-red-500 focus:border-red-500 bg-red-50 shadow-sm":le?"border-amber-300 focus:ring-amber-500 focus:border-amber-500 bg-amber-50 shadow-sm":a?"bg-gray-100 text-gray-500 cursor-not-allowed border-gray-300":x||h?"border-blue-500 focus:ring-blue-500 focus:border-blue-500 shadow-md bg-white":"border-gray-300 hover:border-gray-400 bg-white focus:ring-blue-500 focus:border-blue-500"} ${A.length>0?"text-gray-900":"text-gray-500"}`,onClick:we,onKeyDown:O,disabled:a,"aria-expanded":h,"aria-haspopup":"listbox","aria-invalid":me?"true":"false","aria-describedby":`${me?K:""} ${ce}`.trim()||void 0,"aria-required":u,children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"truncate",children:D}),i.jsxs("div",{className:"flex items-center gap-2",children:[v&&i.jsx("div",{className:"absolute right-10 top-1/2 transform -translate-y-1/2",children:me?i.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold animate-pulse","aria-hidden":"true",children:"!"}):le?i.jsx("div",{className:"w-5 h-5 bg-amber-500 rounded-full flex items-center justify-center text-white text-xs font-bold animate-pulse","aria-hidden":"true",children:"‚ö†"}):xe?i.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center text-white text-xs font-bold","aria-hidden":"true",children:"‚úì"}):null}),i.jsx("span",{className:`transform transition-transform duration-200 ${h?"rotate-180":""}`,children:"‚ñº"})]})]})}),h&&!a&&i.jsx("ul",{className:"absolute z-50 w-full bg-white border border-gray-300 rounded-xl mt-1 max-h-60 overflow-y-auto shadow-lg animate-in slide-in-from-top-2",role:"listbox","aria-labelledby":H,children:P.length===0&&!p?i.jsx("li",{className:"p-3 text-gray-500 text-center",role:"option","aria-disabled":"true",children:"No options available"}):i.jsxs(i.Fragment,{children:[P.map((M,V)=>i.jsx("li",{role:"option","aria-selected":A.includes(M),onClick:()=>Oe(M),onMouseEnter:()=>j(V),className:`p-3 cursor-pointer transition-all duration-150 hover:bg-blue-100 ${S===V?"bg-blue-50 ring-2 ring-blue-200":""} ${A.includes(M)?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-900 font-semibold border-l-4 border-blue-500":"text-gray-900 hover:bg-blue-50"}`,children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{children:M}),A.includes(M)&&i.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold","aria-hidden":"true",children:"‚úì"})]})},M)),p&&i.jsxs(i.Fragment,{children:[P.length>0&&i.jsx("li",{className:"border-t border-gray-200"}),k?i.jsx("li",{className:"p-3 bg-gray-50",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:I,onChange:M=>J(M.target.value),onKeyDown:C,placeholder:g,className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0}),i.jsx("button",{type:"button",onClick:ge,className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 focus:ring-2 focus:ring-blue-500",children:"Add"}),i.jsx("button",{type:"button",onClick:()=>{F(!1),J("")},className:"px-2 py-1 bg-gray-300 text-gray-700 rounded text-sm hover:bg-gray-400",children:"‚úï"})]})}):i.jsxs("li",{onClick:()=>F(!0),className:"p-3 cursor-pointer text-blue-600 hover:bg-blue-50 border-t border-gray-200 flex items-center gap-2",children:[i.jsx("div",{className:"w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-xs font-bold",children:"+"}),i.jsx("span",{className:"text-sm font-medium",children:"Add custom role..."})]})]})]})})]}),me&&i.jsx("div",{className:"mt-2 p-2 bg-red-100 border border-red-200 rounded-lg animate-in slide-in-from-top-2",children:i.jsxs("p",{className:"text-sm text-red-700 flex items-start gap-2",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mt-2 flex-shrink-0"}),s]})}),le&&i.jsx("div",{className:"mt-2 p-2 bg-amber-100 border border-amber-200 rounded-lg animate-in slide-in-from-top-2",children:i.jsxs("p",{className:"text-sm text-amber-700 flex items-start gap-2",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mt-2 flex-shrink-0"}),o]})})]})}function jj({label:r,currentValue:e,previousValue:t,comparisonValue:n,onChange:a,placeholder:s="Enter value",unit:o="",disabled:l=!1,monthComparison:c="Baseline Month",monthPrev:u="Previous Month",monthThis:d="This Month",error:p=null,warning:g=null,validateOnChange:h=!1}){const[b,x]=E.useState(null),[y,v]=E.useState(null),_=Number(n||0),S=Number(t||0),j=Number(e||0),I=S-_,J=j-S,k=j-_,F=ce=>ce>0?"text-green-600":ce<0?"text-red-600":"text-gray-600",T=p||b,R=g||y,A=T&&T.trim()!=="",P=R&&R.trim()!=="",H=ce=>{l||(h&&(ce<0?x("Value cannot be negative"):ce>31?(v("Value seems unusually high"),x(null)):(x(null),v(null))),a(ce))},K=`w-full border rounded-xl p-3 text-base focus:ring-2 transition-colors ${l?"bg-gray-100 text-gray-500 cursor-not-allowed":A?"border-red-300 focus:ring-red-500 focus:border-red-500":P?"border-amber-300 focus:ring-amber-500 focus:border-amber-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`;return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-sm font-medium mb-2 ${A?"text-red-700":P?"text-amber-700":"text-gray-700"}`,children:r}),i.jsx("input",{type:"number",inputMode:"numeric",className:K,placeholder:s,value:e||"",onChange:ce=>{const me=ce.target.value;if(console.log("üîç ThreeWayComparativeField input:",{rawValue:me,type:typeof me}),me==="3"){console.error('üö®üö®üö® DEBUG: User typed "3" - checking for multiplication bug!'),console.error("Raw value:",me,"Type:",typeof me);debugger}if(me===""){console.log("‚úÖ Empty input, passing empty string"),H("");return}const le=Number(me);if(console.log("üî¢ Converted to number:",{numValue:le,type:typeof le}),me==="3"&&le!==3){console.error('üö®üö®üö® MULTIPLICATION BUG DETECTED! Input "3" became',le),console.error('This should not happen. Number("3") should equal 3, not',le);debugger}if(me.length===1&&le===parseInt(me)*10){console.error("üö®üö®üö® 10x MULTIPLICATION BUG! Input",me,"became",le);debugger}!isNaN(le)&&isFinite(le)?H(le):console.warn("‚ö†Ô∏è Invalid number input:",me)},disabled:l}),A&&i.jsxs("div",{className:"mt-1 text-sm text-red-600 flex items-center gap-1 animate-in slide-in-from-top-1",children:[i.jsx("span",{className:"text-red-500",children:"‚ö†Ô∏è"}),T]}),!A&&P&&i.jsxs("div",{className:"mt-1 text-sm text-amber-600 flex items-center gap-1 animate-in slide-in-from-top-1",children:[i.jsx("span",{className:"text-amber-500",children:"‚ö°"}),R]})]}),i.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-3",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Three-way Comparison"}),i.jsx("span",{className:"text-xs font-bold",children:"üìä"})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:c}),i.jsxs("div",{className:"font-semibold text-gray-700",children:[_,o]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:u}),i.jsxs("div",{className:"font-semibold text-gray-700",children:[S,o]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:d}),i.jsxs("div",{className:"font-semibold text-blue-700",children:[j,o]})]})]}),i.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-200 grid grid-cols-3 gap-4 text-xs",children:[i.jsxs("div",{className:`${F(I)}`,children:["Baseline ‚Üí Prev: ",I>=0?"+":"",I,o]}),i.jsxs("div",{className:`${F(J)}`,children:["Prev ‚Üí This: ",J>=0?"+":"",J,o]}),i.jsxs("div",{className:`${F(k)}`,children:["Baseline ‚Üí This: ",k>=0?"+":"",k,o]})]})]})]})}ar.memo(function({label:e,value:t,onChange:n,options:a=[],placeholder:s="Select an option",className:o,info:l,disabled:c=!1,onBlur:u,error:d,warning:p,required:g=!1,id:h}){const[b,x]=E.useState(!1),[y,v]=E.useState(!1),_=h||`selectfield-${Math.random().toString(36).substr(2,9)}`,S=`${_}-error`,j=l?`${_}-description`:void 0,I=()=>{x(!0)},J=R=>{x(!1),v(!0),u&&u(R)},k=R=>{const A=R.target.value;v(!0),n(A)},F=d&&y,T=p&&y&&!F;return i.jsxs("div",{className:`space-y-2 ${o||""}`,children:[e&&i.jsxs("label",{htmlFor:_,className:"block text-sm font-medium text-gray-700",children:[e,g&&i.jsx("span",{className:"text-red-500 ml-1",children:"*"}),l&&i.jsx(b0,{content:l})]}),i.jsx("div",{className:"relative",children:i.jsxs("select",{id:_,value:t||"",onChange:k,onFocus:I,onBlur:J,disabled:c,"aria-describedby":[j,F?S:null].filter(Boolean).join(" ")||void 0,"aria-invalid":F?"true":"false",className:`
            w-full px-3 py-2 border rounded-lg shadow-sm transition-all duration-200
            focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500
            disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed
            ${F?"border-red-300 bg-red-50":T?"border-amber-300 bg-amber-50":"border-gray-300"}
            ${b?"ring-2 ring-blue-500 border-blue-500":""}
          `,children:[s&&i.jsx("option",{value:"",disabled:!0,children:s}),a.map((R,A)=>i.jsx("option",{value:typeof R=="object"?R.value:R,children:typeof R=="object"?R.label:R},A))]})}),F&&i.jsxs("p",{id:S,className:"text-sm text-red-600 flex items-center gap-1",children:[i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),d]}),T&&i.jsxs("p",{className:"text-sm text-amber-600 flex items-center gap-1",children:[i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),p]}),l&&!F&&!T&&i.jsx("p",{id:j,className:"text-sm text-gray-500",children:l})]})});function kj({errors:r=[],warnings:e=[],stepTitle:t="Step"}){const n=Array.isArray(r)&&r.length>0,a=Array.isArray(e)&&e.length>0;if(!n&&!a)return i.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-gradient-to-r from-emerald-50 to-green-50 border border-emerald-200 text-emerald-700 shadow-sm transition-all duration-300 animate-in slide-in-from-top-2 hover:shadow-md",children:[i.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center text-white font-bold text-sm animate-pulse shadow-lg shadow-emerald-500/30 hover:shadow-emerald-500/50 hover:scale-110 transition-all duration-200",children:"‚úì"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"font-semibold text-emerald-800",children:[t," is complete"]}),i.jsx("div",{className:"text-sm text-emerald-600 mt-1",children:"All required fields are properly filled"})]}),i.jsx("div",{className:"flex-shrink-0 text-emerald-500",children:i.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]});const s=n?"border-red-300":"border-amber-300",o=n?"from-red-50 to-rose-50":"from-amber-50 to-yellow-50",l=n?"bg-red-500":"bg-amber-500",c=n?"text-red-800":"text-amber-800",u=n?"text-red-600":"text-amber-600";return i.jsxs("div",{className:`p-4 rounded-xl bg-gradient-to-r ${o} border ${s} shadow-sm transition-all duration-300 animate-in slide-in-from-top-2`,children:[i.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[i.jsx("div",{className:`flex-shrink-0 w-8 h-8 ${l} rounded-full flex items-center justify-center text-white font-bold text-sm ${n?"animate-bounce":"animate-pulse"} shadow-lg ${n?"shadow-red-500/30 hover:shadow-red-500/50":"shadow-amber-500/30 hover:shadow-amber-500/50"} hover:scale-110 transition-all duration-200`,children:n?"!":"‚ö†"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:`font-semibold ${c}`,children:n?"Action Required":"Please Review"}),i.jsx("div",{className:`text-sm ${u} mt-1`,children:n?"Fix these issues to continue":"Some items need attention"})]})]}),n&&i.jsxs("div",{className:"mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold shadow-md shadow-red-500/30 hover:shadow-red-500/50 hover:scale-110 transition-all duration-200",children:"!"}),i.jsx("div",{className:"text-red-800 font-semibold text-sm",children:"Critical Issues"})]}),i.jsx("div",{className:"space-y-2",children:r.map((d,p)=>i.jsxs("div",{className:"flex items-start gap-2 p-2 bg-red-100 rounded-lg border border-red-200",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mt-2 flex-shrink-0"}),i.jsx("div",{className:"text-sm text-red-700 leading-relaxed",children:d})]},`err-${p}`))})]}),a&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("div",{className:"w-4 h-4 bg-amber-500 rounded-full flex items-center justify-center text-white text-xs font-bold shadow-md shadow-amber-500/30 hover:shadow-amber-500/50 hover:scale-110 transition-all duration-200",children:"‚ö†"}),i.jsx("div",{className:"text-amber-800 font-semibold text-sm",children:"Recommendations"})]}),i.jsx("div",{className:"space-y-2",children:e.map((d,p)=>i.jsxs("div",{className:"flex items-start gap-2 p-2 bg-amber-100 rounded-lg border border-amber-200",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mt-2 flex-shrink-0"}),i.jsx("div",{className:"text-sm text-amber-700 leading-relaxed",children:d})]},`warn-${p}`))})]})]})}const Ry=[{value:"Standard",label:"Standard",description:"Basic service package"},{value:"Premium",label:"Premium",description:"Enhanced service package"},{value:"Enterprise",label:"Enterprise",description:"Full-service package"}],Dy=[{value:"Web",label:"Web Team",description:"Website development, maintenance, and AI tools"},{value:"Marketing",label:"Marketing Team",description:"Website development and marketing services"},{value:"Website",label:"Website Team",description:"Website development only"}];function Oy({onClientAdded:r,onCancel:e,compact:t=!1,inline:n=!1}){const a=ha(),{notify:s}=Fn(),{user:o,role:l}=Fa(),c=l,{addClient:u}=go(),{addSystemNotification:d}=xd(),[p,g]=E.useState(!1),[h,b]=E.useState(!1),[x,y]=E.useState(1),[v,_]=E.useState({...vs,team:(o==null?void 0:o.department)||"Web"}),[S,j]=E.useState([]),[I,J]=E.useState({}),[k,F]=E.useState({}),T=E.useCallback(()=>{_({...vs,team:(o==null?void 0:o.department)||"Web"}),j([]),J({}),F({}),y(1)},[o==null?void 0:o.department]),R=E.useCallback(ge=>{const C={};return ge===1&&(v.name.trim()||(C.name="Client name is required"),v.team||(C.team="Team selection is required"),v.client_type||(C.client_type="Client type is required")),ge===2&&S.length===0&&(C.services="At least one service must be selected"),ge===3&&(v.contact_email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v.contact_email)&&(C.contact_email="Please enter a valid email address"),v.contact_phone&&!/^[\d\s\-\+\(\)]+$/.test(v.contact_phone)&&(C.contact_phone="Please enter a valid phone number")),F(C),Object.keys(C).length===0},[v,S]),A=E.useCallback((ge,C)=>{_(O=>({...O,[ge]:C})),k[ge]&&F(O=>{const D={...O};return delete D[ge],D})},[k]),P=E.useCallback(ge=>{j(C=>{const O=C.includes(ge),D=O?C.filter(M=>M!==ge):[...C,ge];return O||J(M=>({...M,[ge]:Lc[ge]||"Monthly"})),D}),k.services&&F(C=>{const O={...C};return delete O.services,O})},[k.services]),H=E.useCallback((ge,C)=>{J(O=>({...O,[ge]:C}))},[]),K=E.useCallback(()=>{R(x)&&y(ge=>ge+1)},[x,R]),ce=E.useCallback(()=>{y(ge=>ge-1)},[]),me=E.useCallback(async()=>{var ge,C,O;if(R(3)){b(!0);try{const D=S.map(ue=>({service:ue,frequency:I[ue]||Lc[ue]||"Monthly",notes:"",added_date:new Date().toISOString()})),M={name:v.name.trim(),team:v.team,client_type:v.client_type,status:"Active",services:S,service_scopes:D.reduce((ue,Z)=>(ue[Z.service]={frequency:Z.frequency,description:Z.notes||"",deliverables:0},ue),{}),contact_email:((ge=v.contact_email)==null?void 0:ge.trim())||"",contact_phone:((C=v.contact_phone)==null?void 0:C.trim())||"",notes:((O=v.scope_notes)==null?void 0:O.trim())||"",contract_start_date:v.start_date||new Date().toISOString().split("T")[0],created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:V,error:oe}=await a.from("clients").insert([M]).select().single();if(oe)throw new Error(`Database error: ${oe.message}`);u(V);const he={type:"success",priority:"medium",category:"client_management",title:"New Client Added",message:`${V.name} has been added to the ${V.team} team by ${(o==null?void 0:o.name)||"Unknown"} (${c||"employee"})`,dashboard:"all",metadata:{clientId:V.id,clientName:V.name,team:V.team,addedBy:(o==null?void 0:o.name)||"Unknown",addedByRole:c||"employee",services:S}};d(he),s({type:"success",title:"Client Added Successfully",message:`${V.name} has been added to the ${V.team} team`}),T(),g(!1),r&&r(V)}catch(D){console.error("Error creating client:",D),s({type:"error",title:"Failed to Add Client",message:D.message||"An unexpected error occurred"})}finally{b(!1)}}},[v,S,I,R,a,o,c,u,d,s,T,r]),le=()=>i.jsx("div",{className:"flex items-center justify-center mb-6",children:[1,2,3].map(ge=>i.jsxs(ar.Fragment,{children:[i.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium ${x>=ge?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:ge}),ge<3&&i.jsx("div",{className:`w-12 h-1 mx-2 ${x>ge?"bg-blue-600":"bg-gray-200"}`})]},ge))}),xe=()=>i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Name *"}),i.jsx("input",{type:"text",value:v.name,onChange:ge=>A("name",ge.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${k.name?"border-red-300":"border-gray-300"}`,placeholder:"Enter client name"}),k.name&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:k.name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team *"}),i.jsx("select",{value:v.team,onChange:ge=>A("team",ge.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${k.team?"border-red-300":"border-gray-300"}`,children:Dy.map(ge=>i.jsx("option",{value:ge.value,children:ge.label},ge.value))}),k.team&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:k.team})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Type *"}),i.jsx("div",{className:"grid grid-cols-1 gap-3",children:Ry.map(ge=>i.jsxs("label",{className:"flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[i.jsx("input",{type:"radio",name:"client_type",value:ge.value,checked:v.client_type===ge.value,onChange:C=>A("client_type",C.target.value),className:"mr-3 text-blue-600 focus:ring-blue-500"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:ge.label}),i.jsx("div",{className:"text-sm text-gray-600",children:ge.description})]})]},ge.value))}),k.client_type&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:k.client_type})]})]}),we=()=>i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Services & Scope"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Services *"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-64 overflow-y-auto border rounded-lg p-3",children:Ty(v.team).map(ge=>i.jsxs("label",{className:"flex items-start gap-3 p-2 hover:bg-gray-50 rounded",children:[i.jsx("input",{type:"checkbox",checked:S.includes(ge),onChange:()=>P(ge),className:"mt-1 text-blue-600 focus:ring-blue-500"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-medium text-sm text-gray-900",children:ge}),S.includes(ge)&&i.jsx("select",{value:I[ge]||Lc[ge]||"Monthly",onChange:C=>H(ge,C.target.value),className:"mt-1 text-xs border border-gray-300 rounded px-2 py-1 w-full",children:Ly.map(C=>i.jsx("option",{value:C,children:C},C))})]})]},ge))}),k.services&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:k.services})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scope Notes"}),i.jsx("textarea",{value:v.scope_notes,onChange:ge=>A("scope_notes",ge.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe the scope of work, special requirements, or notes..."})]})]}),Oe=()=>i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email"}),i.jsx("input",{type:"email",value:v.contact_email,onChange:ge=>A("contact_email",ge.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${k.contact_email?"border-red-300":"border-gray-300"}`,placeholder:"client@example.com"}),k.contact_email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:k.contact_email})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Phone"}),i.jsx("input",{type:"tel",value:v.contact_phone,onChange:ge=>A("contact_phone",ge.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${k.contact_phone?"border-red-300":"border-gray-300"}`,placeholder:"+1 (555) 123-4567"}),k.contact_phone&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:k.contact_phone})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),i.jsx("input",{type:"date",value:v.start_date,onChange:ge=>A("start_date",ge.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-6",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Summary"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Client:"})," ",v.name]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Team:"})," ",v.team]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Type:"})," ",v.client_type]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Services:"})," ",S.join(", ")]}),v.contact_email&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Email:"})," ",v.contact_email]}),v.contact_phone&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Phone:"})," ",v.contact_phone]})]})]})]});return n?i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Add New Client"}),le()]}),i.jsxs("div",{className:"mb-6",children:[x===1&&xe(),x===2&&we(),x===3&&Oe()]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("button",{onClick:x===1?()=>{T(),e&&e()}:ce,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:x===1?"Cancel":"Previous"}),x<3?i.jsx("button",{onClick:K,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Next"}):i.jsxs("button",{onClick:me,disabled:h,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[h&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),h?"Adding Client...":"Add Client"]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>g(!0),className:t?"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2":"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[i.jsx("span",{className:"text-lg",children:"‚ûï"}),"Add New Client"]}),p&&i.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden relative",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New Client"}),i.jsx("button",{onClick:()=>{g(!1),T(),e&&e()},className:"text-gray-400 hover:text-gray-600 text-xl",children:"‚úï"})]}),le()]}),i.jsxs("div",{className:"px-6 py-4 overflow-y-auto max-h-[60vh]",children:[x===1&&xe(),x===2&&we(),x===3&&Oe()]}),i.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-between",children:[i.jsx("button",{onClick:x===1?()=>{g(!1),T(),e&&e()}:ce,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:x===1?"Cancel":"Previous"}),x<3?i.jsx("button",{onClick:K,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Next"}):i.jsxs("button",{onClick:me,disabled:h,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[h&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),h?"Adding Client...":"Add Client"]})]})]})})]})}function Iy(r,e,t=!0,n=2e3,a,s){const[o,l]=E.useState(null),[c,u]=E.useState(!1),[d,p]=E.useState(!1),g=E.useRef(null),h=E.useRef(r),b=E.useRef(t);E.useEffect(()=>{h.current=r,b.current=t},[r,t]);const x=E.useCallback(async()=>{if(!b.current||!e)return!1;try{u(!0);const j={...h.current,lastSaved:new Date().toISOString(),sessionInfo:{userAgent:navigator.userAgent,timestamp:Date.now(),url:window.location.href}};return localStorage.setItem(e,JSON.stringify(j)),l(new Date),p(!1),a&&a(j),console.log("üíæ Auto-save successful:",e),!0}catch(j){return console.error("‚ùå Auto-save failed:",j),s&&s(j),!1}finally{u(!1)}},[e,a,s]),y=E.useCallback(()=>{g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{x()},n)},[x,n]);E.useEffect(()=>(t&&e&&r&&(p(!0),y()),()=>{g.current&&clearTimeout(g.current)}),[r,t,e,y]);const v=E.useCallback(()=>{if(!e)return null;try{const j=localStorage.getItem(e);if(j){const I=JSON.parse(j);return console.log("üìÑ Loaded saved data:",e),I}}catch(j){console.error("‚ùå Failed to load saved data:",j)}return null},[e]),_=E.useCallback(()=>{if(e)try{localStorage.removeItem(e),l(null),p(!1),console.log("üóëÔ∏è Cleared saved data:",e)}catch(j){console.error("‚ùå Failed to clear saved data:",j)}},[e]),S=E.useCallback(async()=>(g.current&&clearTimeout(g.current),await x()),[x]);return E.useEffect(()=>{const j=I=>{if(d&&t&&e){try{const J={...h.current,lastSaved:new Date().toISOString(),emergencySave:!0};localStorage.setItem(e,JSON.stringify(J)),console.log("üíæ Emergency save on page unload")}catch(J){console.error("‚ùå Emergency save failed:",J)}return I.preventDefault(),I.returnValue="You have unsaved changes. Are you sure you want to leave?","You have unsaved changes. Are you sure you want to leave?"}};return window.addEventListener("beforeunload",j),()=>window.removeEventListener("beforeunload",j)},[d,t,e]),{lastSaved:o,isSaving:c,hasUnsavedChanges:d,saveNow:S,loadSavedData:v,clearSavedData:_,isEnabled:t&&!!e}}function My(r,e){return E.useCallback(()=>{if(!r||!e)return null;const t=[r];return Object.entries(e).forEach(([n,a])=>{a&&t.push(`${n}-${a}`)}),t.length>1?t.join("_"):null},[r,e])()}const Cd={superAdmin:[{title:"Employee Dashboard",icon:"Users",color:"bg-blue-500",stats:"125 Active",path:"/employee-dashboard"},{title:"Agency Dashboard",icon:"Building",color:"bg-green-500",stats:"8 Departments",path:"/agency-dashboard"},{title:"Intern Dashboard",icon:"GraduationCap",color:"bg-purple-500",stats:"15 Active",path:"/intern-dashboard"},{title:"Manager Dashboard",icon:"UserCheck",color:"bg-orange-500",stats:"12 Managers",path:"/manager-dashboard"},{title:"Sales Dashboard",icon:"TrendingUp",color:"bg-red-500",stats:"‚Çπ2.5M Revenue",path:"/sales-dashboard"}],operationsHead:[{title:"Marketing Employees",icon:"Users",color:"bg-blue-500",stats:"45 Active",path:"/marketing-employees"},{title:"Agency Operations",icon:"Settings",color:"bg-green-500",stats:"Running Smooth",path:"/agency-operations"},{title:"Interns",icon:"GraduationCap",color:"bg-purple-500",stats:"15 Active",path:"/interns"}],manager:[{title:"Employee Dashboard",icon:"Users",color:"bg-blue-500",stats:"25 Employees",path:"/employee-dashboard"},{title:"Agency Dashboard",icon:"Building",color:"bg-green-500",stats:"5 Departments",path:"/agency-dashboard"},{title:"Intern Dashboard",icon:"GraduationCap",color:"bg-purple-500",stats:"Projects: 12, Completion Rate: 85%",path:"/intern-dashboard"}],hr:[{title:"Total Employees",value:"156",icon:"Users",className:"bg-blue-50 border-blue-200"},{title:"Pending Reviews",value:"23",icon:"Clock",className:"bg-yellow-50 border-yellow-200"},{title:"New Hires",value:"8",icon:"UserPlus",className:"bg-green-50 border-green-200"},{title:"Departments",value:"12",icon:"Building",className:"bg-purple-50 border-purple-200"}]},Hc={dashboards:{agency:"#/agency-dashboard",manager:"#/manager-dashboard",employee:"#/employee-signup",intern:"#/intern-dashboard",reports:"#/reports-dashboard",arcade:"#/arcade-dashboard",superAdmin:"#/super-admin-dashboard",operationsHead:"#/operations-head-dashboard",hr:"#/hr-dashboard",sales:"#/sales-crm-dashboard",seo:"#/seo-dashboard",ads:"#/ads-dashboard",freelancers:"#/freelancers-dashboard"},profiles:{superAdmin:"#/super-admin-profile",hr:"#/hr-profile",intern:"#/intern-profile",manager:"#/manager-profile",employee:"#/employee-profile",freelancer:"#/freelancer-profile",operationsHead:"#/operations-head-profile"},forms:{employeeSignup:"#/employee-signup",clientOnboarding:"#/client-onboarding",leaveApplication:"#/leave-application",performanceReview:"#/performance-review"}},al={light:{name:"Light",colors:{primary:"#3b82f6",secondary:"#64748b",background:"#ffffff",surface:"#f8fafc",text:"#1e293b",textSecondary:"#64748b",border:"#e2e8f0",success:"#10b981",warning:"#f59e0b",error:"#ef4444",info:"#3b82f6"},shadows:{sm:"0 1px 2px 0 rgb(0 0 0 / 0.05)",md:"0 4px 6px -1px rgb(0 0 0 / 0.1)",lg:"0 10px 15px -3px rgb(0 0 0 / 0.1)"}},dark:{name:"Dark",colors:{primary:"#60a5fa",secondary:"#94a3b8",background:"#0f172a",surface:"#1e293b",text:"#f1f5f9",textSecondary:"#94a3b8",border:"#334155",success:"#34d399",warning:"#fbbf24",error:"#f87171",info:"#60a5fa"},shadows:{sm:"0 1px 2px 0 rgb(0 0 0 / 0.3)",md:"0 4px 6px -1px rgb(0 0 0 / 0.3)",lg:"0 10px 15px -3px rgb(0 0 0 / 0.3)"}},blue:{name:"Blue",colors:{primary:"#2563eb",secondary:"#64748b",background:"#f8fafc",surface:"#ffffff",text:"#1e293b",textSecondary:"#64748b",border:"#e2e8f0",success:"#10b981",warning:"#f59e0b",error:"#ef4444",info:"#2563eb"},shadows:{sm:"0 1px 2px 0 rgb(37 99 235 / 0.1)",md:"0 4px 6px -1px rgb(37 99 235 / 0.1)",lg:"0 10px 15px -3px rgb(37 99 235 / 0.1)"}}},pl={superAdmin:{title:"Super Admin Panel",sections:[{title:"Dashboard",items:[{label:"Overview",path:"#/super-admin-dashboard",icon:"LayoutDashboard"},{label:"Analytics",path:"#/analytics",icon:"BarChart3"}]},{title:"Management",items:[{label:"Employees",path:"#/employee-management",icon:"Users"},{label:"Departments",path:"#/department-management",icon:"Building"},{label:"Roles",path:"#/role-management",icon:"Shield"}]},{title:"System",items:[{label:"Settings",path:"#/system-settings",icon:"Settings"},{label:"Audit Logs",path:"#/audit-logs",icon:"FileText"},{label:"Backup",path:"#/backup",icon:"Database"}]}]},hr:{title:"HR Dashboard",sections:[{title:"Employee Management",items:[{label:"All Employees",path:"#/employees",icon:"Users"},{label:"Onboarding",path:"#/onboarding",icon:"UserPlus"},{label:"Performance",path:"#/performance",icon:"TrendingUp"}]},{title:"Reports",items:[{label:"Monthly Reports",path:"#/monthly-reports",icon:"FileText"},{label:"Analytics",path:"#/hr-analytics",icon:"BarChart3"}]}]},manager:{title:"Manager Dashboard",sections:[{title:"Team Management",items:[{label:"My Team",path:"#/my-team",icon:"Users"},{label:"Projects",path:"#/projects",icon:"FolderOpen"},{label:"Performance",path:"#/team-performance",icon:"TrendingUp"}]}]}},jd={project:{completed:{color:"text-green-600",bgColor:"bg-green-100",icon:"CheckCircle"},"in-progress":{color:"text-blue-600",bgColor:"bg-blue-100",icon:"Clock"},pending:{color:"text-yellow-600",bgColor:"bg-yellow-100",icon:"AlertCircle"},upcoming:{color:"text-gray-600",bgColor:"bg-gray-100",icon:"Calendar"}},employee:{active:{color:"text-green-600",bgColor:"bg-green-100",icon:"CheckCircle"},inactive:{color:"text-red-600",bgColor:"bg-red-100",icon:"XCircle"},pending:{color:"text-yellow-600",bgColor:"bg-yellow-100",icon:"Clock"}},intern:{active:{color:"text-green-600",bgColor:"bg-green-100",icon:"CheckCircle"},completed:{color:"text-blue-600",bgColor:"bg-blue-100",icon:"GraduationCap"},"on-leave":{color:"text-orange-600",bgColor:"bg-orange-100",icon:"Calendar"}}},$c={blue:"bg-blue-500",green:"bg-green-500",orange:"bg-orange-500",purple:"bg-purple-500",red:"bg-red-500",yellow:"bg-yellow-500"},kd={maintenance:{color:"bg-red-100 text-red-800",icon:"Wrench"},meeting:{color:"bg-blue-100 text-blue-800",icon:"Users"},deadline:{color:"bg-orange-100 text-orange-800",icon:"Clock"},holiday:{color:"bg-green-100 text-green-800",icon:"Calendar"},training:{color:"bg-purple-100 text-purple-800",icon:"BookOpen"}},qc={personal:{fullName:"Full Name",email:"Email",phone:"Phone",dateOfBirth:"Date of Birth",address:"Address"},professional:{role:"Role",department:"Department",joiningDate:"Joining Date",employeeId:"Employee ID",manager:"Direct Manager",securityClearance:"Security Clearance"},skills:{technical:"Technical Skills",soft:"Soft Skills",certifications:"Certifications",languages:"Languages"},performance:{kpiScore:"KPI Score",learningScore:"Learning Score",clientRelations:"Client Relations",overallRating:"Overall Rating"}},Wc={profile:{securityClearance:"Level 5 - Full Access",department:"Administration",role:"Super Admin",status:"Active",notSet:"Not set"},metrics:{dailyActiveUsers:38,weeklyActiveUsers:42,monthlyActiveUsers:45,averagePerformanceScore:8.2,submissionRate:94,clientSatisfaction:94}},Td={systemActivity:["Activity","User","Time","Status"],monthlyPerformance:["Employee","Department","Performance","Status"],dailyReports:["Intern","Date","Hours","Productivity","Learning","Status","Actions"],employeeList:["Name","Department","Role","Status","Actions"]},zc={noData:"No data available",loading:"Loading...",noEmployees:"No employees found",noEvents:"No events scheduled for this month",noReports:"No reports available",noProfile:"No profile found",leaderboardData:"Leaderboard data will be displayed here",arcadeManagement:"Arcade management panel will be available here"},Ld={reports:[{value:"all",label:"All Reports"},{value:"pending",label:"Pending Review"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"}],departments:[{value:"all",label:"All Departments"},{value:"web",label:"Web"},{value:"social-media",label:"Social Media"},{value:"ads",label:"Ads"},{value:"seo",label:"SEO"},{value:"hr",label:"HR"},{value:"sales",label:"Sales"}],status:[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"pending",label:"Pending"}]},Fd={intern:[{id:"overview",label:"Overview",icon:"Home"},{id:"projects",label:"Projects",icon:"FolderOpen"},{id:"skills",label:"Skills",icon:"Award"},{id:"roadmap",label:"Roadmap",icon:"Map"},{id:"reports",label:"Reports",icon:"FileText"}],internsDashboard:[{id:"daily-report",label:"Daily Report"},{id:"my-projects",label:"My Projects"},{id:"performance",label:"Performance"},{id:"certificate",label:"Certificate"}]},Pd=["January","February","March","April","May","June","July","August","September","October","November","December"],Rd=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s1={title:"Agency Dashboard",welcomeMessage:"Welcome",guestAccess:"Guest Access",myProfile:"My Profile",sections:{addNewClient:"Add New Client",dailyInspiration:"Daily Inspiration",performanceLeaderboard:"Performance Leaderboard",live:"Live",performanceDescription:"Top performers based on monthly submissions and KPIs",quickStats:"Quick Stats",projectWorkspaces:"Project Workspaces",onboardingForms:"Onboarding Forms",onboardingDescription:"Shareable links - send to new employees & clients",quickAccess:"Quick Access"},navigation:{monthlyForm:"Monthly Form",reports:"Reports",tools:"Tools",leaveWfh:"Leave/WFH",addClient:"Add Client"},stats:{q4Targets:{value:"+15%",label:"Q4 Targets"},newClients:{value:"5",label:"New Clients"}},workspaces:{clientTracker:"Client Tracker",clientServicing:"Client Servicing",web:"Web",crm:"CRM",hr:"HR",ads:"Ads",seo:"SEO",socialMedia:"Social Media",general:"General"},onboarding:{employee:{title:"Employee Onboarding",description:"For new employees to fill",openForm:"Open Form",copyLink:"Copy Link",shareLabel:"Share"},client:{title:"Client Onboarding",description:"For new clients to fill",openForm:"Open Form",copyLink:"Copy Link",shareLabel:"Share"}},quickAccess:{organizationChart:"Organization Chart",employeeDirectory:"Employee Directory",clientDirectory:"Client Directory",performanceScoring:"Performance Scoring",performanceConcerns:"Performance Concerns",arcadeProgram:"Arcade Program",companyGuidebook:"Company Guidebook & Policies"},alerts:{leaveSuccess:"Leave application submitted successfully!",leaveError:"Error submitting leave application. Please try again.",urlCopied:"URL copied to clipboard!",urlCopyError:"Failed to copy URL. Please copy manually."}},Dd={internDashboard:{overview:"Welcome to your internship dashboard! Here you can track your progress, view projects, and monitor your skill development. Use the tabs above to navigate between different sections.",projects:"Click Projects tab to view details about your assigned projects and their current status.",skills:"View Skills tab for detailed breakdown of your technical and soft skills progress.",timeRemaining:"Time remaining in your internship program."},certificateEligibility:"You are eligible for a certificate upon successful completion of your internship program."},i1={profileCompletion:{title:"Complete Your Intern Profile",description:"Complete your profile to help mentors understand your learning goals.",buttonText:"Complete Now"},learningOverview:{learningHours:{title:"Learning Hours",subtitle:"This month",icon:"üìö"},progress:{title:"Progress",subtitle:"Tasks completed",icon:"üìà"},performance:{title:"Performance",subtitle:"Average score",icon:"‚≠ê"},skills:{title:"Skills",subtitle:"New skills",icon:"üéØ"}},kpiDashboard:{title:"Learning KPI Dashboard",description:"Track your learning progress and development goals",overallScoreLabel:"Overall Learning Score",updateButton:"Update KPIs",kpiLabels:{skillDevelopment:"Skill Development",learningHours:"Learning Hours",goalCompletion:"Goal Completion",mentorRating:"Mentor Rating",projectQuality:"Project Quality",technicalGrowth:"Technical Growth",softSkills:"Soft Skills",initiativeScore:"Initiative Score"},kpiIcons:{skillDevelopment:"üöÄ",learningHours:"‚è∞",goalCompletion:"‚úÖ",mentorRating:"‚≠ê",projectQuality:"üíé",technicalGrowth:"üíª",softSkills:"ü§ù",initiativeScore:"üéØ"}},tabs:{learningOverview:{label:"Learning Overview",icon:"üìö"},skillDevelopment:{label:"Skill Development",icon:"üéØ"},academicProgress:{label:"Academic Progress",icon:"üéì"},mentorFeedback:{label:"Mentor Feedback",icon:"üí¨"}},skillDevelopment:{technicalSkills:{title:"üöÄ Technical Skills",subtitle:"Programming & Tools"},softSkills:{title:"ü§ù Soft Skills",subtitle:"Communication & Teamwork"},initiative:{title:"üéØ Initiative",subtitle:"Proactivity & Leadership"}},academicProgress:{title:"üéì Academic Performance",currentCoursesTitle:"üìö Current Courses",labels:{currentGPA:"Current GPA:",creditsCompleted:"Credits Completed:",yearLevel:"Year Level:"},emptyState:{icon:"üéì",title:"No Academic Data",message:"Academic progress information will appear here when available."},noCoursesMessage:"No courses listed"},mentorFeedback:{title:"Mentor Feedback",ratingLabel:"Rating:",emptyState:{icon:"üí¨",title:"No Feedback Yet",message:"Mentor feedback will appear here as you progress through your internship."}},personalInfo:{title:"Personal Information",editButton:"Edit Profile",labels:{fullName:"Full Name",email:"Email",phone:"Phone",university:"University",major:"Major",graduationYear:"Graduation Year",bio:"Bio",learningObjectives:"Learning Objectives"},defaultValues:{notProvided:"Not provided",noBio:"No bio provided",noObjectives:"No learning objectives specified"}},learningGoals:{title:"Learning Goals",statusLabels:{completed:"completed",in_progress:"in_progress",pending:"pending"},targetLabel:"Target:",progressLabel:"Progress:",emptyState:{icon:"üéØ",title:"No Learning Goals Set",message:"Set learning goals to track your progress during the internship.",buttonText:"Add Learning Goal"}},monthlyProgress:{title:"Monthly Learning Progress",stats:{tasks:"Tasks",completed:"Completed",avgScore:"Avg Score",hours:"Hours"}},recentActivities:{title:"Recent Activities",tableHeaders:{date:"Date",activity:"Activity",hours:"Hours",score:"Score",status:"Status"},defaultActivity:"Learning Task",emptyState:{icon:"üìù",title:"No Activities Yet",message:"Your learning activities will appear here as you progress."}},modals:{editProfile:{title:"Edit Intern Profile",placeholders:{interests:"e.g., Web Development, Design, Marketing",learningObjectives:"What do you want to learn during this internship?",careerGoals:"What are your long-term career aspirations?",bio:"Tell us about yourself..."},buttons:{cancel:"Cancel",save:"Save Changes"}},kpiUpdate:{title:"Update Learning KPIs",sections:{learningDevelopment:{title:"üìö Learning Development",labels:{skillDevelopment:"Skill Development (%)",learningHours:"Learning Hours (Weekly)",goalCompletion:"Goal Completion (%)",mentorRating:"Mentor Rating (%)"}},performanceGrowth:{title:"üöÄ Performance & Growth",labels:{projectQuality:"Project Quality (%)",technicalGrowth:"Technical Growth (%)",softSkills:"Soft Skills (%)",initiativeScore:"Initiative Score (%)"}}},overallScore:{title:"Overall Learning Score",description:"Based on all learning KPIs"},buttons:{cancel:"Cancel",save:"Save KPIs"}}},alerts:{profileUpdateSuccess:"Profile updated successfully",profileUpdateError:"Failed to update profile",kpiUpdateSuccess:"Learning KPIs updated successfully",kpiUpdateError:"Failed to update learning KPIs",dataLoadError:"Failed to load learning data"}},By={dashboardCards:Cd,navigationPaths:Hc,themes:al,sidebar:pl,statusColors:jd,progressBarColors:$c,calendarEventTypes:kd,defaultProfileFields:qc,defaultValues:Wc,tableHeaders:Td,placeholderMessages:zc,filterOptions:Ld,tabConfigurations:Fd,monthFormatting:{names:Pd,short:Rd},instructionalText:Dd,agencyDashboard:s1,personalizedDashboard:{roleThemes:{SEO:{primary:"from-blue-600 to-blue-700",secondary:"bg-blue-50",text:"text-blue-700",border:"border-blue-200",accent:"text-blue-600",gradient:"bg-gradient-to-r from-blue-500 to-blue-600"},Ads:{primary:"from-green-600 to-green-700",secondary:"bg-green-50",text:"text-green-700",border:"border-green-200",accent:"text-green-600",gradient:"bg-gradient-to-r from-green-500 to-green-600"},HR:{primary:"from-purple-600 to-purple-700",secondary:"bg-purple-50",text:"text-purple-700",border:"border-purple-200",accent:"text-purple-600",gradient:"bg-gradient-to-r from-purple-500 to-purple-600"},"Social Media":{primary:"from-pink-600 to-pink-700",secondary:"bg-pink-50",text:"text-pink-700",border:"border-pink-200",accent:"text-pink-600",gradient:"bg-gradient-to-r from-pink-500 to-pink-600"},"YouTube SEO":{primary:"from-red-600 to-red-700",secondary:"bg-red-50",text:"text-red-700",border:"border-red-200",accent:"text-red-600",gradient:"bg-gradient-to-r from-red-500 to-red-600"},"Web Developer":{primary:"from-indigo-600 to-indigo-700",secondary:"bg-indigo-50",text:"text-indigo-700",border:"border-indigo-200",accent:"text-indigo-600",gradient:"bg-gradient-to-r from-indigo-500 to-indigo-600"},"Graphic Designer":{primary:"from-orange-600 to-orange-700",secondary:"bg-orange-50",text:"text-orange-700",border:"border-orange-200",accent:"text-orange-600",gradient:"bg-gradient-to-r from-orange-500 to-orange-600"},Freelancer:{primary:"from-teal-600 to-teal-700",secondary:"bg-teal-50",text:"text-teal-700",border:"border-teal-200",accent:"text-teal-600",gradient:"bg-gradient-to-r from-teal-500 to-teal-600"},Intern:{primary:"from-cyan-600 to-cyan-700",secondary:"bg-cyan-50",text:"text-cyan-700",border:"border-cyan-200",accent:"text-cyan-600",gradient:"bg-gradient-to-r from-cyan-500 to-cyan-600"},"Operations Head":{primary:"from-amber-600 to-amber-700",secondary:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",accent:"text-amber-600",gradient:"bg-gradient-to-r from-amber-500 to-amber-600"},"Super Admin":{primary:"from-slate-600 to-slate-700",secondary:"bg-slate-50",text:"text-slate-700",border:"border-slate-200",accent:"text-slate-600",gradient:"bg-gradient-to-r from-slate-500 to-slate-600"},default:{primary:"from-gray-600 to-gray-700",secondary:"bg-gray-50",text:"text-gray-700",border:"border-gray-200",accent:"text-gray-600",gradient:"bg-gradient-to-r from-gray-500 to-gray-600"}},roleToDepartment:{SEO:"seo",Ads:"ads",HR:"human_resources","Social Media":"social_media","YouTube SEO":"youtube_seo","Web Developer":"web_development","Graphic Designer":"creative",Freelancer:"freelancer",Intern:"intern","Operations Head":"operations","Super Admin":"administration"},roleSpecificFeatures:{SEO:{quickActions:["Keyword Research","SERP Analysis","Content Optimization","GMB Management"],notifications:["Ranking Updates","Client Reports Due","Algorithm Changes"],widgets:["keyword_rankings","organic_traffic","backlink_profile","content_performance"],kpiPriority:["organic_traffic","keyword_rankings","conversion_rate","bounce_rate"]},Ads:{quickActions:["Campaign Setup","Budget Optimization","A/B Testing","Performance Review"],notifications:["Budget Alerts","Campaign Performance","Bid Adjustments"],widgets:["campaign_performance","roas_metrics","budget_utilization","conversion_tracking"],kpiPriority:["roas","cpc","conversion_rate","click_through_rate"]},"Social Media":{quickActions:["Content Scheduling","Engagement Analysis","Hashtag Research","Story Creation"],notifications:["Post Performance","Engagement Milestones","Content Calendar"],widgets:["engagement_metrics","follower_growth","content_reach","story_performance"],kpiPriority:["engagement_rate","follower_growth","reach","impressions"]},"YouTube SEO":{quickActions:["Video Optimization","Thumbnail Design","Analytics Review","Keyword Tags"],notifications:["Video Performance","Subscriber Milestones","Trending Topics"],widgets:["video_performance","subscriber_growth","watch_time","ctr_metrics"],kpiPriority:["watch_time","subscriber_growth","ctr","video_views"]},"Web Developer":{quickActions:["Code Review","Performance Testing","Bug Fixes","Feature Development"],notifications:["Build Status","Code Reviews","Performance Alerts"],widgets:["project_status","code_quality","performance_metrics","deployment_history"],kpiPriority:["code_quality","project_completion","bug_resolution","performance_score"]},"Graphic Designer":{quickActions:["Design Review","Asset Creation","Brand Guidelines","Client Feedback"],notifications:["Design Approvals","Project Deadlines","Brand Updates"],widgets:["project_portfolio","design_feedback","asset_library","brand_compliance"],kpiPriority:["design_quality","project_completion","client_satisfaction","creativity_score"]},Freelancer:{quickActions:["Project Bidding","Time Tracking","Invoice Generation","Client Communication"],notifications:["Project Invitations","Payment Updates","Deadline Reminders"],widgets:["project_pipeline","earnings_tracker","time_management","client_ratings"],kpiPriority:["project_completion","client_satisfaction","earnings","time_efficiency"]},Intern:{quickActions:["Learning Modules","Task Submission","Mentor Meeting","Progress Review"],notifications:["Learning Milestones","Task Assignments","Mentor Feedback"],widgets:["learning_progress","task_completion","skill_development","mentor_feedback"],kpiPriority:["learning_progress","task_completion","skill_acquisition","mentor_rating"]},Manager:{quickActions:["Team Management","Performance Reviews","Employee Directory","Organization Chart","Performance Scoring","Monthly Reports"],notifications:["Team Performance","Performance Reviews Due","Team Updates"],widgets:["team_performance","employee_metrics","performance_overview","team_goals"],kpiPriority:["team_productivity","employee_satisfaction","goal_achievement","performance_score"]},HR:{quickActions:["Employee Onboarding","Performance Reviews","Policy Updates","Recruitment","Employee Directory","Organization Chart","Performance Scoring"],notifications:["New Hires","Performance Reviews Due","Policy Changes"],widgets:["employee_metrics","recruitment_pipeline","performance_overview","policy_compliance"],kpiPriority:["employee_satisfaction","retention_rate","recruitment_efficiency","training_completion"]},"Operations Head":{quickActions:["Team Management","Process Optimization","Resource Allocation","Strategic Planning","Employee Directory","Organization Chart","Performance Scoring"],notifications:["Team Performance","Resource Alerts","Strategic Updates"],widgets:["team_performance","operational_metrics","resource_utilization","strategic_goals"],kpiPriority:["operational_efficiency","team_productivity","resource_optimization","goal_achievement"]},"Super Admin":{quickActions:["System Monitoring","User Management","Security Review","Data Analytics","Employee Directory","Organization Chart","Performance Scoring"],notifications:["System Alerts","Security Updates","Performance Metrics"],widgets:["system_health","user_analytics","security_dashboard","performance_overview"],kpiPriority:["system_uptime","user_engagement","security_score","data_integrity"]}},baseSidebarSections:[{id:"testimonials",label:"Testimonials",icon:"üí¨"},{id:"appreciation",label:"Appreciation",icon:"üèÜ"}],departmentSections:{seo:[{id:"monthly_work",label:"SEO Campaigns",icon:"üìä"},{id:"performance",label:"Performance",icon:"üìà"},{id:"learning_goals",label:"Learning Goals",icon:"üéØ"}],ads:[{id:"monthly_work",label:"Ad Campaigns",icon:"üì¢"},{id:"performance",label:"Performance",icon:"üìà"},{id:"client_relationships",label:"Client Relations",icon:"ü§ù"}],human_resources:[{id:"monthly_work",label:"HR Activities",icon:"üë•"},{id:"performance",label:"Performance",icon:"üìà"},{id:"discipline_attendance",label:"Attendance",icon:"üìÖ"}],social_media:[{id:"monthly_work",label:"Social Campaigns",icon:"üì±"},{id:"performance",label:"Performance",icon:"üìà"},{id:"learning_goals",label:"Learning Goals",icon:"üéØ"}],web_development:[{id:"monthly_work",label:"Web Projects",icon:"üíª"},{id:"performance",label:"Performance",icon:"üìà"},{id:"learning_goals",label:"Learning Goals",icon:"üéØ"}]},defaultProfileData:{name:"",role:"",department:"",email:"",phone:"",joining_date:null,profile_picture:null},sections:{testimonials:{title:"Client Testimonials",emptyMessage:"No testimonials yet. Keep delivering great work!",defaultClientName:"Anonymous",defaultProjectName:"General Feedback"},appreciation:{title:"Recognition & Appreciation",emptyMessage:"Keep up the great work to earn recognition!",defaultTitle:"Recognition",defaultGivenBy:"Management",defaultCategory:"General",icon:"üèÜ"},monthly_work:{title:"Monthly Work Progress",emptyMessage:"No monthly submissions yet. Start tracking your progress!",statusLabels:{approved:"Approved",pending:"Pending",submitted:"Submitted"},fields:{projectsCompleted:"Projects Completed:",goalsAchieved:"Goals Achieved:",challenges:"Challenges:",nextMonthGoals:"Next Month Goals:"},defaultValues:{projectsCompleted:"N/A",goalsAchieved:"N/A",challenges:"None reported",nextMonthGoals:"N/A"}},performance:{title:"Performance Progress",emptyMessage:"Performance evaluations will appear here.",overallScoreLabel:"Overall Score",reviewTitle:"Performance Review",metrics:{qualityOfWork:"Quality of Work",teamCollaboration:"Team Collaboration"},feedbackLabel:"Feedback:",defaultScore:"N/A"},learning_goals:{title:"Learning Goals & Development",emptyMessage:"Set learning goals to track your professional development!",statusLabels:{completed:"Completed",in_progress:"In Progress",not_started:"Not Started"},labels:{targetDate:"Target Date:",category:"Category:",progress:"Progress"},defaultCategory:"General"},client_relationships:{title:"Client Relationships",emptyMessage:"Client relationship data will appear here.",defaultProjectName:"General Relationship",satisfactionLabel:"Satisfaction",labels:{started:"Started:",status:"Status:"},defaultStatus:"Active"},discipline_attendance:{title:"Discipline & Attendance",emptyMessage:"Attendance records will appear here.",recentAttendanceTitle:"Recent Attendance",stats:{daysPresent:"Days Present",lateArrivals:"Late Arrivals",absences:"Absences"},statusLabels:{present:"Present",late:"Late",absent:"Absent",unknown:"Unknown"},timeLabels:{in:"In:",out:"Out:"}}},header:{backButton:"Back",profileSectionsTitle:"Profile Sections",departmentSuffix:"Department"},loading:{text:"Loading your profile..."},fallback:{sectionNotAvailable:"Section content not available.",defaultProfileName:"My Profile"}},internProfile:i1},Uy=Object.freeze(Object.defineProperty({__proto__:null,AGENCY_DASHBOARD_CONFIG:s1,CALENDAR_EVENT_TYPES:kd,DASHBOARD_CARDS:Cd,DEFAULT_VALUES:Wc,FILTER_OPTIONS:Ld,INSTRUCTIONAL_TEXT:Dd,INTERN_PROFILE_CONFIG:i1,MONTH_NAMES:Pd,MONTH_NAMES_SHORT:Rd,NAVIGATION_PATHS:Hc,PLACEHOLDER_MESSAGES:zc,PROFILE_FIELD_LABELS:qc,PROGRESS_COLORS:$c,SIDEBAR_CONFIG:pl,STATUS_CONFIG:jd,TABLE_HEADERS:Td,TAB_CONFIGS:Fd,THEMES:al,UI_CONFIG:By},Symbol.toStringTag,{value:"Module"})),of=[{id:1,activity:"Employee Performance Review",user:"John Manager",time:"2 hours ago",status:"Completed"},{id:2,activity:"System Backup",user:"System",time:"4 hours ago",status:"Completed"},{id:3,activity:"New Employee Onboarding",user:"HR Team",time:"6 hours ago",status:"In Progress"},{id:4,activity:"Client Meeting",user:"Sales Team",time:"8 hours ago",status:"Completed"}],lf={dailyActiveUsers:38,weeklyActiveUsers:42,monthlyActiveUsers:45},cf={averagePerformanceScore:8.2,submissionRate:94,clientSatisfaction:94},uf={employees:125,interns:15,freelancers:8,managers:12},df={sales:{value:"‚Çπ2.5M",change:"+12%"},hr:{value:"156",change:"+8"},finance:{value:"‚Çπ1.2M",change:"+5%"},intern:{value:"15",change:"+3"}},Hy={profile:{name:"Alex Johnson",studentId:"INT2024001",email:"alex.johnson@company.com",phone:"+91 9876543210",startDate:"2024-01-15",endDate:"2024-07-15",department:"Web Development",mentor:"Sarah Wilson",currentWeek:12,totalWeeks:24,internshipType:"Full-time",status:"Active"},projects:[{id:1,title:"Onboarding Project",description:"Learn company processes and basic web development setup",status:"completed",startDate:"2024-01-15",endDate:"2024-02-15",technologies:["HTML","CSS","JavaScript"],learningOutcomes:["Understanding of company workflow","Basic web development skills","Version control with Git"],rating:4.5},{id:2,title:"First Real Project",description:"Build a responsive landing page for client",status:"in-progress",startDate:"2024-02-16",endDate:"2024-04-15",technologies:["React","Tailwind CSS","JavaScript"],learningOutcomes:["React component development","Responsive design principles","Client communication skills"],rating:null}],skills:{technical:[{name:"JavaScript",level:75,category:"Programming"},{name:"React",level:60,category:"Framework"},{name:"HTML/CSS",level:85,category:"Markup"},{name:"Git",level:70,category:"Version Control"}],soft:[{name:"Communication",level:80,category:"Interpersonal"},{name:"Time Management",level:75,category:"Organizational"},{name:"Problem Solving",level:70,category:"Analytical"},{name:"Teamwork",level:85,category:"Collaborative"}]},weeklyReports:[{week:12,date:"2024-04-01",hoursWorked:40,tasksCompleted:8,learningHours:10,feedback:"Great progress on React components",challenges:"Understanding state management",achievements:"Completed responsive design module"},{week:11,date:"2024-03-25",hoursWorked:38,tasksCompleted:7,learningHours:12,feedback:"Good improvement in coding practices",challenges:"CSS Grid layout",achievements:"Built first React component"}],roadmap:[{phase:"Foundation",status:"completed",goals:["Learn HTML/CSS","Understand JavaScript basics","Git workflow"],completedGoals:["Learn HTML/CSS","Understand JavaScript basics","Git workflow"]},{phase:"Framework Learning",status:"in-progress",goals:["Master React basics","Component lifecycle","State management"],completedGoals:["Master React basics"]},{phase:"Project Development",status:"upcoming",goals:["Build full-stack app","API integration","Testing"],completedGoals:[]}]},$y={ytdAvgScore:8.5,lastMonthScore:9.2,activeAccounts:15,avgRoas90d:4.2},qy=[{id:1,name:"TechCorp Solutions",type:"B2B",platforms:["Google Ads","LinkedIn"],roas:4.5,spend:5e4},{id:2,name:"Fashion Boutique",type:"B2C",platforms:["Facebook","Instagram"],roas:3.8,spend:25e3},{id:3,name:"Local Restaurant",type:"Local",platforms:["Google Ads","Facebook"],roas:5.2,spend:15e3}],Wy=[{month:"January 2024",grade:"B+",score:82},{month:"February 2024",grade:"A-",score:87},{month:"March 2024",grade:"A",score:91},{month:"April 2024",grade:"A+",score:95}],zy=[{id:1,title:"Team Meeting",date:"2024-04-15",type:"meeting",description:"Weekly team sync"},{id:2,title:"System Maintenance",date:"2024-04-20",type:"maintenance",description:"Scheduled server maintenance"},{id:3,title:"Project Deadline",date:"2024-04-25",type:"deadline",description:"Client project delivery"},{id:4,title:"Holiday",date:"2024-04-30",type:"holiday",description:"Public holiday"}],hf=[{id:1,name:"John Doe",department:"Web",performance:85,status:"Active"},{id:2,name:"Jane Smith",department:"Social Media",performance:92,status:"Active"},{id:3,name:"Mike Johnson",department:"Ads",performance:78,status:"Active"},{id:4,name:"Sarah Wilson",department:"SEO",performance:88,status:"Active"}],Vy=[{id:1,intern:"Alex Johnson",date:"2024-04-15",hours:8,productivity:85,learning:90,status:"Submitted"},{id:2,intern:"Emma Davis",date:"2024-04-15",hours:7.5,productivity:78,learning:85,status:"Pending Review"},{id:3,intern:"Ryan Chen",date:"2024-04-15",hours:8,productivity:92,learning:88,status:"Approved"}],Gy={superAdmin:{personalInfo:{fullName:"Admin User",email:"admin@company.com",phone:"+91 9876543210",dateOfBirth:"1985-01-15",address:"123 Admin Street, City"},professionalInfo:{role:"Super Admin",department:"Administration",joiningDate:"2020-01-01",employeeId:"SA001",manager:"CEO",securityClearance:"Level 5 - Full Access"}},hr:{personalInfo:{fullName:"HR Manager",email:"hr@company.com",phone:"+91 9876543211",dateOfBirth:"1988-03-20",address:"456 HR Avenue, City"},professionalInfo:{role:"HR Manager",department:"Human Resources",joiningDate:"2021-06-15",employeeId:"HR001",manager:"Operations Head",securityClearance:"Level 3 - HR Access"}},intern:{personalInfo:{fullName:"Intern Student",email:"intern@company.com",phone:"+91 9876543212",dateOfBirth:"2002-08-10",address:"789 Student Lane, City"},professionalInfo:{role:"Intern",department:"Web Development",joiningDate:"2024-01-15",employeeId:"INT001",manager:"Development Lead",securityClearance:"Level 1 - Basic Access"}}},Ky={adsExecutive:{clients:[{value:"client1",label:"TechCorp Solutions"},{value:"client2",label:"Fashion Boutique"},{value:"client3",label:"Local Restaurant"}],months:[{value:"2024-01",label:"January 2024"},{value:"2024-02",label:"February 2024"},{value:"2024-03",label:"March 2024"},{value:"2024-04",label:"April 2024"}]}},ff={superAdmin:{totalEmployees:156,activeProjects:23,monthlyRevenue:"‚Çπ2.5M",clientSatisfaction:94},hr:{totalEmployees:156,pendingReviews:23,newHires:8,departments:12},manager:{teamSize:25,activeProjects:12,completionRate:85,teamPerformance:88}};class Yy{constructor(){this.cache=new Map,this.cacheTimeout=2*60*1e3}getCachedData(e){if(this.cache.has(e)){const t=this.cache.get(e);if(Date.now()-t.timestamp<this.cacheTimeout)return t.data;this.cache.delete(e)}return null}setCachedData(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}async getSystemActivities(){const e="system_activities",t=this.getCachedData(e);if(t)return t;try{if(!dt)throw new Error("Supabase not configured");const{data:n,error:a}=await dt.from("user_sessions").select(`
          id,
          created_at,
          unified_users!inner(name)
        `).order("created_at",{ascending:!1}).limit(10);if(a)throw a;const{data:s,error:o}=await dt.from("submissions").select(`
          id,
          created_at,
          status,
          unified_users!inner(name)
        `).order("created_at",{ascending:!1}).limit(5);if(o)throw o;const l=[];n==null||n.forEach(u=>{var d;l.push({id:`login_${u.id}`,activity:"User Login",user:((d=u.unified_users)==null?void 0:d.name)||"Unknown User",time:this.formatTimeAgo(u.created_at),status:"Completed"})}),s==null||s.forEach(u=>{var d;l.push({id:`submission_${u.id}`,activity:"Form Submission",user:((d=u.unified_users)==null?void 0:d.name)||"Unknown User",time:this.formatTimeAgo(u.created_at),status:u.status==="submitted"?"Completed":"In Progress"})});const c=l.sort((u,d)=>new Date(d.time)-new Date(u.time)).slice(0,10);return this.setCachedData(e,c),c}catch(n){return console.error("Error fetching system activities:",n),[{id:1,activity:"System Status Check",user:"System",time:"5 minutes ago",status:"Completed"}]}}async getUserMetrics(){const e="user_metrics",t=this.getCachedData(e);if(t)return t;try{if(!dt)throw new Error("Supabase not configured");const{data:n,error:a}=await dt.from("unified_users").select("id").eq("is_active",!0);if(a)throw a;const s=new Date;s.setHours(0,0,0,0);const{data:o,error:l}=await dt.from("user_sessions").select("user_id").gte("created_at",s.toISOString());if(l)throw l;const c=new Date;c.setDate(c.getDate()-7);const{data:u,error:d}=await dt.from("user_sessions").select("user_id").gte("created_at",c.toISOString());if(d)throw d;const p=new Date;p.setDate(p.getDate()-30);const{data:g,error:h}=await dt.from("user_sessions").select("user_id").gte("created_at",p.toISOString());if(h)throw h;const b={dailyActiveUsers:new Set((o==null?void 0:o.map(x=>x.user_id))||[]).size,weeklyActiveUsers:new Set((u==null?void 0:u.map(x=>x.user_id))||[]).size,monthlyActiveUsers:new Set((g==null?void 0:g.map(x=>x.user_id))||[]).size,totalUsers:(n==null?void 0:n.length)||0};return this.setCachedData(e,b),b}catch(n){return console.error("Error fetching user metrics:",n),{dailyActiveUsers:25,weeklyActiveUsers:35,monthlyActiveUsers:42,totalUsers:50}}}async getPerformanceMetrics(){const e="performance_metrics",t=this.getCachedData(e);if(t)return t;try{if(!dt)throw new Error("Supabase not configured");const{data:n,error:a}=await dt.from("monthly_kpi_reports").select("overall_score, client_satisfaction_score").not("overall_score","is",null).not("client_satisfaction_score","is",null);if(a)throw a;const{data:s,error:o}=await dt.from("submissions").select("status");if(o)throw o;const l=(n==null?void 0:n.length)>0?n.reduce((h,b)=>h+(b.overall_score||0),0)/n.length:0,c=(n==null?void 0:n.length)>0?n.reduce((h,b)=>h+(b.client_satisfaction_score||0),0)/n.length:0,u=(s==null?void 0:s.length)||0,d=(s==null?void 0:s.filter(h=>h.status==="submitted").length)||0,p=u>0?d/u*100:0,g={averagePerformanceScore:Math.round(l*10)/10,submissionRate:Math.round(p),clientSatisfaction:Math.round(c)};return this.setCachedData(e,g),g}catch(n){return console.error("Error fetching performance metrics:",n),{averagePerformanceScore:8.2,submissionRate:94,clientSatisfaction:94}}}async getActiveUsers(){const e="active_users",t=this.getCachedData(e);if(t)return t;try{if(!dt)throw new Error("Supabase not configured");const{data:n,error:a}=await dt.from("unified_users").select("role, user_category").eq("is_active",!0);if(a)throw a;const s={employees:0,interns:0,freelancers:0,managers:0};return n==null||n.forEach(o=>{var u,d;const l=((u=o.user_category)==null?void 0:u.toLowerCase())||"",c=((d=o.role)==null?void 0:d.toLowerCase())||"";l.includes("intern")||c.includes("intern")?s.interns++:l.includes("freelancer")||c.includes("freelancer")?s.freelancers++:l.includes("manager")||c.includes("manager")||c.includes("head")||c.includes("admin")?s.managers++:s.employees++}),this.setCachedData(e,s),s}catch(n){return console.error("Error fetching active users:",n),{employees:125,interns:15,freelancers:8,managers:12}}}async getDynamicStats(){const e="dynamic_stats",t=this.getCachedData(e);if(t)return t;try{if(!dt)throw new Error("Supabase not configured");const{data:n,error:a}=await dt.from("clients").select("id").eq("status","Active");if(a)throw a;const{data:s,error:o}=await dt.from("unified_users").select("department").eq("is_active",!0);if(o)throw o;const l={};s==null||s.forEach(g=>{const h=g.department||"Other";l[h]=(l[h]||0)+1});const c=new Date;c.setMonth(c.getMonth()-1);const{data:u,error:d}=await dt.from("submissions").select("created_at").gte("created_at",c.toISOString());if(d)throw d;const p={sales:{value:`‚Çπ${(((n==null?void 0:n.length)||0)*5e4).toLocaleString()}`,change:"+12%"},hr:{value:((s==null?void 0:s.length)||0).toString(),change:"+8"},finance:{value:`‚Çπ${(((u==null?void 0:u.length)||0)*25e3).toLocaleString()}`,change:"+5%"},intern:{value:(l.Intern||15).toString(),change:"+3"}};return this.setCachedData(e,p),p}catch(n){return console.error("Error fetching dynamic stats:",n),{sales:{value:"‚Çπ2.5M",change:"+12%"},hr:{value:"156",change:"+8"},finance:{value:"‚Çπ1.2M",change:"+5%"},intern:{value:"15",change:"+3"}}}}async getEmployeePerformance(){const e="employee_performance",t=this.getCachedData(e);if(t)return t;try{if(!dt)throw new Error("Supabase not configured");const{data:n,error:a}=await dt.from("monthly_kpi_reports").select("employee_id, overall_score, growth_percentage").not("overall_score","is",null).order("overall_score",{ascending:!1}).limit(10);if(a)throw a;if(!n||n.length===0)throw new Error("No performance data found");const s=n.map(u=>u.employee_id),{data:o,error:l}=await dt.from("unified_users").select("id, name, role, department").in("id",s);if(l)throw l;const c=n.map((u,d)=>{const p=o==null?void 0:o.find(g=>g.id===u.employee_id);return{id:d+1,name:(p==null?void 0:p.name)||"Unknown",role:(p==null?void 0:p.role)||"Employee",department:(p==null?void 0:p.department)||"General",score:Math.round(u.overall_score||0),change:u.growth_percentage||0,trend:u.growth_percentage>0?"up":u.growth_percentage<0?"down":"stable",avatar:`https://ui-avatars.com/api/?name=${encodeURIComponent((p==null?void 0:p.name)||"User")}&background=random`}}).filter(u=>u.name!=="Unknown");return this.setCachedData(e,c),c}catch(n){return console.error("Error fetching employee performance:",n),[{id:1,name:"Sarah Johnson",role:"SEO Specialist",department:"Marketing",score:95,change:12,trend:"up",avatar:"https://ui-avatars.com/api/?name=Sarah+Johnson&background=random"}]}}async getDashboardStats(e){const t=`dashboard_stats_${e}`,n=this.getCachedData(t);if(n)return n;try{if(!dt)throw new Error("Supabase not configured");let a={};switch(e==null?void 0:e.toLowerCase()){case"super admin":case"superadmin":a=await this.getSuperAdminStats();break;case"hr":a=await this.getHRStats();break;case"manager":a=await this.getManagerStats();break;default:a=await this.getGeneralStats()}return this.setCachedData(t,a),a}catch(a){return console.error("Error fetching dashboard stats:",a),this.getFallbackStats(e)}}async getDashboardContent(){var n;const e="dashboard_content",t=this.getCachedData(e);if(t)return t;try{if(!dt)throw new Error("Supabase not configured");const{data:a,error:s}=await dt.from("announcements").select("*").eq("active",!0).order("created_at",{ascending:!1}).limit(1),{data:o,error:l}=await dt.from("events").select("*").gte("date",new Date().toISOString().split("T")[0]).order("date",{ascending:!0}).limit(5),{data:c,error:u}=await dt.from("system_updates").select("*").eq("active",!0).order("created_at",{ascending:!1}).limit(3),d={news:((n=a==null?void 0:a[0])==null?void 0:n.content)||"Welcome to our agency dashboard! Stay updated with the latest company news and announcements.",events:(o==null?void 0:o.map(p=>`${p.title} - ${new Date(p.date).toLocaleDateString()}`).join(". "))||"Team meeting every Monday at 10 AM. Monthly all-hands on the first Friday of each month.",updates:(c==null?void 0:c.map(p=>p.content).join(". "))||"New project management system launched. Please update your profiles in the employee directory.",tools:[]};return this.setCachedData(e,d),d}catch(a){return console.error("Error fetching dashboard content:",a),{news:"Welcome to our agency dashboard! Stay updated with the latest company news and announcements.",tools:[],events:"Team meeting every Monday at 10 AM. Monthly all-hands on the first Friday of each month.",updates:"New project management system launched. Please update your profiles in the employee directory."}}}async updateNews(e){try{const{data:t,error:n}=await dt.from("announcements").upsert({content:e,active:!0},{onConflict:"id"});if(n)throw n;return this.cache.delete("dashboard_content"),t}catch(t){throw console.error("Error updating news:",t),t}}async updateEvents(e){try{const{data:t,error:n}=await dt.from("events").upsert(e);if(n)throw n;return this.cache.delete("dashboard_content"),t}catch(t){throw console.error("Error updating events:",t),t}}async updateUpdates(e){try{const{data:t,error:n}=await dt.from("system_updates").upsert(e);if(n)throw n;return this.cache.delete("dashboard_content"),t}catch(t){throw console.error("Error updating updates:",t),t}}async getSuperAdminStats(){var c,u;const[e,t,n,a]=await Promise.all([this.getActiveUsers(),dt.from("clients").select("id").eq("status","Active"),dt.from("monthly_kpi_reports").select("overall_score"),dt.from("monthly_kpi_reports").select("client_satisfaction_score")]),s=Object.values(e).reduce((d,p)=>d+p,0),o=((c=t.data)==null?void 0:c.length)||0,l=((u=a.data)==null?void 0:u.length)>0?a.data.reduce((d,p)=>d+(p.client_satisfaction_score||0),0)/a.data.length:0;return{totalEmployees:s,activeProjects:o,monthlyRevenue:`‚Çπ${(o*5e4).toLocaleString()}`,clientSatisfaction:Math.round(l)}}async getHRStats(){var o;const[e,t]=await Promise.all([this.getActiveUsers(),dt.from("employee_performance").select("id, performance_status")]),n=Object.values(e).reduce((l,c)=>l+c,0),a=((o=t.data)==null?void 0:o.filter(l=>l.performance_status==="pending").length)||0,s=e.interns||0;return{totalEmployees:n,pendingReviews:a,newHires:s,departments:12}}async getManagerStats(){var s,o,l;const[e,t,n]=await Promise.all([dt.from("unified_users").select("id").eq("is_active",!0).limit(25),dt.from("clients").select("id").eq("status","Active").limit(12),dt.from("monthly_kpi_reports").select("overall_score")]),a=((s=n.data)==null?void 0:s.length)>0?n.data.reduce((c,u)=>c+(u.overall_score||0),0)/n.data.length:0;return{teamSize:((o=e.data)==null?void 0:o.length)||0,activeProjects:((l=t.data)==null?void 0:l.length)||0,completionRate:85,teamPerformance:Math.round(a)}}async getGeneralStats(){const e=await this.getUserMetrics(),t=await this.getPerformanceMetrics();return{activeUsers:e.dailyActiveUsers,completedTasks:t.submissionRate,performance:t.averagePerformanceScore,satisfaction:t.clientSatisfaction}}getFallbackStats(e){return{"super admin":{totalEmployees:156,activeProjects:23,monthlyRevenue:"‚Çπ2.5M",clientSatisfaction:94},hr:{totalEmployees:156,pendingReviews:23,newHires:8,departments:12},manager:{teamSize:25,activeProjects:12,completionRate:85,teamPerformance:88}}[e==null?void 0:e.toLowerCase()]||{activeUsers:38,completedTasks:94,performance:8.2,satisfaction:94}}formatTimeAgo(e){const t=new Date(e),a=Math.floor((new Date-t)/(1e3*60));return a<1?"Just now":a<60?`${a} minutes ago`:a<1440?`${Math.floor(a/60)} hours ago`:`${Math.floor(a/1440)} days ago`}clearCache(){this.cache.clear()}}const Ya=new Yy,{getSystemActivities:Tj,getUserMetrics:Lj,getPerformanceMetrics:Fj,getActiveUsers:Pj,getDynamicStats:Rj,getEmployeePerformance:Dj,getDashboardStats:Oj,getDashboardContent:Ij}=Ya;class Xy{constructor(){this.useDatabase=!0,this.cache=new Map,this.cacheTimeout=5*60*1e3}getDashboardCards(e){return Cd[e]||[]}getNavigationPaths(e=null){return e?Hc[e]||{}:Hc}getTheme(e="light"){return al[e]||al.light}getAllThemes(){return al}getSidebarConfig(e){return pl[e]||{}}getStatusConfig(e,t=null){const n=jd[e]||{};return t?n[t]||{}:n}getProgressColor(e){return $c[e]||$c.blue}getCalendarEventType(e){return kd[e]||{}}getProfileFieldLabels(e=null){return e?qc[e]||{}:qc}getDefaultValues(e=null){return e?Wc[e]||{}:Wc}getTableHeaders(e){return Td[e]||[]}getPlaceholderMessage(e){return zc[e]||zc.noData}getFilterOptions(e){return Ld[e]||[]}getTabConfig(e){return Fd[e]||[]}getMonthNames(e=!1){return e?Rd:Pd}getInstructionalText(e,t=null){const n=Dd[e]||{};return t?n[t]||"":n}async getSystemActivities(){if(this.useDatabase)try{return await Ya.getSystemActivities()}catch(e){return console.error("Failed to fetch system activities from database:",e),of}return of}async getUserMetrics(){if(this.useDatabase)try{return await Ya.getUserMetrics()}catch(e){return console.error("Failed to fetch user metrics from database:",e),lf}return lf}async getPerformanceMetrics(){if(this.useDatabase)try{return await Ya.getPerformanceMetrics()}catch(e){return console.error("Failed to fetch performance metrics from database:",e),cf}return cf}async getActiveUsers(){if(this.useDatabase)try{return await Ya.getActiveUsers()}catch(e){return console.error("Failed to fetch active users from database:",e),uf}return uf}async getDynamicStats(){if(this.useDatabase)try{return await Ya.getDynamicStats()}catch(e){return console.error("Failed to fetch dynamic stats from database:",e),df}return df}async getInternData(e=null){return this.useDatabase,Hy}async getAdsEmployeeData(e=null){return this.useDatabase,$y}async getAdsClients(){return this.useDatabase,qy}async getMonthlyPerformance(e=null){return this.useDatabase,Wy}async getCalendarEvents(e=null){return this.useDatabase,zy}async getEmployeePerformance(){if(this.useDatabase)try{return await Ya.getEmployeePerformance()}catch(e){return console.error("Failed to fetch employee performance from database:",e),hf}return hf}async getDailyReports(e=null){return this.useDatabase,Vy}async getProfileTemplate(e){return this.useDatabase,Gy[e]||{}}async getFormData(e){return this.useDatabase,Ky[e]||{}}async getDashboardStats(e){if(this.useDatabase)try{return e?await Ya.getDashboardStats(e):await Ya.getDynamicStats()}catch(t){return console.error("Failed to fetch dashboard stats from database:",t),ff[e]||{}}return ff[e]||{}}enableDatabase(){this.useDatabase=!0}disableDatabase(){this.useDatabase=!1}isDatabaseEnabled(){return this.useDatabase}async getUIConfig(){try{const{UI_CONFIG:e}=await zs(async()=>{const{UI_CONFIG:t}=await Promise.resolve().then(()=>Uy);return{UI_CONFIG:t}},[]);return e}catch(e){return console.error("Error loading UI config:",e),{}}}async getDashboardConfig(e){try{const{getDashboardConfig:t}=await zs(async()=>{const{getDashboardConfig:n}=await import("./dashboardConfig-B4XLhSg_.js");return{getDashboardConfig:n}},[]);return t(e)}catch(t){return console.error("Error loading dashboard config:",t),{}}}async generateDefaultData(e,t){try{const n=await zs(()=>import("./dashboardConfig-B4XLhSg_.js"),[]);switch(e){case"intern":return n.generateDefaultInternData(t);case"adsExecutive":return n.generateDefaultAdsExecutiveData(t);default:return{}}}catch(n){return console.error("Error generating default data:",n),{}}}async getScoreColor(e,t="common"){try{const{getScoreColor:n}=await zs(async()=>{const{getScoreColor:a}=await import("./dashboardConfig-B4XLhSg_.js");return{getScoreColor:a}},[]);return n(e,t)}catch(n){return console.error("Error getting score color:",n),"text-gray-600"}}async getPerformanceLevel(e,t="manager"){try{const{getPerformanceLevel:n}=await zs(async()=>{const{getPerformanceLevel:a}=await import("./dashboardConfig-B4XLhSg_.js");return{getPerformanceLevel:a}},[]);return n(e,t)}catch(n){return console.error("Error getting performance level:",n),"Medium"}}clearCache(){this.cache.clear()}async apiCall(e,t={}){const n=`${e}_${JSON.stringify(t)}`;if(this.cache.has(n)){const a=this.cache.get(n);if(Date.now()-a.timestamp<this.cacheTimeout)return a.data}try{const a=await fetch(e,{headers:{"Content-Type":"application/json",...t.headers},...t});if(!a.ok)throw new Error(`API call failed: ${a.statusText}`);const s=await a.json();return this.cache.set(n,{data:s,timestamp:Date.now()}),s}catch(a){throw console.error("API call error:",a),a}}async getDashboardConfigFromDB(e,t,n=null){if(!this.useDatabase)return null;try{const a={dashboard_type:e,component_name:t};n&&(a.config_key=n);let s=`/api/dashboard-configurations?dashboard_type=${e}&component_name=${t}`;n&&(s+=`&config_key=${n}`);const o=await this.apiCall(s);return n&&o.length>0?o[0].config_value:o}catch(a){return console.error("Error fetching dashboard config from database:",a),null}}async getThemeFromDB(e){if(!this.useDatabase)return null;try{const t=await this.apiCall(`/api/theme-configurations?theme_name=${e}`);return t.length>0?t[0]:null}catch(t){return console.error("Error fetching theme from database:",t),null}}async getNavigationFromDB(e,t){if(!this.useDatabase)return null;try{const n=await this.apiCall(`/api/navigation-configurations?nav_type=${e}&role=${t}`);return n.length>0?n[0]:null}catch(n){return console.error("Error fetching navigation from database:",n),null}}async getDynamicContentFromDB(e,t=[]){if(!this.useDatabase)return[];try{const n={content_type:e};t.length>0&&(n.target_roles=t);let a=`/api/dynamic-content?content_type=${e}&is_active=true`;return t.length>0&&(a+=`&target_roles=${t.join(",")}`),await this.apiCall(a)||[]}catch(n){return console.error("Error fetching dynamic content from database:",n),[]}}async getUIComponentSettingsFromDB(e,t,n=[]){if(!this.useDatabase)return null;try{const a={component_type:e,component_name:t};n.length>0&&(a.applies_to_roles=n);let s=`/api/ui-component-settings?component_type=${e}&component_name=${t}&is_active=true`;n.length>0&&(s+=`&applies_to_roles=${n.join(",")}`);const o=await this.apiCall(s);return o.length>0?o[0].settings:null}catch(a){return console.error("Error fetching UI component settings from database:",a),null}}async getApplicationSettingFromDB(e){if(!this.useDatabase)return null;try{const t=await this.apiCall(`/api/application-settings?setting_key=${e}&is_active=true`);return t.length>0?t[0].setting_value:null}catch(t){return console.error("Error fetching application setting from database:",t),null}}async getDashboardConfigEnhanced(e,t,n){try{if(this.useDatabase){const a=await this.getDashboardConfigFromDB(e,t,n);if(a!==null)return a}return null}catch(a){return console.error("Error getting enhanced dashboard config:",a),null}}async getThemeEnhanced(e="light"){try{if(this.useDatabase){const t=await this.getThemeFromDB(e);if(t)return{name:t.theme_name,type:t.theme_type,colors:{primary:t.primary_color,secondary:t.secondary_color,accent:t.accent_color,background:t.background_color,text:t.text_color,border:t.border_color,success:t.success_color,warning:t.warning_color,error:t.error_color,info:t.info_color},cssVariables:t.css_variables||{}}}return this.getTheme(e)}catch(t){return console.error("Error getting enhanced theme:",t),this.getTheme(e)}}async getNavigationEnhanced(e,t){try{if(this.useDatabase){const n=await this.getNavigationFromDB(e,t);if(n)return{type:n.nav_type,role:n.role,items:n.nav_items,displayOrder:n.display_order}}return this.getSidebarConfig(t)}catch(n){return console.error("Error getting enhanced navigation:",n),this.getSidebarConfig(t)}}async getQuoteOfTheDay(e=[]){try{if(this.useDatabase){const n=await this.getDynamicContentFromDB("quote_of_day",e);if(n.length>0)return n[Math.floor(Math.random()*n.length)].content}const t=["Success is not final, failure is not fatal: it is the courage to continue that counts.","The way to get started is to quit talking and begin doing.","Innovation distinguishes between a leader and a follower.","Your limitation‚Äîit's only your imagination.","Great things never come from comfort zones."];return t[Math.floor(Math.random()*t.length)]}catch(t){return console.error("Error getting quote of the day:",t),"Success is not final, failure is not fatal: it is the courage to continue that counts."}}async getAnnouncements(e=[]){try{if(this.useDatabase){const t=await this.getDynamicContentFromDB("announcement",e);if(t.length>0)return t.map(n=>({id:n.id,title:n.title,content:n.content,startDate:n.start_date,endDate:n.end_date}))}return[]}catch(t){return console.error("Error getting announcements:",t),[]}}}const mf=new Xy,pf=({show:r,children:e,duration:t="duration-200",className:n=""})=>i.jsx(Zx,{show:r,enter:`ease-out ${t}`,enterFrom:"opacity-0",enterTo:"opacity-100",leave:`ease-in ${t}`,leaveFrom:"opacity-100",leaveTo:"opacity-0",className:n,children:e}),Jy=({children:r,onClick:e,variant:t="primary",size:n="medium",disabled:a=!1,loading:s=!1,className:o="",...l})=>{const[c,u]=E.useState(!1),[d,p]=E.useState(!1),g={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-gray-300 text-gray-700 bg-white hover:bg-gray-50 focus:ring-gray-500"},h={small:"px-3 py-1.5 text-sm",medium:"px-4 py-2 text-sm",large:"px-6 py-3 text-base"},b="inline-flex items-center justify-center gap-2 font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",x=g[t]||g.primary,y=h[n]||h.medium,v=()=>u(!0),_=()=>u(!1),S=()=>p(!0),j=()=>{p(!1),u(!1)};return i.jsxs("button",{...l,onClick:e,disabled:a||s,onMouseDown:v,onMouseUp:_,onMouseEnter:S,onMouseLeave:j,className:`
        ${b} 
        ${x} 
        ${y} 
        ${o}
        transform transition-transform duration-150 ease-in-out
        ${c?"scale-95":d?"scale-105":"scale-100"}
        ${s?"animate-pulse":""}
      `,children:[s&&i.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full"}),r]})};function nr(r){"@babel/helpers - typeof";return nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nr(r)}var La=Uint8Array,ta=Uint16Array,Od=Int32Array,Id=new La([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Md=new La([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),gf=new La([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o1=function(r,e){for(var t=new ta(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var a=new Od(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)a[s]=s-t[n]<<5|n;return{b:t,r:a}},l1=o1(Id,2),Zy=l1.b,Qu=l1.r;Zy[28]=258,Qu[258]=28;var Qy=o1(Md,0),xf=Qy.r,ed=new ta(32768);for(var gr=0;gr<32768;++gr){var $s=(gr&43690)>>1|(gr&21845)<<1;$s=($s&52428)>>2|($s&13107)<<2,$s=($s&61680)>>4|($s&3855)<<4,ed[gr]=(($s&65280)>>8|($s&255)<<8)>>1}var sl=function(r,e,t){for(var n=r.length,a=0,s=new ta(e);a<n;++a)r[a]&&++s[r[a]-1];var o=new ta(e);for(a=1;a<e;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(t){l=new ta(1<<e);var c=15-e;for(a=0;a<n;++a)if(r[a])for(var u=a<<4|r[a],d=e-r[a],p=o[r[a]-1]++<<d,g=p|(1<<d)-1;p<=g;++p)l[ed[p]>>c]=u}else for(l=new ta(n),a=0;a<n;++a)r[a]&&(l[a]=ed[o[r[a]-1]++]>>15-r[a]);return l},_i=new La(288);for(var gr=0;gr<144;++gr)_i[gr]=8;for(var gr=144;gr<256;++gr)_i[gr]=9;for(var gr=256;gr<280;++gr)_i[gr]=7;for(var gr=280;gr<288;++gr)_i[gr]=8;var Vc=new La(32);for(var gr=0;gr<32;++gr)Vc[gr]=5;var eb=sl(_i,9,0),tb=sl(Vc,5,0),c1=function(r){return(r+7)/8|0},rb=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new La(r.subarray(e,t))},fs=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8},Zo=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8,r[n+2]|=t>>16},gu=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var a=t.length,s=t.slice();if(!a)return{t:d1,l:0};if(a==1){var o=new La(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(I,J){return I.f-J.f}),t.push({s:-1,f:25001});var l=t[0],c=t[1],u=0,d=1,p=2;for(t[0]={s:-1,f:l.f+c.f,l,r:c};d!=a-1;)l=t[t[u].f<t[p].f?u++:p++],c=t[u!=d&&t[u].f<t[p].f?u++:p++],t[d++]={s:-1,f:l.f+c.f,l,r:c};for(var g=s[0].s,n=1;n<a;++n)s[n].s>g&&(g=s[n].s);var h=new ta(g+1),b=td(t[d-1],h,0);if(b>e){var n=0,x=0,y=b-e,v=1<<y;for(s.sort(function(J,k){return h[k.s]-h[J.s]||J.f-k.f});n<a;++n){var _=s[n].s;if(h[_]>e)x+=v-(1<<b-h[_]),h[_]=e;else break}for(x>>=y;x>0;){var S=s[n].s;h[S]<e?x-=1<<e-h[S]++-1:++n}for(;n>=0&&x;--n){var j=s[n].s;h[j]==e&&(--h[j],++x)}b=e}return{t:new La(h),l:b}},td=function(r,e,t){return r.s==-1?Math.max(td(r.l,e,t+1),td(r.r,e,t+1)):e[r.s]=t},vf=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new ta(++e),n=0,a=r[0],s=1,o=function(c){t[n++]=c},l=1;l<=e;++l)if(r[l]==a&&l!=e)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=r[l]}return{c:t.subarray(0,n),n:e}},Qo=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},u1=function(r,e,t){var n=t.length,a=c1(e+2);r[a]=n&255,r[a+1]=n>>8,r[a+2]=r[a]^255,r[a+3]=r[a+1]^255;for(var s=0;s<n;++s)r[a+s+4]=t[s];return(a+4+n)*8},yf=function(r,e,t,n,a,s,o,l,c,u,d){fs(e,d++,t),++a[256];for(var p=gu(a,15),g=p.t,h=p.l,b=gu(s,15),x=b.t,y=b.l,v=vf(g),_=v.c,S=v.n,j=vf(x),I=j.c,J=j.n,k=new ta(19),F=0;F<_.length;++F)++k[_[F]&31];for(var F=0;F<I.length;++F)++k[I[F]&31];for(var T=gu(k,7),R=T.t,A=T.l,P=19;P>4&&!R[gf[P-1]];--P);var H=u+5<<3,K=Qo(a,_i)+Qo(s,Vc)+o,ce=Qo(a,g)+Qo(s,x)+o+14+3*P+Qo(k,R)+2*k[16]+3*k[17]+7*k[18];if(c>=0&&H<=K&&H<=ce)return u1(e,d,r.subarray(c,c+u));var me,le,xe,we;if(fs(e,d,1+(ce<K)),d+=2,ce<K){me=sl(g,h,0),le=g,xe=sl(x,y,0),we=x;var Oe=sl(R,A,0);fs(e,d,S-257),fs(e,d+5,J-1),fs(e,d+10,P-4),d+=14;for(var F=0;F<P;++F)fs(e,d+3*F,R[gf[F]]);d+=3*P;for(var ge=[_,I],C=0;C<2;++C)for(var O=ge[C],F=0;F<O.length;++F){var D=O[F]&31;fs(e,d,Oe[D]),d+=R[D],D>15&&(fs(e,d,O[F]>>5&127),d+=O[F]>>12)}}else me=eb,le=_i,xe=tb,we=Vc;for(var F=0;F<l;++F){var M=n[F];if(M>255){var D=M>>18&31;Zo(e,d,me[D+257]),d+=le[D+257],D>7&&(fs(e,d,M>>23&31),d+=Id[D]);var V=M&31;Zo(e,d,xe[V]),d+=we[V],V>3&&(Zo(e,d,M>>5&8191),d+=Md[V])}else Zo(e,d,me[M]),d+=le[M]}return Zo(e,d,me[256]),d+le[256]},nb=new Od([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),d1=new La(0),ab=function(r,e,t,n,a,s){var o=s.z||r.length,l=new La(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),u=s.l,d=(s.r||0)&7;if(e){d&&(c[0]=s.r>>3);for(var p=nb[e-1],g=p>>13,h=p&8191,b=(1<<t)-1,x=s.p||new ta(32768),y=s.h||new ta(b+1),v=Math.ceil(t/3),_=2*v,S=function(pe){return(r[pe]^r[pe+1]<<v^r[pe+2]<<_)&b},j=new Od(25e3),I=new ta(288),J=new ta(32),k=0,F=0,T=s.i||0,R=0,A=s.w||0,P=0;T+2<o;++T){var H=S(T),K=T&32767,ce=y[H];if(x[K]=ce,y[H]=K,A<=T){var me=o-T;if((k>7e3||R>24576)&&(me>423||!u)){d=yf(r,c,0,j,I,J,F,R,P,T-P,d),R=k=F=0,P=T;for(var le=0;le<286;++le)I[le]=0;for(var le=0;le<30;++le)J[le]=0}var xe=2,we=0,Oe=h,ge=K-ce&32767;if(me>2&&H==S(T-ge))for(var C=Math.min(g,me)-1,O=Math.min(32767,T),D=Math.min(258,me);ge<=O&&--Oe&&K!=ce;){if(r[T+xe]==r[T+xe-ge]){for(var M=0;M<D&&r[T+M]==r[T+M-ge];++M);if(M>xe){if(xe=M,we=ge,M>C)break;for(var V=Math.min(ge,M-2),oe=0,le=0;le<V;++le){var he=T-ge+le&32767,ue=x[he],Z=he-ue&32767;Z>oe&&(oe=Z,ce=he)}}}K=ce,ce=x[K],ge+=K-ce&32767}if(we){j[R++]=268435456|Qu[xe]<<18|xf[we];var ye=Qu[xe]&31,Le=xf[we]&31;F+=Id[ye]+Md[Le],++I[257+ye],++J[Le],A=T+xe,++k}else j[R++]=r[T],++I[r[T]]}}for(T=Math.max(T,A);T<o;++T)j[R++]=r[T],++I[r[T]];d=yf(r,c,u,j,I,J,F,R,P,T-P,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=y,s.p=x,s.i=T,s.w=A)}else{for(var T=s.w||0;T<o+u;T+=65535){var Ie=T+65535;Ie>=o&&(c[d/8|0]=u,Ie=o),d=u1(c,d+1,r.subarray(T,Ie))}s.i=o}return rb(l,0,n+c1(d)+a)},h1=function(){var r=1,e=0;return{p:function(t){for(var n=r,a=e,s=t.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=n+=t[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}r=n,e=a},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},sb=function(r,e,t,n,a){if(!a&&(a={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new La(s.length+r.length);o.set(s),o.set(r,s.length),r=o,a.w=s.length}return ab(r,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,n,a)},f1=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},ib=function(r,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(r[0]=120,r[1]=n<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var a=h1();a.p(e.dictionary),f1(r,2,a.d())}};function rd(r,e){e||(e={});var t=h1();t.p(r);var n=sb(r,e,e.dictionary?6:2,4);return ib(n,e),f1(n,n.length-4,t.d()),n}var ob=typeof TextDecoder<"u"&&new TextDecoder,lb=0;try{ob.decode(d1,{stream:!0}),lb=1}catch{}function cb(r){if(Array.isArray(r))return r}function ub(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,a,s,o,l=[],c=!0,u=!1;try{if(s=(t=t.call(r)).next,e!==0)for(;!(c=(n=s.call(t)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function bf(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function db(r,e){if(r){if(typeof r=="string")return bf(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?bf(r,e):void 0}}function hb(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wf(r,e){return cb(r)||ub(r,e)||db(r,e)||hb()}function _f(r,e="utf8"){return new TextDecoder(e).decode(r)}const fb=new TextEncoder;function mb(r){return fb.encode(r)}const pb=1024*8,gb=(()=>{const r=new Uint8Array(4),e=new Uint32Array(r.buffer);return!((e[0]=1)&r[0])})(),xu={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Bd{constructor(e=pb,t={}){er(this,"buffer");er(this,"byteLength");er(this,"byteOffset");er(this,"length");er(this,"offset");er(this,"lastWrittenByte");er(this,"littleEndian");er(this,"_data");er(this,"_mark");er(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const a=t.offset?t.offset>>>0:0,s=e.byteLength-a;let o=a;(ArrayBuffer.isView(e)||e instanceof Bd)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+a),e=e.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const n=xu[t].BYTES_PER_ELEMENT*e,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+n);if(this.littleEndian===gb&&t!=="uint8"&&t!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new xu[t](l.buffer);return this.offset+=n,c.reverse(),c}const o=new xu[t](s);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let n=0;n<e;n++)t+=this.readChar();return t}readUtf8(e=1){return _f(this.readBytes(e))}decodeText(e=1,t="utf8"){return _f(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(mb(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function wo(r){let e=r.length;for(;--e>=0;)r[e]=0}const xb=3,vb=258,m1=29,yb=256,bb=yb+1+m1,p1=30,wb=512,_b=new Array((bb+2)*2);wo(_b);const Nb=new Array(p1*2);wo(Nb);const Sb=new Array(wb);wo(Sb);const Eb=new Array(vb-xb+1);wo(Eb);const Ab=new Array(m1);wo(Ab);const Cb=new Array(p1);wo(Cb);const jb=(r,e,t,n)=>{let a=r&65535|0,s=r>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do a=a+e[n++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var nd=jb;const kb=()=>{let r,e=[];for(var t=0;t<256;t++){r=t;for(var n=0;n<8;n++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e},Tb=new Uint32Array(kb()),Lb=(r,e,t,n)=>{const a=Tb,s=n+t;r^=-1;for(let o=n;o<s;o++)r=r>>>8^a[(r^e[o])&255];return r^-1};var za=Lb,ad={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},g1={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Fb=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var Pb=function(r){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)Fb(t,n)&&(r[n]=t[n])}}return r},Rb=r=>{let e=0;for(let n=0,a=r.length;n<a;n++)e+=r[n].length;const t=new Uint8Array(e);for(let n=0,a=0,s=r.length;n<s;n++){let o=r[n];t.set(o,a),a+=o.length}return t},x1={assign:Pb,flattenChunks:Rb};let v1=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{v1=!1}const gl=new Uint8Array(256);for(let r=0;r<256;r++)gl[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;gl[254]=gl[254]=1;var Db=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let e,t,n,a,s,o=r.length,l=0;for(a=0;a<o;a++)t=r.charCodeAt(a),(t&64512)===55296&&a+1<o&&(n=r.charCodeAt(a+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),a++)),l+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(l),s=0,a=0;s<l;a++)t=r.charCodeAt(a),(t&64512)===55296&&a+1<o&&(n=r.charCodeAt(a+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),a++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const Ob=(r,e)=>{if(e<65534&&r.subarray&&v1)return String.fromCharCode.apply(null,r.length===e?r:r.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(r[n]);return t};var Ib=(r,e)=>{const t=e||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,e));let n,a;const s=new Array(t*2);for(a=0,n=0;n<t;){let o=r[n++];if(o<128){s[a++]=o;continue}let l=gl[o];if(l>4){s[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<t;)o=o<<6|r[n++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return Ob(s,a)},Mb=(r,e)=>{e=e||r.length,e>r.length&&(e=r.length);let t=e-1;for(;t>=0&&(r[t]&192)===128;)t--;return t<0||t===0?e:t+gl[r[t]]>e?t:e},sd={string2buf:Db,buf2string:Ib,utf8border:Mb};function Bb(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Ub=Bb;const cc=16209,Hb=16191;var $b=function(e,t){let n,a,s,o,l,c,u,d,p,g,h,b,x,y,v,_,S,j,I,J,k,F,T,R;const A=e.state;n=e.next_in,T=e.input,a=n+(e.avail_in-5),s=e.next_out,R=e.output,o=s-(t-e.avail_out),l=s+(e.avail_out-257),c=A.dmax,u=A.wsize,d=A.whave,p=A.wnext,g=A.window,h=A.hold,b=A.bits,x=A.lencode,y=A.distcode,v=(1<<A.lenbits)-1,_=(1<<A.distbits)-1;e:do{b<15&&(h+=T[n++]<<b,b+=8,h+=T[n++]<<b,b+=8),S=x[h&v];t:for(;;){if(j=S>>>24,h>>>=j,b-=j,j=S>>>16&255,j===0)R[s++]=S&65535;else if(j&16){I=S&65535,j&=15,j&&(b<j&&(h+=T[n++]<<b,b+=8),I+=h&(1<<j)-1,h>>>=j,b-=j),b<15&&(h+=T[n++]<<b,b+=8,h+=T[n++]<<b,b+=8),S=y[h&_];r:for(;;){if(j=S>>>24,h>>>=j,b-=j,j=S>>>16&255,j&16){if(J=S&65535,j&=15,b<j&&(h+=T[n++]<<b,b+=8,b<j&&(h+=T[n++]<<b,b+=8)),J+=h&(1<<j)-1,J>c){e.msg="invalid distance too far back",A.mode=cc;break e}if(h>>>=j,b-=j,j=s-o,J>j){if(j=J-j,j>d&&A.sane){e.msg="invalid distance too far back",A.mode=cc;break e}if(k=0,F=g,p===0){if(k+=u-j,j<I){I-=j;do R[s++]=g[k++];while(--j);k=s-J,F=R}}else if(p<j){if(k+=u+p-j,j-=p,j<I){I-=j;do R[s++]=g[k++];while(--j);if(k=0,p<I){j=p,I-=j;do R[s++]=g[k++];while(--j);k=s-J,F=R}}}else if(k+=p-j,j<I){I-=j;do R[s++]=g[k++];while(--j);k=s-J,F=R}for(;I>2;)R[s++]=F[k++],R[s++]=F[k++],R[s++]=F[k++],I-=3;I&&(R[s++]=F[k++],I>1&&(R[s++]=F[k++]))}else{k=s-J;do R[s++]=R[k++],R[s++]=R[k++],R[s++]=R[k++],I-=3;while(I>2);I&&(R[s++]=R[k++],I>1&&(R[s++]=R[k++]))}}else if(j&64){e.msg="invalid distance code",A.mode=cc;break e}else{S=y[(S&65535)+(h&(1<<j)-1)];continue r}break}}else if(j&64)if(j&32){A.mode=Hb;break e}else{e.msg="invalid literal/length code",A.mode=cc;break e}else{S=x[(S&65535)+(h&(1<<j)-1)];continue t}break}}while(n<a&&s<l);I=b>>3,n-=I,b-=I<<3,h&=(1<<b)-1,e.next_in=n,e.next_out=s,e.avail_in=n<a?5+(a-n):5-(n-a),e.avail_out=s<l?257+(l-s):257-(s-l),A.hold=h,A.bits=b};const Gi=15,Nf=852,Sf=592,Ef=0,vu=1,Af=2,qb=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Wb=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),zb=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Vb=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Gb=(r,e,t,n,a,s,o,l)=>{const c=l.bits;let u=0,d=0,p=0,g=0,h=0,b=0,x=0,y=0,v=0,_=0,S,j,I,J,k,F=null,T;const R=new Uint16Array(Gi+1),A=new Uint16Array(Gi+1);let P=null,H,K,ce;for(u=0;u<=Gi;u++)R[u]=0;for(d=0;d<n;d++)R[e[t+d]]++;for(h=c,g=Gi;g>=1&&R[g]===0;g--);if(h>g&&(h=g),g===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(p=1;p<g&&R[p]===0;p++);for(h<p&&(h=p),y=1,u=1;u<=Gi;u++)if(y<<=1,y-=R[u],y<0)return-1;if(y>0&&(r===Ef||g!==1))return-1;for(A[1]=0,u=1;u<Gi;u++)A[u+1]=A[u]+R[u];for(d=0;d<n;d++)e[t+d]!==0&&(o[A[e[t+d]]++]=d);if(r===Ef?(F=P=o,T=20):r===vu?(F=qb,P=Wb,T=257):(F=zb,P=Vb,T=0),_=0,d=0,u=p,k=s,b=h,x=0,I=-1,v=1<<h,J=v-1,r===vu&&v>Nf||r===Af&&v>Sf)return 1;for(;;){H=u-x,o[d]+1<T?(K=0,ce=o[d]):o[d]>=T?(K=P[o[d]-T],ce=F[o[d]-T]):(K=96,ce=0),S=1<<u-x,j=1<<b,p=j;do j-=S,a[k+(_>>x)+j]=H<<24|K<<16|ce|0;while(j!==0);for(S=1<<u-1;_&S;)S>>=1;if(S!==0?(_&=S-1,_+=S):_=0,d++,--R[u]===0){if(u===g)break;u=e[t+o[d]]}if(u>h&&(_&J)!==I){for(x===0&&(x=h),k+=p,b=u-x,y=1<<b;b+x<g&&(y-=R[b+x],!(y<=0));)b++,y<<=1;if(v+=1<<b,r===vu&&v>Nf||r===Af&&v>Sf)return 1;I=_&J,a[I]=h<<24|b<<16|k-s|0}}return _!==0&&(a[k+_]=u-x<<24|64<<16|0),l.bits=h,0};var il=Gb;const Kb=0,y1=1,b1=2,{Z_FINISH:Cf,Z_BLOCK:Yb,Z_TREES:uc,Z_OK:Ni,Z_STREAM_END:Xb,Z_NEED_DICT:Jb,Z_STREAM_ERROR:da,Z_DATA_ERROR:w1,Z_MEM_ERROR:_1,Z_BUF_ERROR:Zb,Z_DEFLATED:jf}=g1,w0=16180,kf=16181,Tf=16182,Lf=16183,Ff=16184,Pf=16185,Rf=16186,Df=16187,Of=16188,If=16189,Gc=16190,ms=16191,yu=16192,Mf=16193,bu=16194,Bf=16195,Uf=16196,Hf=16197,$f=16198,dc=16199,hc=16200,qf=16201,Wf=16202,zf=16203,Vf=16204,Gf=16205,wu=16206,Kf=16207,Yf=16208,yr=16209,N1=16210,S1=16211,Qb=852,ew=592,tw=15,rw=tw,Xf=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function nw(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ci=r=>{if(!r)return 1;const e=r.state;return!e||e.strm!==r||e.mode<w0||e.mode>S1?1:0},E1=r=>{if(Ci(r))return da;const e=r.state;return r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=w0,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Qb),e.distcode=e.distdyn=new Int32Array(ew),e.sane=1,e.back=-1,Ni},A1=r=>{if(Ci(r))return da;const e=r.state;return e.wsize=0,e.whave=0,e.wnext=0,E1(r)},C1=(r,e)=>{let t;if(Ci(r))return da;const n=r.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?da:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,A1(r))},j1=(r,e)=>{if(!r)return da;const t=new nw;r.state=t,t.strm=r,t.window=null,t.mode=w0;const n=C1(r,e);return n!==Ni&&(r.state=null),n},aw=r=>j1(r,rw);let Jf=!0,_u,Nu;const sw=r=>{if(Jf){_u=new Int32Array(512),Nu=new Int32Array(32);let e=0;for(;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(il(y1,r.lens,0,288,_u,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;il(b1,r.lens,0,32,Nu,0,r.work,{bits:5}),Jf=!1}r.lencode=_u,r.lenbits=9,r.distcode=Nu,r.distbits=5},k1=(r,e,t,n)=>{let a;const s=r.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(e.subarray(t-n,t-n+a),s.wnext),n-=a,n?(s.window.set(e.subarray(t-n,t),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},iw=(r,e)=>{let t,n,a,s,o,l,c,u,d,p,g,h,b,x,y=0,v,_,S,j,I,J,k,F;const T=new Uint8Array(4);let R,A;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ci(r)||!r.output||!r.input&&r.avail_in!==0)return da;t=r.state,t.mode===ms&&(t.mode=yu),o=r.next_out,a=r.output,c=r.avail_out,s=r.next_in,n=r.input,l=r.avail_in,u=t.hold,d=t.bits,p=l,g=c,F=Ni;e:for(;;)switch(t.mode){case w0:if(t.wrap===0){t.mode=yu;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(t.wrap&2&&u===35615){t.wbits===0&&(t.wbits=15),t.check=0,T[0]=u&255,T[1]=u>>>8&255,t.check=za(t.check,T,2,0),u=0,d=0,t.mode=kf;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){r.msg="incorrect header check",t.mode=yr;break}if((u&15)!==jf){r.msg="unknown compression method",t.mode=yr;break}if(u>>>=4,d-=4,k=(u&15)+8,t.wbits===0&&(t.wbits=k),k>15||k>t.wbits){r.msg="invalid window size",t.mode=yr;break}t.dmax=1<<t.wbits,t.flags=0,r.adler=t.check=1,t.mode=u&512?If:ms,u=0,d=0;break;case kf:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(t.flags=u,(t.flags&255)!==jf){r.msg="unknown compression method",t.mode=yr;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=yr;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&t.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,t.check=za(t.check,T,2,0)),u=0,d=0,t.mode=Tf;case Tf:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.head&&(t.head.time=u),t.flags&512&&t.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,t.check=za(t.check,T,4,0)),u=0,d=0,t.mode=Lf;case Lf:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&t.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,t.check=za(t.check,T,2,0)),u=0,d=0,t.mode=Ff;case Ff:if(t.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&t.wrap&4&&(T[0]=u&255,T[1]=u>>>8&255,t.check=za(t.check,T,2,0)),u=0,d=0}else t.head&&(t.head.extra=null);t.mode=Pf;case Pf:if(t.flags&1024&&(h=t.length,h>l&&(h=l),h&&(t.head&&(k=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(s,s+h),k)),t.flags&512&&t.wrap&4&&(t.check=za(t.check,n,h,s)),l-=h,s+=h,t.length-=h),t.length))break e;t.length=0,t.mode=Rf;case Rf:if(t.flags&2048){if(l===0)break e;h=0;do k=n[s+h++],t.head&&k&&t.length<65536&&(t.head.name+=String.fromCharCode(k));while(k&&h<l);if(t.flags&512&&t.wrap&4&&(t.check=za(t.check,n,h,s)),l-=h,s+=h,k)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Df;case Df:if(t.flags&4096){if(l===0)break e;h=0;do k=n[s+h++],t.head&&k&&t.length<65536&&(t.head.comment+=String.fromCharCode(k));while(k&&h<l);if(t.flags&512&&t.wrap&4&&(t.check=za(t.check,n,h,s)),l-=h,s+=h,k)break e}else t.head&&(t.head.comment=null);t.mode=Of;case Of:if(t.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(t.wrap&4&&u!==(t.check&65535)){r.msg="header crc mismatch",t.mode=yr;break}u=0,d=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=ms;break;case If:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.adler=t.check=Xf(u),u=0,d=0,t.mode=Gc;case Gc:if(t.havedict===0)return r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=l,t.hold=u,t.bits=d,Jb;r.adler=t.check=1,t.mode=ms;case ms:if(e===Yb||e===uc)break e;case yu:if(t.last){u>>>=d&7,d-=d&7,t.mode=wu;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(t.last=u&1,u>>>=1,d-=1,u&3){case 0:t.mode=Mf;break;case 1:if(sw(t),t.mode=dc,e===uc){u>>>=2,d-=2;break e}break;case 2:t.mode=Uf;break;case 3:r.msg="invalid block type",t.mode=yr}u>>>=2,d-=2;break;case Mf:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){r.msg="invalid stored block lengths",t.mode=yr;break}if(t.length=u&65535,u=0,d=0,t.mode=bu,e===uc)break e;case bu:t.mode=Bf;case Bf:if(h=t.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;a.set(n.subarray(s,s+h),o),l-=h,s+=h,c-=h,o+=h,t.length-=h;break}t.mode=ms;break;case Uf:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(t.nlen=(u&31)+257,u>>>=5,d-=5,t.ndist=(u&31)+1,u>>>=5,d-=5,t.ncode=(u&15)+4,u>>>=4,d-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=yr;break}t.have=0,t.mode=Hf;case Hf:for(;t.have<t.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.lens[P[t.have++]]=u&7,u>>>=3,d-=3}for(;t.have<19;)t.lens[P[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,R={bits:t.lenbits},F=il(Kb,t.lens,0,19,t.lencode,0,t.work,R),t.lenbits=R.bits,F){r.msg="invalid code lengths set",t.mode=yr;break}t.have=0,t.mode=$f;case $f:for(;t.have<t.nlen+t.ndist;){for(;y=t.lencode[u&(1<<t.lenbits)-1],v=y>>>24,_=y>>>16&255,S=y&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(S<16)u>>>=v,d-=v,t.lens[t.have++]=S;else{if(S===16){for(A=v+2;d<A;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=v,d-=v,t.have===0){r.msg="invalid bit length repeat",t.mode=yr;break}k=t.lens[t.have-1],h=3+(u&3),u>>>=2,d-=2}else if(S===17){for(A=v+3;d<A;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,k=0,h=3+(u&7),u>>>=3,d-=3}else{for(A=v+7;d<A;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,k=0,h=11+(u&127),u>>>=7,d-=7}if(t.have+h>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=yr;break}for(;h--;)t.lens[t.have++]=k}}if(t.mode===yr)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=yr;break}if(t.lenbits=9,R={bits:t.lenbits},F=il(y1,t.lens,0,t.nlen,t.lencode,0,t.work,R),t.lenbits=R.bits,F){r.msg="invalid literal/lengths set",t.mode=yr;break}if(t.distbits=6,t.distcode=t.distdyn,R={bits:t.distbits},F=il(b1,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,R),t.distbits=R.bits,F){r.msg="invalid distances set",t.mode=yr;break}if(t.mode=dc,e===uc)break e;case dc:t.mode=hc;case hc:if(l>=6&&c>=258){r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=l,t.hold=u,t.bits=d,$b(r,g),o=r.next_out,a=r.output,c=r.avail_out,s=r.next_in,n=r.input,l=r.avail_in,u=t.hold,d=t.bits,t.mode===ms&&(t.back=-1);break}for(t.back=0;y=t.lencode[u&(1<<t.lenbits)-1],v=y>>>24,_=y>>>16&255,S=y&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(_&&!(_&240)){for(j=v,I=_,J=S;y=t.lencode[J+((u&(1<<j+I)-1)>>j)],v=y>>>24,_=y>>>16&255,S=y&65535,!(j+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=j,d-=j,t.back+=j}if(u>>>=v,d-=v,t.back+=v,t.length=S,_===0){t.mode=Gf;break}if(_&32){t.back=-1,t.mode=ms;break}if(_&64){r.msg="invalid literal/length code",t.mode=yr;break}t.extra=_&15,t.mode=qf;case qf:if(t.extra){for(A=t.extra;d<A;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,d-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Wf;case Wf:for(;y=t.distcode[u&(1<<t.distbits)-1],v=y>>>24,_=y>>>16&255,S=y&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(_&240)){for(j=v,I=_,J=S;y=t.distcode[J+((u&(1<<j+I)-1)>>j)],v=y>>>24,_=y>>>16&255,S=y&65535,!(j+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=j,d-=j,t.back+=j}if(u>>>=v,d-=v,t.back+=v,_&64){r.msg="invalid distance code",t.mode=yr;break}t.offset=S,t.extra=_&15,t.mode=zf;case zf:if(t.extra){for(A=t.extra;d<A;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,d-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=yr;break}t.mode=Vf;case Vf:if(c===0)break e;if(h=g-c,t.offset>h){if(h=t.offset-h,h>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=yr;break}h>t.wnext?(h-=t.wnext,b=t.wsize-h):b=t.wnext-h,h>t.length&&(h=t.length),x=t.window}else x=a,b=o-t.offset,h=t.length;h>c&&(h=c),c-=h,t.length-=h;do a[o++]=x[b++];while(--h);t.length===0&&(t.mode=hc);break;case Gf:if(c===0)break e;a[o++]=t.length,c--,t.mode=hc;break;case wu:if(t.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(g-=c,r.total_out+=g,t.total+=g,t.wrap&4&&g&&(r.adler=t.check=t.flags?za(t.check,a,g,o-g):nd(t.check,a,g,o-g)),g=c,t.wrap&4&&(t.flags?u:Xf(u))!==t.check){r.msg="incorrect data check",t.mode=yr;break}u=0,d=0}t.mode=Kf;case Kf:if(t.wrap&&t.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(t.wrap&4&&u!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=yr;break}u=0,d=0}t.mode=Yf;case Yf:F=Xb;break e;case yr:F=w1;break e;case N1:return _1;case S1:default:return da}return r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=l,t.hold=u,t.bits=d,(t.wsize||g!==r.avail_out&&t.mode<yr&&(t.mode<wu||e!==Cf))&&k1(r,r.output,r.next_out,g-r.avail_out),p-=r.avail_in,g-=r.avail_out,r.total_in+=p,r.total_out+=g,t.total+=g,t.wrap&4&&g&&(r.adler=t.check=t.flags?za(t.check,a,g,r.next_out-g):nd(t.check,a,g,r.next_out-g)),r.data_type=t.bits+(t.last?64:0)+(t.mode===ms?128:0)+(t.mode===dc||t.mode===bu?256:0),(p===0&&g===0||e===Cf)&&F===Ni&&(F=Zb),F},ow=r=>{if(Ci(r))return da;let e=r.state;return e.window&&(e.window=null),r.state=null,Ni},lw=(r,e)=>{if(Ci(r))return da;const t=r.state;return t.wrap&2?(t.head=e,e.done=!1,Ni):da},cw=(r,e)=>{const t=e.length;let n,a,s;return Ci(r)||(n=r.state,n.wrap!==0&&n.mode!==Gc)?da:n.mode===Gc&&(a=1,a=nd(a,e,t,0),a!==n.check)?w1:(s=k1(r,e,t,t),s?(n.mode=N1,_1):(n.havedict=1,Ni))};var uw=A1,dw=C1,hw=E1,fw=aw,mw=j1,pw=iw,gw=ow,xw=lw,vw=cw,yw="pako inflate (from Nodeca project)",gs={inflateReset:uw,inflateReset2:dw,inflateResetKeep:hw,inflateInit:fw,inflateInit2:mw,inflate:pw,inflateEnd:gw,inflateGetHeader:xw,inflateSetDictionary:vw,inflateInfo:yw};function bw(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ww=bw;const T1=Object.prototype.toString,{Z_NO_FLUSH:_w,Z_FINISH:Nw,Z_OK:xl,Z_STREAM_END:Su,Z_NEED_DICT:Eu,Z_STREAM_ERROR:Sw,Z_DATA_ERROR:Zf,Z_MEM_ERROR:Ew}=g1;function kl(r){this.options=x1.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ub,this.strm.avail_out=0;let t=gs.inflateInit2(this.strm,e.windowBits);if(t!==xl)throw new Error(ad[t]);if(this.header=new ww,gs.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=sd.string2buf(e.dictionary):T1.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=gs.inflateSetDictionary(this.strm,e.dictionary),t!==xl)))throw new Error(ad[t])}kl.prototype.push=function(r,e){const t=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?Nw:_w,T1.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),s=gs.inflate(t,o),s===Eu&&a&&(s=gs.inflateSetDictionary(t,a),s===xl?s=gs.inflate(t,o):s===Zf&&(s=Eu));t.avail_in>0&&s===Su&&t.state.wrap>0&&r[t.next_in]!==0;)gs.inflateReset(t),s=gs.inflate(t,o);switch(s){case Sw:case Zf:case Eu:case Ew:return this.onEnd(s),this.ended=!0,!1}if(l=t.avail_out,t.next_out&&(t.avail_out===0||s===Su))if(this.options.to==="string"){let c=sd.utf8border(t.output,t.next_out),u=t.next_out-c,d=sd.buf2string(t.output,c);t.next_out=u,t.avail_out=n-u,u&&t.output.set(t.output.subarray(c,c+u),0),this.onData(d)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===xl&&l===0)){if(s===Su)return s=gs.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};kl.prototype.onData=function(r){this.chunks.push(r)};kl.prototype.onEnd=function(r){r===xl&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x1.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function Aw(r,e){const t=new kl(e);if(t.push(r),t.err)throw t.msg||ad[t.err];return t.result}var Cw=kl,jw=Aw,kw={Inflate:Cw,inflate:jw};const{Inflate:Tw,inflate:Lw}=kw;var Qf=Tw,Fw=Lw;const L1=[];for(let r=0;r<256;r++){let e=r;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;L1[r]=e}const em=4294967295;function Pw(r,e,t){let n=r;for(let a=0;a<t;a++)n=L1[(n^e[a])&255]^n>>>8;return n}function Rw(r,e){return(Pw(em,r,e)^em)>>>0}function tm(r,e,t){const n=r.readUint32(),a=Rw(new Uint8Array(r.buffer,r.byteOffset+r.offset-e-4,e),e);if(a!==n)throw new Error(`CRC mismatch for chunk ${t}. Expected ${n}, found ${a}`)}function F1(r,e,t){for(let n=0;n<t;n++)e[n]=r[n]}function P1(r,e,t,n){let a=0;for(;a<n;a++)e[a]=r[a];for(;a<t;a++)e[a]=r[a]+e[a-n]&255}function R1(r,e,t,n){let a=0;if(t.length===0)for(;a<n;a++)e[a]=r[a];else for(;a<n;a++)e[a]=r[a]+t[a]&255}function D1(r,e,t,n,a){let s=0;if(t.length===0){for(;s<a;s++)e[s]=r[s];for(;s<n;s++)e[s]=r[s]+(e[s-a]>>1)&255}else{for(;s<a;s++)e[s]=r[s]+(t[s]>>1)&255;for(;s<n;s++)e[s]=r[s]+(e[s-a]+t[s]>>1)&255}}function O1(r,e,t,n,a){let s=0;if(t.length===0){for(;s<a;s++)e[s]=r[s];for(;s<n;s++)e[s]=r[s]+e[s-a]&255}else{for(;s<a;s++)e[s]=r[s]+t[s]&255;for(;s<n;s++)e[s]=r[s]+Dw(e[s-a],t[s],t[s-a])&255}}function Dw(r,e,t){const n=r+e-t,a=Math.abs(n-r),s=Math.abs(n-e),o=Math.abs(n-t);return a<=s&&a<=o?r:s<=o?e:t}function Ow(r,e,t,n,a,s){switch(r){case 0:F1(e,t,a);break;case 1:P1(e,t,a,s);break;case 2:R1(e,t,n,a);break;case 3:D1(e,t,n,a,s);break;case 4:O1(e,t,n,a,s);break;default:throw new Error(`Unsupported filter: ${r}`)}}const Iw=new Uint16Array([255]),Mw=new Uint8Array(Iw.buffer),Bw=Mw[0]===255;function Uw(r){const{data:e,width:t,height:n,channels:a,depth:s}=r,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,c=new Uint8Array(n*t*l);let u=0;for(let d=0;d<7;d++){const p=o[d],g=Math.ceil((t-p.x)/p.xStep),h=Math.ceil((n-p.y)/p.yStep);if(g<=0||h<=0)continue;const b=g*l,x=new Uint8Array(b);for(let y=0;y<h;y++){const v=e[u++],_=e.subarray(u,u+b);u+=b;const S=new Uint8Array(b);Ow(v,_,S,x,b,l),x.set(S);for(let j=0;j<g;j++){const I=p.x+j*p.xStep,J=p.y+y*p.yStep;if(!(I>=t||J>=n))for(let k=0;k<l;k++)c[(J*t+I)*l+k]=S[j*l+k]}}}if(s===16){const d=new Uint16Array(c.buffer);if(Bw)for(let p=0;p<d.length;p++)d[p]=Hw(d[p]);return d}else return c}function Hw(r){return(r&255)<<8|r>>8&255}const $w=new Uint16Array([255]),qw=new Uint8Array($w.buffer),Ww=qw[0]===255,zw=new Uint8Array(0);function rm(r){const{data:e,width:t,height:n,channels:a,depth:s}=r,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*t),c=new Uint8Array(n*l);let u=zw,d=0,p,g;for(let h=0;h<n;h++){switch(p=e.subarray(d+1,d+1+l),g=c.subarray(h*l,(h+1)*l),e[d]){case 0:F1(p,g,l);break;case 1:P1(p,g,l,o);break;case 2:R1(p,g,u,l);break;case 3:D1(p,g,u,l,o);break;case 4:O1(p,g,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}u=g,d+=l+1}if(s===16){const h=new Uint16Array(c.buffer);if(Ww)for(let b=0;b<h.length;b++)h[b]=Vw(h[b]);return h}else return c}function Vw(r){return(r&255)<<8|r>>8&255}const Fc=Uint8Array.of(137,80,78,71,13,10,26,10);function nm(r){if(!Gw(r.readBytes(Fc.length)))throw new Error("wrong PNG signature")}function Gw(r){if(r.length<Fc.length)return!1;for(let e=0;e<Fc.length;e++)if(r[e]!==Fc[e])return!1;return!0}const Kw="tEXt",Yw=0,I1=new TextDecoder("latin1");function Xw(r){if(Zw(r),r.length===0||r.length>79)throw new Error("keyword length must be between 1 and 79")}const Jw=/^[\u0000-\u00FF]*$/;function Zw(r){if(!Jw.test(r))throw new Error("invalid latin1 text")}function Qw(r,e,t){const n=M1(e);r[n]=e4(e,t-n.length-1)}function M1(r){for(r.mark();r.readByte()!==Yw;);const e=r.offset;r.reset();const t=I1.decode(r.readBytes(e-r.offset-1));return r.skip(1),Xw(t),t}function e4(r,e){return I1.decode(r.readBytes(e))}const Xn={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Au={UNKNOWN:-1,DEFLATE:0},am={UNKNOWN:-1,ADAPTIVE:0},Cu={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},fc={NONE:0,BACKGROUND:1,PREVIOUS:2},ju={SOURCE:0,OVER:1};class t4 extends Bd{constructor(t,n={}){super(t);er(this,"_checkCrc");er(this,"_inflator");er(this,"_png");er(this,"_apng");er(this,"_end");er(this,"_hasPalette");er(this,"_palette");er(this,"_hasTransparency");er(this,"_transparency");er(this,"_compressionMethod");er(this,"_filterMethod");er(this,"_interlaceMethod");er(this,"_colorType");er(this,"_isAnimated");er(this,"_numberOfFrames");er(this,"_numberOfPlays");er(this,"_frames");er(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new Qf,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Au.UNKNOWN,this._filterMethod=am.UNKNOWN,this._interlaceMethod=Cu.UNKNOWN,this._colorType=Xn.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(nm(this);!this._end;){const t=this.readUint32(),n=this.readChars(4);this.decodeChunk(t,n)}return this.decodeImage(),this._png}decodeApng(){for(nm(this);!this._end;){const t=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(t,n)}return this.decodeApngImage(),this._apng}decodeChunk(t,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case Kw:Qw(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?tm(this,t+4,n):this.skip(4)}decodeApngChunk(t,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,n),this.offset=a+t;break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?tm(this,t+4,n):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=r4(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Xn.GREYSCALE:a=1;break;case Xn.TRUECOLOUR:a=3;break;case Xn.INDEXED_COLOUR:a=1;break;case Xn.GREYSCALE_ALPHA:a=2;break;case Xn.TRUECOLOUR_ALPHA:a=4;break;case Xn.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==Au.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const n=t/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<n;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const n=t,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let n=t,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case Xn.GREYSCALE:case Xn.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let n=0;n<t/2;n++)this._transparency[n]=this.readUint16();break}case Xn.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let n=0;for(;n<t;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Xn.UNKNOWN:case Xn.GREYSCALE_ALPHA:case Xn.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const n=M1(this),a=this.readUint8();if(a!==Au.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(t-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:Fw(s)}}decodepHYs(){const t=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:t,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const n={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(t);if(a){if(a.data=rm({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const s=this._apng.frames.at(t-1);this.disposeFrame(a,s,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(t,n,a){switch(t.disposeOp){case fc.NONE:break;case fc.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*t.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case fc.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,n){const a=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case ju.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)t.data[c+d]=n.data[u+d]}break;case ju.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const p=n.data[u+this._png.channels-1]/a,g=d%(this._png.channels-1)===0?1:n.data[u+d],h=Math.floor(p*g+(1-p)*t.data[c+d]);t.data[c+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==am.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Cu.NO_INTERLACE)this._png.data=rm({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Cu.ADAM7)this._png.data=Uw({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,n=this._frames.at(-1);n?n.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:fc.NONE,blendOp:ju.SOURCE,data:t}),this._inflator=new Qf,this._writingDataChunks=!1}}function r4(r){if(r!==1&&r!==2&&r!==4&&r!==8&&r!==16)throw new Error(`invalid bit depth: ${r}`);return r}var sm;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.METRE=1]="METRE"})(sm||(sm={}));function n4(r,e){return new t4(r,e).decode()}var Dt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function ku(){Dt.console&&typeof Dt.console.log=="function"&&Dt.console.log.apply(Dt.console,arguments)}var dr={log:ku,warn:function(r){Dt.console&&(typeof Dt.console.warn=="function"?Dt.console.warn.apply(Dt.console,arguments):ku.call(null,arguments))},error:function(r){Dt.console&&(typeof Dt.console.error=="function"?Dt.console.error.apply(Dt.console,arguments):ku(r))}};function Tu(r,e,t){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){gi(n.response,e,t)},n.onerror=function(){dr.error("could not download file")},n.send()}function im(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function mc(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var gi=Dt.saveAs||((typeof window>"u"?"undefined":nr(window))!=="object"||window!==Dt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var n=Dt.URL||Dt.webkitURL,a=document.createElement("a");e=e||r.name||"download",a.download=e,a.rel="noopener",typeof r=="string"?(a.href=r,a.origin!==location.origin?im(a.href)?Tu(r,e,t):mc(a,a.target="_blank"):mc(a)):(a.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){mc(a)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(im(r))Tu(r,e,t);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){mc(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:nr(s)!=="object"&&(dr.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(r,t),e)}:function(r,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return Tu(r,e,t);var a=r.type==="application/octet-stream",s=/constructor/i.test(Dt.HTMLElement)||Dt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":nr(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(r)}else{var c=Dt.URL||Dt.webkitURL,u=c.createObjectURL(r);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function B1(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<t.length;n++){var a=t[n].re,s=t[n].process,o=a.exec(r);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var Pc=Dt.atob.bind(Dt),om=Dt.btoa.bind(Dt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Lu(r,e){var t=r[0],n=r[1],a=r[2],s=r[3];t=yn(t,n,a,s,e[0],7,-680876936),s=yn(s,t,n,a,e[1],12,-389564586),a=yn(a,s,t,n,e[2],17,606105819),n=yn(n,a,s,t,e[3],22,-1044525330),t=yn(t,n,a,s,e[4],7,-176418897),s=yn(s,t,n,a,e[5],12,1200080426),a=yn(a,s,t,n,e[6],17,-1473231341),n=yn(n,a,s,t,e[7],22,-45705983),t=yn(t,n,a,s,e[8],7,1770035416),s=yn(s,t,n,a,e[9],12,-1958414417),a=yn(a,s,t,n,e[10],17,-42063),n=yn(n,a,s,t,e[11],22,-1990404162),t=yn(t,n,a,s,e[12],7,1804603682),s=yn(s,t,n,a,e[13],12,-40341101),a=yn(a,s,t,n,e[14],17,-1502002290),t=bn(t,n=yn(n,a,s,t,e[15],22,1236535329),a,s,e[1],5,-165796510),s=bn(s,t,n,a,e[6],9,-1069501632),a=bn(a,s,t,n,e[11],14,643717713),n=bn(n,a,s,t,e[0],20,-373897302),t=bn(t,n,a,s,e[5],5,-701558691),s=bn(s,t,n,a,e[10],9,38016083),a=bn(a,s,t,n,e[15],14,-660478335),n=bn(n,a,s,t,e[4],20,-405537848),t=bn(t,n,a,s,e[9],5,568446438),s=bn(s,t,n,a,e[14],9,-1019803690),a=bn(a,s,t,n,e[3],14,-187363961),n=bn(n,a,s,t,e[8],20,1163531501),t=bn(t,n,a,s,e[13],5,-1444681467),s=bn(s,t,n,a,e[2],9,-51403784),a=bn(a,s,t,n,e[7],14,1735328473),t=wn(t,n=bn(n,a,s,t,e[12],20,-1926607734),a,s,e[5],4,-378558),s=wn(s,t,n,a,e[8],11,-2022574463),a=wn(a,s,t,n,e[11],16,1839030562),n=wn(n,a,s,t,e[14],23,-35309556),t=wn(t,n,a,s,e[1],4,-1530992060),s=wn(s,t,n,a,e[4],11,1272893353),a=wn(a,s,t,n,e[7],16,-155497632),n=wn(n,a,s,t,e[10],23,-1094730640),t=wn(t,n,a,s,e[13],4,681279174),s=wn(s,t,n,a,e[0],11,-358537222),a=wn(a,s,t,n,e[3],16,-722521979),n=wn(n,a,s,t,e[6],23,76029189),t=wn(t,n,a,s,e[9],4,-640364487),s=wn(s,t,n,a,e[12],11,-421815835),a=wn(a,s,t,n,e[15],16,530742520),t=_n(t,n=wn(n,a,s,t,e[2],23,-995338651),a,s,e[0],6,-198630844),s=_n(s,t,n,a,e[7],10,1126891415),a=_n(a,s,t,n,e[14],15,-1416354905),n=_n(n,a,s,t,e[5],21,-57434055),t=_n(t,n,a,s,e[12],6,1700485571),s=_n(s,t,n,a,e[3],10,-1894986606),a=_n(a,s,t,n,e[10],15,-1051523),n=_n(n,a,s,t,e[1],21,-2054922799),t=_n(t,n,a,s,e[8],6,1873313359),s=_n(s,t,n,a,e[15],10,-30611744),a=_n(a,s,t,n,e[6],15,-1560198380),n=_n(n,a,s,t,e[13],21,1309151649),t=_n(t,n,a,s,e[4],6,-145523070),s=_n(s,t,n,a,e[11],10,-1120210379),a=_n(a,s,t,n,e[2],15,718787259),n=_n(n,a,s,t,e[9],21,-343485551),r[0]=Ks(t,r[0]),r[1]=Ks(n,r[1]),r[2]=Ks(a,r[2]),r[3]=Ks(s,r[3])}function _0(r,e,t,n,a,s){return e=Ks(Ks(e,r),Ks(n,s)),Ks(e<<a|e>>>32-a,t)}function yn(r,e,t,n,a,s,o){return _0(e&t|~e&n,r,e,a,s,o)}function bn(r,e,t,n,a,s,o){return _0(e&n|t&~n,r,e,a,s,o)}function wn(r,e,t,n,a,s,o){return _0(e^t^n,r,e,a,s,o)}function _n(r,e,t,n,a,s,o){return _0(t^(e|~n),r,e,a,s,o)}function U1(r){var e,t=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)Lu(n,a4(r.substring(e-64,e)));r=r.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)a[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(Lu(n,a),e=0;e<16;e++)a[e]=0;return a[14]=8*t,Lu(n,a),n}function a4(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}var lm="0123456789abcdef".split("");function s4(r){for(var e="",t=0;t<4;t++)e+=lm[r>>8*t+4&15]+lm[r>>8*t&15];return e}function i4(r){return String.fromCharCode(255&r,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function id(r){return U1(r).map(i4).join("")}var o4=function(r){for(var e=0;e<r.length;e++)r[e]=s4(r[e]);return r.join("")}(U1("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ks(r,e){if(o4){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function od(r,e){var t,n,a,s;if(r!==t){for(var o=(a=r,s=1+(256/r.length|0),new Array(s+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}t=r,n=l}else l=n;var p=e.length,g=0,h=0,b="";for(c=0;c<p;c++)h=(h+(d=l[g=(g+1)%256]))%256,l[g]=l[h],l[h]=d,o=l[(l[g]+l[h])%256],b+=String.fromCharCode(e.charCodeAt(c)^o);return b}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var cm={print:4,modify:8,copy:16,"annot-forms":32};function Qi(r,e,t,n){this.v=1,this.r=2;var a=192;r.forEach(function(l){if(cm.perm!==void 0)throw new Error("Invalid permission: "+l);a+=cm[l]}),this.padding="(¬øN^Nu¬äAd\0NV√ø√∫\b..\0¬∂√êh>¬Ä/\f¬©√ædSiz";var s=(e+this.padding).substr(0,32),o=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=id(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=od(this.encryptionKey,this.padding)}function eo(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,n=0;n<t;n++){var a=r.charCodeAt(n);e+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):r[n]}return e}function um(r){if(nr(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,a){if(a=a||!1,typeof t!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[n,!!a],s},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in e[t]){var o=e[t][s];try{o[0].apply(r,n)}catch(l){Dt.console&&dr.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Kc(r){if(!(this instanceof Kc))return new Kc(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function H1(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function vi(r,e,t,n,a){if(!(this instanceof vi))return new vi(r,e,t,n,a);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,H1.call(this,n,a)}function ro(r,e,t,n,a){if(!(this instanceof ro))return new ro(r,e,t,n,a);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,H1.call(this,n,a)}function _t(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;nr(r=r||{})==="object"&&(t=r.orientation,n=r.unit||n,a=r.format||a,s=r.compress||r.compressPdf||s,(d=r.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(c=r.floatPrecision),u=r.defaultPathOperation||"S"),o=r.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",t=(""+(t||"P")).toLowerCase();var p=r.putOnlyUsedFonts||!1,g={},h={internal:{},__private__:{}};h.__private__.PubSub=um;var b="1.3",x=h.__private__.getPdfVersion=function(){return b};h.__private__.setPdfVersion=function(w){b=w};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return y};var v=h.__private__.getPageFormat=function(w){return y[w]};a=a||"a4";var _="compat",S="advanced",j=_;function I(){this.saveGraphicsState(),ee(new jt(Ct,0,0,-Ct,0,$n()*Ct).toString()+" cm"),this.setFontSize(this.getFontSize()/Ct),u="n",j=S}function J(){this.restoreGraphicsState(),u="S",j=_}var k=h.__private__.combineFontStyleAndFontWeight=function(w,U){if(w=="bold"&&U=="normal"||w=="bold"&&U==400||w=="normal"&&U=="italic"||w=="bold"&&U=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return U&&(w=U==400||U==="normal"?w==="italic"?"italic":"normal":U!=700&&U!=="bold"||w!=="normal"?(U==700?"bold":U)+""+w:"bold"),w};h.advancedAPI=function(w){var U=j===_;return U&&I.call(this),typeof w!="function"||(w(this),U&&J.call(this)),this},h.compatAPI=function(w){var U=j===S;return U&&J.call(this),typeof w!="function"||(w(this),U&&I.call(this)),this},h.isAdvancedAPI=function(){return j===S};var F,T=function(w){if(j!==S)throw new Error(w+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},R=h.roundToPrecision=h.__private__.roundToPrecision=function(w,U){var se=e||U;if(isNaN(w)||isNaN(se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return w.toFixed(se).replace(/0+$/,"")};F=h.hpf=h.__private__.hpf=typeof c=="number"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return R(w,c)}:c==="smart"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return R(w,w>-1&&w<1?16:5)}:function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return R(w,16)};var A=h.f2=h.__private__.f2=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f2");return R(w,2)},P=h.__private__.f3=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f3");return R(w,3)},H=h.scale=h.__private__.scale=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.scale");return j===_?w*Ct:j===S?w:void 0},K=function(w){return H(function(U){return j===_?$n()-U:j===S?U:void 0}(w))};h.__private__.setPrecision=h.setPrecision=function(w){typeof parseInt(w,10)=="number"&&(e=parseInt(w,10))};var ce,me="00000000000000000000000000000000",le=h.__private__.getFileId=function(){return me},xe=h.__private__.setFileId=function(w){return me=w!==void 0&&/^[a-fA-F0-9]{32}$/.test(w)?w.toUpperCase():me.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(jr=new Qi(d.userPermissions,d.userPassword,d.ownerPassword,me)),me};h.setFileId=function(w){return xe(w),this},h.getFileId=function(){return le()};var we=h.__private__.convertDateToPDFDate=function(w){var U=w.getTimezoneOffset(),se=U<0?"+":"-",fe=Math.floor(Math.abs(U/60)),_e=Math.abs(U%60),He=[se,D(fe),"'",D(_e),"'"].join("");return["D:",w.getFullYear(),D(w.getMonth()+1),D(w.getDate()),D(w.getHours()),D(w.getMinutes()),D(w.getSeconds()),He].join("")},Oe=h.__private__.convertPDFDateToDate=function(w){var U=parseInt(w.substr(2,4),10),se=parseInt(w.substr(6,2),10)-1,fe=parseInt(w.substr(8,2),10),_e=parseInt(w.substr(10,2),10),He=parseInt(w.substr(12,2),10),Ve=parseInt(w.substr(14,2),10);return new Date(U,se,fe,_e,He,Ve,0)},ge=h.__private__.setCreationDate=function(w){var U;if(w===void 0&&(w=new Date),w instanceof Date)U=we(w);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(w))throw new Error("Invalid argument passed to jsPDF.setCreationDate");U=w}return ce=U},C=h.__private__.getCreationDate=function(w){var U=ce;return w==="jsDate"&&(U=Oe(ce)),U};h.setCreationDate=function(w){return ge(w),this},h.getCreationDate=function(w){return C(w)};var O,D=h.__private__.padd2=function(w){return("0"+parseInt(w)).slice(-2)},M=h.__private__.padd2Hex=function(w){return("00"+(w=w.toString())).substr(w.length)},V=0,oe=[],he=[],ue=0,Z=[],ye=[],Le=!1,Ie=he;h.__private__.setCustomOutputDestination=function(w){Le=!0,Ie=w};var pe=function(w){Le||(Ie=w)};h.__private__.resetCustomOutputDestination=function(){Le=!1,Ie=he};var ee=h.__private__.out=function(w){return w=w.toString(),ue+=w.length+1,Ie.push(w),Ie},lt=h.__private__.write=function(w){return ee(arguments.length===1?w.toString():Array.prototype.join.call(arguments," "))},Pe=h.__private__.getArrayBuffer=function(w){for(var U=w.length,se=new ArrayBuffer(U),fe=new Uint8Array(se);U--;)fe[U]=w.charCodeAt(U);return se},at=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return at};var qe=r.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(w){return qe=j===S?w/Ct:w,this};var ft,rt=h.__private__.getFontSize=h.getFontSize=function(){return j===_?qe:qe*Ct},Pt=r.R2L||!1;h.__private__.setR2L=h.setR2L=function(w){return Pt=w,this},h.__private__.getR2L=h.getR2L=function(){return Pt};var xt,Ot=h.__private__.setZoomMode=function(w){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(w))ft=w;else if(isNaN(w)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(w)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+w+'" is not recognized.');ft=w}else ft=parseInt(w,10)};h.__private__.getZoomMode=function(){return ft};var kt,Tt=h.__private__.setPageMode=function(w){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(w)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+w+'" is not recognized.');xt=w};h.__private__.getPageMode=function(){return xt};var zt=h.__private__.setLayoutMode=function(w){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(w)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+w+'" is not recognized.');kt=w};h.__private__.getLayoutMode=function(){return kt},h.__private__.setDisplayMode=h.setDisplayMode=function(w,U,se){return Ot(w),zt(U),Tt(se),this};var At={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(w){if(Object.keys(At).indexOf(w)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return At[w]},h.__private__.getDocumentProperties=function(){return At},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(w){for(var U in At)At.hasOwnProperty(U)&&w[U]&&(At[U]=w[U]);return this},h.__private__.setDocumentProperty=function(w,U){if(Object.keys(At).indexOf(w)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return At[w]=U};var wt,Ct,vt,de,Me,Te={},Ge={},it=[],Xe={},Ue={},Ke={},ct={},ht=null,Et=0,ut=[],Lt=new um(h),ma=r.hotfixes||[],Jr={},pa={},na=[],jt=function w(U,se,fe,_e,He,Ve){if(!(this instanceof w))return new w(U,se,fe,_e,He,Ve);isNaN(U)&&(U=1),isNaN(se)&&(se=0),isNaN(fe)&&(fe=0),isNaN(_e)&&(_e=1),isNaN(He)&&(He=0),isNaN(Ve)&&(Ve=0),this._matrix=[U,se,fe,_e,He,Ve]};Object.defineProperty(jt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(jt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(jt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(jt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(jt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(jt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(jt.prototype,"a",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(jt.prototype,"b",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(jt.prototype,"c",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(jt.prototype,"d",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(jt.prototype,"e",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(jt.prototype,"f",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(jt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(jt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(jt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(jt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),jt.prototype.join=function(w){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(F).join(w)},jt.prototype.multiply=function(w){var U=w.sx*this.sx+w.shy*this.shx,se=w.sx*this.shy+w.shy*this.sy,fe=w.shx*this.sx+w.sy*this.shx,_e=w.shx*this.shy+w.sy*this.sy,He=w.tx*this.sx+w.ty*this.shx+this.tx,Ve=w.tx*this.shy+w.ty*this.sy+this.ty;return new jt(U,se,fe,_e,He,Ve)},jt.prototype.decompose=function(){var w=this.sx,U=this.shy,se=this.shx,fe=this.sy,_e=this.tx,He=this.ty,Ve=Math.sqrt(w*w+U*U),gt=(w/=Ve)*se+(U/=Ve)*fe;se-=w*gt,fe-=U*gt;var Nt=Math.sqrt(se*se+fe*fe);return gt/=Nt,w*(fe/=Nt)<U*(se/=Nt)&&(w=-w,U=-U,gt=-gt,Ve=-Ve),{scale:new jt(Ve,0,0,Nt,0,0),translate:new jt(1,0,0,1,_e,He),rotate:new jt(w,U,-U,w,0,0),skew:new jt(1,0,gt,1,0,0)}},jt.prototype.toString=function(w){return this.join(" ")},jt.prototype.inversed=function(){var w=this.sx,U=this.shy,se=this.shx,fe=this.sy,_e=this.tx,He=this.ty,Ve=1/(w*fe-U*se),gt=fe*Ve,Nt=-U*Ve,Rt=-se*Ve,Ut=w*Ve;return new jt(gt,Nt,Rt,Ut,-gt*_e-Rt*He,-Nt*_e-Ut*He)},jt.prototype.applyToPoint=function(w){var U=w.x*this.sx+w.y*this.shx+this.tx,se=w.x*this.shy+w.y*this.sy+this.ty;return new ci(U,se)},jt.prototype.applyToRectangle=function(w){var U=this.applyToPoint(w),se=this.applyToPoint(new ci(w.x+w.w,w.y+w.h));return new Po(U.x,U.y,se.x-U.x,se.y-U.y)},jt.prototype.clone=function(){var w=this.sx,U=this.shy,se=this.shx,fe=this.sy,_e=this.tx,He=this.ty;return new jt(w,U,se,fe,_e,He)},h.Matrix=jt;var ga=h.matrixMult=function(w,U){return U.multiply(w)},xa=new jt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=xa;var gn=function(w,U){if(!Ue[w]){var se=(U instanceof vi?"Sh":"P")+(Object.keys(Xe).length+1).toString(10);U.id=se,Ue[w]=se,Xe[se]=U,Lt.publish("addPattern",U)}};h.ShadingPattern=vi,h.TilingPattern=ro,h.addShadingPattern=function(w,U){return T("addShadingPattern()"),gn(w,U),this},h.beginTilingPattern=function(w){T("beginTilingPattern()"),Ro(w.boundingBox[0],w.boundingBox[1],w.boundingBox[2]-w.boundingBox[0],w.boundingBox[3]-w.boundingBox[1],w.matrix)},h.endTilingPattern=function(w,U){T("endTilingPattern()"),U.stream=ye[O].join(`
`),gn(w,U),Lt.publish("endTilingPattern",U),na.pop().restore()};var Pn,vr=h.__private__.newObject=function(){var w=Ir();return q(w,!0),w},Ir=h.__private__.newObjectDeferred=function(){return V++,oe[V]=function(){return ue},V},q=function(w,U){return U=typeof U=="boolean"&&U,oe[w]=ue,U&&ee(w+" 0 obj"),w},ne=h.__private__.newAdditionalObject=function(){var w={objId:Ir(),content:""};return Z.push(w),w},Y=Ir(),Q=Ir(),ae=h.__private__.decodeColorString=function(w){var U=w.split(" ");if(U.length!==2||U[1]!=="g"&&U[1]!=="G")U.length!==5||U[4]!=="k"&&U[4]!=="K"||(U=[(1-U[0])*(1-U[3]),(1-U[1])*(1-U[3]),(1-U[2])*(1-U[3]),"r"]);else{var se=parseFloat(U[0]);U=[se,se,se,"r"]}for(var fe="#",_e=0;_e<3;_e++)fe+=("0"+Math.floor(255*parseFloat(U[_e])).toString(16)).slice(-2);return fe},ie=h.__private__.encodeColorString=function(w){var U;typeof w=="string"&&(w={ch1:w});var se=w.ch1,fe=w.ch2,_e=w.ch3,He=w.ch4,Ve=w.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof se=="string"&&se.charAt(0)!=="#"){var gt=new B1(se);if(gt.ok)se=gt.toHex();else if(!/^\d*\.?\d*$/.test(se))throw new Error('Invalid color "'+se+'" passed to jsPDF.encodeColorString.')}if(typeof se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(se)&&(se="#"+se[1]+se[1]+se[2]+se[2]+se[3]+se[3]),typeof se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(se)){var Nt=parseInt(se.substr(1),16);se=Nt>>16&255,fe=Nt>>8&255,_e=255&Nt}if(fe===void 0||He===void 0&&se===fe&&fe===_e)U=typeof se=="string"?se+" "+Ve[0]:w.precision===2?A(se/255)+" "+Ve[0]:P(se/255)+" "+Ve[0];else if(He===void 0||nr(He)==="object"){if(He&&!isNaN(He.a)&&He.a===0)return["1.","1.","1.",Ve[1]].join(" ");U=typeof se=="string"?[se,fe,_e,Ve[1]].join(" "):w.precision===2?[A(se/255),A(fe/255),A(_e/255),Ve[1]].join(" "):[P(se/255),P(fe/255),P(_e/255),Ve[1]].join(" ")}else U=typeof se=="string"?[se,fe,_e,He,Ve[2]].join(" "):w.precision===2?[A(se),A(fe),A(_e),A(He),Ve[2]].join(" "):[P(se),P(fe),P(_e),P(He),Ve[2]].join(" ");return U},Se=h.__private__.getFilters=function(){return o},Fe=h.__private__.putStream=function(w){var U=(w=w||{}).data||"",se=w.filters||Se(),fe=w.alreadyAppliedFilters||[],_e=w.addLength1||!1,He=U.length,Ve=w.objectId,gt=function(zr){return zr};if(d!==null&&Ve===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(gt=jr.encryptor(Ve,0));var Nt={};se===!0&&(se=["FlateEncode"]);var Rt=w.additionalKeyValues||[],Ut=(Nt=_t.API.processDataByFilters!==void 0?_t.API.processDataByFilters(U,se):{data:U,reverseChain:[]}).reverseChain+(Array.isArray(fe)?fe.join(" "):fe.toString());if(Nt.data.length!==0&&(Rt.push({key:"Length",value:Nt.data.length}),_e===!0&&Rt.push({key:"Length1",value:He})),Ut.length!=0)if(Ut.split("/").length-1==1)Rt.push({key:"Filter",value:Ut});else{Rt.push({key:"Filter",value:"["+Ut+"]"});for(var Xt=0;Xt<Rt.length;Xt+=1)if(Rt[Xt].key==="DecodeParms"){for(var wr=[],Br=0;Br<Nt.reverseChain.split("/").length-1;Br+=1)wr.push("null");wr.push(Rt[Xt].value),Rt[Xt].value="["+wr.join(" ")+"]"}}ee("<<");for(var lr=0;lr<Rt.length;lr++)ee("/"+Rt[lr].key+" "+Rt[lr].value);ee(">>"),Nt.data.length!==0&&(ee("stream"),ee(gt(Nt.data)),ee("endstream"))},Ee=h.__private__.putPage=function(w){var U=w.number,se=w.data,fe=w.objId,_e=w.contentsObjId;q(fe,!0),ee("<</Type /Page"),ee("/Parent "+w.rootDictionaryObjId+" 0 R"),ee("/Resources "+w.resourceDictionaryObjId+" 0 R"),ee("/MediaBox ["+parseFloat(F(w.mediaBox.bottomLeftX))+" "+parseFloat(F(w.mediaBox.bottomLeftY))+" "+F(w.mediaBox.topRightX)+" "+F(w.mediaBox.topRightY)+"]"),w.cropBox!==null&&ee("/CropBox ["+F(w.cropBox.bottomLeftX)+" "+F(w.cropBox.bottomLeftY)+" "+F(w.cropBox.topRightX)+" "+F(w.cropBox.topRightY)+"]"),w.bleedBox!==null&&ee("/BleedBox ["+F(w.bleedBox.bottomLeftX)+" "+F(w.bleedBox.bottomLeftY)+" "+F(w.bleedBox.topRightX)+" "+F(w.bleedBox.topRightY)+"]"),w.trimBox!==null&&ee("/TrimBox ["+F(w.trimBox.bottomLeftX)+" "+F(w.trimBox.bottomLeftY)+" "+F(w.trimBox.topRightX)+" "+F(w.trimBox.topRightY)+"]"),w.artBox!==null&&ee("/ArtBox ["+F(w.artBox.bottomLeftX)+" "+F(w.artBox.bottomLeftY)+" "+F(w.artBox.topRightX)+" "+F(w.artBox.topRightY)+"]"),typeof w.userUnit=="number"&&w.userUnit!==1&&ee("/UserUnit "+w.userUnit),Lt.publish("putPage",{objId:fe,pageContext:ut[U],pageNumber:U,page:se}),ee("/Contents "+_e+" 0 R"),ee(">>"),ee("endobj");var He=se.join(`
`);return j===S&&(He+=`
Q`),q(_e,!0),Fe({data:He,filters:Se(),objectId:_e}),ee("endobj"),fe},Ae=h.__private__.putPages=function(){var w,U,se=[];for(w=1;w<=Et;w++)ut[w].objId=Ir(),ut[w].contentsObjId=Ir();for(w=1;w<=Et;w++)se.push(Ee({number:w,data:ye[w],objId:ut[w].objId,contentsObjId:ut[w].contentsObjId,mediaBox:ut[w].mediaBox,cropBox:ut[w].cropBox,bleedBox:ut[w].bleedBox,trimBox:ut[w].trimBox,artBox:ut[w].artBox,userUnit:ut[w].userUnit,rootDictionaryObjId:Y,resourceDictionaryObjId:Q}));q(Y,!0),ee("<</Type /Pages");var fe="/Kids [";for(U=0;U<Et;U++)fe+=se[U]+" 0 R ";ee(fe+"]"),ee("/Count "+Et),ee(">>"),ee("endobj"),Lt.publish("postPutPages")},ke=function(w){Lt.publish("putFont",{font:w,out:ee,newObject:vr,putStream:Fe}),w.isAlreadyPutted!==!0&&(w.objectNumber=vr(),ee("<<"),ee("/Type /Font"),ee("/BaseFont /"+eo(w.postScriptName)),ee("/Subtype /Type1"),typeof w.encoding=="string"&&ee("/Encoding /"+w.encoding),ee("/FirstChar 32"),ee("/LastChar 255"),ee(">>"),ee("endobj"))},Ye=function(w){w.objectNumber=vr();var U=[];U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Form"}),U.push({key:"BBox",value:"["+[F(w.x),F(w.y),F(w.x+w.width),F(w.y+w.height)].join(" ")+"]"}),U.push({key:"Matrix",value:"["+w.matrix.toString()+"]"});var se=w.pages[1].join(`
`);Fe({data:se,additionalKeyValues:U,objectId:w.objectNumber}),ee("endobj")},Qe=function(w,U){U||(U=21);var se=vr(),fe=function(Ve,gt){var Nt,Rt=[],Ut=1/(gt-1);for(Nt=0;Nt<1;Nt+=Ut)Rt.push(Nt);if(Rt.push(1),Ve[0].offset!=0){var Xt={offset:0,color:Ve[0].color};Ve.unshift(Xt)}if(Ve[Ve.length-1].offset!=1){var wr={offset:1,color:Ve[Ve.length-1].color};Ve.push(wr)}for(var Br="",lr=0,zr=0;zr<Rt.length;zr++){for(Nt=Rt[zr];Nt>Ve[lr+1].offset;)lr++;var Ur=Ve[lr].offset,an=(Nt-Ur)/(Ve[lr+1].offset-Ur),ss=Ve[lr].color,Ts=Ve[lr+1].color;Br+=M(Math.round((1-an)*ss[0]+an*Ts[0]).toString(16))+M(Math.round((1-an)*ss[1]+an*Ts[1]).toString(16))+M(Math.round((1-an)*ss[2]+an*Ts[2]).toString(16))}return Br.trim()}(w.colors,U),_e=[];_e.push({key:"FunctionType",value:"0"}),_e.push({key:"Domain",value:"[0.0 1.0]"}),_e.push({key:"Size",value:"["+U+"]"}),_e.push({key:"BitsPerSample",value:"8"}),_e.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),_e.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe({data:fe,additionalKeyValues:_e,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:se}),ee("endobj"),w.objectNumber=vr(),ee("<< /ShadingType "+w.type),ee("/ColorSpace /DeviceRGB");var He="/Coords ["+F(parseFloat(w.coords[0]))+" "+F(parseFloat(w.coords[1]))+" ";w.type===2?He+=F(parseFloat(w.coords[2]))+" "+F(parseFloat(w.coords[3])):He+=F(parseFloat(w.coords[2]))+" "+F(parseFloat(w.coords[3]))+" "+F(parseFloat(w.coords[4]))+" "+F(parseFloat(w.coords[5])),ee(He+="]"),w.matrix&&ee("/Matrix ["+w.matrix.toString()+"]"),ee("/Function "+se+" 0 R"),ee("/Extend [true true]"),ee(">>"),ee("endobj")},ot=function(w,U){var se=Ir(),fe=vr();U.push({resourcesOid:se,objectOid:fe}),w.objectNumber=fe;var _e=[];_e.push({key:"Type",value:"/Pattern"}),_e.push({key:"PatternType",value:"1"}),_e.push({key:"PaintType",value:"1"}),_e.push({key:"TilingType",value:"1"}),_e.push({key:"BBox",value:"["+w.boundingBox.map(F).join(" ")+"]"}),_e.push({key:"XStep",value:F(w.xStep)}),_e.push({key:"YStep",value:F(w.yStep)}),_e.push({key:"Resources",value:se+" 0 R"}),w.matrix&&_e.push({key:"Matrix",value:"["+w.matrix.toString()+"]"}),Fe({data:w.stream,additionalKeyValues:_e,objectId:w.objectNumber}),ee("endobj")},Ze=function(w){for(var U in w.objectNumber=vr(),ee("<<"),w)switch(U){case"opacity":ee("/ca "+A(w[U]));break;case"stroke-opacity":ee("/CA "+A(w[U]))}ee(">>"),ee("endobj")},st=function(w){q(w.resourcesOid,!0),ee("<<"),ee("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var U in ee("/Font <<"),Te)Te.hasOwnProperty(U)&&(p===!1||p===!0&&g.hasOwnProperty(U))&&ee("/"+U+" "+Te[U].objectNumber+" 0 R");ee(">>")}(),function(){if(Object.keys(Xe).length>0){for(var U in ee("/Shading <<"),Xe)Xe.hasOwnProperty(U)&&Xe[U]instanceof vi&&Xe[U].objectNumber>=0&&ee("/"+U+" "+Xe[U].objectNumber+" 0 R");Lt.publish("putShadingPatternDict"),ee(">>")}}(),function(U){if(Object.keys(Xe).length>0){for(var se in ee("/Pattern <<"),Xe)Xe.hasOwnProperty(se)&&Xe[se]instanceof h.TilingPattern&&Xe[se].objectNumber>=0&&Xe[se].objectNumber<U&&ee("/"+se+" "+Xe[se].objectNumber+" 0 R");Lt.publish("putTilingPatternDict"),ee(">>")}}(w.objectOid),function(){if(Object.keys(Ke).length>0){var U;for(U in ee("/ExtGState <<"),Ke)Ke.hasOwnProperty(U)&&Ke[U].objectNumber>=0&&ee("/"+U+" "+Ke[U].objectNumber+" 0 R");Lt.publish("putGStateDict"),ee(">>")}}(),function(){for(var U in ee("/XObject <<"),Jr)Jr.hasOwnProperty(U)&&Jr[U].objectNumber>=0&&ee("/"+U+" "+Jr[U].objectNumber+" 0 R");Lt.publish("putXobjectDict"),ee(">>")}(),ee(">>"),ee("endobj")},Ft=function(w){Ge[w.fontName]=Ge[w.fontName]||{},Ge[w.fontName][w.fontStyle]=w.id},or=function(w,U,se,fe,_e){var He={id:"F"+(Object.keys(Te).length+1).toString(10),postScriptName:w,fontName:U,fontStyle:se,encoding:fe,isStandardFont:_e||!1,metadata:{}};return Lt.publish("addFont",{font:He,instance:this}),Te[He.id]=He,Ft(He),He.id},Wt=h.__private__.pdfEscape=h.pdfEscape=function(w,U){return function(se,fe){var _e,He,Ve,gt,Nt,Rt,Ut,Xt,wr;if(Ve=(fe=fe||{}).sourceEncoding||"Unicode",Nt=fe.outputEncoding,(fe.autoencode||Nt)&&Te[wt].metadata&&Te[wt].metadata[Ve]&&Te[wt].metadata[Ve].encoding&&(gt=Te[wt].metadata[Ve].encoding,!Nt&&Te[wt].encoding&&(Nt=Te[wt].encoding),!Nt&&gt.codePages&&(Nt=gt.codePages[0]),typeof Nt=="string"&&(Nt=gt[Nt]),Nt)){for(Ut=!1,Rt=[],_e=0,He=se.length;_e<He;_e++)(Xt=Nt[se.charCodeAt(_e)])?Rt.push(String.fromCharCode(Xt)):Rt.push(se[_e]),Rt[_e].charCodeAt(0)>>8&&(Ut=!0);se=Rt.join("")}for(_e=se.length;Ut===void 0&&_e!==0;)se.charCodeAt(_e-1)>>8&&(Ut=!0),_e--;if(!Ut)return se;for(Rt=fe.noBOM?[]:[254,255],_e=0,He=se.length;_e<He;_e++){if((wr=(Xt=se.charCodeAt(_e))>>8)>>8)throw new Error("Character at position "+_e+" of string '"+se+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Rt.push(wr),Rt.push(Xt-(wr<<8))}return String.fromCharCode.apply(void 0,Rt)}(w,U).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},_r=h.__private__.beginPage=function(w){ye[++Et]=[],ut[Et]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(w[0]),topRightY:Number(w[1])}},Ia(Et),pe(ye[O])},Oa=function(w,U){var se,fe,_e;switch(t=U||t,typeof w=="string"&&(se=v(w.toLowerCase()),Array.isArray(se)&&(fe=se[0],_e=se[1])),Array.isArray(w)&&(fe=w[0]*Ct,_e=w[1]*Ct),isNaN(fe)&&(fe=a[0],_e=a[1]),(fe>14400||_e>14400)&&(dr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),fe=Math.min(14400,fe),_e=Math.min(14400,_e)),a=[fe,_e],t.substr(0,1)){case"l":_e>fe&&(a=[_e,fe]);break;case"p":fe>_e&&(a=[_e,fe])}_r(a),B0(ko),ee(Ri),Lo!==0&&ee(Lo+" J"),Fo!==0&&ee(Fo+" j"),Lt.publish("addPage",{pageNumber:Et})},va=function(w){w>0&&w<=Et&&(ye.splice(w,1),ut.splice(w,1),Et--,O>Et&&(O=Et),this.setPage(O))},Ia=function(w){w>0&&w<=Et&&(O=w)},aa=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return ye.length-1},Cs=function(w,U,se){var fe,_e=void 0;return se=se||{},w=w!==void 0?w:Te[wt].fontName,U=U!==void 0?U:Te[wt].fontStyle,fe=w.toLowerCase(),Ge[fe]!==void 0&&Ge[fe][U]!==void 0?_e=Ge[fe][U]:Ge[w]!==void 0&&Ge[w][U]!==void 0?_e=Ge[w][U]:se.disableWarning===!1&&dr.warn("Unable to look up font label for font '"+w+"', '"+U+"'. Refer to getFontList() for available fonts."),_e||se.noFallback||(_e=Ge.times[U])==null&&(_e=Ge.times.normal),_e},xn=h.__private__.putInfo=function(){var w=vr(),U=function(fe){return fe};for(var se in d!==null&&(U=jr.encryptor(w,0)),ee("<<"),ee("/Producer ("+Wt(U("jsPDF "+_t.version))+")"),At)At.hasOwnProperty(se)&&At[se]&&ee("/"+se.substr(0,1).toUpperCase()+se.substr(1)+" ("+Wt(U(At[se]))+")");ee("/CreationDate ("+Wt(U(ce))+")"),ee(">>"),ee("endobj")},L0=h.__private__.putCatalog=function(w){var U=(w=w||{}).rootDictionaryObjId||Y;switch(vr(),ee("<<"),ee("/Type /Catalog"),ee("/Pages "+U+" 0 R"),ft||(ft="fullwidth"),ft){case"fullwidth":ee("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ee("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ee("/OpenAction [3 0 R /Fit]");break;case"original":ee("/OpenAction [3 0 R /XYZ null null 1]");break;default:var se=""+ft;se.substr(se.length-1)==="%"&&(ft=parseInt(ft)/100),typeof ft=="number"&&ee("/OpenAction [3 0 R /XYZ null null "+A(ft)+"]")}switch(kt||(kt="continuous"),kt){case"continuous":ee("/PageLayout /OneColumn");break;case"single":ee("/PageLayout /SinglePage");break;case"two":case"twoleft":ee("/PageLayout /TwoColumnLeft");break;case"tworight":ee("/PageLayout /TwoColumnRight")}xt&&ee("/PageMode /"+xt),Lt.publish("putCatalog"),ee(">>"),ee("endobj")},Mr=h.__private__.putTrailer=function(){ee("trailer"),ee("<<"),ee("/Size "+(V+1)),ee("/Root "+V+" 0 R"),ee("/Info "+(V-1)+" 0 R"),d!==null&&ee("/Encrypt "+jr.oid+" 0 R"),ee("/ID [ <"+me+"> <"+me+"> ]"),ee(">>")},Ol=h.__private__.putHeader=function(){ee("%PDF-"+b),ee("%¬∫√ü¬¨√†")},Il=h.__private__.putXRef=function(){var w="0000000000";ee("xref"),ee("0 "+(V+1)),ee("0000000000 65535 f ");for(var U=1;U<=V;U++)typeof oe[U]=="function"?ee((w+oe[U]()).slice(-10)+" 00000 n "):oe[U]!==void 0?ee((w+oe[U]).slice(-10)+" 00000 n "):ee("0000000000 00000 n ")},rs=h.__private__.buildDocument=function(){var w;V=0,ue=0,he=[],oe=[],Z=[],Y=Ir(),Q=Ir(),pe(he),Lt.publish("buildDocument"),Ol(),Ae(),function(){Lt.publish("putAdditionalObjects");for(var se=0;se<Z.length;se++){var fe=Z[se];q(fe.objId,!0),ee(fe.content),ee("endobj")}Lt.publish("postPutAdditionalObjects")}(),w=[],function(){for(var se in Te)Te.hasOwnProperty(se)&&(p===!1||p===!0&&g.hasOwnProperty(se))&&ke(Te[se])}(),function(){var se;for(se in Ke)Ke.hasOwnProperty(se)&&Ze(Ke[se])}(),function(){for(var se in Jr)Jr.hasOwnProperty(se)&&Ye(Jr[se])}(),function(se){var fe;for(fe in Xe)Xe.hasOwnProperty(fe)&&(Xe[fe]instanceof vi?Qe(Xe[fe]):Xe[fe]instanceof ro&&ot(Xe[fe],se))}(w),Lt.publish("putResources"),w.forEach(st),st({resourcesOid:Q,objectOid:Number.MAX_SAFE_INTEGER}),Lt.publish("postPutResources"),d!==null&&(jr.oid=vr(),ee("<<"),ee("/Filter /Standard"),ee("/V "+jr.v),ee("/R "+jr.r),ee("/U <"+jr.toHexString(jr.U)+">"),ee("/O <"+jr.toHexString(jr.O)+">"),ee("/P "+jr.P),ee(">>"),ee("endobj")),xn(),L0();var U=ue;return Il(),Mr(),ee("startxref"),ee(""+U),ee("%%EOF"),pe(ye[O]),he.join(`
`)},ni=h.__private__.getBlob=function(w){return new Blob([Pe(w)],{type:"application/pdf"})},ya=h.output=h.__private__.output=(Pn=function(w,U){switch(typeof(U=U||{})=="string"?U={filename:U}:U.filename=U.filename||"generated.pdf",w){case void 0:return rs();case"save":h.save(U.filename);break;case"arraybuffer":return Pe(rs());case"blob":return ni(rs());case"bloburi":case"bloburl":if(Dt.URL!==void 0&&typeof Dt.URL.createObjectURL=="function")return Dt.URL&&Dt.URL.createObjectURL(ni(rs()))||void 0;dr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var se="",fe=rs();try{se=om(fe)}catch{se=om(unescape(encodeURIComponent(fe)))}return"data:application/pdf;filename="+U.filename+";base64,"+se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Dt)==="[object Window]"){var _e="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",He=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';U.pdfObjectUrl&&(_e=U.pdfObjectUrl,He="");var Ve='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+_e+'"'+He+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(U)+");<\/script></body></html>",gt=Dt.open();return gt!==null&&gt.document.write(Ve),gt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Dt)==="[object Window]"){var Nt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(U.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+U.filename+'" width="500px" height="400px" /></body></html>',Rt=Dt.open();if(Rt!==null){Rt.document.write(Nt);var Ut=this;Rt.document.documentElement.querySelector("#pdfViewer").onload=function(){Rt.document.title=U.filename,Rt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ut.output("bloburl"))}}return Rt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Dt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",U)+'"></iframe></body></html>',wr=Dt.open();if(wr!==null&&(wr.document.write(Xt),wr.document.title=U.filename),wr||typeof safari>"u")return wr;break;case"datauri":case"dataurl":return Dt.document.location.href=this.output("datauristring",U);default:return null}},Pn.foo=function(){try{return Pn.apply(this,arguments)}catch(se){var w=se.stack||"";~w.indexOf(" at ")&&(w=w.split(" at ")[1]);var U="Error in function "+w.split(`
`)[0].split("<")[0]+": "+se.message;if(!Dt.console)throw new Error(U);Dt.console.error(U,se),Dt.alert&&alert(U)}},Pn.foo.bar=Pn,Pn.foo),ai=function(w){return Array.isArray(ma)===!0&&ma.indexOf(w)>-1};switch(n){case"pt":Ct=1;break;case"mm":Ct=72/25.4;break;case"cm":Ct=72/2.54;break;case"in":Ct=72;break;case"px":Ct=ai("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ct=12;break;case"ex":Ct=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Ct=n}var jr=null;ge(),xe();var Ao=h.__private__.getPageInfo=h.getPageInfo=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ut[w].objId,pageNumber:w,pageContext:ut[w]}},F0=h.__private__.getPageInfoByObjId=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var U in ut)if(ut[U].objId===w)break;return Ao(U)},P0=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:ut[O].objId,pageNumber:O,pageContext:ut[O]}};h.addPage=function(){return Oa.apply(this,arguments),this},h.setPage=function(){return Ia.apply(this,arguments),pe.call(this,ye[O]),this},h.insertPage=function(w){return this.addPage(),this.movePage(O,w),this},h.movePage=function(w,U){var se,fe;if(w>U){se=ye[w],fe=ut[w];for(var _e=w;_e>U;_e--)ye[_e]=ye[_e-1],ut[_e]=ut[_e-1];ye[U]=se,ut[U]=fe,this.setPage(U)}else if(w<U){se=ye[w],fe=ut[w];for(var He=w;He<U;He++)ye[He]=ye[He+1],ut[He]=ut[He+1];ye[U]=se,ut[U]=fe,this.setPage(U)}return this},h.deletePage=function(){return va.apply(this,arguments),this},h.__private__.text=h.text=function(w,U,se,fe,_e){var He,Ve,gt,Nt,Rt,Ut,Xt,wr,Br,lr=(fe=fe||{}).scope||this;if(typeof w=="number"&&typeof U=="number"&&(typeof se=="string"||Array.isArray(se))){var zr=se;se=U,U=w,w=zr}if(arguments[3]instanceof jt==0?(gt=arguments[4],Nt=arguments[5],nr(Xt=arguments[3])==="object"&&Xt!==null||(typeof gt=="string"&&(Nt=gt,gt=null),typeof Xt=="string"&&(Nt=Xt,Xt=null),typeof Xt=="number"&&(gt=Xt,Xt=null),fe={flags:Xt,angle:gt,align:Nt})):(T("The transform parameter of text() with a Matrix value"),Br=_e),isNaN(U)||isNaN(se)||w==null)throw new Error("Invalid arguments passed to jsPDF.text");if(w.length===0)return lr;var Ur,an="",ss=typeof fe.lineHeightFactor=="number"?fe.lineHeightFactor:ii,Ts=lr.internal.scaleFactor;function V0(hr){return hr=hr.split("	").join(Array(fe.TabLen||9).join(" ")),Wt(hr,Xt)}function Ul(hr){for(var fr,Tr=hr.concat(),Lr=[],cs=Tr.length;cs--;)typeof(fr=Tr.shift())=="string"?Lr.push(fr):Array.isArray(hr)&&(fr.length===1||fr[1]===void 0&&fr[2]===void 0)?Lr.push(fr[0]):Lr.push([fr[0],fr[1],fr[2]]);return Lr}function di(hr,fr){var Tr;if(typeof hr=="string")Tr=fr(hr)[0];else if(Array.isArray(hr)){for(var Lr,cs,zi=hr.concat(),Wa=[],Wo=zi.length;Wo--;)typeof(Lr=zi.shift())=="string"?Wa.push(fr(Lr)[0]):Array.isArray(Lr)&&typeof Lr[0]=="string"&&(cs=fr(Lr[0],Lr[1],Lr[2]),Wa.push([cs[0],cs[1],cs[2]]));Tr=Wa}return Tr}var ba=!1,Io=!0;if(typeof w=="string")ba=!0;else if(Array.isArray(w)){var Mi=w.concat();Ve=[];for(var Ls,Zr=Mi.length;Zr--;)(typeof(Ls=Mi.shift())!="string"||Array.isArray(Ls)&&typeof Ls[0]!="string")&&(Io=!1);ba=Io}if(ba===!1)throw new Error('Type of text must be string or Array. "'+w+'" is not recognized.');typeof w=="string"&&(w=w.match(/[\r?\n]/)?w.split(/\r\n|\r|\n/g):[w]);var is=qe/lr.internal.scaleFactor,os=is*(ss-1);switch(fe.baseline){case"bottom":se-=os;break;case"top":se+=is-os;break;case"hanging":se+=is-2*os;break;case"middle":se+=is/2-os}if((Ut=fe.maxWidth||0)>0&&(typeof w=="string"?w=lr.splitTextToSize(w,Ut):Object.prototype.toString.call(w)==="[object Array]"&&(w=w.reduce(function(hr,fr){return hr.concat(lr.splitTextToSize(fr,Ut))},[]))),He={text:w,x:U,y:se,options:fe,mutex:{pdfEscape:Wt,activeFontKey:wt,fonts:Te,activeFontSize:qe}},Lt.publish("preProcessText",He),w=He.text,gt=(fe=He.options).angle,Br instanceof jt==0&&gt&&typeof gt=="number"){gt*=Math.PI/180,fe.rotationDirection===0&&(gt=-gt),j===S&&(gt=-gt);var Bi=Math.cos(gt),Mo=Math.sin(gt);Br=new jt(Bi,Mo,-Mo,Bi,0,0)}else gt&&gt instanceof jt&&(Br=gt);j!==S||Br||(Br=xa),(Rt=fe.charSpace||Oi)!==void 0&&(an+=F(H(Rt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(wr=fe.horizontalScale)!==void 0&&(an+=F(100*wr)+` Tz
`),fe.lang;var En=-1,Hl=fe.renderingMode!==void 0?fe.renderingMode:fe.stroke,Ui=lr.internal.getCurrentPageInfo().pageContext;switch(Hl){case 0:case!1:case"fill":En=0;break;case 1:case!0:case"stroke":En=1;break;case 2:case"fillThenStroke":En=2;break;case 3:case"invisible":En=3;break;case 4:case"fillAndAddForClipping":En=4;break;case 5:case"strokeAndAddPathForClipping":En=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":En=6;break;case 7:case"addToPathForClipping":En=7}var $l=Ui.usedRenderingMode!==void 0?Ui.usedRenderingMode:-1;En!==-1?an+=En+` Tr
`:$l!==-1&&(an+=`0 Tr
`),En!==-1&&(Ui.usedRenderingMode=En),Nt=fe.align||"left";var Vr,sa=qe*ss,Bo=lr.internal.pageSize.getWidth(),Uo=Te[wt];Rt=fe.charSpace||Oi,Ut=fe.maxWidth||0,Xt=Object.assign({autoencode:!0,noBOM:!0},fe.flags);var Fs=[],Hi=function(hr){return lr.getStringUnitWidth(hr,{font:Uo,charSpace:Rt,fontSize:qe,doKerning:!1})*qe/Ts};if(Object.prototype.toString.call(w)==="[object Array]"){var Rn;Ve=Ul(w),Nt!=="left"&&(Vr=Ve.map(Hi));var Dn,hi=0;if(Nt==="right"){U-=Vr[0],w=[],Zr=Ve.length;for(var Ua=0;Ua<Zr;Ua++)Ua===0?(Dn=ns(U),Rn=as(se)):(Dn=H(hi-Vr[Ua]),Rn=-sa),w.push([Ve[Ua],Dn,Rn]),hi=Vr[Ua]}else if(Nt==="center"){U-=Vr[0]/2,w=[],Zr=Ve.length;for(var Ps=0;Ps<Zr;Ps++)Ps===0?(Dn=ns(U),Rn=as(se)):(Dn=H((hi-Vr[Ps])/2),Rn=-sa),w.push([Ve[Ps],Dn,Rn]),hi=Vr[Ps]}else if(Nt==="left"){w=[],Zr=Ve.length;for(var Ho=0;Ho<Zr;Ho++)w.push(Ve[Ho])}else if(Nt==="justify"&&Uo.encoding==="Identity-H"){w=[],Zr=Ve.length,Ut=Ut!==0?Ut:Bo;for(var Rs=0,kr=0;kr<Zr;kr++)if(Rn=kr===0?as(se):-sa,Dn=kr===0?ns(U):Rs,kr<Zr-1){var G0=H((Ut-Vr[kr])/(Ve[kr].split(" ").length-1)),Ha=Ve[kr].split(" ");w.push([Ha[0]+" ",Dn,Rn]),Rs=0;for(var $a=1;$a<Ha.length;$a++){var $i=(Hi(Ha[$a-1]+" "+Ha[$a])-Hi(Ha[$a]))*Ts+G0;$a==Ha.length-1?w.push([Ha[$a],$i,0]):w.push([Ha[$a]+" ",$i,0]),Rs-=$i}}else w.push([Ve[kr],Dn,Rn]);w.push(["",Rs,0])}else{if(Nt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(w=[],Zr=Ve.length,Ut=Ut!==0?Ut:Bo,kr=0;kr<Zr;kr++)Rn=kr===0?as(se):-sa,Dn=kr===0?ns(U):0,kr<Zr-1?Fs.push(F(H((Ut-Vr[kr])/(Ve[kr].split(" ").length-1)))):Fs.push(0),w.push([Ve[kr],Dn,Rn])}}(typeof fe.R2L=="boolean"?fe.R2L:Pt)===!0&&(w=di(w,function(hr,fr,Tr){return[hr.split("").reverse().join(""),fr,Tr]})),He={text:w,x:U,y:se,options:fe,mutex:{pdfEscape:Wt,activeFontKey:wt,fonts:Te,activeFontSize:qe}},Lt.publish("postProcessText",He),w=He.text,Ur=He.mutex.isHex||!1;var $o=Te[wt].encoding;$o!=="WinAnsiEncoding"&&$o!=="StandardEncoding"||(w=di(w,function(hr,fr,Tr){return[V0(hr),fr,Tr]})),Ve=Ul(w),w=[];for(var qi,Wi,fi,mi=Array.isArray(Ve[0])?1:0,ls="",qo=function(hr,fr,Tr){var Lr="";return Tr instanceof jt?(Tr=typeof fe.angle=="number"?ga(Tr,new jt(1,0,0,1,hr,fr)):ga(new jt(1,0,0,1,hr,fr),Tr),j===S&&(Tr=ga(new jt(1,0,0,-1,0,0),Tr)),Lr=Tr.join(" ")+` Tm
`):Lr=F(hr)+" "+F(fr)+` Td
`,Lr},qn=0;qn<Ve.length;qn++){switch(ls="",mi){case 1:fi=(Ur?"<":"(")+Ve[qn][0]+(Ur?">":")"),qi=parseFloat(Ve[qn][1]),Wi=parseFloat(Ve[qn][2]);break;case 0:fi=(Ur?"<":"(")+Ve[qn]+(Ur?">":")"),qi=ns(U),Wi=as(se)}Fs!==void 0&&Fs[qn]!==void 0&&(ls=Fs[qn]+` Tw
`),qn===0?w.push(ls+qo(qi,Wi,Br)+fi):mi===0?w.push(ls+fi):mi===1&&w.push(ls+qo(qi,Wi,Br)+fi)}w=mi===0?w.join(` Tj
T* `):w.join(` Tj
`),w+=` Tj
`;var qa=`BT
/`;return qa+=wt+" "+qe+` Tf
`,qa+=F(qe*ss)+` TL
`,qa+=oi+`
`,qa+=an,qa+=w,ee(qa+="ET"),g[wt]=!0,lr};var R0=h.__private__.clip=h.clip=function(w){return ee(w==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return R0("evenodd")},h.__private__.discardPath=h.discardPath=function(){return ee("n"),this};var Ma=h.__private__.isValidStyle=function(w){var U=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(w)!==-1&&(U=!0),U};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(w){return Ma(w)&&(u=w),this};var Ml=h.__private__.getStyle=h.getStyle=function(w){var U=u;switch(w){case"D":case"S":U="S";break;case"F":U="f";break;case"FD":case"DF":U="B";break;case"f":case"f*":case"B":case"B*":U=w}return U},Bl=h.close=function(){return ee("h"),this};h.stroke=function(){return ee("S"),this},h.fill=function(w){return js("f",w),this},h.fillEvenOdd=function(w){return js("f*",w),this},h.fillStroke=function(w){return js("B",w),this},h.fillStrokeEvenOdd=function(w){return js("B*",w),this};var js=function(w,U){nr(U)==="object"?O0(U,w):ee(w)},Co=function(w){w===null||j===S&&w===void 0||(w=Ml(w),ee(w))};function D0(w,U,se,fe,_e){var He=new ro(U||this.boundingBox,se||this.xStep,fe||this.yStep,this.gState,_e||this.matrix);He.stream=this.stream;var Ve=w+"$$"+this.cloneIndex+++"$$";return gn(Ve,He),He}var O0=function(w,U){var se=Ue[w.key],fe=Xe[se];if(fe instanceof vi)ee("q"),ee(I0(U)),fe.gState&&h.setGState(fe.gState),ee(w.matrix.toString()+" cm"),ee("/"+se+" sh"),ee("Q");else if(fe instanceof ro){var _e=new jt(1,0,0,-1,0,$n());w.matrix&&(_e=_e.multiply(w.matrix||xa),se=D0.call(fe,w.key,w.boundingBox,w.xStep,w.yStep,_e).id),ee("q"),ee("/Pattern cs"),ee("/"+se+" scn"),fe.gState&&h.setGState(fe.gState),ee(U),ee("Q")}},I0=function(w){switch(w){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},jo=h.moveTo=function(w,U){return ee(F(H(w))+" "+F(K(U))+" m"),this},si=h.lineTo=function(w,U){return ee(F(H(w))+" "+F(K(U))+" l"),this},ks=h.curveTo=function(w,U,se,fe,_e,He){return ee([F(H(w)),F(K(U)),F(H(se)),F(K(fe)),F(H(_e)),F(K(He)),"c"].join(" ")),this};h.__private__.line=h.line=function(w,U,se,fe,_e){if(isNaN(w)||isNaN(U)||isNaN(se)||isNaN(fe)||!Ma(_e))throw new Error("Invalid arguments passed to jsPDF.line");return j===_?this.lines([[se-w,fe-U]],w,U,[1,1],_e||"S"):this.lines([[se-w,fe-U]],w,U,[1,1]).stroke()},h.__private__.lines=h.lines=function(w,U,se,fe,_e,He){var Ve,gt,Nt,Rt,Ut,Xt,wr,Br,lr,zr,Ur,an;if(typeof w=="number"&&(an=se,se=U,U=w,w=an),fe=fe||[1,1],He=He||!1,isNaN(U)||isNaN(se)||!Array.isArray(w)||!Array.isArray(fe)||!Ma(_e)||typeof He!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(jo(U,se),Ve=fe[0],gt=fe[1],Rt=w.length,zr=U,Ur=se,Nt=0;Nt<Rt;Nt++)(Ut=w[Nt]).length===2?(zr=Ut[0]*Ve+zr,Ur=Ut[1]*gt+Ur,si(zr,Ur)):(Xt=Ut[0]*Ve+zr,wr=Ut[1]*gt+Ur,Br=Ut[2]*Ve+zr,lr=Ut[3]*gt+Ur,zr=Ut[4]*Ve+zr,Ur=Ut[5]*gt+Ur,ks(Xt,wr,Br,lr,zr,Ur));return He&&Bl(),Co(_e),this},h.path=function(w){for(var U=0;U<w.length;U++){var se=w[U],fe=se.c;switch(se.op){case"m":jo(fe[0],fe[1]);break;case"l":si(fe[0],fe[1]);break;case"c":ks.apply(this,fe);break;case"h":Bl()}}return this},h.__private__.rect=h.rect=function(w,U,se,fe,_e){if(isNaN(w)||isNaN(U)||isNaN(se)||isNaN(fe)||!Ma(_e))throw new Error("Invalid arguments passed to jsPDF.rect");return j===_&&(fe=-fe),ee([F(H(w)),F(K(U)),F(H(se)),F(H(fe)),"re"].join(" ")),Co(_e),this},h.__private__.triangle=h.triangle=function(w,U,se,fe,_e,He,Ve){if(isNaN(w)||isNaN(U)||isNaN(se)||isNaN(fe)||isNaN(_e)||isNaN(He)||!Ma(Ve))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[se-w,fe-U],[_e-se,He-fe],[w-_e,U-He]],w,U,[1,1],Ve,!0),this},h.__private__.roundedRect=h.roundedRect=function(w,U,se,fe,_e,He,Ve){if(isNaN(w)||isNaN(U)||isNaN(se)||isNaN(fe)||isNaN(_e)||isNaN(He)||!Ma(Ve))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var gt=4/3*(Math.SQRT2-1);return _e=Math.min(_e,.5*se),He=Math.min(He,.5*fe),this.lines([[se-2*_e,0],[_e*gt,0,_e,He-He*gt,_e,He],[0,fe-2*He],[0,He*gt,-_e*gt,He,-_e,He],[2*_e-se,0],[-_e*gt,0,-_e,-He*gt,-_e,-He],[0,2*He-fe],[0,-He*gt,_e*gt,-He,_e,-He]],w+_e,U,[1,1],Ve,!0),this},h.__private__.ellipse=h.ellipse=function(w,U,se,fe,_e){if(isNaN(w)||isNaN(U)||isNaN(se)||isNaN(fe)||!Ma(_e))throw new Error("Invalid arguments passed to jsPDF.ellipse");var He=4/3*(Math.SQRT2-1)*se,Ve=4/3*(Math.SQRT2-1)*fe;return jo(w+se,U),ks(w+se,U-Ve,w+He,U-fe,w,U-fe),ks(w-He,U-fe,w-se,U-Ve,w-se,U),ks(w-se,U+Ve,w-He,U+fe,w,U+fe),ks(w+He,U+fe,w+se,U+Ve,w+se,U),Co(_e),this},h.__private__.circle=h.circle=function(w,U,se,fe){if(isNaN(w)||isNaN(U)||isNaN(se)||!Ma(fe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(w,U,se,se,fe)},h.setFont=function(w,U,se){return se&&(U=k(U,se)),wt=Cs(w,U,{disableWarning:!1}),this};var M0=h.__private__.getFont=h.getFont=function(){return Te[Cs.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var w,U,se={};for(w in Ge)if(Ge.hasOwnProperty(w))for(U in se[w]=[],Ge[w])Ge[w].hasOwnProperty(U)&&se[w].push(U);return se},h.addFont=function(w,U,se,fe,_e){var He=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&He.indexOf(arguments[3])!==-1?_e=arguments[3]:arguments[3]&&He.indexOf(arguments[3])==-1&&(se=k(se,fe)),or.call(this,w,U,se,_e=_e||"Identity-H")};var ii,ko=r.lineWidth||.200025,It=h.__private__.getLineWidth=h.getLineWidth=function(){return ko},B0=h.__private__.setLineWidth=h.setLineWidth=function(w){return ko=w,ee(F(H(w))+" w"),this};h.__private__.setLineDash=_t.API.setLineDash=_t.API.setLineDashPattern=function(w,U){if(w=w||[],U=U||0,isNaN(U)||!Array.isArray(w))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return w=w.map(function(se){return F(H(se))}).join(" "),U=F(H(U)),ee("["+w+"] "+U+" d"),this};var U0=h.__private__.getLineHeight=h.getLineHeight=function(){return qe*ii};h.__private__.getLineHeight=h.getLineHeight=function(){return qe*ii};var H0=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(w){return typeof(w=w||1.15)=="number"&&(ii=w),this},$0=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return ii};H0(r.lineHeight);var ns=h.__private__.getHorizontalCoordinate=function(w){return H(w)},as=h.__private__.getVerticalCoordinate=function(w){return j===S?w:ut[O].mediaBox.topRightY-ut[O].mediaBox.bottomLeftY-H(w)},q0=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(w){return F(ns(w))},W0=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(w){return F(as(w))},Ri=r.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ae(Ri)},h.__private__.setStrokeColor=h.setDrawColor=function(w,U,se,fe){return Ri=ie({ch1:w,ch2:U,ch3:se,ch4:fe,pdfColorType:"draw",precision:2}),ee(Ri),this};var To=r.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ae(To)},h.__private__.setFillColor=h.setFillColor=function(w,U,se,fe){return To=ie({ch1:w,ch2:U,ch3:se,ch4:fe,pdfColorType:"fill",precision:2}),ee(To),this};var oi=r.textColor||"0 g",Di=h.__private__.getTextColor=h.getTextColor=function(){return ae(oi)};h.__private__.setTextColor=h.setTextColor=function(w,U,se,fe){return oi=ie({ch1:w,ch2:U,ch3:se,ch4:fe,pdfColorType:"text",precision:3}),this};var Oi=r.charSpace,z0=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Oi||0)};h.__private__.setCharSpace=h.setCharSpace=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Oi=w,this};var Lo=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(w){var U=h.CapJoinStyles[w];if(U===void 0)throw new Error("Line cap style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Lo=U,ee(U+" J"),this};var Fo=0;h.__private__.setLineJoin=h.setLineJoin=function(w){var U=h.CapJoinStyles[w];if(U===void 0)throw new Error("Line join style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Fo=U,ee(U+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(w){if(w=w||0,isNaN(w))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ee(F(H(w))+" M"),this},h.GState=Kc,h.setGState=function(w){(w=typeof w=="string"?Ke[ct[w]]:li(null,w)).equals(ht)||(ee("/"+w.id+" gs"),ht=w)};var li=function(w,U){if(!w||!ct[w]){var se=!1;for(var fe in Ke)if(Ke.hasOwnProperty(fe)&&Ke[fe].equals(U)){se=!0;break}if(se)U=Ke[fe];else{var _e="GS"+(Object.keys(Ke).length+1).toString(10);Ke[_e]=U,U.id=_e}return w&&(ct[w]=U.id),Lt.publish("addGState",U),U}};h.addGState=function(w,U){return li(w,U),this},h.saveGraphicsState=function(){return ee("q"),it.push({key:wt,size:qe,color:oi}),this},h.restoreGraphicsState=function(){ee("Q");var w=it.pop();return wt=w.key,qe=w.size,oi=w.color,ht=null,this},h.setCurrentTransformationMatrix=function(w){return ee(w.toString()+" cm"),this},h.comment=function(w){return ee("#"+w),this};var ci=function(w,U){var se=w||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return se},set:function(He){isNaN(He)||(se=parseFloat(He))}});var fe=U||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return fe},set:function(He){isNaN(He)||(fe=parseFloat(He))}});var _e="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return _e},set:function(He){_e=He.toString()}}),this},Po=function(w,U,se,fe){ci.call(this,w,U),this.type="rect";var _e=se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return _e},set:function(Ve){isNaN(Ve)||(_e=parseFloat(Ve))}});var He=fe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return He},set:function(Ve){isNaN(Ve)||(He=parseFloat(Ve))}}),this},Ii=function(){this.page=Et,this.currentPage=O,this.pages=ye.slice(0),this.pagesContext=ut.slice(0),this.x=vt,this.y=de,this.matrix=Me,this.width=Do(O),this.height=$n(O),this.outputDestination=Ie,this.id="",this.objectNumber=-1};Ii.prototype.restore=function(){Et=this.page,O=this.currentPage,ut=this.pagesContext,ye=this.pages,vt=this.x,de=this.y,Me=this.matrix,Oo(O,this.width),Ba(O,this.height),Ie=this.outputDestination};var Ro=function(w,U,se,fe,_e){na.push(new Ii),Et=O=0,ye=[],vt=w,de=U,Me=_e,_r([se,fe])};for(var ui in h.beginFormObject=function(w,U,se,fe,_e){return Ro(w,U,se,fe,_e),this},h.endFormObject=function(w){return function(U){if(pa[U])na.pop().restore();else{var se=new Ii,fe="Xo"+(Object.keys(Jr).length+1).toString(10);se.id=fe,pa[U]=fe,Jr[fe]=se,Lt.publish("addFormObject",se),na.pop().restore()}}(w),this},h.doFormObject=function(w,U){var se=Jr[pa[w]];return ee("q"),ee(U.toString()+" cm"),ee("/"+se.id+" Do"),ee("Q"),this},h.getFormObject=function(w){var U=Jr[pa[w]];return{x:U.x,y:U.y,width:U.width,height:U.height,matrix:U.matrix}},h.save=function(w,U){return w=w||"generated.pdf",(U=U||{}).returnPromise=U.returnPromise||!1,U.returnPromise===!1?(gi(ni(rs()),w),typeof gi.unload=="function"&&Dt.setTimeout&&setTimeout(gi.unload,911),this):new Promise(function(se,fe){try{var _e=gi(ni(rs()),w);typeof gi.unload=="function"&&Dt.setTimeout&&setTimeout(gi.unload,911),se(_e)}catch(He){fe(He.message)}})},_t.API)_t.API.hasOwnProperty(ui)&&(ui==="events"&&_t.API.events.length?function(w,U){var se,fe,_e;for(_e=U.length-1;_e!==-1;_e--)se=U[_e][0],fe=U[_e][1],w.subscribe.apply(w,[se].concat(typeof fe=="function"?[fe]:fe))}(Lt,_t.API.events):h[ui]=_t.API[ui]);var Do=h.getPageWidth=function(w){return(ut[w=w||O].mediaBox.topRightX-ut[w].mediaBox.bottomLeftX)/Ct},Oo=h.setPageWidth=function(w,U){ut[w].mediaBox.topRightX=U*Ct+ut[w].mediaBox.bottomLeftX},$n=h.getPageHeight=function(w){return(ut[w=w||O].mediaBox.topRightY-ut[w].mediaBox.bottomLeftY)/Ct},Ba=h.setPageHeight=function(w,U){ut[w].mediaBox.topRightY=U*Ct+ut[w].mediaBox.bottomLeftY};return h.internal={pdfEscape:Wt,getStyle:Ml,getFont:M0,getFontSize:rt,getCharSpace:z0,getTextColor:Di,getLineHeight:U0,getLineHeightFactor:$0,getLineWidth:It,write:lt,getHorizontalCoordinate:ns,getVerticalCoordinate:as,getCoordinateString:q0,getVerticalCoordinateString:W0,collections:{},newObject:vr,newAdditionalObject:ne,newObjectDeferred:Ir,newObjectDeferredBegin:q,getFilters:Se,putStream:Fe,events:Lt,scaleFactor:Ct,pageSize:{getWidth:function(){return Do(O)},setWidth:function(w){Oo(O,w)},getHeight:function(){return $n(O)},setHeight:function(w){Ba(O,w)}},encryptionOptions:d,encryption:jr,getEncryptor:function(w){return d!==null?jr.encryptor(w,0):function(U){return U}},output:ya,getNumberOfPages:aa,pages:ye,out:ee,f2:A,f3:P,getPageInfo:Ao,getPageInfoByObjId:F0,getCurrentPageInfo:P0,getPDFVersion:x,Point:ci,Rectangle:Po,Matrix:jt,hasHotfix:ai},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Do(O)},set:function(w){Oo(O,w)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return $n(O)},set:function(w){Ba(O,w)},enumerable:!0,configurable:!0}),(function(w){for(var U=0,se=at.length;U<se;U++){var fe=or.call(this,w[U][0],w[U][1],w[U][2],at[U][3],!0);p===!1&&(g[fe]=!0);var _e=w[U][0].split("-");Ft({id:fe,fontName:_e[0],fontStyle:_e[1]||""})}Lt.publish("addFonts",{fonts:Te,dictionary:Ge})}).call(h,at),wt="F1",Oa(a,t),Lt.publish("initialized"),h}Qi.prototype.lsbFirstWord=function(r){return String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255)},Qi.prototype.toHexString=function(r){return r.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Qi.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},Qi.prototype.processOwnerPassword=function(r,e){return od(id(e).substr(0,5),r)},Qi.prototype.encryptor=function(r,e){var t=id(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return od(t,n)}},Kc.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||nr(r)!==nr(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;n++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},_t.API={events:[]},_t.version="3.0.2";var Er=_t.API,Ud=1,ji=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ki=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Mt=function(r){return r.toFixed(2)},qs=function(r){return r.toFixed(5)};Er.__acroform__={};var Hn=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},dm=function(r){return r*Ud},Va=function(r){var e=new q1,t=pt.internal.getHeight(r)||0,n=pt.internal.getWidth(r)||0;return e.BBox=[0,0,Number(Mt(n)),Number(Mt(t))],e},l4=Er.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|1<<e},c4=Er.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&~(1<<e)},u4=Er.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<e?1:0},Rr=Er.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return u4(r,e-1)},Dr=Er.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return l4(r,e-1)},Or=Er.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return c4(r,e-1)},d4=Er.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,a=r[0],s=r[1],o=r[2],l=r[3],c={};return c.lowerLeft_X=t(a)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=t(a+o)||0,c.upperRight_Y=n(s)||0,[Number(Mt(c.lowerLeft_X)),Number(Mt(c.lowerLeft_Y)),Number(Mt(c.upperRight_X)),Number(Mt(c.upperRight_Y))]},h4=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,n=ld(r,t),a=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+a+" "+Mt(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Va(r);return s.scope=r.scope,s.stream=e.join(`
`),s}},ld=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=r.multiline?a.map(function(A){return A.split(`
`)}):a.map(function(A){return[A]});var s=t,o=pt.internal.getHeight(r)||0;o=o<0?-o:o;var l=pt.internal.getWidth(r)||0;l=l<0?-l:l;var c=function(A,P,H){if(A+1<a.length){var K=P+" "+a[A+1][0];return pc(K,r,H).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var u,d,p=pc("3",r,s).height,g=r.multiline?o-s:(o-p)/2,h=g+=2,b=0,x=0,y=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+pc(e,r,s=12).width+", FieldWidth:"+l+`
`;break}for(var v="",_=0,S=0;S<a.length;S++)if(a.hasOwnProperty(S)){var j=!1;if(a[S].length!==1&&y!==a[S].length-1){if((p+2)*(_+2)+2>o)continue e;v+=a[S][y],j=!0,x=S,S--}else{v=(v+=a[S][y]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var I=parseInt(S),J=c(I,v,s),k=S>=a.length-1;if(J&&!k){v+=" ",y=0;continue}if(J||k){if(k)x=I;else if(r.multiline&&(p+2)*(_+2)+2>o)continue e}else{if(!r.multiline||(p+2)*(_+2)+2>o)continue e;x=I}}for(var F="",T=b;T<=x;T++){var R=a[T];if(r.multiline){if(T===x){F+=R[y]+" ",y=(y+1)%R.length;continue}if(T===b){F+=R[R.length-1]+" ";continue}}F+=R[0]+" "}switch(F=F.substr(F.length-1)==" "?F.substr(0,F.length-1):F,d=pc(F,r,s).width,r.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}e+=Mt(u)+" "+Mt(h)+` Td
`,e+="("+ji(F)+`) Tj
`,e+=-Mt(u)+` 0 Td
`,h=-(s+2),d=0,b=j?x:x+1,_++,v=""}break}return n.text=e,n.fontSize=s,n},pc=function(r,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:a}},f4={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},m4=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},p4=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(Ra.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(f4)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Ud=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new W1,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&m4(s,t)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(t){(function(n,a){var s=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=d4(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=pt.createDefaultAppearanceStream(l),nr(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=h4(l);c.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var p="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var h=l.appearanceStreamContent[g];if(p+="/"+g+" ",p+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var b=h[o];typeof b=="function"&&(b=b.call(a,l)),p+="/"+o+" "+b+" ",a.internal.acroformPlugin.xForms.indexOf(b)>=0||a.internal.acroformPlugin.xForms.push(b)}}else typeof(b=h)=="function"&&(b=b.call(a,l)),p+="/"+o+" "+b,a.internal.acroformPlugin.xForms.indexOf(b)>=0||a.internal.acroformPlugin.xForms.push(b);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}s&&function(x,y){for(var v in x)if(x.hasOwnProperty(v)){var _=v,S=x[v];y.internal.newObjectDeferredBegin(S.objId,!0),nr(S)==="object"&&typeof S.putStream=="function"&&S.putStream(),delete x[_]}}(a.internal.acroformPlugin.xForms,a)})(t,r)}),r.internal.acroformPlugin.isInitialized=!0}},$1=Er.__acroform__.arrayToPdfArray=function(r,e,t){var n=function(o){return o};if(Array.isArray(r)){for(var a="[",s=0;s<r.length;s++)switch(s!==0&&(a+=" "),nr(r[s])){case"boolean":case"number":case"object":a+=r[s].toString();break;case"string":r[s].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),a+="("+ji(n(r[s].toString()))+")"):a+=r[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Fu=function(r,e,t){var n=function(a){return a};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(r=r||"").toString(),"("+ji(n(r))+")"},Za=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Za.prototype.toString=function(){return this.objId+" 0 R"},Za.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Za.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],a=this[n];a&&(Array.isArray(a)?r.push({key:n,value:$1(a,this.objId,this.scope)}):a instanceof Za?(a.scope=this.scope,r.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&r.push({key:n,value:a}))}return r};var q1=function(){Za.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};Hn(q1,Za);var W1=function(){Za.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+ji(t(r))+")"}},set:function(t){r=t}})};Hn(W1,Za);var Ra=function r(){Za.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Rr(e,3)},set:function(v){v?this.F=Dr(e,3):this.F=Or(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');t=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Yc)return;s="FieldObject"+r.FieldNum++}var v=function(_){return _};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+ji(v(s))+")"},set:function(v){s=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(v){s=v}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/Ud:u},set:function(v){u=v}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(v){d=v}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof Yc||this instanceof bi))return Fu(p,this.objId,this.scope)},set:function(v){v=v.toString(),p=v}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Qr==0?Fu(g,this.objId,this.scope):g},set:function(v){v=v.toString(),g=this instanceof Qr==0?v.substr(0,1)==="("?Ki(v.substr(1,v.length-2)):Ki(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qr==1?Ki(g.substr(1,g.length-1)):g},set:function(v){v=v.toString(),g=this instanceof Qr==1?"/"+v:v}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Qr==0?Fu(h,this.objId,this.scope):h},set:function(v){v=v.toString(),h=this instanceof Qr==0?v.substr(0,1)==="("?Ki(v.substr(1,v.length-2)):Ki(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qr==1?Ki(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof Qr==1?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(v){v=!!v,x=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(v){b=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,1)},set:function(v){v?this.Ff=Dr(this.Ff,1):this.Ff=Or(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,2)},set:function(v){v?this.Ff=Dr(this.Ff,2):this.Ff=Or(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,3)},set:function(v){v?this.Ff=Dr(this.Ff,3):this.Ff=Or(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');y=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(y){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Hn(Ra,Za);var so=function(){Ra.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return $1(e,this.objId,this.scope)},set:function(t){var n,a;a=[],typeof(n=t)=="string"&&(a=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,18)},set:function(t){t?this.Ff=Dr(this.Ff,18):this.Ff=Or(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Dr(this.Ff,19):this.Ff=Or(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,20)},set:function(t){t?(this.Ff=Dr(this.Ff,20),e.sort()):this.Ff=Or(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,22)},set:function(t){t?this.Ff=Dr(this.Ff,22):this.Ff=Or(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,23)},set:function(t){t?this.Ff=Dr(this.Ff,23):this.Ff=Or(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,27)},set:function(t){t?this.Ff=Dr(this.Ff,27):this.Ff=Or(this.Ff,27)}}),this.hasAppearanceStream=!1};Hn(so,Ra);var io=function(){so.call(this),this.fontName="helvetica",this.combo=!1};Hn(io,so);var oo=function(){io.call(this),this.combo=!0};Hn(oo,io);var Rc=function(){oo.call(this),this.edit=!0};Hn(Rc,oo);var Qr=function(){Ra.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,15)},set:function(t){t?this.Ff=Dr(this.Ff,15):this.Ff=Or(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,16)},set:function(t){t?this.Ff=Dr(this.Ff,16):this.Ff=Or(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,17)},set:function(t){t?this.Ff=Dr(this.Ff,17):this.Ff=Or(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,26)},set:function(t){t?this.Ff=Dr(this.Ff,26):this.Ff=Or(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,a=[];for(n in a.push("<<"),e)a.push("/"+n+" ("+ji(t(e[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(t){nr(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};Hn(Qr,Ra);var Dc=function(){Qr.call(this),this.pushButton=!0};Hn(Dc,Qr);var lo=function(){Qr.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};Hn(lo,Qr);var Yc=function(){var r,e;Ra.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+ji(a(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){nr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(a){t="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=pt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Hn(Yc,Ra),lo.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},lo.prototype.createOption=function(r){var e=new Yc;return e.Parent=this,e.optionName=r,this.Kids.push(e),g4.call(this.scope,e),e};var Oc=function(){Qr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=pt.CheckBox.createAppearanceStream()};Hn(Oc,Qr);var bi=function(){Ra.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,13)},set:function(e){e?this.Ff=Dr(this.Ff,13):this.Ff=Or(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,21)},set:function(e){e?this.Ff=Dr(this.Ff,21):this.Ff=Or(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,23)},set:function(e){e?this.Ff=Dr(this.Ff,23):this.Ff=Or(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,24)},set:function(e){e?this.Ff=Dr(this.Ff,24):this.Ff=Or(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,25)},set:function(e){e?this.Ff=Dr(this.Ff,25):this.Ff=Or(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,26)},set:function(e){e?this.Ff=Dr(this.Ff,26):this.Ff=Or(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Hn(bi,Ra);var Ic=function(){bi.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Rr(this.Ff,14)},set:function(r){r?this.Ff=Dr(this.Ff,14):this.Ff=Or(this.Ff,14)}}),this.password=!0};Hn(Ic,bi);var pt={CheckBox:{createAppearanceStream:function(){return{N:{On:pt.CheckBox.YesNormal},D:{On:pt.CheckBox.YesPushDown,Off:pt.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=Va(r);e.scope=r.scope;var t=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,a=r.scope.__private__.encodeColorString(r.color),s=ld(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+Mt(pt.internal.getWidth(r))+" "+Mt(pt.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+Mt(s.fontSize)+" Tf "+a),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=Va(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),a=[],s=pt.internal.getHeight(r),o=pt.internal.getWidth(r),l=ld(r,r.caption);return a.push("1 g"),a.push("0 0 "+Mt(o)+" "+Mt(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Mt(o-1)+" "+Mt(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+t+" "+Mt(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(r){var e=Va(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Mt(pt.internal.getWidth(r))+" "+Mt(pt.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:pt.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=pt.RadioButton.Circle.YesNormal,e.D[r]=pt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=Va(r);e.scope=r.scope;var t=[],n=pt.internal.getWidth(r)<=pt.internal.getHeight(r)?pt.internal.getWidth(r)/4:pt.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=pt.internal.Bezier_C,s=Number((n*a).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+qs(pt.internal.getWidth(r)/2)+" "+qs(pt.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),t.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),t.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),t.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Va(r);e.scope=r.scope;var t=[],n=pt.internal.getWidth(r)<=pt.internal.getHeight(r)?pt.internal.getWidth(r)/4:pt.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*pt.internal.Bezier_C).toFixed(5)),o=Number((n*pt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+qs(pt.internal.getWidth(r)/2)+" "+qs(pt.internal.getHeight(r)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),t.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),t.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),t.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+qs(pt.internal.getWidth(r)/2)+" "+qs(pt.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),t.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),t.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),t.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=Va(r);e.scope=r.scope;var t=[],n=pt.internal.getWidth(r)<=pt.internal.getHeight(r)?pt.internal.getWidth(r)/4:pt.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*pt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+qs(pt.internal.getWidth(r)/2)+" "+qs(pt.internal.getHeight(r)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),t.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),t.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),t.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:pt.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=pt.RadioButton.Cross.YesNormal,e.D[r]=pt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=Va(r);e.scope=r.scope;var t=[],n=pt.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+Mt(pt.internal.getWidth(r)-2)+" "+Mt(pt.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(Mt(n.x1.x)+" "+Mt(n.x1.y)+" m"),t.push(Mt(n.x2.x)+" "+Mt(n.x2.y)+" l"),t.push(Mt(n.x4.x)+" "+Mt(n.x4.y)+" m"),t.push(Mt(n.x3.x)+" "+Mt(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Va(r);e.scope=r.scope;var t=pt.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+Mt(pt.internal.getWidth(r))+" "+Mt(pt.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Mt(pt.internal.getWidth(r)-2)+" "+Mt(pt.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(Mt(t.x1.x)+" "+Mt(t.x1.y)+" m"),n.push(Mt(t.x2.x)+" "+Mt(t.x2.y)+" l"),n.push(Mt(t.x4.x)+" "+Mt(t.x4.y)+" m"),n.push(Mt(t.x3.x)+" "+Mt(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=Va(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Mt(pt.internal.getWidth(r))+" "+Mt(pt.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};pt.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=pt.internal.getWidth(r),t=pt.internal.getHeight(r),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},pt.internal.getWidth=function(r){var e=0;return nr(r)==="object"&&(e=dm(r.Rect[2])),e},pt.internal.getHeight=function(r){var e=0;return nr(r)==="object"&&(e=dm(r.Rect[3])),e};var g4=Er.addField=function(r){if(p4(this,r),!(r instanceof Ra))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};Er.AcroFormChoiceField=so,Er.AcroFormListBox=io,Er.AcroFormComboBox=oo,Er.AcroFormEditBox=Rc,Er.AcroFormButton=Qr,Er.AcroFormPushButton=Dc,Er.AcroFormRadioButton=lo,Er.AcroFormCheckBox=Oc,Er.AcroFormTextField=bi,Er.AcroFormPasswordField=Ic,Er.AcroFormAppearance=pt,Er.AcroForm={ChoiceField:so,ListBox:io,ComboBox:oo,EditBox:Rc,Button:Qr,PushButton:Dc,RadioButton:lo,CheckBox:Oc,TextField:bi,PasswordField:Ic,Appearance:pt},_t.AcroForm={ChoiceField:so,ListBox:io,ComboBox:oo,EditBox:Rc,Button:Qr,PushButton:Dc,RadioButton:lo,CheckBox:Oc,TextField:bi,PasswordField:Ic,Appearance:pt};_t.AcroForm;function z1(r){return r.reduce(function(e,t,n){return e[t]=n,e},{})}(function(r){var e="addImage_";r.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=r.__addimage__.getImageFileTypeByImageData=function(A,P){var H,K,ce,me,le,xe=t;if((P=P||t)==="RGBA"||A.data!==void 0&&A.data instanceof Uint8ClampedArray&&"height"in A&&"width"in A)return"RGBA";if(J(A))for(le in n)for(ce=n[le],H=0;H<ce.length;H+=1){for(me=!0,K=0;K<ce[H].length;K+=1)if(ce[H][K]!==void 0&&ce[H][K]!==A[K]){me=!1;break}if(me===!0){xe=le;break}}else for(le in n)for(ce=n[le],H=0;H<ce.length;H+=1){for(me=!0,K=0;K<ce[H].length;K+=1)if(ce[H][K]!==void 0&&ce[H][K]!==A.charCodeAt(K)){me=!1;break}if(me===!0){xe=le;break}}return xe===t&&P!==t&&(xe=P),xe},s=function A(P){for(var H=this.internal.write,K=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var me=[];if(me.push({key:"Type",value:"/XObject"}),me.push({key:"Subtype",value:"/Image"}),me.push({key:"Width",value:P.width}),me.push({key:"Height",value:P.height}),P.colorSpace===v.INDEXED?me.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(me.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===v.DEVICE_CMYK&&me.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),me.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&me.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)){for(var le="",xe=0,we=P.transparency.length;xe<we;xe++)le+=P.transparency[xe]+" "+P.transparency[xe]+" ";me.push({key:"Mask",value:"["+le+"]"})}P.sMask!==void 0&&me.push({key:"SMask",value:P.objectId+1+" 0 R"});var Oe=P.filter!==void 0?["/"+P.filter]:void 0;if(K({data:P.data,additionalKeyValues:me,alreadyAppliedFilters:Oe,objectId:P.objectId}),H("endobj"),"sMask"in P&&P.sMask!==void 0){var ge=(P.predictor!=null?"/Predictor "+P.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+P.width,C={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:P.bitsPerComponent,decodeParameters:ge,data:P.sMask};"filter"in P&&(C.filter=P.filter),A.call(this,C)}if(P.colorSpace===v.INDEXED){var O=this.internal.newObject();K({data:F(new Uint8Array(P.palette)),objectId:O}),H("endobj")}},o=function(){var A=this.internal.collections[e+"images"];for(var P in A)s.call(this,A[P])},l=function(){var A,P=this.internal.collections[e+"images"],H=this.internal.write;for(var K in P)H("/I"+(A=P[K]).index,A.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var A=this.internal.collections[e+"images"];return c.call(this),A},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},p=function(A){return typeof r["process"+A.toUpperCase()]=="function"},g=function(A){return nr(A)==="object"&&A.nodeType===1},h=function(A,P){if(A.nodeName==="IMG"&&A.hasAttribute("src")){var H=""+A.getAttribute("src");if(H.indexOf("data:image/")===0)return Pc(unescape(H).split("base64,").pop());var K=r.loadFile(H,!0);if(K!==void 0)return K}if(A.nodeName==="CANVAS"){if(A.width===0||A.height===0)throw new Error("Given canvas must have data. Canvas width: "+A.width+", height: "+A.height);var ce;switch(P){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;default:ce="image/jpeg"}return Pc(A.toDataURL(ce,1).split("base64,").pop())}},b=function(A){var P=this.internal.collections[e+"images"];if(P){for(var H in P)if(A===P[H].alias)return P[H]}},x=function(A,P,H){return A||P||(A=-96,P=-96),A<0&&(A=-1*H.width*72/A/this.internal.scaleFactor),P<0&&(P=-1*H.height*72/P/this.internal.scaleFactor),A===0&&(A=P*H.width/H.height),P===0&&(P=A*H.height/H.width),[A,P]},y=function(A,P,H,K,ce,me){var le=x.call(this,H,K,ce),xe=this.internal.getCoordinateString,we=this.internal.getVerticalCoordinateString,Oe=u.call(this);if(H=le[0],K=le[1],Oe[ce.index]=ce,me){me*=Math.PI/180;var ge=Math.cos(me),C=Math.sin(me),O=function(M){return M.toFixed(4)},D=[O(ge),O(C),O(-1*C),O(ge),0,0,"cm"]}this.internal.write("q"),me?(this.internal.write([1,"0","0",1,xe(A),we(P+K),"cm"].join(" ")),this.internal.write(D.join(" ")),this.internal.write([xe(H),"0","0",xe(K),"0","0","cm"].join(" "))):this.internal.write([xe(H),"0","0",xe(K),xe(A),we(P+K),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},v=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var _=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=r.__addimage__.sHashCode=function(A){var P,H,K=0;if(typeof A=="string")for(H=A.length,P=0;P<H;P++)K=(K<<5)-K+A.charCodeAt(P),K|=0;else if(J(A))for(H=A.byteLength/2,P=0;P<H;P++)K=(K<<5)-K+A[P],K|=0;return K},j=r.__addimage__.validateStringAsBase64=function(A){(A=A||"").toString().trim();var P=!0;return A.length===0&&(P=!1),A.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(A.substr(0,A.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(A.substr(-2))===!1&&(P=!1),P},I=r.__addimage__.extractImageFromDataUrl=function(A){if(A==null||!(A=A.trim()).startsWith("data:"))return null;var P=A.indexOf(",");return P<0?null:A.substring(0,P).trim().endsWith("base64")?A.substring(P+1):null};r.__addimage__.isArrayBuffer=function(A){return A instanceof ArrayBuffer};var J=r.__addimage__.isArrayBufferView=function(A){return A instanceof Int8Array||A instanceof Uint8Array||A instanceof Uint8ClampedArray||A instanceof Int16Array||A instanceof Uint16Array||A instanceof Int32Array||A instanceof Uint32Array||A instanceof Float32Array||A instanceof Float64Array},k=r.__addimage__.binaryStringToUint8Array=function(A){for(var P=A.length,H=new Uint8Array(P),K=0;K<P;K++)H[K]=A.charCodeAt(K);return H},F=r.__addimage__.arrayBufferToBinaryString=function(A){for(var P="",H=J(A)?A:new Uint8Array(A),K=0;K<H.length;K+=8192)P+=String.fromCharCode.apply(null,H.subarray(K,K+8192));return P};r.addImage=function(){var A,P,H,K,ce,me,le,xe,we;if(typeof arguments[1]=="number"?(P=t,H=arguments[1],K=arguments[2],ce=arguments[3],me=arguments[4],le=arguments[5],xe=arguments[6],we=arguments[7]):(P=arguments[1],H=arguments[2],K=arguments[3],ce=arguments[4],me=arguments[5],le=arguments[6],xe=arguments[7],we=arguments[8]),nr(A=arguments[0])==="object"&&!g(A)&&"imageData"in A){var Oe=A;A=Oe.imageData,P=Oe.format||P||t,H=Oe.x||H||0,K=Oe.y||K||0,ce=Oe.w||Oe.width||ce,me=Oe.h||Oe.height||me,le=Oe.alias||le,xe=Oe.compression||xe,we=Oe.rotation||Oe.angle||we}var ge=this.internal.getFilters();if(xe===void 0&&ge.indexOf("FlateEncode")!==-1&&(xe="SLOW"),isNaN(H)||isNaN(K))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var C=T.call(this,A,P,le,xe);return y.call(this,H,K,ce,me,C,we),this};var T=function(A,P,H,K){var ce,me,le;if(typeof A=="string"&&a(A)===t){A=unescape(A);var xe=R(A,!1);(xe!==""||(xe=r.loadFile(A,!0))!==void 0)&&(A=xe)}if(g(A)&&(A=h(A,P)),P=a(A,P),!p(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((le=H)==null||le.length===0)&&(H=function(we){return typeof we=="string"||J(we)?S(we):J(we.data)?S(we.data):null}(A)),(ce=b.call(this,H))||(A instanceof Uint8Array||P==="RGBA"||(me=A,A=k(A)),ce=this["process"+P.toUpperCase()](A,d.call(this),H,function(we){return we&&typeof we=="string"&&(we=we.toUpperCase()),we in r.image_compression?we:_.NONE}(K),me)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},R=r.__addimage__.convertBase64ToBinaryString=function(A,P){P=typeof P!="boolean"||P;var H,K="";if(typeof A=="string"){var ce;H=(ce=I(A))!==null&&ce!==void 0?ce:A;try{K=Pc(H)}catch(me){if(P)throw j(H)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+me.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return K};r.getImageProperties=function(A){var P,H,K="";if(g(A)&&(A=h(A)),typeof A=="string"&&a(A)===t&&((K=R(A,!1))===""&&(K=r.loadFile(A)||""),A=K),H=a(A),!p(H))throw new Error("addImage does not support files of type '"+H+"', please ensure that a plugin for '"+H+"' support is added.");if(A instanceof Uint8Array||(A=k(A)),!(P=this["process"+H.toUpperCase()](A)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=H,P}})(_t.API),function(r){var e=function(t){if(t!==void 0&&t!="")return!0};_t.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var n,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(t.objId),u=t.pageContext.annotations,d=!1,p=0;p<u.length&&!d;p++)switch((n=u[p]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var g=0;g<u.length;g++){n=u[g];var h=this.internal.pdfEscape,b=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(x.objId),_=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(v(n.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(v(_))+") >>",x.content=s;var S=x.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+S,n.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(x.objId,"0 R",y.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(b(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var I=this.annotations._nameMap[n.options.name];n.options.pageNumber=I.page,n.options.top=I.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(b(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var J=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+J+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},r.link=function(t,n,a,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(t),y:u(n),w:c(t+a),h:u(n+s)},options:o,type:"link"})},r.textWithLink=function(t,n,a,s){var o,l,c=this.getTextWidth(t),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(t,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(t,n,a,s),a+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-u,l,o,s),c},r.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(_t.API),function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];r.__arabicParser__={};var s=r.__arabicParser__.isInArabicSubstitutionA=function(x){return e[x.charCodeAt(0)]!==void 0},o=r.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},l=r.__arabicParser__.isArabicEndLetter=function(x){return o(x)&&s(x)&&e[x.charCodeAt(0)].length<=2},c=r.__arabicParser__.isArabicAlfLetter=function(x){return o(x)&&a.indexOf(x.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return o(x)&&s(x)&&e[x.charCodeAt(0)].length>=1};var u=r.__arabicParser__.arabicLetterHasFinalForm=function(x){return o(x)&&s(x)&&e[x.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(x){return o(x)&&s(x)&&e[x.charCodeAt(0)].length>=3};var d=r.__arabicParser__.arabicLetterHasMedialForm=function(x){return o(x)&&s(x)&&e[x.charCodeAt(0)].length==4},p=r.__arabicParser__.resolveLigatures=function(x){var y=0,v=t,_="",S=0;for(y=0;y<x.length;y+=1)v[x.charCodeAt(y)]!==void 0?(S++,typeof(v=v[x.charCodeAt(y)])=="number"&&(_+=String.fromCharCode(v),v=t,S=0),y===x.length-1&&(v=t,_+=x.charAt(y-(S-1)),y-=S-1,S=0)):(v=t,_+=x.charAt(y-S),y-=S,S=0);return _};r.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&n[x.charCodeAt(0)]!==void 0};var g=r.__arabicParser__.getCorrectForm=function(x,y,v){return o(x)?s(x)===!1?-1:!u(x)||!o(y)&&!o(v)||!o(v)&&l(y)||l(x)&&!o(y)||l(x)&&c(y)||l(x)&&l(y)?0:d(x)&&o(y)&&!l(y)&&o(v)&&u(v)?3:l(x)||!o(v)?1:2:-1},h=function(x){var y=0,v=0,_=0,S="",j="",I="",J=(x=x||"").split("\\s+"),k=[];for(y=0;y<J.length;y+=1){for(k.push(""),v=0;v<J[y].length;v+=1)S=J[y][v],j=J[y][v-1],I=J[y][v+1],o(S)?(_=g(S,j,I),k[y]+=_!==-1?String.fromCharCode(e[S.charCodeAt(0)][_]):S):k[y]+=S;k[y]=p(k[y])}return k.join(" ")},b=r.__arabicParser__.processArabic=r.processArabic=function(){var x,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(y)){var _=0;for(v=[],_=0;_<y.length;_+=1)Array.isArray(y[_])?v.push([h(y[_][0]),y[_][1],y[_][2]]):v.push([h(y[_])]);x=v}else x=h(y);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};r.events.push(["preProcessText",b])}(_t.API),_t.API.autoPrint=function(r){var e;return(r=r||{}).variant=r.variant||"non-conform",r.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(l){t=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var a;if((t=t||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(_t.API),function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(x){c=x}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(x){u=x}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(x){d=x}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(x){p=x}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(x){g=x}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(x){h=x}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(x){b=x}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},r.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),p=u.font||this.getFont(),g=u.scaleFactor||this.internal.scaleFactor,h=0,b=0,x=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=u.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(S,j){return S.concat(y.splitTextToSize(j,v))},[])):c=Array.isArray(c)?c:[c];for(var _=0;_<c.length;_++)h<(x=this.getStringUnitWidth(c[_],{font:p})*d)&&(h=x);return h!==0&&(b=c.length),{w:h/=g,h:Math.max((b*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/g,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=r.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,p=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,h&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,t===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};r.table=function(c,u,d,p,g){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,b,x,y,v=[],_=[],S=[],j={},I={},J=[],k=[],F=(g=g||{}).autoSize||!1,T=g.printHeaders!==!1,R=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,A=g.margins||Object.assign({width:this.getPageWidth()},e),P=typeof g.padding=="number"?g.padding:3,H=g.headerBackgroundColor||"#c8c8c8",K=g.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=T,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=R,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=H,this.internal.__cell__.headerTextColor=K,this.setFontSize(R),p==null)_=v=Object.keys(d[0]),S=v.map(function(){return"left"});else if(Array.isArray(p)&&nr(p[0])==="object")for(v=p.map(function(Oe){return Oe.name}),_=p.map(function(Oe){return Oe.prompt||Oe.name||""}),S=p.map(function(Oe){return Oe.align||"left"}),h=0;h<p.length;h+=1)I[p[h].name]=.7499990551181103*p[h].width;else Array.isArray(p)&&typeof p[0]=="string"&&(_=v=p,S=v.map(function(){return"left"}));if(F||Array.isArray(p)&&typeof p[0]=="string")for(h=0;h<v.length;h+=1){for(j[y=v[h]]=d.map(function(Oe){return Oe[y]}),this.setFont(void 0,"bold"),J.push(this.getTextDimensions(_[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=j[y],this.setFont(void 0,"normal"),x=0;x<b.length;x+=1)J.push(this.getTextDimensions(b[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);I[y]=Math.max.apply(null,J)+P+P,J=[]}if(T){var ce={};for(h=0;h<v.length;h+=1)ce[v[h]]={},ce[v[h]].text=_[h],ce[v[h]].align=S[h];var me=l.call(this,ce,I);k=v.map(function(Oe){return new s(c,u,I[Oe],me,ce[Oe].text,void 0,ce[Oe].align)}),this.setTableHeaderRow(k),this.printHeaderRow(1,!1)}var le=p.reduce(function(Oe,ge){return Oe[ge.name]=ge.align,Oe},{});for(h=0;h<d.length;h+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:h,data:d[h]},this);var xe=l.call(this,d[h],I);for(x=0;x<v.length;x+=1){var we=d[h][v[x]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:h,col:x,data:we},this),o.call(this,new s(c,u,I[v[x]],xe,we,h+2,le[v[x]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(h){var b=c[h];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*p/g+d+d},this).reduce(function(h,b){return Math.max(h,b)},0)};r.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},r.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,g.push(d)),d.lineNumber=c;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(b)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),t=!1}}(_t.API);var V1={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},G1=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],cd=z1(G1),K1=[100,200,300,400,500,600,700,800,900],x4=z1(K1);function Pu(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=function(s){return V1[s=s||"normal"]?s:"normal"}(r.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(r.weight),a=function(s){return typeof cd[s=s||"normal"]=="number"?s:"normal"}(r.stretch);return{family:e,style:t,weight:n,stretch:a,src:r.src||[],ref:r.ref||{name:e,style:[a,t,n].join(" ")}}}function hm(r,e,t,n){var a;for(a=t;a>=0&&a<e.length;a+=n)if(r[e[a]])return r[e[a]];for(a=t;a>=0&&a<e.length;a-=n)if(r[e[a]])return r[e[a]]}var v4={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},fm={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function mm(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function pm(r){return r.trimLeft()}function y4(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function b4(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var gc,gm,xm,Yi,xc,vm,ym,bm,Ru=["times"];function wm(r,e,t,n){var a=4,s=Nm;switch(n){case _t.API.image_compression.FAST:a=1,s=_m;break;case _t.API.image_compression.MEDIUM:a=6,s=Sm;break;case _t.API.image_compression.SLOW:a=9,s=Em}r=function(l,c,u,d){for(var p,g=l.length/c,h=new Uint8Array(l.length+g),b=[w4,_m,Nm,Sm,Em],x=0;x<g;x+=1){var y=x*c,v=l.subarray(y,y+c);if(d)h.set(d(v,u,p),y+x);else{for(var _=b.length,S=[],j=0;j<_;j+=1)S[j]=b[j](v,u,p);var I=N4(S.concat());h.set(S[I],y+x)}p=v}return h}(r,e,t,s);var o=rd(r,{level:a});return _t.API.__addimage__.arrayBufferToBinaryString(o)}function w4(r){var e=Array.apply([],r);return e.unshift(0),e}function _m(r,e){var t=r.length,n=[];n[0]=1;for(var a=0;a<t;a+=1){var s=r[a-e]||0;n[a+1]=r[a]-s+256&255}return n}function Nm(r,e,t){var n=r.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var o=t&&t[s]||0;a[s+1]=r[s]-o+256&255}return a}function Sm(r,e,t){var n=r.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var o=r[s-e]||0,l=t&&t[s]||0;a[s+1]=r[s]+256-(o+l>>>1)&255}return a}function Em(r,e,t){var n=r.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var o=_4(r[s-e]||0,t&&t[s]||0,t&&t[s-e]||0);a[s+1]=r[s]-o+256&255}return a}function _4(r,e,t){if(r===e&&e===t)return r;var n=Math.abs(e-t),a=Math.abs(r-t),s=Math.abs(r+e-t-t);return n<=a&&n<=s?r:a<=s?e:t}function N4(r){var e=r.map(function(t){return t.reduce(function(n,a){return n+Math.abs(a)},0)});return e.indexOf(Math.min.apply(null,e))}function Du(r,e,t){var n=e*t,a=Math.floor(n/8),s=16-(n-8*a+t),o=(1<<t)-1;return Y1(r,a)>>s&o}function Am(r,e,t,n){var a=t*n,s=Math.floor(a/8),o=16-(a-8*s+n),l=(1<<n)-1,c=(e&l)<<o;(function(u,d,p){if(d+1<u.byteLength)u.setUint16(d,p,!1);else{var g=p>>8&255;u.setUint8(d,g)}})(r,s,Y1(r,s)&~(l<<o)&65535|c)}function Y1(r,e){return e+1<r.byteLength?r.getUint16(e,!1):r.getUint8(e)<<8}function S4(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,n=r[e++]|r[e++]<<8,a=r[e++],s=a>>7,o=1<<1+(7&a);r[e++],r[e++];var l=null,c=null;s&&(l=e,c=o,e+=3*o);var u=!0,d=[],p=0,g=null,h=0,b=null;for(this.width=t,this.height=n;u&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,b=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((A=r[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var x=r[e++];p=r[e++]|r[e++]<<8,g=r[e++],1&x||(g=null),h=x>>2&7,e++;break;case 254:for(;;){if(!((A=r[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var y=r[e++]|r[e++]<<8,v=r[e++]|r[e++]<<8,_=r[e++]|r[e++]<<8,S=r[e++]|r[e++]<<8,j=r[e++],I=j>>6&1,J=1<<1+(7&j),k=l,F=c,T=!1;j>>7&&(T=!0,k=e,F=J,e+=3*J);var R=e;for(e++;;){var A;if(!((A=r[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}d.push({x:y,y:v,width:_,height:S,has_local_palette:T,palette_offset:k,palette_size:F,data_offset:R,data_length:e-R,transparent_index:g,interlaced:!!I,delay:p,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return b},this.frameInfo=function(P){if(P<0||P>=d.length)throw new Error("Frame index out of range.");return d[P]},this.decodeAndBlitFrameBGRA=function(P,H){var K=this.frameInfo(P),ce=K.width*K.height,me=new Uint8Array(ce);Cm(r,K.data_offset,me,ce);var le=K.palette_offset,xe=K.transparent_index;xe===null&&(xe=256);var we=K.width,Oe=t-we,ge=we,C=4*(K.y*t+K.x),O=4*((K.y+K.height)*t+K.x),D=C,M=4*Oe;K.interlaced===!0&&(M+=4*t*7);for(var V=8,oe=0,he=me.length;oe<he;++oe){var ue=me[oe];if(ge===0&&(ge=we,(D+=M)>=O&&(M=4*Oe+4*t*(V-1),D=C+(we+Oe)*(V<<1),V>>=1)),ue===xe)D+=4;else{var Z=r[le+3*ue],ye=r[le+3*ue+1],Le=r[le+3*ue+2];H[D++]=Le,H[D++]=ye,H[D++]=Z,H[D++]=255}--ge}},this.decodeAndBlitFrameRGBA=function(P,H){var K=this.frameInfo(P),ce=K.width*K.height,me=new Uint8Array(ce);Cm(r,K.data_offset,me,ce);var le=K.palette_offset,xe=K.transparent_index;xe===null&&(xe=256);var we=K.width,Oe=t-we,ge=we,C=4*(K.y*t+K.x),O=4*((K.y+K.height)*t+K.x),D=C,M=4*Oe;K.interlaced===!0&&(M+=4*t*7);for(var V=8,oe=0,he=me.length;oe<he;++oe){var ue=me[oe];if(ge===0&&(ge=we,(D+=M)>=O&&(M=4*Oe+4*t*(V-1),D=C+(we+Oe)*(V<<1),V>>=1)),ue===xe)D+=4;else{var Z=r[le+3*ue],ye=r[le+3*ue+1],Le=r[le+3*ue+2];H[D++]=Z,H[D++]=ye,H[D++]=Le,H[D++]=255}--ge}}}function Cm(r,e,t,n){for(var a=r[e++],s=1<<a,o=s+1,l=o+1,c=a+1,u=(1<<c)-1,d=0,p=0,g=0,h=r[e++],b=new Int32Array(4096),x=null;;){for(;d<16&&h!==0;)p|=r[e++]<<d,d+=8,h===1?h=r[e++]:--h;if(d<c)break;var y=p&u;if(p>>=c,d-=c,y!==s){if(y===o)break;for(var v=y<l?y:x,_=0,S=v;S>s;)S=b[S]>>8,++_;var j=S;if(g+_+(v!==y?1:0)>n)return void dr.log("Warning, gif stream longer than expected.");t[g++]=j;var I=g+=_;for(v!==y&&(t[g++]=j),S=v;_--;)S=b[S],t[--I]=255&S,S>>=8;x!==null&&l<4096&&(b[l++]=x<<8|j,l>=u+1&&c<12&&(++c,u=u<<1|1)),x=y}else l=o+1,u=(1<<(c=a+1))-1,x=null}return g!==n&&dr.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Ou(r){var e,t,n,a,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),p=new Array(65535),g=new Array(65535),h=new Array(64),b=new Array(64),x=[],y=0,v=7,_=new Array(64),S=new Array(64),j=new Array(64),I=new Array(256),J=new Array(2048),k=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],F=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],K=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function me(C,O){for(var D=0,M=0,V=new Array,oe=1;oe<=16;oe++){for(var he=1;he<=C[oe];he++)V[O[M]]=[],V[O[M]][0]=D,V[O[M]][1]=oe,M++,D++;D*=2}return V}function le(C){for(var O=C[0],D=C[1]-1;D>=0;)O&1<<D&&(y|=1<<v),D--,--v<0&&(y==255?(xe(255),xe(0)):xe(y),v=7,y=0)}function xe(C){x.push(C)}function we(C){xe(C>>8&255),xe(255&C)}function Oe(C,O,D,M,V){for(var oe,he=V[0],ue=V[240],Z=function(qe,ft){var rt,Pt,xt,Ot,kt,Tt,zt,At,wt,Ct,vt=0;for(wt=0;wt<8;++wt){rt=qe[vt],Pt=qe[vt+1],xt=qe[vt+2],Ot=qe[vt+3],kt=qe[vt+4],Tt=qe[vt+5],zt=qe[vt+6];var de=rt+(At=qe[vt+7]),Me=rt-At,Te=Pt+zt,Ge=Pt-zt,it=xt+Tt,Xe=xt-Tt,Ue=Ot+kt,Ke=Ot-kt,ct=de+Ue,ht=de-Ue,Et=Te+it,ut=Te-it;qe[vt]=ct+Et,qe[vt+4]=ct-Et;var Lt=.707106781*(ut+ht);qe[vt+2]=ht+Lt,qe[vt+6]=ht-Lt;var ma=.382683433*((ct=Ke+Xe)-(ut=Ge+Me)),Jr=.5411961*ct+ma,pa=1.306562965*ut+ma,na=.707106781*(Et=Xe+Ge),jt=Me+na,ga=Me-na;qe[vt+5]=ga+Jr,qe[vt+3]=ga-Jr,qe[vt+1]=jt+pa,qe[vt+7]=jt-pa,vt+=8}for(vt=0,wt=0;wt<8;++wt){rt=qe[vt],Pt=qe[vt+8],xt=qe[vt+16],Ot=qe[vt+24],kt=qe[vt+32],Tt=qe[vt+40],zt=qe[vt+48];var xa=rt+(At=qe[vt+56]),gn=rt-At,Pn=Pt+zt,vr=Pt-zt,Ir=xt+Tt,q=xt-Tt,ne=Ot+kt,Y=Ot-kt,Q=xa+ne,ae=xa-ne,ie=Pn+Ir,Se=Pn-Ir;qe[vt]=Q+ie,qe[vt+32]=Q-ie;var Fe=.707106781*(Se+ae);qe[vt+16]=ae+Fe,qe[vt+48]=ae-Fe;var Ee=.382683433*((Q=Y+q)-(Se=vr+gn)),Ae=.5411961*Q+Ee,ke=1.306562965*Se+Ee,Ye=.707106781*(ie=q+vr),Qe=gn+Ye,ot=gn-Ye;qe[vt+40]=ot+Ae,qe[vt+24]=ot-Ae,qe[vt+8]=Qe+ke,qe[vt+56]=Qe-ke,vt++}for(wt=0;wt<64;++wt)Ct=qe[wt]*ft[wt],h[wt]=Ct>0?Ct+.5|0:Ct-.5|0;return h}(C,O),ye=0;ye<64;++ye)b[k[ye]]=Z[ye];var Le=b[0]-D;D=b[0],Le==0?le(M[0]):(le(M[g[oe=32767+Le]]),le(p[oe]));for(var Ie=63;Ie>0&&b[Ie]==0;)Ie--;if(Ie==0)return le(he),D;for(var pe,ee=1;ee<=Ie;){for(var lt=ee;b[ee]==0&&ee<=Ie;)++ee;var Pe=ee-lt;if(Pe>=16){pe=Pe>>4;for(var at=1;at<=pe;++at)le(ue);Pe&=15}oe=32767+b[ee],le(V[(Pe<<4)+g[oe]]),le(p[oe]),ee++}return Ie!=63&&le(he),D}function ge(C){C=Math.min(Math.max(C,1),100),s!=C&&(function(O){for(var D=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],M=0;M<64;M++){var V=o((D[M]*O+50)/100);V=Math.min(Math.max(V,1),255),l[k[M]]=V}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],he=0;he<64;he++){var ue=o((oe[he]*O+50)/100);ue=Math.min(Math.max(ue,1),255),c[k[he]]=ue}for(var Z=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ye=0,Le=0;Le<8;Le++)for(var Ie=0;Ie<8;Ie++)u[ye]=1/(l[k[ye]]*Z[Le]*Z[Ie]*8),d[ye]=1/(c[k[ye]]*Z[Le]*Z[Ie]*8),ye++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),s=C)}this.encode=function(C,O){O&&ge(O),x=new Array,y=0,v=7,we(65496),we(65504),we(16),xe(74),xe(70),xe(73),xe(70),xe(0),xe(1),xe(1),xe(0),we(1),we(1),xe(0),xe(0),function(){we(65499),we(132),xe(0);for(var Pt=0;Pt<64;Pt++)xe(l[Pt]);xe(1);for(var xt=0;xt<64;xt++)xe(c[xt])}(),function(Pt,xt){we(65472),we(17),xe(8),we(xt),we(Pt),xe(3),xe(1),xe(17),xe(0),xe(2),xe(17),xe(1),xe(3),xe(17),xe(1)}(C.width,C.height),function(){we(65476),we(418),xe(0);for(var Pt=0;Pt<16;Pt++)xe(F[Pt+1]);for(var xt=0;xt<=11;xt++)xe(T[xt]);xe(16);for(var Ot=0;Ot<16;Ot++)xe(R[Ot+1]);for(var kt=0;kt<=161;kt++)xe(A[kt]);xe(1);for(var Tt=0;Tt<16;Tt++)xe(P[Tt+1]);for(var zt=0;zt<=11;zt++)xe(H[zt]);xe(17);for(var At=0;At<16;At++)xe(K[At+1]);for(var wt=0;wt<=161;wt++)xe(ce[wt])}(),we(65498),we(12),xe(3),xe(1),xe(0),xe(2),xe(17),xe(3),xe(17),xe(0),xe(63),xe(0);var D=0,M=0,V=0;y=0,v=7,this.encode.displayName="_encode_";for(var oe,he,ue,Z,ye,Le,Ie,pe,ee,lt=C.data,Pe=C.width,at=C.height,qe=4*Pe,ft=0;ft<at;){for(oe=0;oe<qe;){for(ye=qe*ft+oe,Ie=-1,pe=0,ee=0;ee<64;ee++)Le=ye+(pe=ee>>3)*qe+(Ie=4*(7&ee)),ft+pe>=at&&(Le-=qe*(ft+1+pe-at)),oe+Ie>=qe&&(Le-=oe+Ie-qe+4),he=lt[Le++],ue=lt[Le++],Z=lt[Le++],_[ee]=(J[he]+J[ue+256|0]+J[Z+512|0]>>16)-128,S[ee]=(J[he+768|0]+J[ue+1024|0]+J[Z+1280|0]>>16)-128,j[ee]=(J[he+1280|0]+J[ue+1536|0]+J[Z+1792|0]>>16)-128;D=Oe(_,u,D,e,n),M=Oe(S,d,M,t,a),V=Oe(j,d,V,t,a),oe+=32}ft+=8}if(v>=0){var rt=[];rt[1]=v+1,rt[0]=(1<<v+1)-1,le(rt)}return we(65497),new Uint8Array(x)},r=r||50,function(){for(var C=String.fromCharCode,O=0;O<256;O++)I[O]=C(O)}(),e=me(F,T),t=me(P,H),n=me(R,A),a=me(K,ce),function(){for(var C=1,O=2,D=1;D<=15;D++){for(var M=C;M<O;M++)g[32767+M]=D,p[32767+M]=[],p[32767+M][1]=D,p[32767+M][0]=M;for(var V=-(O-1);V<=-C;V++)g[32767+V]=D,p[32767+V]=[],p[32767+V][1]=D,p[32767+V][0]=O-1+V;C<<=1,O<<=1}}(),function(){for(var C=0;C<256;C++)J[C]=19595*C,J[C+256|0]=38470*C,J[C+512|0]=7471*C+32768,J[C+768|0]=-11059*C,J[C+1024|0]=-21709*C,J[C+1280|0]=32768*C+8421375,J[C+1536|0]=-27439*C,J[C+1792|0]=-5329*C}(),ge(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Sa(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function jm(r){function e(T){if(!T)throw Error("assert :P")}function t(T,R,A){for(var P=0;4>P;P++)if(T[R+P]!=A.charCodeAt(P))return!0;return!1}function n(T,R,A,P,H){for(var K=0;K<H;K++)T[R+K]=A[P+K]}function a(T,R,A,P){for(var H=0;H<P;H++)T[R+H]=A}function s(T){return new Int32Array(T)}function o(T,R){for(var A=[],P=0;P<T;P++)A.push(new R);return A}function l(T,R){var A=[];return function P(H,K,ce){for(var me=ce[K],le=0;le<me&&(H.push(ce.length>K+1?[]:new R),!(ce.length<K+1));le++)P(H[le],K+1,ce)}(A,0,T),A}var c=function(){var T=this;function R(f,m){for(var N=1<<m-1>>>0;f&N;)N>>>=1;return N?(f&N-1)+N:f}function A(f,m,N,L,B){e(!(L%N));do f[m+(L-=N)]=B;while(0<L)}function P(f,m,N,L,B){if(e(2328>=B),512>=B)var W=s(512);else if((W=s(B))==null)return 0;return function(z,G,X,te,ve,je){var re,be,Ne=G,De=1<<X,Ce=s(16),Be=s(16);for(e(ve!=0),e(te!=null),e(z!=null),e(0<X),be=0;be<ve;++be){if(15<te[be])return 0;++Ce[te[be]]}if(Ce[0]==ve)return 0;for(Be[1]=0,re=1;15>re;++re){if(Ce[re]>1<<re)return 0;Be[re+1]=Be[re]+Ce[re]}for(be=0;be<ve;++be)re=te[be],0<te[be]&&(je[Be[re]++]=be);if(Be[15]==1)return(te=new H).g=0,te.value=je[0],A(z,Ne,1,De,te),De;var $e,Je=-1,ze=De-1,St=0,mt=1,Ht=1,yt=1<<X;for(be=0,re=1,ve=2;re<=X;++re,ve<<=1){if(mt+=Ht<<=1,0>(Ht-=Ce[re]))return 0;for(;0<Ce[re];--Ce[re])(te=new H).g=re,te.value=je[be++],A(z,Ne+St,ve,yt,te),St=R(St,re)}for(re=X+1,ve=2;15>=re;++re,ve<<=1){if(mt+=Ht<<=1,0>(Ht-=Ce[re]))return 0;for(;0<Ce[re];--Ce[re]){if(te=new H,(St&ze)!=Je){for(Ne+=yt,$e=1<<(Je=re)-X;15>Je&&!(0>=($e-=Ce[Je]));)++Je,$e<<=1;De+=yt=1<<($e=Je-X),z[G+(Je=St&ze)].g=$e+X,z[G+Je].value=Ne-G-Je}te.g=re-X,te.value=je[be++],A(z,Ne+(St>>X),ve,yt,te),St=R(St,re)}}return mt!=2*Be[15]-1?0:De}(f,m,N,L,B,W)}function H(){this.value=this.g=0}function K(){this.value=this.g=0}function ce(){this.G=o(5,H),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Ua,K)}function me(f,m,N,L){e(f!=null),e(m!=null),e(2147483648>L),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=m,f.pa=N,f.Jd=m,f.Yc=N+L,f.Zc=4<=L?N+L-4+1:N,he(f)}function le(f,m){for(var N=0;0<m--;)N|=Z(f,128)<<m;return N}function xe(f,m){var N=le(f,m);return ue(f)?-N:N}function we(f,m,N,L){var B,W=0;for(e(f!=null),e(m!=null),e(4294967288>L),f.Sb=L,f.Ra=0,f.u=0,f.h=0,4<L&&(L=4),B=0;B<L;++B)W+=m[N+B]<<8*B;f.Ra=W,f.bb=L,f.oa=m,f.pa=N}function Oe(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<Rs-8>>>0,++f.bb,f.u-=8;M(f)&&(f.h=1,f.u=0)}function ge(f,m){if(e(0<=m),!f.h&&m<=Ho){var N=D(f)&Ps[m];return f.u+=m,Oe(f),N}return f.h=1,f.u=0}function C(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function O(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(f){return f.Ra>>>(f.u&Rs-1)>>>0}function M(f){return e(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>Rs}function V(f,m){f.u=m,f.h=M(f)}function oe(f){f.u>=kr&&(e(f.u>=kr),Oe(f))}function he(f){e(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(e(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function ue(f){return le(f,1)}function Z(f,m){var N=f.Ca;0>f.b&&he(f);var L=f.b,B=N*m>>>8,W=(f.I>>>L>B)+0;for(W?(N-=B,f.I-=B+1<<L>>>0):N=B+1,L=N,B=0;256<=L;)B+=8,L>>=8;return L=7^B+G0[L],f.b-=L,f.Ca=(N<<L)-1,W}function ye(f,m,N){f[m+0]=N>>24&255,f[m+1]=N>>16&255,f[m+2]=N>>8&255,f[m+3]=255&N}function Le(f,m){return f[m+0]|f[m+1]<<8}function Ie(f,m){return Le(f,m)|f[m+2]<<16}function pe(f,m){return Le(f,m)|Le(f,m+2)<<16}function ee(f,m){var N=1<<m;return e(f!=null),e(0<m),f.X=s(N),f.X==null?0:(f.Mb=32-m,f.Xa=m,1)}function lt(f,m){e(f!=null),e(m!=null),e(f.Xa==m.Xa),n(m.X,0,f.X,0,1<<m.Xa)}function Pe(){this.X=[],this.Xa=this.Mb=0}function at(f,m,N,L){e(N!=null),e(L!=null);var B=N[0],W=L[0];return B==0&&(B=(f*W+m/2)/m),W==0&&(W=(m*B+f/2)/f),0>=B||0>=W?0:(N[0]=B,L[0]=W,1)}function qe(f,m){return f+(1<<m)-1>>>m}function ft(f,m){return((4278255360&f)+(4278255360&m)>>>0&4278255360)+((16711935&f)+(16711935&m)>>>0&16711935)>>>0}function rt(f,m){T[m]=function(N,L,B,W,z,G,X){var te;for(te=0;te<z;++te){var ve=T[f](G[X+te-1],B,W+te);G[X+te]=ft(N[L+te],ve)}}}function Pt(){this.ud=this.hd=this.jd=0}function xt(f,m){return((4278124286&(f^m))>>>1)+(f&m)>>>0}function Ot(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function kt(f,m){return Ot(f+(f-m+.5>>1))}function Tt(f,m,N){return Math.abs(m-N)-Math.abs(f-N)}function zt(f,m,N,L,B,W,z){for(L=W[z-1],N=0;N<B;++N)W[z+N]=L=ft(f[m+N],L)}function At(f,m,N,L,B){var W;for(W=0;W<N;++W){var z=f[m+W],G=z>>8&255,X=16711935&(X=(X=16711935&z)+((G<<16)+G));L[B+W]=(4278255360&z)+X>>>0}}function wt(f,m){m.jd=255&f,m.hd=f>>8&255,m.ud=f>>16&255}function Ct(f,m,N,L,B,W){var z;for(z=0;z<L;++z){var G=m[N+z],X=G>>>8,te=G,ve=255&(ve=(ve=G>>>16)+((f.jd<<24>>24)*(X<<24>>24)>>>5));te=255&(te=(te+=(f.hd<<24>>24)*(X<<24>>24)>>>5)+((f.ud<<24>>24)*(ve<<24>>24)>>>5)),B[W+z]=(4278255360&G)+(ve<<16)+te}}function vt(f,m,N,L,B){T[m]=function(W,z,G,X,te,ve,je,re,be){for(X=je;X<re;++X)for(je=0;je<be;++je)te[ve++]=B(G[L(W[z++])])},T[f]=function(W,z,G,X,te,ve,je){var re=8>>W.b,be=W.Ea,Ne=W.K[0],De=W.w;if(8>re)for(W=(1<<W.b)-1,De=(1<<re)-1;z<G;++z){var Ce,Be=0;for(Ce=0;Ce<be;++Ce)Ce&W||(Be=L(X[te++])),ve[je++]=B(Ne[Be&De]),Be>>=re}else T["VP8LMapColor"+N](X,te,Ne,De,ve,je,z,G,be)}}function de(f,m,N,L,B){for(N=m+N;m<N;){var W=f[m++];L[B++]=W>>16&255,L[B++]=W>>8&255,L[B++]=255&W}}function Me(f,m,N,L,B){for(N=m+N;m<N;){var W=f[m++];L[B++]=W>>16&255,L[B++]=W>>8&255,L[B++]=255&W,L[B++]=W>>24&255}}function Te(f,m,N,L,B){for(N=m+N;m<N;){var W=(z=f[m++])>>16&240|z>>12&15,z=240&z|z>>28&15;L[B++]=W,L[B++]=z}}function Ge(f,m,N,L,B){for(N=m+N;m<N;){var W=(z=f[m++])>>16&248|z>>13&7,z=z>>5&224|z>>3&31;L[B++]=W,L[B++]=z}}function it(f,m,N,L,B){for(N=m+N;m<N;){var W=f[m++];L[B++]=255&W,L[B++]=W>>8&255,L[B++]=W>>16&255}}function Xe(f,m,N,L,B,W){if(W==0)for(N=m+N;m<N;)ye(L,((W=f[m++])[0]>>24|W[1]>>8&65280|W[2]<<8&16711680|W[3]<<24)>>>0),B+=32;else n(L,B,f,m,N)}function Ue(f,m){T[m][0]=T[f+"0"],T[m][1]=T[f+"1"],T[m][2]=T[f+"2"],T[m][3]=T[f+"3"],T[m][4]=T[f+"4"],T[m][5]=T[f+"5"],T[m][6]=T[f+"6"],T[m][7]=T[f+"7"],T[m][8]=T[f+"8"],T[m][9]=T[f+"9"],T[m][10]=T[f+"10"],T[m][11]=T[f+"11"],T[m][12]=T[f+"12"],T[m][13]=T[f+"13"],T[m][14]=T[f+"0"],T[m][15]=T[f+"0"]}function Ke(f){return f==X0||f==J0||f==Kl||f==Z0}function ct(){this.eb=[],this.size=this.A=this.fb=0}function ht(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Et(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ct,this.f.kb=new ht,this.sd=null}function ut(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Lt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ma(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function Jr(f,m){var N=f.T,L=m.ba.f.RGBA,B=L.eb,W=L.fb+f.ka*L.A,z=oa[m.ba.S],G=f.y,X=f.O,te=f.f,ve=f.N,je=f.ea,re=f.W,be=m.cc,Ne=m.dc,De=m.Mc,Ce=m.Nc,Be=f.ka,$e=f.ka+f.T,Je=f.U,ze=Je+1>>1;for(Be==0?z(G,X,null,null,te,ve,je,re,te,ve,je,re,B,W,null,null,Je):(z(m.ec,m.fc,G,X,be,Ne,De,Ce,te,ve,je,re,B,W-L.A,B,W,Je),++N);Be+2<$e;Be+=2)be=te,Ne=ve,De=je,Ce=re,ve+=f.Rc,re+=f.Rc,W+=2*L.A,z(G,(X+=2*f.fa)-f.fa,G,X,be,Ne,De,Ce,te,ve,je,re,B,W-L.A,B,W,Je);return X+=f.fa,f.j+$e<f.o?(n(m.ec,m.fc,G,X,Je),n(m.cc,m.dc,te,ve,ze),n(m.Mc,m.Nc,je,re,ze),N--):1&$e||z(G,X,null,null,te,ve,je,re,te,ve,je,re,B,W+L.A,null,null,Je),N}function pa(f,m,N){var L=f.F,B=[f.J];if(L!=null){var W=f.U,z=m.ba.S,G=z==Gl||z==Kl;m=m.ba.f.RGBA;var X=[0],te=f.ka;X[0]=f.T,f.Kb&&(te==0?--X[0]:(--te,B[0]-=f.width),f.j+f.ka+f.T==f.o&&(X[0]=f.o-f.j-te));var ve=m.eb;te=m.fb+te*m.A,f=wh(L,B[0],f.width,W,X,ve,te+(G?0:3),m.A),e(N==X),f&&Ke(z)&&zo(ve,te,G,W,X,m.A)}return 0}function na(f){var m=f.ma,N=m.ba.S,L=11>N,B=N==zl||N==Vl||N==Gl||N==Y0||N==12||Ke(N);if(m.memory=null,m.Ib=null,m.Jb=null,m.Nd=null,!Rn(m.Oa,f,B?11:12))return 0;if(B&&Ke(N)&&Io(),f.da)alert("todo:use_scaling");else{if(L){if(m.Ib=ma,f.Kb){if(N=f.U+1>>1,m.memory=s(f.U+2*N),m.memory==null)return 0;m.ec=m.memory,m.fc=0,m.cc=m.ec,m.dc=m.fc+f.U,m.Mc=m.cc,m.Nc=m.dc+N,m.Ib=Jr,Io()}}else alert("todo:EmitYUV");B&&(m.Jb=pa,L&&di())}if(L&&!Ih){for(f=0;256>f;++f)Z2[f]=89858*(f-128)+Xl>>Yl,tx[f]=-22014*(f-128)+Xl,ex[f]=-45773*(f-128),Q2[f]=113618*(f-128)+Xl>>Yl;for(f=Go;f<tu;++f)m=76283*(f-16)+Xl>>Yl,rx[f-Go]=Vr(m,255),nx[f-Go]=Vr(m+8>>4,15);Ih=1}return 1}function jt(f){var m=f.ma,N=f.U,L=f.T;return e(!(1&f.ka)),0>=N||0>=L?0:(N=m.Ib(f,m),m.Jb!=null&&m.Jb(f,m,N),m.Dc+=N,1)}function ga(f){f.ma.memory=null}function xa(f,m,N,L){return ge(f,8)!=47?0:(m[0]=ge(f,14)+1,N[0]=ge(f,14)+1,L[0]=ge(f,1),ge(f,3)!=0?0:!f.h)}function gn(f,m){if(4>f)return f+1;var N=f-2>>1;return(2+(1&f)<<N)+ge(m,N)+1}function Pn(f,m){return 120<m?m-120:1<=(N=((N=M2[m-1])>>4)*f+(8-(15&N)))?N:1;var N}function vr(f,m,N){var L=D(N),B=f[m+=255&L].g-8;return 0<B&&(V(N,N.u+8),L=D(N),m+=f[m].value,m+=L&(1<<B)-1),V(N,N.u+f[m].g),f[m].value}function Ir(f,m,N){return N.g+=f.g,N.value+=f.value<<m>>>0,e(8>=N.g),f.g}function q(f,m,N){var L=f.xc;return e((m=L==0?0:f.vc[f.md*(N>>L)+(m>>L)])<f.Wb),f.Ya[m]}function ne(f,m,N,L){var B=f.ab,W=f.c*m,z=f.C;m=z+m;var G=N,X=L;for(L=f.Ta,N=f.Ua;0<B--;){var te=f.gc[B],ve=z,je=m,re=G,be=X,Ne=(X=L,G=N,te.Ea);switch(e(ve<je),e(je<=te.nc),te.hc){case 2:$i(re,be,(je-ve)*Ne,X,G);break;case 0:var De=ve,Ce=je,Be=X,$e=G,Je=(yt=te).Ea;De==0&&(Ha(re,be,null,null,1,Be,$e),zt(re,be+1,0,0,Je-1,Be,$e+1),be+=Je,$e+=Je,++De);for(var ze=1<<yt.b,St=ze-1,mt=qe(Je,yt.b),Ht=yt.K,yt=yt.w+(De>>yt.b)*mt;De<Ce;){var Vt=Ht,Gr=yt,$t=1;for($a(re,be,Be,$e-Je,1,Be,$e);$t<Je;){var bt=($t&~St)+ze;bt>Je&&(bt=Je),(0,mi[Vt[Gr++]>>8&15])(re,be+ +$t,Be,$e+$t-Je,bt-$t,Be,$e+$t),$t=bt}be+=Je,$e+=Je,++De&St||(yt+=mt)}je!=te.nc&&n(X,G-Ne,X,G+(je-ve-1)*Ne,Ne);break;case 1:for(Ne=re,Ce=be,Je=(re=te.Ea)-($e=re&~(Be=(be=1<<te.b)-1)),De=qe(re,te.b),ze=te.K,te=te.w+(ve>>te.b)*De;ve<je;){for(St=ze,mt=te,Ht=new Pt,yt=Ce+$e,Vt=Ce+re;Ce<yt;)wt(St[mt++],Ht),ls(Ht,Ne,Ce,be,X,G),Ce+=be,G+=be;Ce<Vt&&(wt(St[mt++],Ht),ls(Ht,Ne,Ce,Je,X,G),Ce+=Je,G+=Je),++ve&Be||(te+=De)}break;case 3:if(re==X&&be==G&&0<te.b){for(Ce=X,re=Ne=G+(je-ve)*Ne-($e=(je-ve)*qe(te.Ea,te.b)),be=X,Be=G,De=[],$e=(Je=$e)-1;0<=$e;--$e)De[$e]=be[Be+$e];for($e=Je-1;0<=$e;--$e)Ce[re+$e]=De[$e];$o(te,ve,je,X,Ne,X,G)}else $o(te,ve,je,re,be,X,G)}G=L,X=N}X!=N&&n(L,N,G,X,W)}function Y(f,m){var N=f.V,L=f.Ba+f.c*f.C,B=m-f.C;if(e(m<=f.l.o),e(16>=B),0<B){var W=f.l,z=f.Ta,G=f.Ua,X=W.width;if(ne(f,B,N,L),B=G=[G],e((N=f.C)<(L=m)),e(W.v<W.va),L>W.o&&(L=W.o),N<W.j){var te=W.j-N;N=W.j,B[0]+=te*X}if(N>=L?N=0:(B[0]+=4*W.v,W.ka=N-W.j,W.U=W.va-W.v,W.T=L-N,N=1),N){if(G=G[0],11>(N=f.ca).S){var ve=N.f.RGBA,je=(L=N.S,B=W.U,W=W.T,te=ve.eb,ve.A),re=W;for(ve=ve.fb+f.Ma*ve.A;0<re--;){var be=z,Ne=G,De=B,Ce=te,Be=ve;switch(L){case Wl:qo(be,Ne,De,Ce,Be);break;case zl:qn(be,Ne,De,Ce,Be);break;case X0:qn(be,Ne,De,Ce,Be),zo(Ce,Be,0,De,1,0);break;case jh:fr(be,Ne,De,Ce,Be);break;case Vl:Xe(be,Ne,De,Ce,Be,1);break;case J0:Xe(be,Ne,De,Ce,Be,1),zo(Ce,Be,0,De,1,0);break;case Gl:Xe(be,Ne,De,Ce,Be,0);break;case Kl:Xe(be,Ne,De,Ce,Be,0),zo(Ce,Be,1,De,1,0);break;case Y0:qa(be,Ne,De,Ce,Be);break;case Z0:qa(be,Ne,De,Ce,Be),bh(Ce,Be,De,1,0);break;case kh:hr(be,Ne,De,Ce,Be);break;default:e(0)}G+=X,ve+=je}f.Ma+=W}else alert("todo:EmitRescaledRowsYUVA");e(f.Ma<=N.height)}}f.C=m,e(f.C<=f.i)}function Q(f){var m;if(0<f.ua)return 0;for(m=0;m<f.Wb;++m){var N=f.Ya[m].G,L=f.Ya[m].H;if(0<N[1][L[1]+0].g||0<N[2][L[2]+0].g||0<N[3][L[3]+0].g)return 0}return 1}function ae(f,m,N,L,B,W){if(f.Z!=0){var z=f.qd,G=f.rd;for(e(Os[f.Z]!=null);m<N;++m)Os[f.Z](z,G,L,B,L,B,W),z=L,G=B,B+=W;f.qd=z,f.rd=G}}function ie(f,m){var N=f.l.ma,L=N.Z==0||N.Z==1?f.l.j:f.C;if(L=f.C<L?L:f.C,e(m<=f.l.o),m>L){var B=f.l.width,W=N.ca,z=N.tb+B*L,G=f.V,X=f.Ba+f.c*L,te=f.gc;e(f.ab==1),e(te[0].hc==3),Wi(te[0],L,m,G,X,W,z),ae(N,L,m,W,z,B)}f.C=f.Ma=m}function Se(f,m,N,L,B,W,z){var G=f.$/L,X=f.$%L,te=f.m,ve=f.s,je=N+f.$,re=je;B=N+L*B;var be=N+L*W,Ne=280+ve.ua,De=f.Pb?G:16777216,Ce=0<ve.ua?ve.Wa:null,Be=ve.wc,$e=je<be?q(ve,X,G):null;e(f.C<W),e(be<=B);var Je=!1;e:for(;;){for(;Je||je<be;){var ze=0;if(G>=De){var St=je-N;e((De=f).Pb),De.wd=De.m,De.xd=St,0<De.s.ua&&lt(De.s.Wa,De.s.vb),De=G+U2}if(X&Be||($e=q(ve,X,G)),e($e!=null),$e.Qb&&(m[je]=$e.qb,Je=!0),!Je)if(oe(te),$e.jc){ze=te,St=m;var mt=je,Ht=$e.pd[D(ze)&Ua-1];e($e.jc),256>Ht.g?(V(ze,ze.u+Ht.g),St[mt]=Ht.value,ze=0):(V(ze,ze.u+Ht.g-256),e(256<=Ht.value),ze=Ht.value),ze==0&&(Je=!0)}else ze=vr($e.G[0],$e.H[0],te);if(te.h)break;if(Je||256>ze){if(!Je)if($e.nd)m[je]=($e.qb|ze<<8)>>>0;else{if(oe(te),Je=vr($e.G[1],$e.H[1],te),oe(te),St=vr($e.G[2],$e.H[2],te),mt=vr($e.G[3],$e.H[3],te),te.h)break;m[je]=(mt<<24|Je<<16|ze<<8|St)>>>0}if(Je=!1,++je,++X>=L&&(X=0,++G,z!=null&&G<=W&&!(G%16)&&z(f,G),Ce!=null))for(;re<je;)ze=m[re++],Ce.X[(506832829*ze&4294967295)>>>Ce.Mb]=ze}else if(280>ze){if(ze=gn(ze-256,te),St=vr($e.G[4],$e.H[4],te),oe(te),St=Pn(L,St=gn(St,te)),te.h)break;if(je-N<St||B-je<ze)break e;for(mt=0;mt<ze;++mt)m[je+mt]=m[je+mt-St];for(je+=ze,X+=ze;X>=L;)X-=L,++G,z!=null&&G<=W&&!(G%16)&&z(f,G);if(e(je<=B),X&Be&&($e=q(ve,X,G)),Ce!=null)for(;re<je;)ze=m[re++],Ce.X[(506832829*ze&4294967295)>>>Ce.Mb]=ze}else{if(!(ze<Ne))break e;for(Je=ze-280,e(Ce!=null);re<je;)ze=m[re++],Ce.X[(506832829*ze&4294967295)>>>Ce.Mb]=ze;ze=je,e(!(Je>>>(St=Ce).Xa)),m[ze]=St.X[Je],Je=!0}Je||e(te.h==M(te))}if(f.Pb&&te.h&&je<B)e(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&lt(f.s.vb,f.s.Wa);else{if(te.h)break e;z!=null&&z(f,G>W?W:G),f.a=0,f.$=je-N}return 1}return f.a=3,0}function Fe(f){e(f!=null),f.vc=null,f.yc=null,f.Ya=null;var m=f.Wa;m!=null&&(m.X=null),f.vb=null,e(f!=null)}function Ee(){var f=new wr;return f==null?null:(f.a=0,f.xb=Fh,Ue("Predictor","VP8LPredictors"),Ue("Predictor","VP8LPredictors_C"),Ue("PredictorAdd","VP8LPredictorsAdd"),Ue("PredictorAdd","VP8LPredictorsAdd_C"),$i=At,ls=Ct,qo=de,qn=Me,qa=Te,hr=Ge,fr=it,T.VP8LMapColor32b=qi,T.VP8LMapColor8b=fi,f)}function Ae(f,m,N,L,B){var W=1,z=[f],G=[m],X=L.m,te=L.s,ve=null,je=0;e:for(;;){if(N)for(;W&&ge(X,1);){var re=z,be=G,Ne=L,De=1,Ce=Ne.m,Be=Ne.gc[Ne.ab],$e=ge(Ce,2);if(Ne.Oc&1<<$e)W=0;else{switch(Ne.Oc|=1<<$e,Be.hc=$e,Be.Ea=re[0],Be.nc=be[0],Be.K=[null],++Ne.ab,e(4>=Ne.ab),$e){case 0:case 1:Be.b=ge(Ce,3)+2,De=Ae(qe(Be.Ea,Be.b),qe(Be.nc,Be.b),0,Ne,Be.K),Be.K=Be.K[0];break;case 3:var Je,ze=ge(Ce,8)+1,St=16<ze?0:4<ze?1:2<ze?2:3;if(re[0]=qe(Be.Ea,St),Be.b=St,Je=De=Ae(ze,1,0,Ne,Be.K)){var mt,Ht=ze,yt=Be,Vt=1<<(8>>yt.b),Gr=s(Vt);if(Gr==null)Je=0;else{var $t=yt.K[0],bt=yt.w;for(Gr[0]=yt.K[0][0],mt=1;mt<1*Ht;++mt)Gr[mt]=ft($t[bt+mt],Gr[mt-1]);for(;mt<4*Vt;++mt)Gr[mt]=0;yt.K[0]=null,yt.K[0]=Gr,Je=1}}De=Je;break;case 2:break;default:e(0)}W=De}}if(z=z[0],G=G[0],W&&ge(X,1)&&!(W=1<=(je=ge(X,4))&&11>=je)){L.a=3;break e}var nt;if(nt=W)t:{var Fr,Bt,Gt,pr=L,sn=z,An=G,Nr=je,vn=N,Cn=pr.m,Kr=pr.s,Kt=[null],Zt=1,Sr=0,Qt=B2[Nr];r:for(;;){if(vn&&ge(Cn,1)){var on=ge(Cn,3)+2,_a=qe(sn,on),Pr=qe(An,on),On=_a*Pr;if(!Ae(_a,Pr,0,pr,Kt))break r;for(Kt=Kt[0],Kr.xc=on,Fr=0;Fr<On;++Fr){var ur=Kt[Fr]>>8&65535;Kt[Fr]=ur,ur>=Zt&&(Zt=ur+1)}}if(Cn.h)break r;for(Bt=0;5>Bt;++Bt){var Yr=Th[Bt];!Bt&&0<Nr&&(Yr+=1<<Nr),Sr<Yr&&(Sr=Yr)}var zn=o(Zt*Qt,H),jn=Zt,Vn=o(jn,ce);if(Vn==null)var Gn=null;else e(65536>=jn),Gn=Vn;var In=s(Sr);if(Gn==null||In==null||zn==null){pr.a=1;break r}var Kn=zn;for(Fr=Gt=0;Fr<Zt;++Fr){var mr=Gn[Fr],Yn=mr.G,Na=mr.H,pi=0,ds=1,ln=0;for(Bt=0;5>Bt;++Bt){Yr=Th[Bt],Yn[Bt]=Kn,Na[Bt]=Gt,!Bt&&0<Nr&&(Yr+=1<<Nr);a:{var Zl,ru=Yr,Ql=pr,Ko=In,ix=Kn,ox=Gt,nu=0,Is=Ql.m,lx=ge(Is,1);if(a(Ko,0,0,ru),lx){var cx=ge(Is,1)+1,ux=ge(Is,1),Uh=ge(Is,ux==0?1:8);Ko[Uh]=1,cx==2&&(Ko[Uh=ge(Is,8)]=1);var ec=1}else{var Hh=s(19),$h=ge(Is,4)+4;if(19<$h){Ql.a=3;var tc=0;break a}for(Zl=0;Zl<$h;++Zl)Hh[I2[Zl]]=ge(Is,3);var au=void 0,Yo=void 0,qh=Ql,dx=Hh,rc=ru,Wh=Ko,su=0,Ms=qh.m,zh=8,Vh=o(128,H);n:for(;P(Vh,0,7,dx,19);){if(ge(Ms,1)){var hx=2+2*ge(Ms,3);if((au=2+ge(Ms,hx))>rc)break n}else au=rc;for(Yo=0;Yo<rc&&au--;){oe(Ms);var Gh=Vh[0+(127&D(Ms))];V(Ms,Ms.u+Gh.g);var Vi=Gh.value;if(16>Vi)Wh[Yo++]=Vi,Vi!=0&&(zh=Vi);else{var fx=Vi==16,Kh=Vi-16,mx=D2[Kh],Yh=ge(Ms,R2[Kh])+mx;if(Yo+Yh>rc)break n;for(var px=fx?zh:0;0<Yh--;)Wh[Yo++]=px}}su=1;break n}su||(qh.a=3),ec=su}(ec=ec&&!Is.h)&&(nu=P(ix,ox,8,Ko,ru)),ec&&nu!=0?tc=nu:(Ql.a=3,tc=0)}if(tc==0)break r;if(ds&&O2[Bt]==1&&(ds=Kn[Gt].g==0),pi+=Kn[Gt].g,Gt+=tc,3>=Bt){var Xo,iu=In[0];for(Xo=1;Xo<Yr;++Xo)In[Xo]>iu&&(iu=In[Xo]);ln+=iu}}if(mr.nd=ds,mr.Qb=0,ds&&(mr.qb=(Yn[3][Na[3]+0].value<<24|Yn[1][Na[1]+0].value<<16|Yn[2][Na[2]+0].value)>>>0,pi==0&&256>Yn[0][Na[0]+0].value&&(mr.Qb=1,mr.qb+=Yn[0][Na[0]+0].value<<8)),mr.jc=!mr.Qb&&6>ln,mr.jc){var nc,hs=mr;for(nc=0;nc<Ua;++nc){var Bs=nc,Us=hs.pd[Bs],ac=hs.G[0][hs.H[0]+Bs];256<=ac.value?(Us.g=ac.g+256,Us.value=ac.value):(Us.g=0,Us.value=0,Bs>>=Ir(ac,8,Us),Bs>>=Ir(hs.G[1][hs.H[1]+Bs],16,Us),Bs>>=Ir(hs.G[2][hs.H[2]+Bs],0,Us),Ir(hs.G[3][hs.H[3]+Bs],24,Us))}}}Kr.vc=Kt,Kr.Wb=Zt,Kr.Ya=Gn,Kr.yc=zn,nt=1;break t}nt=0}if(!(W=nt)){L.a=3;break e}if(0<je){if(te.ua=1<<je,!ee(te.Wa,je)){L.a=1,W=0;break e}}else te.ua=0;var ou=L,Xh=z,gx=G,lu=ou.s,cu=lu.xc;if(ou.c=Xh,ou.i=gx,lu.md=qe(Xh,cu),lu.wc=cu==0?-1:(1<<cu)-1,N){L.xb=G2;break e}if((ve=s(z*G))==null){L.a=1,W=0;break e}W=(W=Se(L,ve,0,z,G,G,null))&&!X.h;break e}return W?(B!=null?B[0]=ve:(e(ve==null),e(N)),L.$=0,N||Fe(te)):Fe(te),W}function ke(f,m){var N=f.c*f.i,L=N+m+16*m;return e(f.c<=m),f.V=s(L),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+N+m,1)}function Ye(f,m){var N=f.C,L=m-N,B=f.V,W=f.Ba+f.c*N;for(e(m<=f.l.o);0<L;){var z=16<L?16:L,G=f.l.ma,X=f.l.width,te=X*z,ve=G.ca,je=G.tb+X*N,re=f.Ta,be=f.Ua;ne(f,z,B,W),_h(re,be,ve,je,te),ae(G,N,N+z,ve,je,X),L-=z,B+=z*f.c,N+=z}e(N==m),f.C=f.Ma=m}function Qe(){this.ub=this.yd=this.td=this.Rb=0}function ot(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ze(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function st(){this.Yb=function(){var f=[];return function m(N,L,B){for(var W=B[L],z=0;z<W&&(N.push(B.length>L+1?[]:0),!(B.length<L+1));z++)m(N[z],L+1,B)}(f,0,[3,11]),f}()}function Ft(){this.jb=s(3),this.Wc=l([4,8],st),this.Xc=l([4,17],st)}function or(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Wt(){this.ld=this.La=this.dd=this.tc=0}function _r(){this.Na=this.la=0}function Oa(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function va(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ia(){this.uc=this.M=this.Nb=0,this.wa=Array(new Wt),this.Y=0,this.ya=Array(new va),this.aa=0,this.l=new xn}function aa(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Cs(){this.cb=this.a=0,this.sc="",this.m=new C,this.Od=new Qe,this.Kc=new ot,this.ed=new or,this.Qa=new Ze,this.Ic=this.$c=this.Aa=0,this.D=new Ia,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,C),this.ia=0,this.pb=o(4,Oa),this.Pa=new Ft,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new aa),this.Hd=0,this.rb=Array(new _r),this.sb=0,this.wa=Array(new Wt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new va),this.L=this.aa=0,this.gd=l([4,2],Wt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function xn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function L0(){var f=new Cs;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,Vo||(Vo=rs)),f}function Mr(f,m,N){return f.a==0&&(f.a=m,f.sc=N,f.cb=0),0}function Ol(f,m,N){return 3<=N&&f[m+0]==157&&f[m+1]==1&&f[m+2]==42}function Il(f,m){if(f==null)return 0;if(f.a=0,f.sc="OK",m==null)return Mr(f,2,"null VP8Io passed to VP8GetHeaders()");var N=m.data,L=m.w,B=m.ha;if(4>B)return Mr(f,7,"Truncated header.");var W=N[L+0]|N[L+1]<<8|N[L+2]<<16,z=f.Od;if(z.Rb=!(1&W),z.td=W>>1&7,z.yd=W>>4&1,z.ub=W>>5,3<z.td)return Mr(f,3,"Incorrect keyframe parameters.");if(!z.yd)return Mr(f,4,"Frame not displayable.");L+=3,B-=3;var G=f.Kc;if(z.Rb){if(7>B)return Mr(f,7,"cannot parse picture header");if(!Ol(N,L,B))return Mr(f,3,"Bad code word");G.c=16383&(N[L+4]<<8|N[L+3]),G.Td=N[L+4]>>6,G.i=16383&(N[L+6]<<8|N[L+5]),G.Ud=N[L+6]>>6,L+=7,B-=7,f.za=G.c+15>>4,f.Ub=G.i+15>>4,m.width=G.c,m.height=G.i,m.Da=0,m.j=0,m.v=0,m.va=m.width,m.o=m.height,m.da=0,m.ib=m.width,m.hb=m.height,m.U=m.width,m.T=m.height,a((W=f.Pa).jb,0,255,W.jb.length),e((W=f.Qa)!=null),W.Cb=0,W.Bb=0,W.Fb=1,a(W.Zb,0,0,W.Zb.length),a(W.Lb,0,0,W.Lb)}if(z.ub>B)return Mr(f,7,"bad partition length");me(W=f.m,N,L,z.ub),L+=z.ub,B-=z.ub,z.Rb&&(G.Ld=ue(W),G.Kd=ue(W)),G=f.Qa;var X,te=f.Pa;if(e(W!=null),e(G!=null),G.Cb=ue(W),G.Cb){if(G.Bb=ue(W),ue(W)){for(G.Fb=ue(W),X=0;4>X;++X)G.Zb[X]=ue(W)?xe(W,7):0;for(X=0;4>X;++X)G.Lb[X]=ue(W)?xe(W,6):0}if(G.Bb)for(X=0;3>X;++X)te.jb[X]=ue(W)?le(W,8):255}else G.Bb=0;if(W.Ka)return Mr(f,3,"cannot parse segment header");if((G=f.ed).zd=ue(W),G.Tb=le(W,6),G.wb=le(W,3),G.Pc=ue(W),G.Pc&&ue(W)){for(te=0;4>te;++te)ue(W)&&(G.vd[te]=xe(W,6));for(te=0;4>te;++te)ue(W)&&(G.od[te]=xe(W,6))}if(f.L=G.Tb==0?0:G.zd?1:2,W.Ka)return Mr(f,3,"cannot parse filter header");var ve=B;if(B=X=L,L=X+ve,G=ve,f.Xb=(1<<le(f.m,2))-1,ve<3*(te=f.Xb))N=7;else{for(X+=3*te,G-=3*te,ve=0;ve<te;++ve){var je=N[B+0]|N[B+1]<<8|N[B+2]<<16;je>G&&(je=G),me(f.Jc[+ve],N,X,je),X+=je,G-=je,B+=3}me(f.Jc[+te],N,X,G),N=X<L?0:5}if(N!=0)return Mr(f,N,"cannot parse partitions");for(N=le(X=f.m,7),B=ue(X)?xe(X,4):0,L=ue(X)?xe(X,4):0,G=ue(X)?xe(X,4):0,te=ue(X)?xe(X,4):0,X=ue(X)?xe(X,4):0,ve=f.Qa,je=0;4>je;++je){if(ve.Cb){var re=ve.Zb[je];ve.Fb||(re+=N)}else{if(0<je){f.pb[je]=f.pb[0];continue}re=N}var be=f.pb[je];be.Sc[0]=Q0[Vr(re+B,127)],be.Sc[1]=eu[Vr(re+0,127)],be.Eb[0]=2*Q0[Vr(re+L,127)],be.Eb[1]=101581*eu[Vr(re+G,127)]>>16,8>be.Eb[1]&&(be.Eb[1]=8),be.Qc[0]=Q0[Vr(re+te,117)],be.Qc[1]=eu[Vr(re+X,127)],be.lc=re+X}if(!z.Rb)return Mr(f,4,"Not a key frame.");for(ue(W),z=f.Pa,N=0;4>N;++N){for(B=0;8>B;++B)for(L=0;3>L;++L)for(G=0;11>G;++G)te=Z(W,z2[N][B][L][G])?le(W,8):q2[N][B][L][G],z.Wc[N][B].Yb[L][G]=te;for(B=0;17>B;++B)z.Xc[N][B]=z.Wc[N][V2[B]]}return f.kc=ue(W),f.kc&&(f.Bd=le(W,8)),f.cb=1}function rs(f,m,N,L,B,W,z){var G=m[B].Yb[N];for(N=0;16>B;++B){if(!Z(f,G[N+0]))return B;for(;!Z(f,G[N+1]);)if(G=m[++B].Yb[0],N=0,B==16)return 16;var X=m[B+1].Yb;if(Z(f,G[N+2])){var te=f,ve=0;if(Z(te,(re=G)[(je=N)+3]))if(Z(te,re[je+6])){for(G=0,je=2*(ve=Z(te,re[je+8]))+(re=Z(te,re[je+9+ve])),ve=0,re=H2[je];re[G];++G)ve+=ve+Z(te,re[G]);ve+=3+(8<<je)}else Z(te,re[je+7])?(ve=7+2*Z(te,165),ve+=Z(te,145)):ve=5+Z(te,159);else ve=Z(te,re[je+4])?3+Z(te,re[je+5]):2;G=X[2]}else ve=1,G=X[1];X=z+$2[B],0>(te=f).b&&he(te);var je,re=te.b,be=(je=te.Ca>>1)-(te.I>>re)>>31;--te.b,te.Ca+=be,te.Ca|=1,te.I-=(je+1&be)<<re,W[X]=((ve^be)-be)*L[(0<B)+0]}return 16}function ni(f){var m=f.rb[f.sb-1];m.la=0,m.Na=0,a(f.zc,0,0,f.zc.length),f.ja=0}function ya(f,m,N,L,B){B=f[m+N+32*L]+(B>>3),f[m+N+32*L]=-256&B?0>B?0:255:B}function ai(f,m,N,L,B,W){ya(f,m,0,N,L+B),ya(f,m,1,N,L+W),ya(f,m,2,N,L-W),ya(f,m,3,N,L-B)}function jr(f){return(20091*f>>16)+f}function Ao(f,m,N,L){var B,W=0,z=s(16);for(B=0;4>B;++B){var G=f[m+0]+f[m+8],X=f[m+0]-f[m+8],te=(35468*f[m+4]>>16)-jr(f[m+12]),ve=jr(f[m+4])+(35468*f[m+12]>>16);z[W+0]=G+ve,z[W+1]=X+te,z[W+2]=X-te,z[W+3]=G-ve,W+=4,m++}for(B=W=0;4>B;++B)G=(f=z[W+0]+4)+z[W+8],X=f-z[W+8],te=(35468*z[W+4]>>16)-jr(z[W+12]),ya(N,L,0,0,G+(ve=jr(z[W+4])+(35468*z[W+12]>>16))),ya(N,L,1,0,X+te),ya(N,L,2,0,X-te),ya(N,L,3,0,G-ve),W++,L+=32}function F0(f,m,N,L){var B=f[m+0]+4,W=35468*f[m+4]>>16,z=jr(f[m+4]),G=35468*f[m+1]>>16;ai(N,L,0,B+z,f=jr(f[m+1]),G),ai(N,L,1,B+W,f,G),ai(N,L,2,B-W,f,G),ai(N,L,3,B-z,f,G)}function P0(f,m,N,L,B){Ao(f,m,N,L),B&&Ao(f,m+16,N,L+4)}function R0(f,m,N,L){Lr(f,m+0,N,L,1),Lr(f,m+32,N,L+128,1)}function Ma(f,m,N,L){var B;for(f=f[m+0]+4,B=0;4>B;++B)for(m=0;4>m;++m)ya(N,L,m,B,f)}function Ml(f,m,N,L){f[m+0]&&Wa(f,m+0,N,L),f[m+16]&&Wa(f,m+16,N,L+4),f[m+32]&&Wa(f,m+32,N,L+128),f[m+48]&&Wa(f,m+48,N,L+128+4)}function Bl(f,m,N,L){var B,W=s(16);for(B=0;4>B;++B){var z=f[m+0+B]+f[m+12+B],G=f[m+4+B]+f[m+8+B],X=f[m+4+B]-f[m+8+B],te=f[m+0+B]-f[m+12+B];W[0+B]=z+G,W[8+B]=z-G,W[4+B]=te+X,W[12+B]=te-X}for(B=0;4>B;++B)z=(f=W[0+4*B]+3)+W[3+4*B],G=W[1+4*B]+W[2+4*B],X=W[1+4*B]-W[2+4*B],te=f-W[3+4*B],N[L+0]=z+G>>3,N[L+16]=te+X>>3,N[L+32]=z-G>>3,N[L+48]=te-X>>3,L+=64}function js(f,m,N){var L,B=m-32,W=Wn,z=255-f[B-1];for(L=0;L<N;++L){var G,X=W,te=z+f[m-1];for(G=0;G<N;++G)f[m+G]=X[te+f[B+G]];m+=32}}function Co(f,m){js(f,m,4)}function D0(f,m){js(f,m,8)}function O0(f,m){js(f,m,16)}function I0(f,m){var N;for(N=0;16>N;++N)n(f,m+32*N,f,m-32,16)}function jo(f,m){var N;for(N=16;0<N;--N)a(f,m,f[m-1],16),m+=32}function si(f,m,N){var L;for(L=0;16>L;++L)a(m,N+32*L,f,16)}function ks(f,m){var N,L=16;for(N=0;16>N;++N)L+=f[m-1+32*N]+f[m+N-32];si(L>>5,f,m)}function M0(f,m){var N,L=8;for(N=0;16>N;++N)L+=f[m-1+32*N];si(L>>4,f,m)}function ii(f,m){var N,L=8;for(N=0;16>N;++N)L+=f[m+N-32];si(L>>4,f,m)}function ko(f,m){si(128,f,m)}function It(f,m,N){return f+2*m+N+2>>2}function B0(f,m){var N,L=m-32;for(L=new Uint8Array([It(f[L-1],f[L+0],f[L+1]),It(f[L+0],f[L+1],f[L+2]),It(f[L+1],f[L+2],f[L+3]),It(f[L+2],f[L+3],f[L+4])]),N=0;4>N;++N)n(f,m+32*N,L,0,L.length)}function U0(f,m){var N=f[m-1],L=f[m-1+32],B=f[m-1+64],W=f[m-1+96];ye(f,m+0,16843009*It(f[m-1-32],N,L)),ye(f,m+32,16843009*It(N,L,B)),ye(f,m+64,16843009*It(L,B,W)),ye(f,m+96,16843009*It(B,W,W))}function H0(f,m){var N,L=4;for(N=0;4>N;++N)L+=f[m+N-32]+f[m-1+32*N];for(L>>=3,N=0;4>N;++N)a(f,m+32*N,L,4)}function $0(f,m){var N=f[m-1+0],L=f[m-1+32],B=f[m-1+64],W=f[m-1-32],z=f[m+0-32],G=f[m+1-32],X=f[m+2-32],te=f[m+3-32];f[m+0+96]=It(L,B,f[m-1+96]),f[m+1+96]=f[m+0+64]=It(N,L,B),f[m+2+96]=f[m+1+64]=f[m+0+32]=It(W,N,L),f[m+3+96]=f[m+2+64]=f[m+1+32]=f[m+0+0]=It(z,W,N),f[m+3+64]=f[m+2+32]=f[m+1+0]=It(G,z,W),f[m+3+32]=f[m+2+0]=It(X,G,z),f[m+3+0]=It(te,X,G)}function ns(f,m){var N=f[m+1-32],L=f[m+2-32],B=f[m+3-32],W=f[m+4-32],z=f[m+5-32],G=f[m+6-32],X=f[m+7-32];f[m+0+0]=It(f[m+0-32],N,L),f[m+1+0]=f[m+0+32]=It(N,L,B),f[m+2+0]=f[m+1+32]=f[m+0+64]=It(L,B,W),f[m+3+0]=f[m+2+32]=f[m+1+64]=f[m+0+96]=It(B,W,z),f[m+3+32]=f[m+2+64]=f[m+1+96]=It(W,z,G),f[m+3+64]=f[m+2+96]=It(z,G,X),f[m+3+96]=It(G,X,X)}function as(f,m){var N=f[m-1+0],L=f[m-1+32],B=f[m-1+64],W=f[m-1-32],z=f[m+0-32],G=f[m+1-32],X=f[m+2-32],te=f[m+3-32];f[m+0+0]=f[m+1+64]=W+z+1>>1,f[m+1+0]=f[m+2+64]=z+G+1>>1,f[m+2+0]=f[m+3+64]=G+X+1>>1,f[m+3+0]=X+te+1>>1,f[m+0+96]=It(B,L,N),f[m+0+64]=It(L,N,W),f[m+0+32]=f[m+1+96]=It(N,W,z),f[m+1+32]=f[m+2+96]=It(W,z,G),f[m+2+32]=f[m+3+96]=It(z,G,X),f[m+3+32]=It(G,X,te)}function q0(f,m){var N=f[m+0-32],L=f[m+1-32],B=f[m+2-32],W=f[m+3-32],z=f[m+4-32],G=f[m+5-32],X=f[m+6-32],te=f[m+7-32];f[m+0+0]=N+L+1>>1,f[m+1+0]=f[m+0+64]=L+B+1>>1,f[m+2+0]=f[m+1+64]=B+W+1>>1,f[m+3+0]=f[m+2+64]=W+z+1>>1,f[m+0+32]=It(N,L,B),f[m+1+32]=f[m+0+96]=It(L,B,W),f[m+2+32]=f[m+1+96]=It(B,W,z),f[m+3+32]=f[m+2+96]=It(W,z,G),f[m+3+64]=It(z,G,X),f[m+3+96]=It(G,X,te)}function W0(f,m){var N=f[m-1+0],L=f[m-1+32],B=f[m-1+64],W=f[m-1+96];f[m+0+0]=N+L+1>>1,f[m+2+0]=f[m+0+32]=L+B+1>>1,f[m+2+32]=f[m+0+64]=B+W+1>>1,f[m+1+0]=It(N,L,B),f[m+3+0]=f[m+1+32]=It(L,B,W),f[m+3+32]=f[m+1+64]=It(B,W,W),f[m+3+64]=f[m+2+64]=f[m+0+96]=f[m+1+96]=f[m+2+96]=f[m+3+96]=W}function Ri(f,m){var N=f[m-1+0],L=f[m-1+32],B=f[m-1+64],W=f[m-1+96],z=f[m-1-32],G=f[m+0-32],X=f[m+1-32],te=f[m+2-32];f[m+0+0]=f[m+2+32]=N+z+1>>1,f[m+0+32]=f[m+2+64]=L+N+1>>1,f[m+0+64]=f[m+2+96]=B+L+1>>1,f[m+0+96]=W+B+1>>1,f[m+3+0]=It(G,X,te),f[m+2+0]=It(z,G,X),f[m+1+0]=f[m+3+32]=It(N,z,G),f[m+1+32]=f[m+3+64]=It(L,N,z),f[m+1+64]=f[m+3+96]=It(B,L,N),f[m+1+96]=It(W,B,L)}function To(f,m){var N;for(N=0;8>N;++N)n(f,m+32*N,f,m-32,8)}function oi(f,m){var N;for(N=0;8>N;++N)a(f,m,f[m-1],8),m+=32}function Di(f,m,N){var L;for(L=0;8>L;++L)a(m,N+32*L,f,8)}function Oi(f,m){var N,L=8;for(N=0;8>N;++N)L+=f[m+N-32]+f[m-1+32*N];Di(L>>4,f,m)}function z0(f,m){var N,L=4;for(N=0;8>N;++N)L+=f[m+N-32];Di(L>>3,f,m)}function Lo(f,m){var N,L=4;for(N=0;8>N;++N)L+=f[m-1+32*N];Di(L>>3,f,m)}function Fo(f,m){Di(128,f,m)}function li(f,m,N){var L=f[m-N],B=f[m+0],W=3*(B-L)+K0[1020+f[m-2*N]-f[m+N]],z=ql[112+(W+4>>3)];f[m-N]=Wn[255+L+ql[112+(W+3>>3)]],f[m+0]=Wn[255+B-z]}function ci(f,m,N,L){var B=f[m+0],W=f[m+N];return ia[255+f[m-2*N]-f[m-N]]>L||ia[255+W-B]>L}function Po(f,m,N,L){return 4*ia[255+f[m-N]-f[m+0]]+ia[255+f[m-2*N]-f[m+N]]<=L}function Ii(f,m,N,L,B){var W=f[m-3*N],z=f[m-2*N],G=f[m-N],X=f[m+0],te=f[m+N],ve=f[m+2*N],je=f[m+3*N];return 4*ia[255+G-X]+ia[255+z-te]>L?0:ia[255+f[m-4*N]-W]<=B&&ia[255+W-z]<=B&&ia[255+z-G]<=B&&ia[255+je-ve]<=B&&ia[255+ve-te]<=B&&ia[255+te-X]<=B}function Ro(f,m,N,L){var B=2*L+1;for(L=0;16>L;++L)Po(f,m+L,N,B)&&li(f,m+L,N)}function ui(f,m,N,L){var B=2*L+1;for(L=0;16>L;++L)Po(f,m+L*N,1,B)&&li(f,m+L*N,1)}function Do(f,m,N,L){var B;for(B=3;0<B;--B)Ro(f,m+=4*N,N,L)}function Oo(f,m,N,L){var B;for(B=3;0<B;--B)ui(f,m+=4,N,L)}function $n(f,m,N,L,B,W,z,G){for(W=2*W+1;0<B--;){if(Ii(f,m,N,W,z))if(ci(f,m,N,G))li(f,m,N);else{var X=f,te=m,ve=N,je=X[te-2*ve],re=X[te-ve],be=X[te+0],Ne=X[te+ve],De=X[te+2*ve],Ce=27*($e=K0[1020+3*(be-re)+K0[1020+je-Ne]])+63>>7,Be=18*$e+63>>7,$e=9*$e+63>>7;X[te-3*ve]=Wn[255+X[te-3*ve]+$e],X[te-2*ve]=Wn[255+je+Be],X[te-ve]=Wn[255+re+Ce],X[te+0]=Wn[255+be-Ce],X[te+ve]=Wn[255+Ne-Be],X[te+2*ve]=Wn[255+De-$e]}m+=L}}function Ba(f,m,N,L,B,W,z,G){for(W=2*W+1;0<B--;){if(Ii(f,m,N,W,z))if(ci(f,m,N,G))li(f,m,N);else{var X=f,te=m,ve=N,je=X[te-ve],re=X[te+0],be=X[te+ve],Ne=ql[112+(4+(De=3*(re-je))>>3)],De=ql[112+(De+3>>3)],Ce=Ne+1>>1;X[te-2*ve]=Wn[255+X[te-2*ve]+Ce],X[te-ve]=Wn[255+je+De],X[te+0]=Wn[255+re-Ne],X[te+ve]=Wn[255+be-Ce]}m+=L}}function w(f,m,N,L,B,W){$n(f,m,N,1,16,L,B,W)}function U(f,m,N,L,B,W){$n(f,m,1,N,16,L,B,W)}function se(f,m,N,L,B,W){var z;for(z=3;0<z;--z)Ba(f,m+=4*N,N,1,16,L,B,W)}function fe(f,m,N,L,B,W){var z;for(z=3;0<z;--z)Ba(f,m+=4,1,N,16,L,B,W)}function _e(f,m,N,L,B,W,z,G){$n(f,m,B,1,8,W,z,G),$n(N,L,B,1,8,W,z,G)}function He(f,m,N,L,B,W,z,G){$n(f,m,1,B,8,W,z,G),$n(N,L,1,B,8,W,z,G)}function Ve(f,m,N,L,B,W,z,G){Ba(f,m+4*B,B,1,8,W,z,G),Ba(N,L+4*B,B,1,8,W,z,G)}function gt(f,m,N,L,B,W,z,G){Ba(f,m+4,1,B,8,W,z,G),Ba(N,L+4,1,B,8,W,z,G)}function Nt(){this.ba=new Et,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Lt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Rt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ut(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Xt(){this.ua=0,this.Wa=new Pe,this.vb=new Pe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ce,this.yc=new H}function wr(){this.xb=this.a=0,this.l=new xn,this.ca=new Et,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new O,this.Pb=0,this.wd=new O,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Xt,this.ab=0,this.gc=o(4,Ut),this.Oc=0}function Br(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new xn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function lr(f,m,N,L,B,W,z){for(f=f==null?0:f[m+0],m=0;m<z;++m)B[W+m]=f+N[L+m]&255,f=B[W+m]}function zr(f,m,N,L,B,W,z){var G;if(f==null)lr(null,null,N,L,B,W,z);else for(G=0;G<z;++G)B[W+G]=f[m+G]+N[L+G]&255}function Ur(f,m,N,L,B,W,z){if(f==null)lr(null,null,N,L,B,W,z);else{var G,X=f[m+0],te=X,ve=X;for(G=0;G<z;++G)te=ve+(X=f[m+G])-te,ve=N[L+G]+(-256&te?0>te?0:255:te)&255,te=X,B[W+G]=ve}}function an(f,m,N,L){var B=m.width,W=m.o;if(e(f!=null&&m!=null),0>N||0>=L||N+L>W)return null;if(!f.Cc){if(f.ga==null){var z;if(f.ga=new Br,(z=f.ga==null)||(z=m.width*m.o,e(f.Gb.length==0),f.Gb=s(z),f.Uc=0,f.Gb==null?z=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,z=1),z=!z),!z){z=f.ga;var G=f.Fa,X=f.P,te=f.qc,ve=f.mb,je=f.nb,re=X+1,be=te-1,Ne=z.l;if(e(G!=null&&ve!=null&&m!=null),Os[0]=null,Os[1]=lr,Os[2]=zr,Os[3]=Ur,z.ca=ve,z.tb=je,z.c=m.width,z.i=m.height,e(0<z.c&&0<z.i),1>=te)m=0;else if(z.$a=3&G[X+0],z.Z=G[X+0]>>2&3,z.Lc=G[X+0]>>4&3,X=G[X+0]>>6&3,0>z.$a||1<z.$a||4<=z.Z||1<z.Lc||X)m=0;else if(Ne.put=jt,Ne.ac=na,Ne.bc=ga,Ne.ma=z,Ne.width=m.width,Ne.height=m.height,Ne.Da=m.Da,Ne.v=m.v,Ne.va=m.va,Ne.j=m.j,Ne.o=m.o,z.$a)e:{e(z.$a==1),m=Ee();t:for(;;){if(m==null){m=0;break e}if(e(z!=null),z.mc=m,m.c=z.c,m.i=z.i,m.l=z.l,m.l.ma=z,m.l.width=z.c,m.l.height=z.i,m.a=0,we(m.m,G,re,be),!Ae(z.c,z.i,1,m,null)||(m.ab==1&&m.gc[0].hc==3&&Q(m.s)?(z.ic=1,G=m.c*m.i,m.Ta=null,m.Ua=0,m.V=s(G),m.Ba=0,m.V==null?(m.a=1,m=0):m=1):(z.ic=0,m=ke(m,z.c)),!m))break t;m=1;break e}z.mc=null,m=0}else m=be>=z.c*z.i;z=!m}if(z)return null;f.ga.Lc!=1?f.Ga=0:L=W-N}e(f.ga!=null),e(N+L<=W);e:{if(m=(G=f.ga).c,W=G.l.o,G.$a==0){if(re=f.rc,be=f.Vc,Ne=f.Fa,X=f.P+1+N*m,te=f.mb,ve=f.nb+N*m,e(X<=f.P+f.qc),G.Z!=0)for(e(Os[G.Z]!=null),z=0;z<L;++z)Os[G.Z](re,be,Ne,X,te,ve,m),re=te,be=ve,ve+=m,X+=m;else for(z=0;z<L;++z)n(te,ve,Ne,X,m),re=te,be=ve,ve+=m,X+=m;f.rc=re,f.Vc=be}else{if(e(G.mc!=null),m=N+L,e((z=G.mc)!=null),e(m<=z.i),z.C>=m)m=1;else if(G.ic||di(),G.ic){G=z.V,re=z.Ba,be=z.c;var De=z.i,Ce=(Ne=1,X=z.$/be,te=z.$%be,ve=z.m,je=z.s,z.$),Be=be*De,$e=be*m,Je=je.wc,ze=Ce<$e?q(je,te,X):null;e(Ce<=Be),e(m<=De),e(Q(je));t:for(;;){for(;!ve.h&&Ce<$e;){if(te&Je||(ze=q(je,te,X)),e(ze!=null),oe(ve),256>(De=vr(ze.G[0],ze.H[0],ve)))G[re+Ce]=De,++Ce,++te>=be&&(te=0,++X<=m&&!(X%16)&&ie(z,X));else{if(!(280>De)){Ne=0;break t}De=gn(De-256,ve);var St,mt=vr(ze.G[4],ze.H[4],ve);if(oe(ve),!(Ce>=(mt=Pn(be,mt=gn(mt,ve)))&&Be-Ce>=De)){Ne=0;break t}for(St=0;St<De;++St)G[re+Ce+St]=G[re+Ce+St-mt];for(Ce+=De,te+=De;te>=be;)te-=be,++X<=m&&!(X%16)&&ie(z,X);Ce<$e&&te&Je&&(ze=q(je,te,X))}e(ve.h==M(ve))}ie(z,X>m?m:X);break t}!Ne||ve.h&&Ce<Be?(Ne=0,z.a=ve.h?5:3):z.$=Ce,m=Ne}else m=Se(z,z.V,z.Ba,z.c,z.i,m,Ye);if(!m){L=0;break e}}N+L>=W&&(f.Cc=1),L=1}if(!L)return null;if(f.Cc&&((L=f.ga)!=null&&(L.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+N*B}function ss(f,m,N,L,B,W){for(;0<B--;){var z,G=f,X=m+(N?1:0),te=f,ve=m+(N?0:3);for(z=0;z<L;++z){var je=te[ve+4*z];je!=255&&(je*=32897,G[X+4*z+0]=G[X+4*z+0]*je>>23,G[X+4*z+1]=G[X+4*z+1]*je>>23,G[X+4*z+2]=G[X+4*z+2]*je>>23)}m+=W}}function Ts(f,m,N,L,B){for(;0<L--;){var W;for(W=0;W<N;++W){var z=f[m+2*W+0],G=15&(te=f[m+2*W+1]),X=4369*G,te=(240&te|te>>4)*X>>16;f[m+2*W+0]=(240&z|z>>4)*X>>16&240|(15&z|z<<4)*X>>16>>4&15,f[m+2*W+1]=240&te|G}m+=B}}function V0(f,m,N,L,B,W,z,G){var X,te,ve=255;for(te=0;te<B;++te){for(X=0;X<L;++X){var je=f[m+X];W[z+4*X]=je,ve&=je}m+=N,z+=G}return ve!=255}function Ul(f,m,N,L,B){var W;for(W=0;W<B;++W)N[L+W]=f[m+W]>>8}function di(){zo=ss,bh=Ts,wh=V0,_h=Ul}function ba(f,m,N){T[f]=function(L,B,W,z,G,X,te,ve,je,re,be,Ne,De,Ce,Be,$e,Je){var ze,St=Je-1>>1,mt=G[X+0]|te[ve+0]<<16,Ht=je[re+0]|be[Ne+0]<<16;e(L!=null);var yt=3*mt+Ht+131074>>2;for(m(L[B+0],255&yt,yt>>16,De,Ce),W!=null&&(yt=3*Ht+mt+131074>>2,m(W[z+0],255&yt,yt>>16,Be,$e)),ze=1;ze<=St;++ze){var Vt=G[X+ze]|te[ve+ze]<<16,Gr=je[re+ze]|be[Ne+ze]<<16,$t=mt+Vt+Ht+Gr+524296,bt=$t+2*(Vt+Ht)>>3;yt=bt+mt>>1,mt=($t=$t+2*(mt+Gr)>>3)+Vt>>1,m(L[B+2*ze-1],255&yt,yt>>16,De,Ce+(2*ze-1)*N),m(L[B+2*ze-0],255&mt,mt>>16,De,Ce+(2*ze-0)*N),W!=null&&(yt=$t+Ht>>1,mt=bt+Gr>>1,m(W[z+2*ze-1],255&yt,yt>>16,Be,$e+(2*ze-1)*N),m(W[z+2*ze+0],255&mt,mt>>16,Be,$e+(2*ze+0)*N)),mt=Vt,Ht=Gr}1&Je||(yt=3*mt+Ht+131074>>2,m(L[B+Je-1],255&yt,yt>>16,De,Ce+(Je-1)*N),W!=null&&(yt=3*Ht+mt+131074>>2,m(W[z+Je-1],255&yt,yt>>16,Be,$e+(Je-1)*N)))}}function Io(){oa[Wl]=K2,oa[zl]=Ph,oa[jh]=Y2,oa[Vl]=Rh,oa[Gl]=Dh,oa[Y0]=Oh,oa[kh]=X2,oa[X0]=Ph,oa[J0]=Rh,oa[Kl]=Dh,oa[Z0]=Oh}function Mi(f){return f&-16384?0>f?0:255:f>>J2}function Ls(f,m){return Mi((19077*f>>8)+(26149*m>>8)-14234)}function Zr(f,m,N){return Mi((19077*f>>8)-(6419*m>>8)-(13320*N>>8)+8708)}function is(f,m){return Mi((19077*f>>8)+(33050*m>>8)-17685)}function os(f,m,N,L,B){L[B+0]=Ls(f,N),L[B+1]=Zr(f,m,N),L[B+2]=is(f,m)}function Bi(f,m,N,L,B){L[B+0]=is(f,m),L[B+1]=Zr(f,m,N),L[B+2]=Ls(f,N)}function Mo(f,m,N,L,B){var W=Zr(f,m,N);m=W<<3&224|is(f,m)>>3,L[B+0]=248&Ls(f,N)|W>>5,L[B+1]=m}function En(f,m,N,L,B){var W=240&is(f,m)|15;L[B+0]=240&Ls(f,N)|Zr(f,m,N)>>4,L[B+1]=W}function Hl(f,m,N,L,B){L[B+0]=255,os(f,m,N,L,B+1)}function Ui(f,m,N,L,B){Bi(f,m,N,L,B),L[B+3]=255}function $l(f,m,N,L,B){os(f,m,N,L,B),L[B+3]=255}function Vr(f,m){return 0>f?0:f>m?m:f}function sa(f,m,N){T[f]=function(L,B,W,z,G,X,te,ve,je){for(var re=ve+(-2&je)*N;ve!=re;)m(L[B+0],W[z+0],G[X+0],te,ve),m(L[B+1],W[z+0],G[X+0],te,ve+N),B+=2,++z,++X,ve+=2*N;1&je&&m(L[B+0],W[z+0],G[X+0],te,ve)}}function Bo(f,m,N){return N==0?f==0?m==0?6:5:m==0?4:0:N}function Uo(f,m,N,L,B){switch(f>>>30){case 3:Lr(m,N,L,B,0);break;case 2:cs(m,N,L,B);break;case 1:Wa(m,N,L,B)}}function Fs(f,m){var N,L,B=m.M,W=m.Nb,z=f.oc,G=f.pc+40,X=f.oc,te=f.pc+584,ve=f.oc,je=f.pc+600;for(N=0;16>N;++N)z[G+32*N-1]=129;for(N=0;8>N;++N)X[te+32*N-1]=129,ve[je+32*N-1]=129;for(0<B?z[G-1-32]=X[te-1-32]=ve[je-1-32]=129:(a(z,G-32-1,127,21),a(X,te-32-1,127,9),a(ve,je-32-1,127,9)),L=0;L<f.za;++L){var re=m.ya[m.aa+L];if(0<L){for(N=-1;16>N;++N)n(z,G+32*N-4,z,G+32*N+12,4);for(N=-1;8>N;++N)n(X,te+32*N-4,X,te+32*N+4,4),n(ve,je+32*N-4,ve,je+32*N+4,4)}var be=f.Gd,Ne=f.Hd+L,De=re.ad,Ce=re.Hc;if(0<B&&(n(z,G-32,be[Ne].y,0,16),n(X,te-32,be[Ne].f,0,8),n(ve,je-32,be[Ne].ea,0,8)),re.Za){var Be=z,$e=G-32+16;for(0<B&&(L>=f.za-1?a(Be,$e,be[Ne].y[15],4):n(Be,$e,be[Ne+1].y,0,4)),N=0;4>N;N++)Be[$e+128+N]=Be[$e+256+N]=Be[$e+384+N]=Be[$e+0+N];for(N=0;16>N;++N,Ce<<=2)Be=z,$e=G+Mh[N],wa[re.Ob[N]](Be,$e),Uo(Ce,De,16*+N,Be,$e)}else if(Be=Bo(L,B,re.Ob[0]),Ds[Be](z,G),Ce!=0)for(N=0;16>N;++N,Ce<<=2)Uo(Ce,De,16*+N,z,G+Mh[N]);for(N=re.Gc,Be=Bo(L,B,re.Dd),us[Be](X,te),us[Be](ve,je),Ce=De,Be=X,$e=te,255&(re=0|N)&&(170&re?zi(Ce,256,Be,$e):Wo(Ce,256,Be,$e)),re=ve,Ce=je,255&(N>>=8)&&(170&N?zi(De,320,re,Ce):Wo(De,320,re,Ce)),B<f.Ub-1&&(n(be[Ne].y,0,z,G+480,16),n(be[Ne].f,0,X,te+224,8),n(be[Ne].ea,0,ve,je+224,8)),N=8*W*f.B,be=f.sa,Ne=f.ta+16*L+16*W*f.R,De=f.qa,re=f.ra+8*L+N,Ce=f.Ha,Be=f.Ia+8*L+N,N=0;16>N;++N)n(be,Ne+N*f.R,z,G+32*N,16);for(N=0;8>N;++N)n(De,re+N*f.B,X,te+32*N,8),n(Ce,Be+N*f.B,ve,je+32*N,8)}}function Hi(f,m,N,L,B,W,z,G,X){var te=[0],ve=[0],je=0,re=X!=null?X.kd:0,be=X??new Rt;if(f==null||12>N)return 7;be.data=f,be.w=m,be.ha=N,m=[m],N=[N],be.gb=[be.gb];e:{var Ne=m,De=N,Ce=be.gb;if(e(f!=null),e(De!=null),e(Ce!=null),Ce[0]=0,12<=De[0]&&!t(f,Ne[0],"RIFF")){if(t(f,Ne[0]+8,"WEBP")){Ce=3;break e}var Be=pe(f,Ne[0]+4);if(12>Be||4294967286<Be){Ce=3;break e}if(re&&Be>De[0]-8){Ce=7;break e}Ce[0]=Be,Ne[0]+=12,De[0]-=12}Ce=0}if(Ce!=0)return Ce;for(Be=0<be.gb[0],N=N[0];;){e:{var $e=f;De=m,Ce=N;var Je=te,ze=ve,St=Ne=[0];if((yt=je=[je])[0]=0,8>Ce[0])Ce=7;else{if(!t($e,De[0],"VP8X")){if(pe($e,De[0]+4)!=10){Ce=3;break e}if(18>Ce[0]){Ce=7;break e}var mt=pe($e,De[0]+8),Ht=1+Ie($e,De[0]+12);if(2147483648<=Ht*($e=1+Ie($e,De[0]+15))){Ce=3;break e}St!=null&&(St[0]=mt),Je!=null&&(Je[0]=Ht),ze!=null&&(ze[0]=$e),De[0]+=18,Ce[0]-=18,yt[0]=1}Ce=0}}if(je=je[0],Ne=Ne[0],Ce!=0)return Ce;if(De=!!(2&Ne),!Be&&je)return 3;if(W!=null&&(W[0]=!!(16&Ne)),z!=null&&(z[0]=De),G!=null&&(G[0]=0),z=te[0],Ne=ve[0],je&&De&&X==null){Ce=0;break}if(4>N){Ce=7;break}if(Be&&je||!Be&&!je&&!t(f,m[0],"ALPH")){N=[N],be.na=[be.na],be.P=[be.P],be.Sa=[be.Sa];e:{mt=f,Ce=m,Be=N;var yt=be.gb;Je=be.na,ze=be.P,St=be.Sa,Ht=22,e(mt!=null),e(Be!=null),$e=Ce[0];var Vt=Be[0];for(e(Je!=null),e(St!=null),Je[0]=null,ze[0]=null,St[0]=0;;){if(Ce[0]=$e,Be[0]=Vt,8>Vt){Ce=7;break e}var Gr=pe(mt,$e+4);if(4294967286<Gr){Ce=3;break e}var $t=8+Gr+1&-2;if(Ht+=$t,0<yt&&Ht>yt){Ce=3;break e}if(!t(mt,$e,"VP8 ")||!t(mt,$e,"VP8L")){Ce=0;break e}if(Vt[0]<$t){Ce=7;break e}t(mt,$e,"ALPH")||(Je[0]=mt,ze[0]=$e+8,St[0]=Gr),$e+=$t,Vt-=$t}}if(N=N[0],be.na=be.na[0],be.P=be.P[0],be.Sa=be.Sa[0],Ce!=0)break}N=[N],be.Ja=[be.Ja],be.xa=[be.xa];e:if(yt=f,Ce=m,Be=N,Je=be.gb[0],ze=be.Ja,St=be.xa,mt=Ce[0],$e=!t(yt,mt,"VP8 "),Ht=!t(yt,mt,"VP8L"),e(yt!=null),e(Be!=null),e(ze!=null),e(St!=null),8>Be[0])Ce=7;else{if($e||Ht){if(yt=pe(yt,mt+4),12<=Je&&yt>Je-12){Ce=3;break e}if(re&&yt>Be[0]-8){Ce=7;break e}ze[0]=yt,Ce[0]+=8,Be[0]-=8,St[0]=Ht}else St[0]=5<=Be[0]&&yt[mt+0]==47&&!(yt[mt+4]>>5),ze[0]=Be[0];Ce=0}if(N=N[0],be.Ja=be.Ja[0],be.xa=be.xa[0],m=m[0],Ce!=0)break;if(4294967286<be.Ja)return 3;if(G==null||De||(G[0]=be.xa?2:1),z=[z],Ne=[Ne],be.xa){if(5>N){Ce=7;break}G=z,re=Ne,De=W,f==null||5>N?f=0:5<=N&&f[m+0]==47&&!(f[m+4]>>5)?(Be=[0],yt=[0],Je=[0],we(ze=new O,f,m,N),xa(ze,Be,yt,Je)?(G!=null&&(G[0]=Be[0]),re!=null&&(re[0]=yt[0]),De!=null&&(De[0]=Je[0]),f=1):f=0):f=0}else{if(10>N){Ce=7;break}G=Ne,f==null||10>N||!Ol(f,m+3,N-3)?f=0:(re=f[m+0]|f[m+1]<<8|f[m+2]<<16,De=16383&(f[m+7]<<8|f[m+6]),f=16383&(f[m+9]<<8|f[m+8]),1&re||3<(re>>1&7)||!(re>>4&1)||re>>5>=be.Ja||!De||!f?f=0:(z&&(z[0]=De),G&&(G[0]=f),f=1))}if(!f||(z=z[0],Ne=Ne[0],je&&(te[0]!=z||ve[0]!=Ne)))return 3;X!=null&&(X[0]=be,X.offset=m-X.w,e(4294967286>m-X.w),e(X.offset==X.ha-N));break}return Ce==0||Ce==7&&je&&X==null?(W!=null&&(W[0]|=be.na!=null&&0<be.na.length),L!=null&&(L[0]=z),B!=null&&(B[0]=Ne),0):Ce}function Rn(f,m,N){var L=m.width,B=m.height,W=0,z=0,G=L,X=B;if(m.Da=f!=null&&0<f.Da,m.Da&&(G=f.cd,X=f.bd,W=f.v,z=f.j,11>N||(W&=-2,z&=-2),0>W||0>z||0>=G||0>=X||W+G>L||z+X>B))return 0;if(m.v=W,m.j=z,m.va=W+G,m.o=z+X,m.U=G,m.T=X,m.da=f!=null&&0<f.da,m.da){if(!at(G,X,N=[f.ib],W=[f.hb]))return 0;m.ib=N[0],m.hb=W[0]}return m.ob=f!=null&&f.ob,m.Kb=f==null||!f.Sd,m.da&&(m.ob=m.ib<3*L/4&&m.hb<3*B/4,m.Kb=0),1}function Dn(f){if(f==null)return 2;if(11>f.S){var m=f.f.RGBA;m.fb+=(f.height-1)*m.A,m.A=-m.A}else m=f.f.kb,f=f.height,m.O+=(f-1)*m.fa,m.fa=-m.fa,m.N+=(f-1>>1)*m.Ab,m.Ab=-m.Ab,m.W+=(f-1>>1)*m.Db,m.Db=-m.Db,m.F!=null&&(m.J+=(f-1)*m.lb,m.lb=-m.lb);return 0}function hi(f,m,N,L){if(L==null||0>=f||0>=m)return 2;if(N!=null){if(N.Da){var B=N.cd,W=N.bd,z=-2&N.v,G=-2&N.j;if(0>z||0>G||0>=B||0>=W||z+B>f||G+W>m)return 2;f=B,m=W}if(N.da){if(!at(f,m,B=[N.ib],W=[N.hb]))return 2;f=B[0],m=W[0]}}L.width=f,L.height=m;e:{var X=L.width,te=L.height;if(f=L.S,0>=X||0>=te||!(f>=Wl&&13>f))f=2;else{if(0>=L.Rd&&L.sd==null){z=W=B=m=0;var ve=(G=X*Bh[f])*te;if(11>f||(W=(te+1)/2*(m=(X+1)/2),f==12&&(z=(B=X)*te)),(te=s(ve+2*W+z))==null){f=1;break e}L.sd=te,11>f?((X=L.f.RGBA).eb=te,X.fb=0,X.A=G,X.size=ve):((X=L.f.kb).y=te,X.O=0,X.fa=G,X.Fd=ve,X.f=te,X.N=0+ve,X.Ab=m,X.Cd=W,X.ea=te,X.W=0+ve+W,X.Db=m,X.Ed=W,f==12&&(X.F=te,X.J=0+ve+2*W),X.Tc=z,X.lb=B)}if(m=1,B=L.S,W=L.width,z=L.height,B>=Wl&&13>B)if(11>B)f=L.f.RGBA,m&=(G=Math.abs(f.A))*(z-1)+W<=f.size,m&=G>=W*Bh[B],m&=f.eb!=null;else{f=L.f.kb,G=(W+1)/2,ve=(z+1)/2,X=Math.abs(f.fa),te=Math.abs(f.Ab);var je=Math.abs(f.Db),re=Math.abs(f.lb),be=re*(z-1)+W;m&=X*(z-1)+W<=f.Fd,m&=te*(ve-1)+G<=f.Cd,m=(m&=je*(ve-1)+G<=f.Ed)&X>=W&te>=G&je>=G,m&=f.y!=null,m&=f.f!=null,m&=f.ea!=null,B==12&&(m&=re>=W,m&=be<=f.Tc,m&=f.F!=null)}else m=0;f=m?0:2}}return f!=0||N!=null&&N.fd&&(f=Dn(L)),f}var Ua=64,Ps=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ho=24,Rs=32,kr=8,G0=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];rt("Predictor0","PredictorAdd0"),T.Predictor0=function(){return 4278190080},T.Predictor1=function(f){return f},T.Predictor2=function(f,m,N){return m[N+0]},T.Predictor3=function(f,m,N){return m[N+1]},T.Predictor4=function(f,m,N){return m[N-1]},T.Predictor5=function(f,m,N){return xt(xt(f,m[N+1]),m[N+0])},T.Predictor6=function(f,m,N){return xt(f,m[N-1])},T.Predictor7=function(f,m,N){return xt(f,m[N+0])},T.Predictor8=function(f,m,N){return xt(m[N-1],m[N+0])},T.Predictor9=function(f,m,N){return xt(m[N+0],m[N+1])},T.Predictor10=function(f,m,N){return xt(xt(f,m[N-1]),xt(m[N+0],m[N+1]))},T.Predictor11=function(f,m,N){var L=m[N+0];return 0>=Tt(L>>24&255,f>>24&255,(m=m[N-1])>>24&255)+Tt(L>>16&255,f>>16&255,m>>16&255)+Tt(L>>8&255,f>>8&255,m>>8&255)+Tt(255&L,255&f,255&m)?L:f},T.Predictor12=function(f,m,N){var L=m[N+0];return(Ot((f>>24&255)+(L>>24&255)-((m=m[N-1])>>24&255))<<24|Ot((f>>16&255)+(L>>16&255)-(m>>16&255))<<16|Ot((f>>8&255)+(L>>8&255)-(m>>8&255))<<8|Ot((255&f)+(255&L)-(255&m)))>>>0},T.Predictor13=function(f,m,N){var L=m[N-1];return(kt((f=xt(f,m[N+0]))>>24&255,L>>24&255)<<24|kt(f>>16&255,L>>16&255)<<16|kt(f>>8&255,L>>8&255)<<8|kt(255&f,255&L))>>>0};var Ha=T.PredictorAdd0;T.PredictorAdd1=zt,rt("Predictor2","PredictorAdd2"),rt("Predictor3","PredictorAdd3"),rt("Predictor4","PredictorAdd4"),rt("Predictor5","PredictorAdd5"),rt("Predictor6","PredictorAdd6"),rt("Predictor7","PredictorAdd7"),rt("Predictor8","PredictorAdd8"),rt("Predictor9","PredictorAdd9"),rt("Predictor10","PredictorAdd10"),rt("Predictor11","PredictorAdd11"),rt("Predictor12","PredictorAdd12"),rt("Predictor13","PredictorAdd13");var $a=T.PredictorAdd2;vt("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),vt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var $i,$o=T.ColorIndexInverseTransform,qi=T.MapARGB,Wi=T.VP8LColorIndexInverseTransformAlpha,fi=T.MapAlpha,mi=T.VP8LPredictorsAdd=[];mi.length=16,(T.VP8LPredictors=[]).length=16,(T.VP8LPredictorsAdd_C=[]).length=16,(T.VP8LPredictors_C=[]).length=16;var ls,qo,qn,qa,hr,fr,Tr,Lr,cs,zi,Wa,Wo,lh,ch,uh,dh,hh,fh,mh,ph,gh,xh,vh,yh,zo,bh,wh,_h,Nh=s(511),Sh=s(2041),Eh=s(225),Ah=s(767),Ch=0,K0=Sh,ql=Eh,Wn=Ah,ia=Nh,Wl=0,zl=1,jh=2,Vl=3,Gl=4,Y0=5,kh=6,X0=7,J0=8,Kl=9,Z0=10,R2=[2,3,7],D2=[3,3,11],Th=[280,256,256,256,40],O2=[0,1,1,1,0],I2=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],M2=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],B2=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],U2=8,Q0=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],eu=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Vo=null,H2=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],$2=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Lh=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],q2=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],W2=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],z2=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],V2=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ds=[],wa=[],us=[],G2=1,Fh=2,Os=[],oa=[];ba("UpsampleRgbLinePair",os,3),ba("UpsampleBgrLinePair",Bi,3),ba("UpsampleRgbaLinePair",$l,4),ba("UpsampleBgraLinePair",Ui,4),ba("UpsampleArgbLinePair",Hl,4),ba("UpsampleRgba4444LinePair",En,2),ba("UpsampleRgb565LinePair",Mo,2);var K2=T.UpsampleRgbLinePair,Y2=T.UpsampleBgrLinePair,Ph=T.UpsampleRgbaLinePair,Rh=T.UpsampleBgraLinePair,Dh=T.UpsampleArgbLinePair,Oh=T.UpsampleRgba4444LinePair,X2=T.UpsampleRgb565LinePair,Yl=16,Xl=1<<Yl-1,Go=-227,tu=482,J2=6,Ih=0,Z2=s(256),Q2=s(256),ex=s(256),tx=s(256),rx=s(tu-Go),nx=s(tu-Go);sa("YuvToRgbRow",os,3),sa("YuvToBgrRow",Bi,3),sa("YuvToRgbaRow",$l,4),sa("YuvToBgraRow",Ui,4),sa("YuvToArgbRow",Hl,4),sa("YuvToRgba4444Row",En,2),sa("YuvToRgb565Row",Mo,2);var Mh=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Jl=[0,2,8],ax=[8,7,6,4,4,2,2,2,1,1,1,1],sx=1;this.WebPDecodeRGBA=function(f,m,N,L,B){var W=zl,z=new Nt,G=new Et;z.ba=G,G.S=W,G.width=[G.width],G.height=[G.height];var X=G.width,te=G.height,ve=new ut;if(ve==null||f==null)var je=2;else e(ve!=null),je=Hi(f,m,N,ve.width,ve.height,ve.Pd,ve.Qd,ve.format,null);if(je!=0?X=0:(X!=null&&(X[0]=ve.width[0]),te!=null&&(te[0]=ve.height[0]),X=1),X){G.width=G.width[0],G.height=G.height[0],L!=null&&(L[0]=G.width),B!=null&&(B[0]=G.height);e:{if(L=new xn,(B=new Rt).data=f,B.w=m,B.ha=N,B.kd=1,m=[0],e(B!=null),((f=Hi(B.data,B.w,B.ha,null,null,null,m,null,B))==0||f==7)&&m[0]&&(f=4),(m=f)==0){if(e(z!=null),L.data=B.data,L.w=B.w+B.offset,L.ha=B.ha-B.offset,L.put=jt,L.ac=na,L.bc=ga,L.ma=z,B.xa){if((f=Ee())==null){z=1;break e}if(function(re,be){var Ne=[0],De=[0],Ce=[0];t:for(;;){if(re==null)return 0;if(be==null)return re.a=2,0;if(re.l=be,re.a=0,we(re.m,be.data,be.w,be.ha),!xa(re.m,Ne,De,Ce)){re.a=3;break t}if(re.xb=Fh,be.width=Ne[0],be.height=De[0],!Ae(Ne[0],De[0],1,re,null))break t;return 1}return e(re.a!=0),0}(f,L)){if(L=(m=hi(L.width,L.height,z.Oa,z.ba))==0){t:{L=f;r:for(;;){if(L==null){L=0;break t}if(e(L.s.yc!=null),e(L.s.Ya!=null),e(0<L.s.Wb),e((N=L.l)!=null),e((B=N.ma)!=null),L.xb!=0){if(L.ca=B.ba,L.tb=B.tb,e(L.ca!=null),!Rn(B.Oa,N,Vl)){L.a=2;break r}if(!ke(L,N.width)||N.da)break r;if((N.da||Ke(L.ca.S))&&di(),11>L.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),L.ca.f.kb.F!=null&&di()),L.Pb&&0<L.s.ua&&L.s.vb.X==null&&!ee(L.s.vb,L.s.Wa.Xa)){L.a=1;break r}L.xb=0}if(!Se(L,L.V,L.Ba,L.c,L.i,N.o,Y))break r;B.Dc=L.Ma,L=1;break t}e(L.a!=0),L=0}L=!L}L&&(m=f.a)}else m=f.a}else{if((f=new L0)==null){z=1;break e}if(f.Fa=B.na,f.P=B.P,f.qc=B.Sa,Il(f,L)){if((m=hi(L.width,L.height,z.Oa,z.ba))==0){if(f.Aa=0,N=z.Oa,e((B=f)!=null),N!=null){if(0<(X=0>(X=N.Md)?0:100<X?255:255*X/100)){for(te=ve=0;4>te;++te)12>(je=B.pb[te]).lc&&(je.ia=X*ax[0>je.lc?0:je.lc]>>3),ve|=je.ia;ve&&(alert("todo:VP8InitRandom"),B.ia=1)}B.Ga=N.Id,100<B.Ga?B.Ga=100:0>B.Ga&&(B.Ga=0)}(function(re,be){if(re==null)return 0;if(be==null)return Mr(re,2,"NULL VP8Io parameter in VP8Decode().");if(!re.cb&&!Il(re,be))return 0;if(e(re.cb),be.ac==null||be.ac(be)){be.ob&&(re.L=0);var Ne=Jl[re.L];if(re.L==2?(re.yb=0,re.zb=0):(re.yb=be.v-Ne>>4,re.zb=be.j-Ne>>4,0>re.yb&&(re.yb=0),0>re.zb&&(re.zb=0)),re.Va=be.o+15+Ne>>4,re.Hb=be.va+15+Ne>>4,re.Hb>re.za&&(re.Hb=re.za),re.Va>re.Ub&&(re.Va=re.Ub),0<re.L){var De=re.ed;for(Ne=0;4>Ne;++Ne){var Ce;if(re.Qa.Cb){var Be=re.Qa.Lb[Ne];re.Qa.Fb||(Be+=De.Tb)}else Be=De.Tb;for(Ce=0;1>=Ce;++Ce){var $e=re.gd[Ne][Ce],Je=Be;if(De.Pc&&(Je+=De.vd[0],Ce&&(Je+=De.od[0])),0<(Je=0>Je?0:63<Je?63:Je)){var ze=Je;0<De.wb&&(ze=4<De.wb?ze>>2:ze>>1)>9-De.wb&&(ze=9-De.wb),1>ze&&(ze=1),$e.dd=ze,$e.tc=2*Je+ze,$e.ld=40<=Je?2:15<=Je?1:0}else $e.tc=0;$e.La=Ce}}}Ne=0}else Mr(re,6,"Frame setup failed"),Ne=re.a;if(Ne=Ne==0){if(Ne){re.$c=0,0<re.Aa||(re.Ic=sx);t:{Ne=re.Ic,De=4*(ze=re.za);var St=32*ze,mt=ze+1,Ht=0<re.L?ze*(0<re.Aa?2:1):0,yt=(re.Aa==2?2:1)*ze;if(($e=De+832+(Ce=3*(16*Ne+Jl[re.L])/2*St)+(Be=re.Fa!=null&&0<re.Fa.length?re.Kc.c*re.Kc.i:0))!=$e)Ne=0;else{if($e>re.Vb){if(re.Vb=0,re.Ec=s($e),re.Fc=0,re.Ec==null){Ne=Mr(re,1,"no memory during frame initialization.");break t}re.Vb=$e}$e=re.Ec,Je=re.Fc,re.Ac=$e,re.Bc=Je,Je+=De,re.Gd=o(St,aa),re.Hd=0,re.rb=o(mt+1,_r),re.sb=1,re.wa=Ht?o(Ht,Wt):null,re.Y=0,re.D.Nb=0,re.D.wa=re.wa,re.D.Y=re.Y,0<re.Aa&&(re.D.Y+=ze),e(!0),re.oc=$e,re.pc=Je,Je+=832,re.ya=o(yt,va),re.aa=0,re.D.ya=re.ya,re.D.aa=re.aa,re.Aa==2&&(re.D.aa+=ze),re.R=16*ze,re.B=8*ze,ze=(St=Jl[re.L])*re.R,St=St/2*re.B,re.sa=$e,re.ta=Je+ze,re.qa=re.sa,re.ra=re.ta+16*Ne*re.R+St,re.Ha=re.qa,re.Ia=re.ra+8*Ne*re.B+St,re.$c=0,Je+=Ce,re.mb=Be?$e:null,re.nb=Be?Je:null,e(Je+Be<=re.Fc+re.Vb),ni(re),a(re.Ac,re.Bc,0,De),Ne=1}}if(Ne){if(be.ka=0,be.y=re.sa,be.O=re.ta,be.f=re.qa,be.N=re.ra,be.ea=re.Ha,be.Vd=re.Ia,be.fa=re.R,be.Rc=re.B,be.F=null,be.J=0,!Ch){for(Ne=-255;255>=Ne;++Ne)Nh[255+Ne]=0>Ne?-Ne:Ne;for(Ne=-1020;1020>=Ne;++Ne)Sh[1020+Ne]=-128>Ne?-128:127<Ne?127:Ne;for(Ne=-112;112>=Ne;++Ne)Eh[112+Ne]=-16>Ne?-16:15<Ne?15:Ne;for(Ne=-255;510>=Ne;++Ne)Ah[255+Ne]=0>Ne?0:255<Ne?255:Ne;Ch=1}Tr=Bl,Lr=P0,zi=R0,Wa=Ma,Wo=Ml,cs=F0,lh=w,ch=U,uh=_e,dh=He,hh=se,fh=fe,mh=Ve,ph=gt,gh=Ro,xh=ui,vh=Do,yh=Oo,wa[0]=H0,wa[1]=Co,wa[2]=B0,wa[3]=U0,wa[4]=$0,wa[5]=as,wa[6]=ns,wa[7]=q0,wa[8]=Ri,wa[9]=W0,Ds[0]=ks,Ds[1]=O0,Ds[2]=I0,Ds[3]=jo,Ds[4]=M0,Ds[5]=ii,Ds[6]=ko,us[0]=Oi,us[1]=D0,us[2]=To,us[3]=oi,us[4]=Lo,us[5]=z0,us[6]=Fo,Ne=1}else Ne=0}Ne&&(Ne=function(Vt,Gr){for(Vt.M=0;Vt.M<Vt.Va;++Vt.M){var $t,bt=Vt.Jc[Vt.M&Vt.Xb],nt=Vt.m,Fr=Vt;for($t=0;$t<Fr.za;++$t){var Bt=nt,Gt=Fr,pr=Gt.Ac,sn=Gt.Bc+4*$t,An=Gt.zc,Nr=Gt.ya[Gt.aa+$t];if(Gt.Qa.Bb?Nr.$b=Z(Bt,Gt.Pa.jb[0])?2+Z(Bt,Gt.Pa.jb[2]):Z(Bt,Gt.Pa.jb[1]):Nr.$b=0,Gt.kc&&(Nr.Ad=Z(Bt,Gt.Bd)),Nr.Za=!Z(Bt,145)+0,Nr.Za){var vn=Nr.Ob,Cn=0;for(Gt=0;4>Gt;++Gt){var Kr,Kt=An[0+Gt];for(Kr=0;4>Kr;++Kr){Kt=W2[pr[sn+Kr]][Kt];for(var Zt=Lh[Z(Bt,Kt[0])];0<Zt;)Zt=Lh[2*Zt+Z(Bt,Kt[Zt])];Kt=-Zt,pr[sn+Kr]=Kt}n(vn,Cn,pr,sn,4),Cn+=4,An[0+Gt]=Kt}}else Kt=Z(Bt,156)?Z(Bt,128)?1:3:Z(Bt,163)?2:0,Nr.Ob[0]=Kt,a(pr,sn,Kt,4),a(An,0,Kt,4);Nr.Dd=Z(Bt,142)?Z(Bt,114)?Z(Bt,183)?1:3:2:0}if(Fr.m.Ka)return Mr(Vt,7,"Premature end-of-partition0 encountered.");for(;Vt.ja<Vt.za;++Vt.ja){if(Fr=bt,Bt=(nt=Vt).rb[nt.sb-1],pr=nt.rb[nt.sb+nt.ja],$t=nt.ya[nt.aa+nt.ja],sn=nt.kc?$t.Ad:0)Bt.la=pr.la=0,$t.Za||(Bt.Na=pr.Na=0),$t.Hc=0,$t.Gc=0,$t.ia=0;else{var Sr,Qt;if(Bt=pr,pr=Fr,sn=nt.Pa.Xc,An=nt.ya[nt.aa+nt.ja],Nr=nt.pb[An.$b],Gt=An.ad,vn=0,Cn=nt.rb[nt.sb-1],Kt=Kr=0,a(Gt,vn,0,384),An.Za)var on=0,_a=sn[3];else{Zt=s(16);var Pr=Bt.Na+Cn.Na;if(Pr=Vo(pr,sn[1],Pr,Nr.Eb,0,Zt,0),Bt.Na=Cn.Na=(0<Pr)+0,1<Pr)Tr(Zt,0,Gt,vn);else{var On=Zt[0]+3>>3;for(Zt=0;256>Zt;Zt+=16)Gt[vn+Zt]=On}on=1,_a=sn[0]}var ur=15&Bt.la,Yr=15&Cn.la;for(Zt=0;4>Zt;++Zt){var zn=1&Yr;for(On=Qt=0;4>On;++On)ur=ur>>1|(zn=(Pr=Vo(pr,_a,Pr=zn+(1&ur),Nr.Sc,on,Gt,vn))>on)<<7,Qt=Qt<<2|(3<Pr?3:1<Pr?2:Gt[vn+0]!=0),vn+=16;ur>>=4,Yr=Yr>>1|zn<<7,Kr=(Kr<<8|Qt)>>>0}for(_a=ur,on=Yr>>4,Sr=0;4>Sr;Sr+=2){for(Qt=0,ur=Bt.la>>4+Sr,Yr=Cn.la>>4+Sr,Zt=0;2>Zt;++Zt){for(zn=1&Yr,On=0;2>On;++On)Pr=zn+(1&ur),ur=ur>>1|(zn=0<(Pr=Vo(pr,sn[2],Pr,Nr.Qc,0,Gt,vn)))<<3,Qt=Qt<<2|(3<Pr?3:1<Pr?2:Gt[vn+0]!=0),vn+=16;ur>>=2,Yr=Yr>>1|zn<<5}Kt|=Qt<<4*Sr,_a|=ur<<4<<Sr,on|=(240&Yr)<<Sr}Bt.la=_a,Cn.la=on,An.Hc=Kr,An.Gc=Kt,An.ia=43690&Kt?0:Nr.ia,sn=!(Kr|Kt)}if(0<nt.L&&(nt.wa[nt.Y+nt.ja]=nt.gd[$t.$b][$t.Za],nt.wa[nt.Y+nt.ja].La|=!sn),Fr.Ka)return Mr(Vt,7,"Premature end-of-file encountered.")}if(ni(Vt),nt=Gr,Fr=1,$t=(bt=Vt).D,Bt=0<bt.L&&bt.M>=bt.zb&&bt.M<=bt.Va,bt.Aa==0)t:{if($t.M=bt.M,$t.uc=Bt,Fs(bt,$t),Fr=1,$t=(Qt=bt.D).Nb,Bt=(Kt=Jl[bt.L])*bt.R,pr=Kt/2*bt.B,Zt=16*$t*bt.R,On=8*$t*bt.B,sn=bt.sa,An=bt.ta-Bt+Zt,Nr=bt.qa,Gt=bt.ra-pr+On,vn=bt.Ha,Cn=bt.Ia-pr+On,Yr=(ur=Qt.M)==0,Kr=ur>=bt.Va-1,bt.Aa==2&&Fs(bt,Qt),Qt.uc)for(zn=(Pr=bt).D.M,e(Pr.D.uc),Qt=Pr.yb;Qt<Pr.Hb;++Qt){on=Qt,_a=zn;var jn=(Vn=(ln=Pr).D).Nb;Sr=ln.R;var Vn=Vn.wa[Vn.Y+on],Gn=ln.sa,In=ln.ta+16*jn*Sr+16*on,Kn=Vn.dd,mr=Vn.tc;if(mr!=0)if(e(3<=mr),ln.L==1)0<on&&xh(Gn,In,Sr,mr+4),Vn.La&&yh(Gn,In,Sr,mr),0<_a&&gh(Gn,In,Sr,mr+4),Vn.La&&vh(Gn,In,Sr,mr);else{var Yn=ln.B,Na=ln.qa,pi=ln.ra+8*jn*Yn+8*on,ds=ln.Ha,ln=ln.Ia+8*jn*Yn+8*on;jn=Vn.ld,0<on&&(ch(Gn,In,Sr,mr+4,Kn,jn),dh(Na,pi,ds,ln,Yn,mr+4,Kn,jn)),Vn.La&&(fh(Gn,In,Sr,mr,Kn,jn),ph(Na,pi,ds,ln,Yn,mr,Kn,jn)),0<_a&&(lh(Gn,In,Sr,mr+4,Kn,jn),uh(Na,pi,ds,ln,Yn,mr+4,Kn,jn)),Vn.La&&(hh(Gn,In,Sr,mr,Kn,jn),mh(Na,pi,ds,ln,Yn,mr,Kn,jn))}}if(bt.ia&&alert("todo:DitherRow"),nt.put!=null){if(Qt=16*ur,ur=16*(ur+1),Yr?(nt.y=bt.sa,nt.O=bt.ta+Zt,nt.f=bt.qa,nt.N=bt.ra+On,nt.ea=bt.Ha,nt.W=bt.Ia+On):(Qt-=Kt,nt.y=sn,nt.O=An,nt.f=Nr,nt.N=Gt,nt.ea=vn,nt.W=Cn),Kr||(ur-=Kt),ur>nt.o&&(ur=nt.o),nt.F=null,nt.J=null,bt.Fa!=null&&0<bt.Fa.length&&Qt<ur&&(nt.J=an(bt,nt,Qt,ur-Qt),nt.F=bt.mb,nt.F==null&&nt.F.length==0)){Fr=Mr(bt,3,"Could not decode alpha data.");break t}Qt<nt.j&&(Kt=nt.j-Qt,Qt=nt.j,e(!(1&Kt)),nt.O+=bt.R*Kt,nt.N+=bt.B*(Kt>>1),nt.W+=bt.B*(Kt>>1),nt.F!=null&&(nt.J+=nt.width*Kt)),Qt<ur&&(nt.O+=nt.v,nt.N+=nt.v>>1,nt.W+=nt.v>>1,nt.F!=null&&(nt.J+=nt.v),nt.ka=Qt-nt.j,nt.U=nt.va-nt.v,nt.T=ur-Qt,Fr=nt.put(nt))}$t+1!=bt.Ic||Kr||(n(bt.sa,bt.ta-Bt,sn,An+16*bt.R,Bt),n(bt.qa,bt.ra-pr,Nr,Gt+8*bt.B,pr),n(bt.Ha,bt.Ia-pr,vn,Cn+8*bt.B,pr))}if(!Fr)return Mr(Vt,6,"Output aborted.")}return 1}(re,be)),be.bc!=null&&be.bc(be),Ne&=1}return Ne?(re.cb=0,Ne):0})(f,L)||(m=f.a)}}else m=f.a}m==0&&z.Oa!=null&&z.Oa.fd&&(m=Dn(z.ba))}z=m}W=z!=0?null:11>W?G.f.RGBA.eb:G.f.kb.y}else W=null;return W};var Bh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(T,R){for(var A="",P=0;P<4;P++)A+=String.fromCharCode(T[R++]);return A}function d(T,R){return T[R+0]|T[R+1]<<8}function p(T,R){return(T[R+0]|T[R+1]<<8|T[R+2]<<16)>>>0}function g(T,R){return(T[R+0]|T[R+1]<<8|T[R+2]<<16|T[R+3]<<24)>>>0}new c;var h=[0],b=[0],x=[],y=new c,v=r,_=function(T,R){var A={},P=0,H=!1,K=0,ce=0;if(A.frames=[],!function(C,O){for(var D=0;D<4;D++)if(C[O+D]!="RIFF".charCodeAt(D))return!0;return!1}(T,R)){for(g(T,R+=4),R+=8;R<T.length;){var me=u(T,R),le=g(T,R+=4);R+=4;var xe=le+(1&le);switch(me){case"VP8 ":case"VP8L":A.frames[P]===void 0&&(A.frames[P]={}),(ge=A.frames[P]).src_off=H?ce:R-8,ge.src_size=K+le+8,P++,H&&(H=!1,K=0,ce=0);break;case"VP8X":(ge=A.header={}).feature_flags=T[R];var we=R+4;ge.canvas_width=1+p(T,we),we+=3,ge.canvas_height=1+p(T,we),we+=3;break;case"ALPH":H=!0,K=xe+8,ce=R-8;break;case"ANIM":(ge=A.header).bgcolor=g(T,R),we=R+4,ge.loop_count=d(T,we),we+=2;break;case"ANMF":var Oe,ge;(ge=A.frames[P]={}).offset_x=2*p(T,R),R+=3,ge.offset_y=2*p(T,R),R+=3,ge.width=1+p(T,R),R+=3,ge.height=1+p(T,R),R+=3,ge.duration=p(T,R),R+=3,Oe=T[R++],ge.dispose=1&Oe,ge.blend=Oe>>1&1}me!="ANMF"&&(R+=xe)}return A}}(v,0);_.response=v,_.rgbaoutput=!0,_.dataurl=!1;var S=_.header?_.header:null,j=_.frames?_.frames:null;if(S){S.loop_counter=S.loop_count,h=[S.canvas_height],b=[S.canvas_width];for(var I=0;I<j.length&&j[I].blend!=0;I++);}var J=j[0],k=y.WebPDecodeRGBA(v,J.src_off,J.src_size,b,h);J.rgba=k,J.imgwidth=b[0],J.imgheight=h[0];for(var F=0;F<b[0]*h[0]*4;F++)x[F]=k[F];return this.width=b,this.height=h,this.data=x,this}(function(r){var e,t,n,a,s,o,l,c,u,d=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new c,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new o,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new o,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new p(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var p=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=C;Object.defineProperty(this,"pdf",{get:function(){return O}});var D=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return D},set:function(pe){D=!!pe}});var M=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return M},set:function(pe){M=!!pe}});var V=0;Object.defineProperty(this,"posX",{get:function(){return V},set:function(pe){isNaN(pe)||(V=pe)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(pe){isNaN(pe)||(oe=pe)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(pe){var ee;typeof pe=="number"?ee=[pe,pe,pe,pe]:((ee=new Array(4))[0]=pe[0],ee[1]=pe.length>=2?pe[1]:ee[0],ee[2]=pe.length>=3?pe[2]:ee[0],ee[3]=pe.length>=4?pe[3]:ee[1]),u.margin=ee}});var he=!1;Object.defineProperty(this,"autoPaging",{get:function(){return he},set:function(pe){he=pe}});var ue=0;Object.defineProperty(this,"lastBreak",{get:function(){return ue},set:function(pe){ue=pe}});var Z=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Z},set:function(pe){Z=pe}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(pe){pe instanceof d&&(u=pe)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(pe){u.path=pe}});var ye=[];Object.defineProperty(this,"ctxStack",{get:function(){return ye},set:function(pe){ye=pe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(pe){var ee;ee=g(pe),this.ctx.fillStyle=ee.style,this.ctx.isFillTransparent=ee.a===0,this.ctx.fillOpacity=ee.a,this.pdf.setFillColor(ee.r,ee.g,ee.b,{a:ee.a}),this.pdf.setTextColor(ee.r,ee.g,ee.b,{a:ee.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(pe){var ee=g(pe);this.ctx.strokeStyle=ee.style,this.ctx.isStrokeTransparent=ee.a===0,this.ctx.strokeOpacity=ee.a,ee.a===0?this.pdf.setDrawColor(255,255,255):(ee.a,this.pdf.setDrawColor(ee.r,ee.g,ee.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(pe){["butt","round","square"].indexOf(pe)!==-1&&(this.ctx.lineCap=pe,this.pdf.setLineCap(pe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(pe){isNaN(pe)||(this.ctx.lineWidth=pe,this.pdf.setLineWidth(pe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(pe){["bevel","round","miter"].indexOf(pe)!==-1&&(this.ctx.lineJoin=pe,this.pdf.setLineJoin(pe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(pe){isNaN(pe)||(this.ctx.miterLimit=pe,this.pdf.setMiterLimit(pe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(pe){this.ctx.textBaseline=pe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(pe){["right","end","center","left","start"].indexOf(pe)!==-1&&(this.ctx.textAlign=pe)}});var Le=null,Ie=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ie},set:function(pe){Le=null,Ie=pe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(pe){var ee;if(this.ctx.font=pe,(ee=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(pe))!==null){var lt=ee[1];ee[2];var Pe=ee[3],at=ee[4];ee[5];var qe=ee[6],ft=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(at)[2];at=Math.floor(ft==="px"?parseFloat(at)*this.pdf.internal.scaleFactor:ft==="em"?parseFloat(at)*this.pdf.getFontSize():parseFloat(at)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(at);var rt=function(Ct){var vt,de,Me=[],Te=Ct.trim();if(Te==="")return Ru;if(Te in fm)return[fm[Te]];for(;Te!=="";){switch(de=null,vt=(Te=pm(Te)).charAt(0)){case'"':case"'":de=y4(Te.substring(1),vt);break;default:de=b4(Te)}if(de===null||(Me.push(de[0]),(Te=pm(de[1]))!==""&&Te.charAt(0)!==","))return Ru;Te=Te.replace(/^,/,"")}return Me}(qe);if(this.fontFaces){var Pt=function(Ct,vt){if(Le===null){var de=function(Me){var Te=[];return Object.keys(Me).forEach(function(Ge){Me[Ge].forEach(function(it){var Xe=null;switch(it){case"bold":Xe={family:Ge,weight:"bold"};break;case"italic":Xe={family:Ge,style:"italic"};break;case"bolditalic":Xe={family:Ge,weight:"bold",style:"italic"};break;case"":case"normal":Xe={family:Ge}}Xe!==null&&(Xe.ref={name:Ge,style:it},Te.push(Xe))})}),Te}(Ct.getFontList());Le=function(Me){for(var Te={},Ge=0;Ge<Me.length;++Ge){var it=Pu(Me[Ge]),Xe=it.family,Ue=it.stretch,Ke=it.style,ct=it.weight;Te[Xe]=Te[Xe]||{},Te[Xe][Ue]=Te[Xe][Ue]||{},Te[Xe][Ue][Ke]=Te[Xe][Ue][Ke]||{},Te[Xe][Ue][Ke][ct]=it}return Te}(de.concat(vt))}return Le}(this.pdf,this.fontFaces),xt=rt.map(function(Ct){return{family:Ct,stretch:"normal",weight:Pe,style:lt}}),Ot=function(Ct,vt,de){for(var Me=(de=de||{}).defaultFontFamily||"times",Te=Object.assign({},v4,de.genericFontFamilies||{}),Ge=null,it=null,Xe=0;Xe<vt.length;++Xe)if(Te[(Ge=Pu(vt[Xe])).family]&&(Ge.family=Te[Ge.family]),Ct.hasOwnProperty(Ge.family)){it=Ct[Ge.family];break}if(!(it=it||Ct[Me]))throw new Error("Could not find a font-family for the rule '"+mm(Ge)+"' and default family '"+Me+"'.");if(it=function(Ue,Ke){if(Ke[Ue])return Ke[Ue];var ct=cd[Ue],ht=ct<=cd.normal?-1:1,Et=hm(Ke,G1,ct,ht);if(!Et)throw new Error("Could not find a matching font-stretch value for "+Ue);return Et}(Ge.stretch,it),it=function(Ue,Ke){if(Ke[Ue])return Ke[Ue];for(var ct=V1[Ue],ht=0;ht<ct.length;++ht)if(Ke[ct[ht]])return Ke[ct[ht]];throw new Error("Could not find a matching font-style for "+Ue)}(Ge.style,it),!(it=function(Ue,Ke){if(Ke[Ue])return Ke[Ue];if(Ue===400&&Ke[500])return Ke[500];if(Ue===500&&Ke[400])return Ke[400];var ct=x4[Ue],ht=hm(Ke,K1,ct,Ue<400?-1:1);if(!ht)throw new Error("Could not find a matching font-weight for value "+Ue);return ht}(Ge.weight,it)))throw new Error("Failed to resolve a font for the rule '"+mm(Ge)+"'.");return it}(Pt,xt);this.pdf.setFont(Ot.ref.name,Ot.ref.style)}else{var kt="";(Pe==="bold"||parseInt(Pe,10)>=700||lt==="bold")&&(kt="bold"),lt==="italic"&&(kt+="italic"),kt.length===0&&(kt="normal");for(var Tt="",zt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},At=0;At<rt.length;At++){if(this.pdf.internal.getFont(rt[At],kt,{noFallback:!0,disableWarning:!0})!==void 0){Tt=rt[At];break}if(kt==="bolditalic"&&this.pdf.internal.getFont(rt[At],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Tt=rt[At],kt="bold";else if(this.pdf.internal.getFont(rt[At],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Tt=rt[At],kt="normal";break}}if(Tt===""){for(var wt=0;wt<rt.length;wt++)if(zt[rt[wt]]){Tt=zt[rt[wt]];break}}Tt=Tt===""?"Times":Tt,this.pdf.setFont(Tt,kt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(pe){this.ctx.globalCompositeOperation=pe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(pe){this.ctx.globalAlpha=pe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(pe){this.ctx.lineDashOffset=pe,ge.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(pe){this.ctx.lineDash=pe,ge.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(pe){this.ctx.ignoreClearRect=!!pe}})};p.prototype.setLineDash=function(C){this.lineDash=C},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){j.call(this,"fill",!1)},p.prototype.stroke=function(){j.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(C,O){if(isNaN(C)||isNaN(O))throw dr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var D=this.ctx.transform.applyToPoint(new o(C,O));this.path.push({type:"mt",x:D.x,y:D.y}),this.ctx.lastPoint=new o(C,O)},p.prototype.closePath=function(){var C=new o(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&nr(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){C=new o(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(C.x,C.y)},p.prototype.lineTo=function(C,O){if(isNaN(C)||isNaN(O))throw dr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var D=this.ctx.transform.applyToPoint(new o(C,O));this.path.push({type:"lt",x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},p.prototype.quadraticCurveTo=function(C,O,D,M){if(isNaN(D)||isNaN(M)||isNaN(C)||isNaN(O))throw dr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var V=this.ctx.transform.applyToPoint(new o(D,M)),oe=this.ctx.transform.applyToPoint(new o(C,O));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:V.x,y:V.y}),this.ctx.lastPoint=new o(V.x,V.y)},p.prototype.bezierCurveTo=function(C,O,D,M,V,oe){if(isNaN(V)||isNaN(oe)||isNaN(C)||isNaN(O)||isNaN(D)||isNaN(M))throw dr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var he=this.ctx.transform.applyToPoint(new o(V,oe)),ue=this.ctx.transform.applyToPoint(new o(C,O)),Z=this.ctx.transform.applyToPoint(new o(D,M));this.path.push({type:"bct",x1:ue.x,y1:ue.y,x2:Z.x,y2:Z.y,x:he.x,y:he.y}),this.ctx.lastPoint=new o(he.x,he.y)},p.prototype.arc=function(C,O,D,M,V,oe){if(isNaN(C)||isNaN(O)||isNaN(D)||isNaN(M)||isNaN(V))throw dr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var he=this.ctx.transform.applyToPoint(new o(C,O));C=he.x,O=he.y;var ue=this.ctx.transform.applyToPoint(new o(0,D)),Z=this.ctx.transform.applyToPoint(new o(0,0));D=Math.sqrt(Math.pow(ue.x-Z.x,2)+Math.pow(ue.y-Z.y,2))}Math.abs(V-M)>=2*Math.PI&&(M=0,V=2*Math.PI),this.path.push({type:"arc",x:C,y:O,radius:D,startAngle:M,endAngle:V,counterclockwise:oe})},p.prototype.arcTo=function(C,O,D,M,V){throw new Error("arcTo not implemented.")},p.prototype.rect=function(C,O,D,M){if(isNaN(C)||isNaN(O)||isNaN(D)||isNaN(M))throw dr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,O),this.lineTo(C+D,O),this.lineTo(C+D,O+M),this.lineTo(C,O+M),this.lineTo(C,O),this.lineTo(C+D,O),this.lineTo(C,O)},p.prototype.fillRect=function(C,O,D,M){if(isNaN(C)||isNaN(O)||isNaN(D)||isNaN(M))throw dr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var V={};this.lineCap!=="butt"&&(V.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(V.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,O,D,M),this.fill(),V.hasOwnProperty("lineCap")&&(this.lineCap=V.lineCap),V.hasOwnProperty("lineJoin")&&(this.lineJoin=V.lineJoin)}},p.prototype.strokeRect=function(C,O,D,M){if(isNaN(C)||isNaN(O)||isNaN(D)||isNaN(M))throw dr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(C,O,D,M),this.stroke())},p.prototype.clearRect=function(C,O,D,M){if(isNaN(C)||isNaN(O)||isNaN(D)||isNaN(M))throw dr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,O,D,M))},p.prototype.save=function(C){C=typeof C!="boolean"||C;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,D=0;D<this.pdf.internal.getNumberOfPages();D++)this.pdf.setPage(D+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var M=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=M}},p.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,D=0;D<this.pdf.internal.getNumberOfPages();D++)this.pdf.setPage(D+1),this.pdf.internal.out("Q");this.pdf.setPage(O),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(C){var O,D,M,V;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))O=0,D=0,M=0,V=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(oe!==null)O=parseInt(oe[1]),D=parseInt(oe[2]),M=parseInt(oe[3]),V=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)O=parseInt(oe[1]),D=parseInt(oe[2]),M=parseInt(oe[3]),V=parseFloat(oe[4]);else{if(V=1,typeof C=="string"&&C.charAt(0)!=="#"){var he=new B1(C);C=he.ok?he.toHex():"#000000"}C.length===4?(O=C.substring(1,2),O+=O,D=C.substring(2,3),D+=D,M=C.substring(3,4),M+=M):(O=C.substring(1,3),D=C.substring(3,5),M=C.substring(5,7)),O=parseInt(O,16),D=parseInt(D,16),M=parseInt(M,16)}}return{r:O,g:D,b:M,a:V,style:C}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(C,O,D,M){if(isNaN(O)||isNaN(D)||typeof C!="string")throw dr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(M=isNaN(M)?void 0:M,!h.call(this)){var V=xe(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;P.call(this,{text:C,x:O,y:D,scale:oe,angle:V,align:this.textAlign,maxWidth:M})}},p.prototype.strokeText=function(C,O,D,M){if(isNaN(O)||isNaN(D)||typeof C!="string")throw dr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){M=isNaN(M)?void 0:M;var V=xe(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;P.call(this,{text:C,x:O,y:D,scale:oe,renderingMode:"stroke",angle:V,align:this.textAlign,maxWidth:M})}},p.prototype.measureText=function(C){if(typeof C!="string")throw dr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,D=this.pdf.internal.scaleFactor,M=O.internal.getFontSize(),V=O.getStringUnitWidth(C)*M/O.internal.scaleFactor;return new function(oe){var he=(oe=oe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return he}}),this}({width:V*=Math.round(96*D/72*1e4)/1e4})},p.prototype.scale=function(C,O){if(isNaN(C)||isNaN(O))throw dr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var D=new c(C,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(D)},p.prototype.rotate=function(C){if(isNaN(C))throw dr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new c(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},p.prototype.translate=function(C,O){if(isNaN(C)||isNaN(O))throw dr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var D=new c(1,0,0,1,C,O);this.ctx.transform=this.ctx.transform.multiply(D)},p.prototype.transform=function(C,O,D,M,V,oe){if(isNaN(C)||isNaN(O)||isNaN(D)||isNaN(M)||isNaN(V)||isNaN(oe))throw dr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var he=new c(C,O,D,M,V,oe);this.ctx.transform=this.ctx.transform.multiply(he)},p.prototype.setTransform=function(C,O,D,M,V,oe){C=isNaN(C)?1:C,O=isNaN(O)?0:O,D=isNaN(D)?0:D,M=isNaN(M)?1:M,V=isNaN(V)?0:V,oe=isNaN(oe)?0:oe,this.ctx.transform=new c(C,O,D,M,V,oe)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(C,O,D,M,V,oe,he,ue,Z){var ye=this.pdf.getImageProperties(C),Le=1,Ie=1,pe=1,ee=1;M!==void 0&&ue!==void 0&&(pe=ue/M,ee=Z/V,Le=ye.width/M*ue/M,Ie=ye.height/V*Z/V),oe===void 0&&(oe=O,he=D,O=0,D=0),M!==void 0&&ue===void 0&&(ue=M,Z=V),M===void 0&&ue===void 0&&(ue=ye.width,Z=ye.height);for(var lt,Pe=this.ctx.transform.decompose(),at=xe(Pe.rotate.shx),qe=new c,ft=(qe=(qe=(qe=qe.multiply(Pe.translate)).multiply(Pe.skew)).multiply(Pe.scale)).applyToRectangle(new l(oe-O*pe,he-D*ee,M*Le,V*Ie)),rt=y.call(this,ft),Pt=[],xt=0;xt<rt.length;xt+=1)Pt.indexOf(rt[xt])===-1&&Pt.push(rt[xt]);if(S(Pt),this.autoPaging)for(var Ot=Pt[0],kt=Pt[Pt.length-1],Tt=Ot;Tt<kt+1;Tt++){this.pdf.setPage(Tt);var zt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],At=Tt===1?this.posY+this.margin[0]:this.margin[0],wt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],vt=Tt===1?0:wt+(Tt-2)*Ct;if(this.ctx.clip_path.length!==0){var de=this.path;lt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(lt,this.posX+this.margin[3],-vt+At+this.ctx.prevPageLastElemOffset),I.call(this,"fill",!0),this.path=de}var Me=JSON.parse(JSON.stringify(ft));Me=_([Me],this.posX+this.margin[3],-vt+At+this.ctx.prevPageLastElemOffset)[0];var Te=(Tt>Ot||Tt<kt)&&x.call(this);Te&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],zt,Ct,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",Me.x,Me.y,Me.w,Me.h,null,null,at),Te&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(C,"JPEG",ft.x,ft.y,ft.w,ft.h,null,null,at)};var y=function(C,O,D){var M=[];O=O||this.pdf.internal.pageSize.width,D=D||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var V=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":M.push(Math.floor((C.y+V)/D)+1);break;case"arc":M.push(Math.floor((C.y+V-C.radius)/D)+1),M.push(Math.floor((C.y+V+C.radius)/D)+1);break;case"qct":var oe=we(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);M.push(Math.floor((oe.y+V)/D)+1),M.push(Math.floor((oe.y+oe.h+V)/D)+1);break;case"bct":var he=Oe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);M.push(Math.floor((he.y+V)/D)+1),M.push(Math.floor((he.y+he.h+V)/D)+1);break;case"rect":M.push(Math.floor((C.y+V)/D)+1),M.push(Math.floor((C.y+C.h+V)/D)+1)}for(var ue=0;ue<M.length;ue+=1)for(;this.pdf.internal.getNumberOfPages()<M[ue];)v.call(this);return M},v=function(){var C=this.fillStyle,O=this.strokeStyle,D=this.font,M=this.lineCap,V=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=O,this.font=D,this.lineCap=M,this.lineWidth=V,this.lineJoin=oe},_=function(C,O,D){for(var M=0;M<C.length;M++)switch(C[M].type){case"bct":C[M].x2+=O,C[M].y2+=D;case"qct":C[M].x1+=O,C[M].y1+=D;default:C[M].x+=O,C[M].y+=D}return C},S=function(C){return C.sort(function(O,D){return O-D})},j=function(C,O){for(var D,M,V=this.fillStyle,oe=this.strokeStyle,he=this.lineCap,ue=this.lineWidth,Z=Math.abs(ue*this.ctx.transform.scaleX),ye=this.lineJoin,Le=JSON.parse(JSON.stringify(this.path)),Ie=JSON.parse(JSON.stringify(this.path)),pe=[],ee=0;ee<Ie.length;ee++)if(Ie[ee].x!==void 0)for(var lt=y.call(this,Ie[ee]),Pe=0;Pe<lt.length;Pe+=1)pe.indexOf(lt[Pe])===-1&&pe.push(lt[Pe]);for(var at=0;at<pe.length;at++)for(;this.pdf.internal.getNumberOfPages()<pe[at];)v.call(this);if(S(pe),this.autoPaging)for(var qe=pe[0],ft=pe[pe.length-1],rt=qe;rt<ft+1;rt++){this.pdf.setPage(rt),this.fillStyle=V,this.strokeStyle=oe,this.lineCap=he,this.lineWidth=Z,this.lineJoin=ye;var Pt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xt=rt===1?this.posY+this.margin[0]:this.margin[0],Ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],kt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Tt=rt===1?0:Ot+(rt-2)*kt;if(this.ctx.clip_path.length!==0){var zt=this.path;D=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(D,this.posX+this.margin[3],-Tt+xt+this.ctx.prevPageLastElemOffset),I.call(this,C,!0),this.path=zt}if(M=JSON.parse(JSON.stringify(Le)),this.path=_(M,this.posX+this.margin[3],-Tt+xt+this.ctx.prevPageLastElemOffset),O===!1||rt===0){var At=(rt>qe||rt<ft)&&x.call(this);At&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pt,kt,null).clip().discardPath()),I.call(this,C,O),At&&this.pdf.restoreGraphicsState()}this.lineWidth=ue}else this.lineWidth=Z,I.call(this,C,O),this.lineWidth=ue;this.path=Le},I=function(C,O){if((C!=="stroke"||O||!b.call(this))&&(C==="stroke"||O||!h.call(this))){for(var D,M,V=[],oe=this.path,he=0;he<oe.length;he++){var ue=oe[he];switch(ue.type){case"begin":V.push({begin:!0});break;case"close":V.push({close:!0});break;case"mt":V.push({start:ue,deltas:[],abs:[]});break;case"lt":var Z=V.length;if(oe[he-1]&&!isNaN(oe[he-1].x)&&(D=[ue.x-oe[he-1].x,ue.y-oe[he-1].y],Z>0)){for(;Z>=0;Z--)if(V[Z-1].close!==!0&&V[Z-1].begin!==!0){V[Z-1].deltas.push(D),V[Z-1].abs.push(ue);break}}break;case"bct":D=[ue.x1-oe[he-1].x,ue.y1-oe[he-1].y,ue.x2-oe[he-1].x,ue.y2-oe[he-1].y,ue.x-oe[he-1].x,ue.y-oe[he-1].y],V[V.length-1].deltas.push(D);break;case"qct":var ye=oe[he-1].x+2/3*(ue.x1-oe[he-1].x),Le=oe[he-1].y+2/3*(ue.y1-oe[he-1].y),Ie=ue.x+2/3*(ue.x1-ue.x),pe=ue.y+2/3*(ue.y1-ue.y),ee=ue.x,lt=ue.y;D=[ye-oe[he-1].x,Le-oe[he-1].y,Ie-oe[he-1].x,pe-oe[he-1].y,ee-oe[he-1].x,lt-oe[he-1].y],V[V.length-1].deltas.push(D);break;case"arc":V.push({deltas:[],abs:[],arc:!0}),Array.isArray(V[V.length-1].abs)&&V[V.length-1].abs.push(ue)}}M=O?null:C==="stroke"?"stroke":"fill";for(var Pe=!1,at=0;at<V.length;at++)if(V[at].arc)for(var qe=V[at].abs,ft=0;ft<qe.length;ft++){var rt=qe[ft];rt.type==="arc"?F.call(this,rt.x,rt.y,rt.radius,rt.startAngle,rt.endAngle,rt.counterclockwise,void 0,O,!Pe):H.call(this,rt.x,rt.y),Pe=!0}else if(V[at].close===!0)this.pdf.internal.out("h"),Pe=!1;else if(V[at].begin!==!0){var Pt=V[at].start.x,xt=V[at].start.y;K.call(this,V[at].deltas,Pt,xt),Pe=!0}M&&T.call(this,M),O&&R.call(this)}},J=function(C){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,D=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-D;case"top":return C+O-D;case"hanging":return C+O-2*D;case"middle":return C+O/2-D;default:return C}},k=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(O,D){this.colorStops.push([O,D])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var F=function(C,O,D,M,V,oe,he,ue,Z){for(var ye=me.call(this,D,M,V,oe),Le=0;Le<ye.length;Le++){var Ie=ye[Le];Le===0&&(Z?A.call(this,Ie.x1+C,Ie.y1+O):H.call(this,Ie.x1+C,Ie.y1+O)),ce.call(this,C,O,Ie.x2,Ie.y2,Ie.x3,Ie.y3,Ie.x4,Ie.y4)}ue?R.call(this):T.call(this,he)},T=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},R=function(){this.pdf.clip(),this.pdf.discardPath()},A=function(C,O){this.pdf.internal.out(t(C)+" "+n(O)+" m")},P=function(C){var O;switch(C.align){case"right":case"end":O="right";break;case"center":O="center";break;default:O="left"}var D=this.pdf.getTextDimensions(C.text),M=J.call(this,C.y),V=k.call(this,M)-D.h,oe=this.ctx.transform.applyToPoint(new o(C.x,M)),he=this.ctx.transform.decompose(),ue=new c;ue=(ue=(ue=ue.multiply(he.translate)).multiply(he.skew)).multiply(he.scale);for(var Z,ye,Le,Ie=this.ctx.transform.applyToRectangle(new l(C.x,M,D.w,D.h)),pe=ue.applyToRectangle(new l(C.x,V,D.w,D.h)),ee=y.call(this,pe),lt=[],Pe=0;Pe<ee.length;Pe+=1)lt.indexOf(ee[Pe])===-1&&lt.push(ee[Pe]);if(S(lt),this.autoPaging)for(var at=lt[0],qe=lt[lt.length-1],ft=at;ft<qe+1;ft++){this.pdf.setPage(ft);var rt=ft===1?this.posY+this.margin[0]:this.margin[0],Pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],xt=this.pdf.internal.pageSize.height-this.margin[2],Ot=xt-this.margin[0],kt=this.pdf.internal.pageSize.width-this.margin[1],Tt=kt-this.margin[3],zt=ft===1?0:Pt+(ft-2)*Ot;if(this.ctx.clip_path.length!==0){var At=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(Z,this.posX+this.margin[3],-1*zt+rt),I.call(this,"fill",!0),this.path=At}var wt=_([JSON.parse(JSON.stringify(pe))],this.posX+this.margin[3],-zt+rt+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(ye=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ye*C.scale),Le=this.lineWidth,this.lineWidth=Le*C.scale);var Ct=this.autoPaging!=="text";if(Ct||wt.y+wt.h<=xt){if(Ct||wt.y>=rt&&wt.x<=kt){var vt=Ct?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||kt-wt.x)[0],de=_([JSON.parse(JSON.stringify(Ie))],this.posX+this.margin[3],-zt+rt+this.ctx.prevPageLastElemOffset)[0],Me=Ct&&(ft>at||ft<qe)&&x.call(this);Me&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,Ot,null).clip().discardPath()),this.pdf.text(vt,de.x,de.y,{angle:C.angle,align:O,renderingMode:C.renderingMode}),Me&&this.pdf.restoreGraphicsState()}}else wt.y<xt&&(this.ctx.prevPageLastElemOffset+=xt-wt.y);C.scale>=.01&&(this.pdf.setFontSize(ye),this.lineWidth=Le)}else C.scale>=.01&&(ye=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ye*C.scale),Le=this.lineWidth,this.lineWidth=Le*C.scale),this.pdf.text(C.text,oe.x+this.posX,oe.y+this.posY,{angle:C.angle,align:O,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(ye),this.lineWidth=Le)},H=function(C,O,D,M){D=D||0,M=M||0,this.pdf.internal.out(t(C+D)+" "+n(O+M)+" l")},K=function(C,O,D){return this.pdf.lines(C,O,D,null,null)},ce=function(C,O,D,M,V,oe,he,ue){this.pdf.internal.out([e(a(D+C)),e(s(M+O)),e(a(V+C)),e(s(oe+O)),e(a(he+C)),e(s(ue+O)),"c"].join(" "))},me=function(C,O,D,M){for(var V=2*Math.PI,oe=Math.PI/2;O>D;)O-=V;var he=Math.abs(D-O);he<V&&M&&(he=V-he);for(var ue=[],Z=M?-1:1,ye=O;he>1e-5;){var Le=ye+Z*Math.min(he,oe);ue.push(le.call(this,C,ye,Le)),he-=Math.abs(Le-ye),ye=Le}return ue},le=function(C,O,D){var M=(D-O)/2,V=C*Math.cos(M),oe=C*Math.sin(M),he=V,ue=-oe,Z=he*he+ue*ue,ye=Z+he*V+ue*oe,Le=4/3*(Math.sqrt(2*Z*ye)-ye)/(he*oe-ue*V),Ie=he-Le*ue,pe=ue+Le*he,ee=Ie,lt=-pe,Pe=M+O,at=Math.cos(Pe),qe=Math.sin(Pe);return{x1:C*Math.cos(O),y1:C*Math.sin(O),x2:Ie*at-pe*qe,y2:Ie*qe+pe*at,x3:ee*at-lt*qe,y3:ee*qe+lt*at,x4:C*Math.cos(D),y4:C*Math.sin(D)}},xe=function(C){return 180*C/Math.PI},we=function(C,O,D,M,V,oe){var he=C+.5*(D-C),ue=O+.5*(M-O),Z=V+.5*(D-V),ye=oe+.5*(M-oe),Le=Math.min(C,V,he,Z),Ie=Math.max(C,V,he,Z),pe=Math.min(O,oe,ue,ye),ee=Math.max(O,oe,ue,ye);return new l(Le,pe,Ie-Le,ee-pe)},Oe=function(C,O,D,M,V,oe,he,ue){var Z,ye,Le,Ie,pe,ee,lt,Pe,at,qe,ft,rt,Pt,xt,Ot=D-C,kt=M-O,Tt=V-D,zt=oe-M,At=he-V,wt=ue-oe;for(ye=0;ye<41;ye++)at=(lt=(Le=C+(Z=ye/40)*Ot)+Z*((pe=D+Z*Tt)-Le))+Z*(pe+Z*(V+Z*At-pe)-lt),qe=(Pe=(Ie=O+Z*kt)+Z*((ee=M+Z*zt)-Ie))+Z*(ee+Z*(oe+Z*wt-ee)-Pe),ye==0?(ft=at,rt=qe,Pt=at,xt=qe):(ft=Math.min(ft,at),rt=Math.min(rt,qe),Pt=Math.max(Pt,at),xt=Math.max(xt,qe));return new l(Math.round(ft),Math.round(rt),Math.round(Pt-ft),Math.round(xt-rt))},ge=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,O,D=(C=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:O}));this.prevLineDash!==D&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=D)}}})(_t.API),function(r){var e=function(o){var l,c,u,d,p,g,h,b,x,y;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(p=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(g=(p=((p=((p=((p=(p-(y=p%85))/85)-(x=p%85))/85)-(b=p%85))/85)-(h=p%85))/85)%85,c.push(g+33,h+33,b+33,x+33,y+33)):c.push(122);return function(v,_){for(var S=_;S>0;S--)v.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},t=function(o){var l,c,u,d,p,g=String,h="length",b=255,x="charCodeAt",y="slice",v="replace";for(o[y](-2),o=o[y](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),u=[],d=0,p=(o+=l="uuuuu"[y](o[h]%5||5))[h];p>d;d+=5)c=52200625*(o[x](d)-33)+614125*(o[x](d+1)-33)+7225*(o[x](d+2)-33)+85*(o[x](d+3)-33)+(o[x](d+4)-33),u.push(b&c>>24,b&c>>16,b&c>>8,b&c);return function(_,S){for(var j=S;j>0;j--)_.pop()}(u,l[h]),g.fromCharCode.apply(g,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=rd(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};r.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=t(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(_t.API),function(r){r.loadFile=function(e,t,n){return function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var p=new XMLHttpRequest,g=0,h=function(b){var x=b.length,y=[],v=String.fromCharCode;for(g=0;g<x;g+=1)y.push(v(255&b.charCodeAt(g)));return y.join("")};if(p.open("GET",c,!u),p.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(p.onload=function(){p.status===200?d(h(this.responseText)):d(void 0)}),p.send(null),u&&p.status===200)return h(p.responseText)}(a,s,o)}catch{}return l}(e,t,n)},r.loadImageFile=r.loadFile}(_t.API),function(r){function e(){return(Dt.html2canvas?Promise.resolve(Dt.html2canvas):zs(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function t(){return(Dt.DOMPurify?Promise.resolve(Dt.DOMPurify):zs(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=nr(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)u!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||d.appendChild(l(p,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(t).then(function(u){return this.set({src:a("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var b=d[h],x=b.src.find(function(y){return y.format==="truetype"});x&&u.addFont(x.url,b.ref.name,b.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,u.context2d.save(!0),c(this.prop.container,g)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||_t.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,p){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(g){return u.updateProgress(null,d),g}).then(d,p).then(function(g){return u.updateProgress(1),g})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),g=u.call(p,l,c);return o.convert(g,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,_t.getPageSize=function(l,c,u){if(nr(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var p,g=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+c}var b,x=0,y=0;if(h.hasOwnProperty(g))x=h[g][1]/p,y=h[g][0]/p;else try{x=u[1],y=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",y>x&&(b=y,y=x,x=b);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",x>y&&(b=y,y=x,x=b)}return{width:y,height:x,unit:c,k:p,orientation:l}},r.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Pu):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(_t.API),_t.API.addJS=function(r){return xm=r,this.internal.events.subscribe("postPutResources",function(){gc=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(gc+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),gm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+xm+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){gc!==void 0&&gm!==void 0&&this.internal.out("/Names <</JavaScript "+gc+" 0 R>>")}),this},function(r){var e;r.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=t.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=n.exec(o);if(l!=null){var c=l[1];t.internal.newObjectDeferredBegin(c,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var p=t.internal.newObject();d.push(p);var g=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var h=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<d.length;s++)t.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+h+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,a,s){var o={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=t.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(_t.API),function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,n,a,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,c=function(p){for(var g,h=256*p.charCodeAt(4)+p.charCodeAt(5),b=p.length,x={width:0,height:0,numcomponents:1},y=4;y<b;y+=2){if(y+=h,e.indexOf(p.charCodeAt(y+1))!==-1){g=256*p.charCodeAt(y+5)+p.charCodeAt(y+6),x={width:256*p.charCodeAt(y+7)+p.charCodeAt(y+8),height:g,numcomponents:p.charCodeAt(y+9)};break}h=256*p.charCodeAt(y+2)+p.charCodeAt(y+3)}return x}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:t,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:a}}return d}}(_t.API),_t.API.processPNG=function(r,e,t,n){if(this.__addimage__.isArrayBuffer(r)&&(r=new Uint8Array(r)),this.__addimage__.isArrayBufferView(r)){var a,s=n4(r,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;a=u&&c===1?function(k){for(var F=k.width,T=k.height,R=k.data,A=k.palette,P=k.depth,H=!1,K=[],ce=[],me=void 0,le=!1,xe=0,we=0;we<A.length;we++){var Oe=wf(A[we],4),ge=Oe[0],C=Oe[1],O=Oe[2],D=Oe[3];K.push(ge,C,O),D!=null&&(D===0?(xe++,ce.length<1&&ce.push(we)):D<255&&(le=!0))}if(le||xe>1){H=!0,ce=void 0;var M=F*T;me=new Uint8Array(M);for(var V=new DataView(R.buffer),oe=0;oe<M;oe++){var he=Du(V,oe,P),ue=wf(A[he],4)[3];me[oe]=ue}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:R,alphaBytes:me,needSMask:H,palette:K,mask:ce}}(s):c===2||c===4?function(k){for(var F=k.data,T=k.width,R=k.height,A=k.channels,P=k.depth,H=A===2?"DeviceGray":"DeviceRGB",K=A-1,ce=T*R,me=K,le=ce*me,xe=1*ce,we=Math.ceil(le*P/8),Oe=Math.ceil(xe*P/8),ge=new Uint8Array(we),C=new Uint8Array(Oe),O=new DataView(F.buffer),D=new DataView(ge.buffer),M=new DataView(C.buffer),V=!1,oe=0;oe<ce;oe++){for(var he=oe*A,ue=0;ue<me;ue++)Am(D,Du(O,he+ue,P),oe*me+ue,P);var Z=Du(O,he+me,P);Z<(1<<P)-1&&(V=!0),Am(M,Z,1*oe,P)}return{colorSpace:H,colorsPerPixel:K,colorBytes:ge,alphaBytes:C,needSMask:V}}(s):function(k){var F=k.data,T=k.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:T,colorsPerPixel:T==="DeviceGray"?1:3,colorBytes:F instanceof Uint8Array?F:new Uint8Array(F.buffer),needSMask:!1}}(s);var p,g,h,b=a,x=b.colorSpace,y=b.colorsPerPixel,v=b.colorBytes,_=b.alphaBytes,S=b.needSMask,j=b.palette,I=b.mask,J=null;return n!==_t.API.image_compression.NONE&&typeof rd=="function"?(J=function(k){var F;switch(k){case _t.API.image_compression.FAST:F=11;break;case _t.API.image_compression.MEDIUM:F=13;break;case _t.API.image_compression.SLOW:F=14;break;default:F=12}return F}(n),p=this.decode.FLATE_DECODE,g="/Predictor ".concat(J," "),r=wm(v,o*y,y,n),S&&(h=wm(_,o,1,n))):(p=void 0,g="",r=v,S&&(h=_)),g+="/Colors ".concat(y," /BitsPerComponent ").concat(d," /Columns ").concat(o),(this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r))&&(r=this.__addimage__.arrayBufferToBinaryString(r)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:t,data:r,index:e,filter:p,decodeParameters:g,transparency:I,palette:j,sMask:h,predictor:J,width:o,height:l,bitsPerComponent:d,colorSpace:x}}},function(r){r.processGIF89A=function(e,t,n,a){var s=new S4(e),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new Ou(100).encode(u,100);return r.processJPEG.call(this,d,t,n,a)},r.processGIF87A=r.processGIF89A}(_t.API),Sa.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Sa.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){dr.log("bit decode error:"+t)}},Sa.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}t!==0&&(this.pos+=4-t)}},Sa.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<r;a++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Sa.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}r!==0&&(this.pos+=4-r)}},Sa.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,d=n*this.width*4+4*a;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=r}},Sa.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&t)/t*255|0,u=(o>>11)/e*255|0,d=a*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=r}},Sa.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Sa.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*t;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},Sa.prototype.getData=function(){return this.data},function(r){r.processBMP=function(e,t,n,a){var s=new Sa(e,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new Ou(100).encode(c,100);return r.processJPEG.call(this,u,t,n,a)}}(_t.API),jm.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(e,t,n,a){var s=new jm(e),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new Ou(100).encode(c,100);return r.processJPEG.call(this,u,t,n,a)}}(_t.API),_t.API.processRGBA=function(r,e,t){for(var n=r.data,a=n.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,u=0;u<a;u+=4){var d=n[u],p=n[u+1],g=n[u+2],h=n[u+3];s[l++]=d,s[l++]=p,s[l++]=g,o[c++]=h}var b=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:b,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},_t.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Yi=_t.API,xc=Yi.getCharWidthsArray=function(r,e){var t,n,a=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:a.metadata.Unicode.kerning,d=u.fof?u.fof:1,p=e.doKerning!==!1,g=0,h=r.length,b=0,x=l[0]||c,y=[];for(t=0;t<h;t++)n=r.charCodeAt(t),typeof a.metadata.widthOfString=="function"?y.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(g=p&&nr(u[n])==="object"&&!isNaN(parseInt(u[n][b],10))?u[n][b]/d:0,y.push((l[n]||x)/c+g)),b=n;return y},vm=Yi.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return Yi.processArabic&&(r=Yi.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,t,a)/t:xc.apply(this,arguments).reduce(function(s,o){return s+o},0)},ym=function(r,e,t,n){for(var a=[],s=0,o=r.length,l=0;s!==o&&l+e[s]<t;)l+=e[s],s++;a.push(r.slice(0,s));var c=s;for(l=0;s!==o;)l+e[s]>n&&(a.push(r.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&a.push(r.slice(c,s)),a},bm=function(r,e,t){t||(t={});var n,a,s,o,l,c,u,d=[],p=[d],g=t.textIndent||0,h=0,b=0,x=r.split(" "),y=xc.apply(this,[" ",t])[0];if(c=t.lineIndent===-1?x[0].length+2:t.lineIndent||0){var v=Array(c).join(" "),_=[];x.map(function(j){(j=j.split(/\s*\n/)).length>1?_=_.concat(j.map(function(I,J){return(J&&I.length?`
`:"")+I})):_.push(j[0])}),x=_,c=vm.apply(this,[v,t])}for(s=0,o=x.length;s<o;s++){var S=0;if(n=x[s],c&&n[0]==`
`&&(n=n.substr(1),S=1),g+h+(b=(a=xc.apply(this,[n,t])).reduce(function(j,I){return j+I},0))>e||S){if(b>e){for(l=ym.apply(this,[n,a,e-(g+h),e]),d.push(l.shift()),d=[l.pop()];l.length;)p.push([l.shift()]);b=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(j,I){return j+I},0)}else d=[n];p.push(d),g=b+c,h=y}else d.push(n),g+=h+b,h=y}return u=c?function(j,I){return(I?v:"")+j.join(" ")}:function(j){return j.join(" ")},p.map(u)},Yi.splitTextToSize=function(r,e,t){var n,a=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var p=this.internal.getFont(d.fontName,d.fontStyle),g="Unicode";return p.metadata[g]?{widths:p.metadata[g].widths||{0:1},kerning:p.metadata[g].kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/a;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=t.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(bm.apply(this,[n[l],o,s]));return u},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[t[s]]=e[s],a[e[s]]=t[s];var o=function(g){return"0x"+parseInt(g,10).toString(16)},l=r.__fontmetrics__.compress=function(g){var h,b,x,y,v=["{"];for(var _ in g){if(h=g[_],isNaN(parseInt(_,10))?b="'"+_+"'":(_=parseInt(_,10),b=(b=o(_).slice(2)).slice(0,-1)+a[b.slice(-1)]),typeof h=="number")h<0?(x=o(h).slice(3),y="-"):(x=o(h).slice(2),y=""),x=y+x.slice(0,-1)+a[x.slice(-1)];else{if(nr(h)!=="object")throw new Error("Don't know what to do with value type "+nr(h)+".");x=l(h)}v.push(b+x)}return v.push("}"),v.join("")},c=r.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,b,x,y,v={},_=1,S=v,j=[],I="",J="",k=g.length-1,F=1;F<k;F+=1)(y=g[F])=="'"?h?(x=h.join(""),h=void 0):h=[]:h?h.push(y):y=="{"?(j.push([S,x]),S={},x=void 0):y=="}"?((b=j.pop())[0][b[1]]=S,x=void 0,S=b[0]):y=="-"?_=-1:x===void 0?n.hasOwnProperty(y)?(I+=n[y],x=parseInt(I,16)*_,_=1,I=""):I+=y:n.hasOwnProperty(y)?(J+=n[y],S[x]=parseInt(J,16)*_,_=1,x=void 0,J=""):J+=y;return v},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},p={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(g){var h=g.font,b=p.Unicode[h.postScriptName];b&&(h.metadata.Unicode={},h.metadata.Unicode.widths=b.widths,h.metadata.Unicode.kerning=b.kerning);var x=d.Unicode[h.postScriptName];x&&(h.metadata.Unicode.encoding=x,h.encoding=x.codePages[0])}])}(_t.API),function(r){var e=function(t){for(var n=t.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=t.charCodeAt(s);return a};r.API.events.push(["addFont",function(t){var n=void 0,a=t.font,s=t.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(Pc(l)),o.metadata=r.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(_t),_t.API.addSvgAsImage=function(r,e,t,n,a,s,o,l){if(isNaN(e)||isNaN(t))throw dr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw dr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return(Dt.canvg?Promise.resolve(Dt.canvg):zs(()=>import("./index.es-BxvMfToA.js"),__vite__mapDeps([0,1,2,3]))).catch(function(g){return Promise.reject(new Error("Could not load canvg: "+g))}).then(function(g){return g.default?g.default:g}).then(function(g){return g.fromString(u,r,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(d)}).then(function(){p.addImage(c.toDataURL("image/jpeg",1),e,t,n,a,o,l)})},_t.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,t);return this},_t.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var n,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,p=0;function g(b,x){var y,v=!1;for(y=0;y<b.length;y+=1)b[y]===x&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var h=l.length;for(p=0;p<h;p+=1)t[l[p]].value=t[l[p]].defaultValue,t[l[p]].explicitSet=!1}if(nr(r)==="object"){for(a in r)if(s=r[a],g(l,a)&&s!==void 0){if(t[a].type==="boolean"&&typeof s=="boolean")t[a].value=s;else if(t[a].type==="name"&&g(t[a].valueSet,s))t[a].value=s;else if(t[a].type==="integer"&&Number.isInteger(s))t[a].value=s;else if(t[a].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}t[a].value="["+c.join(" ")+"]"}else t[a].value=t[a].defaultValue;t[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,x=[];for(b in t)t[b].explicitSet===!0&&(t[b].type==="name"?x.push("/"+b+" /"+t[b].value):x.push("/"+b+" "+t[b].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(r){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(_t.API),function(r){var e=r.API,t=e.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],p=0,g=s.length;p<g;++p){if(l=o.metadata.characterToGlyph(s.charCodeAt(p)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(p),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,p,g;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,g=(l=Object.keys(s).sort(function(h,b){return h-b})).length;p<g;p++)o=l[p],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof r.API.TTFFont&&l.encoding==="Identity-H"){for(var p=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",b=0;b<g.length;b++)h+=String.fromCharCode(g[b]);var x=u();d({data:h,addLength1:!0,objectId:x}),c("endobj");var y=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var v=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+eo(l.fontName)),c("/FontFile2 "+x+" 0 R"),c("/FontBBox "+r.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var _=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+eo(l.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+r.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+eo(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+_+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof r.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var p=l.metadata.rawData,g="",h=0;h<p.length;h++)g+=String.fromCharCode(p[h]);var b=u();d({data:g,addLength1:!0,objectId:b}),c("endobj");var x=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var y=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+b+" 0 R"),c("/Flags 96"),c("/FontBBox "+r.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+eo(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var v=0;v<l.metadata.hmtx.widths.length;v++)l.metadata.hmtx.widths[v]=parseInt(l.metadata.hmtx.widths[v]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+eo(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},p=s.mutex||{},g=p.pdfEscape,h=p.activeFontKey,b=p.fonts,x=h,y="",v=0,_="",S=b[x].encoding;if(b[x].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:p};for(_=l,x=h,Array.isArray(l)&&(_=l[0]),v=0;v<_.length;v+=1)b[x].metadata.hasOwnProperty("cmap")&&(o=b[x].metadata.cmap.unicode.codeMap[_[v].charCodeAt(0)]),o||_[v].charCodeAt(0)<256&&b[x].metadata.hasOwnProperty("Unicode")?y+=_[v]:y+="";var j="";return parseInt(x.slice(1))<14||S==="WinAnsiEncoding"?j=g(y,x).split("").map(function(I){return I.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(j=t(y,b[x])),p.isHex=!0,{text:j,x:c,y:u,options:d,mutex:p}};e.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([a(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(a(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=a(Object.assign({},c,{text:o})).text}])}(_t),function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(_t.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var a,s,o,l,c,u,d,p=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","¬´","¬ª","¬´","‚Äπ","‚Ä∫","‚Äπ","‚ÅÖ","‚ÅÜ","‚ÅÖ","‚ÅΩ","‚Åæ","‚ÅΩ","‚Çç","‚Çé","‚Çç","‚â§","‚â•","‚â§","‚å©","‚å™","‚å©","Ôπô","Ôπö","Ôπô","Ôπõ","Ôπú","Ôπõ","Ôπù","Ôπû","Ôπù","Ôπ§","Ôπ•","Ôπ§"],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),_=!1,S=0;this.__bidiEngine__={};var j=function(A){var P=A.charCodeAt(),H=P>>8,K=x[H];return K!==void 0?p[256*K+(255&P)]:H===252||H===253?"AL":v.test(H)?"L":H===8?"R":"N"},I=function(A){for(var P,H=0;H<A.length;H++){if((P=j(A.charAt(H)))==="L")return!1;if(P==="R")return!0}return!1},J=function(A,P,H,K){var ce,me,le,xe,we=P[K];switch(we){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":_=!1;break;case"N":case"AN":break;case"EN":_&&(we="AN");break;case"AL":_=!0,we="R";break;case"WS":case"BN":we="N";break;case"CS":K<1||K+1>=P.length||(ce=H[K-1])!=="EN"&&ce!=="AN"||(me=P[K+1])!=="EN"&&me!=="AN"?we="N":_&&(me="AN"),we=me===ce?me:"N";break;case"ES":we=(ce=K>0?H[K-1]:"B")==="EN"&&K+1<P.length&&P[K+1]==="EN"?"EN":"N";break;case"ET":if(K>0&&H[K-1]==="EN"){we="EN";break}if(_){we="N";break}for(le=K+1,xe=P.length;le<xe&&P[le]==="ET";)le++;we=le<xe&&P[le]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(xe=P.length,le=K+1;le<xe&&P[le]==="NSM";)le++;if(le<xe){var Oe=A[K],ge=Oe>=1425&&Oe<=2303||Oe===64286;if(ce=P[le],ge&&(ce==="R"||ce==="AL")){we="R";break}}}we=K<1||(ce=P[K-1])==="B"?"N":H[K-1];break;case"B":_=!1,a=!0,we=S;break;case"S":s=!0,we="N"}return we},k=function(A,P,H){var K=A.split("");return H&&F(K,H,{hiLevel:S}),K.reverse(),P&&P.reverse(),K.join("")},F=function(A,P,H){var K,ce,me,le,xe,we=-1,Oe=A.length,ge=0,C=[],O=S?h:g,D=[];for(_=!1,a=!1,s=!1,ce=0;ce<Oe;ce++)D[ce]=j(A[ce]);for(me=0;me<Oe;me++){if(xe=ge,C[me]=J(A,D,C,me),K=240&(ge=O[xe][b[C[me]]]),ge&=15,P[me]=le=O[ge][5],K>0)if(K===16){for(ce=we;ce<me;ce++)P[ce]=1;we=-1}else we=-1;if(O[ge][6])we===-1&&(we=me);else if(we>-1){for(ce=we;ce<me;ce++)P[ce]=le;we=-1}D[me]==="B"&&(P[me]=0),H.hiLevel|=le}s&&function(M,V,oe){for(var he=0;he<oe;he++)if(M[he]==="S"){V[he]=S;for(var ue=he-1;ue>=0&&M[ue]==="WS";ue--)V[ue]=S}}(D,P,Oe)},T=function(A,P,H,K,ce){if(!(ce.hiLevel<A)){if(A===1&&S===1&&!a)return P.reverse(),void(H&&H.reverse());for(var me,le,xe,we,Oe=P.length,ge=0;ge<Oe;){if(K[ge]>=A){for(xe=ge+1;xe<Oe&&K[xe]>=A;)xe++;for(we=ge,le=xe-1;we<le;we++,le--)me=P[we],P[we]=P[le],P[le]=me,H&&(me=H[we],H[we]=H[le],H[le]=me);ge=xe}ge++}}},R=function(A,P,H){var K=A.split(""),ce={hiLevel:S};return H||(H=[]),F(K,H,ce),function(me,le,xe){if(xe.hiLevel!==0&&d)for(var we,Oe=0;Oe<me.length;Oe++)le[Oe]===1&&(we=y.indexOf(me[Oe]))>=0&&(me[Oe]=y[we+1])}(K,H,ce),T(2,K,P,H,ce),T(1,K,P,H,ce),K.join("")};return this.__bidiEngine__.doBidiReorder=function(A,P,H){if(function(ce,me){if(me)for(var le=0;le<ce.length;le++)me[le]=le;l===void 0&&(l=I(ce)),u===void 0&&(u=I(ce))}(A,P),o||!c||u)if(o&&c&&l^u)S=l?1:0,A=k(A,P,H);else if(!o&&c&&u)S=l?1:0,A=R(A,P,H),A=k(A,P);else if(!o||l||c||u){if(o&&!c&&l^u)A=k(A,P),l?(S=0,A=R(A,P,H)):(S=1,A=R(A,P,H),A=k(A,P));else if(o&&l&&!c&&u)S=1,A=R(A,P,H),A=k(A,P);else if(!o&&!c&&l^u){var K=d;l?(S=1,A=R(A,P,H),S=0,d=!1,A=R(A,P,H),d=K):(S=0,A=R(A,P,H),A=k(A,P),S=1,d=!1,A=R(A,P,H),d=K,A=k(A,P))}}else S=0,A=R(A,P,H);else S=l?1:0,A=R(A,P,H);return A},this.__bidiEngine__.setOptions=function(A){A&&(o=A.isInputVisual,c=A.isOutputVisual,l=A.isInputRtl,u=A.isOutputRtl,d=A.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([t.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([t.doBidiReorder(a[l])]);n.text=o}else n.text=t.doBidiReorder(a);t.setOptions({isInputVisual:!0})}])}(_t),_t.API.TTFFont=function(){function r(e){var t;if(this.rawData=e,t=this.contents=new Js(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new B4(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new E4(this.contents),this.head=new C4(this),this.name=new F4(this),this.cmap=new X1(this),this.toUnicode={},this.hhea=new j4(this),this.maxp=new P4(this),this.hmtx=new R4(this),this.post=new T4(this),this.os2=new k4(this),this.loca=new M4(this),this.glyf=new D4(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(t=a>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,n){var a,s,o,l;for(o=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/t)||0;return o*(t/1e3)},r.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},r}();var Da,Js=function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(e){var t,n,a;for(a=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)a.push(this.writeByte(e.charCodeAt(t)));return a},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,n,a,s,o,l,c;return e=this.readByte(),t=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*a+16777216*s+65536*o+256*l+c},r.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},r.prototype.write=function(e){var t,n,a,s;for(s=[],n=0,a=e.length;n<a;n++)t=e[n],s.push(this.writeByte(t));return s},r}(),E4=function(){var r;function e(t){var n,a,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,a,s,o,l,c,u,d,p,g,h,b,x;for(x in h=Object.keys(t).length,c=Math.log(2),p=16*Math.floor(Math.log(h)/c),o=Math.floor(p/c),d=16*h-p,(a=new Js).writeInt(this.scalarType),a.writeShort(h),a.writeShort(p),a.writeShort(o),a.writeShort(d),s=16*h,u=a.pos+s,l=null,b=[],t)for(g=t[x],a.writeString(x),a.writeInt(r(g)),a.writeInt(u),a.writeInt(g.length),b=b.concat(g),x==="head"&&(l=u),u+=g.length;u%4;)b.push(0),u++;return a.write(b),n=2981146554-r(a.data),a.pos=l+8,a.writeUInt32(n),a.data},r=function(t){var n,a,s,o;for(t=J1.call(t);t.length%4;)t.push(0);for(s=new Js(t),a=0,n=0,o=t.length;n<o;n=n+=4)a+=s.readUInt32();return 4294967295&a},e}(),A4={}.hasOwnProperty,ts=function(r,e){for(var t in e)A4.call(e,t)&&(r[t]=e[t]);function n(){this.constructor=r}return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r};Da=function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var C4=function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ts(r,Da),r.prototype.tag="head",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},r.prototype.encode=function(e){var t;return(t=new Js).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},r}(),km=function(){function r(e,t){var n,a,s,o,l,c,u,d,p,g,h,b,x,y,v,_,S;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),p=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),g=h/2,e.pos+=6,s=function(){var j,I;for(I=[],c=j=0;0<=g?j<g:j>g;c=0<=g?++j:--j)I.push(e.readUInt16());return I}(),e.pos+=2,x=function(){var j,I;for(I=[],c=j=0;0<=g?j<g:j>g;c=0<=g?++j:--j)I.push(e.readUInt16());return I}(),u=function(){var j,I;for(I=[],c=j=0;0<=g?j<g:j>g;c=0<=g?++j:--j)I.push(e.readUInt16());return I}(),d=function(){var j,I;for(I=[],c=j=0;0<=g?j<g:j>g;c=0<=g?++j:--j)I.push(e.readUInt16());return I}(),a=(this.length-e.pos+this.offset)/2,l=function(){var j,I;for(I=[],c=j=0;0<=a?j<a:j>a;c=0<=a?++j:--j)I.push(e.readUInt16());return I}(),c=v=0,S=s.length;v<S;c=++v)for(y=s[c],n=_=b=x[c];b<=y?_<=y:_>=y;n=b<=y?++_:--_)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-b)-(g-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}e.pos=p}return r.encode=function(e,t){var n,a,s,o,l,c,u,d,p,g,h,b,x,y,v,_,S,j,I,J,k,F,T,R,A,P,H,K,ce,me,le,xe,we,Oe,ge,C,O,D,M,V,oe,he,ue,Z,ye,Le;switch(K=new Js,o=Object.keys(e).sort(function(Ie,pe){return Ie-pe}),t){case"macroman":for(x=0,y=function(){var Ie=[];for(b=0;b<256;++b)Ie.push(0);return Ie}(),_={0:0},s={},ce=0,we=o.length;ce<we;ce++)_[ue=e[a=o[ce]]]==null&&(_[ue]=++x),s[a]={old:e[a],new:_[e[a]]},y[a]=_[e[a]];return K.writeUInt16(1),K.writeUInt16(0),K.writeUInt32(12),K.writeUInt16(0),K.writeUInt16(262),K.writeUInt16(0),K.write(y),{charMap:s,subtable:K.data,maxGlyphID:x+1};case"unicode":for(P=[],p=[],S=0,_={},n={},v=u=null,me=0,Oe=o.length;me<Oe;me++)_[I=e[a=o[me]]]==null&&(_[I]=++S),n[a]={old:I,new:_[I]},l=_[I]-a,v!=null&&l===u||(v&&p.push(v),P.push(a),u=l),v=a;for(v&&p.push(v),p.push(65535),P.push(65535),R=2*(T=P.length),F=2*Math.pow(Math.log(T)/Math.LN2,2),g=Math.log(F/2)/Math.LN2,k=2*T-F,c=[],J=[],h=[],b=le=0,ge=P.length;le<ge;b=++le){if(A=P[b],d=p[b],A===65535){c.push(0),J.push(0);break}if(A-(H=n[A].new)>=32768)for(c.push(0),J.push(2*(h.length+T-b)),a=xe=A;A<=d?xe<=d:xe>=d;a=A<=d?++xe:--xe)h.push(n[a].new);else c.push(H-A),J.push(0)}for(K.writeUInt16(3),K.writeUInt16(1),K.writeUInt32(12),K.writeUInt16(4),K.writeUInt16(16+8*T+2*h.length),K.writeUInt16(0),K.writeUInt16(R),K.writeUInt16(F),K.writeUInt16(g),K.writeUInt16(k),oe=0,C=p.length;oe<C;oe++)a=p[oe],K.writeUInt16(a);for(K.writeUInt16(0),he=0,O=P.length;he<O;he++)a=P[he],K.writeUInt16(a);for(Z=0,D=c.length;Z<D;Z++)l=c[Z],K.writeUInt16(l);for(ye=0,M=J.length;ye<M;ye++)j=J[ye],K.writeUInt16(j);for(Le=0,V=h.length;Le<V;Le++)x=h[Le],K.writeUInt16(x);return{charMap:n,subtable:K.data,maxGlyphID:S+1}}},r}(),X1=function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ts(r,Da),r.prototype.tag="cmap",r.prototype.parse=function(e){var t,n,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)t=new km(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},r.encode=function(e,t){var n,a;return t==null&&(t="macroman"),n=km.encode(e,t),(a=new Js).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},r}(),j4=function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ts(r,Da),r.prototype.tag="hhea",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},r}(),k4=function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ts(r,Da),r.prototype.tag="OS/2",r.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n}(),this.charRange=function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},r}(),T4=function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ts(r,Da),r.prototype.tag="post",r.prototype.parse=function(e){var t,n,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)t=e.readByte(),a.push(this.names.push(e.readString(t)));return a;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},r}(),L4=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},F4=function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ts(r,Da),r.prototype.tag="name",r.prototype.parse=function(e){var t,n,a,s,o,l,c,u,d,p,g;for(e.pos=this.offset,e.readShort(),t=e.readShort(),l=e.readShort(),n=[],s=0;0<=t?s<t:s>t;s=0<=t?++s:--s)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=d=0,p=n.length;d<p;s=++d)a=n[s],e.pos=a.offset,u=e.readString(a.length),o=new L4(u,a),c[g=a.nameID]==null&&(c[g]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},r}(),P4=function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ts(r,Da),r.prototype.tag="maxp",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},r}(),R4=function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ts(r,Da),r.prototype.tag="hmtx",r.prototype.parse=function(e){var t,n,a,s,o,l,c;for(e.pos=this.offset,this.metrics=[],t=0,l=this.file.hhea.numberOfMetrics;0<=l?t<l:t>l;t=0<=l?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],t=u=0;0<=a?u<a:u>a;t=0<=a?++u:--u)d.push(e.readInt16());return d}(),this.widths=(function(){var u,d,p,g;for(g=[],u=0,d=(p=this.metrics).length;u<d;u++)s=p[u],g.push(s.advance);return g}).call(this),n=this.widths[this.widths.length-1],c=[],t=o=0;0<=a?o<a:o>a;t=0<=a?++o:--o)c.push(this.widths.push(n));return c},r.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},r}(),J1=[].slice,D4=function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ts(r,Da),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(e){var t,n,a,s,o,l,c,u,d,p;return e in this.cache?this.cache[e]:(s=this.file.loca,t=this.file.contents,n=s.indexOf(e),(a=s.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+n,o=(l=new Js(t.read(a))).readShort(),u=l.readShort(),p=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[e]=o===-1?new I4(l,u,p,c,d):new O4(l,o,u,p,c,d),this.cache[e]))},r.prototype.encode=function(e,t,n){var a,s,o,l,c;for(o=[],s=[],l=0,c=t.length;l<c;l++)a=e[t[l]],s.push(o.length),a&&(o=o.concat(a.encode(n)));return s.push(o.length),{table:o,offsets:s}},r}(),O4=function(){function r(e,t,n,a,s,o){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),I4=function(){function r(e,t,n,a,s){var o,l;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return r.prototype.encode=function(){var e,t,n;for(t=new Js(J1.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},r}(),M4=function(){function r(){return r.__super__.constructor.apply(this,arguments)}return ts(r,Da),r.prototype.tag="loca",r.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=4)s.push(e.readUInt32());return s}).call(this)},r.prototype.indexOf=function(e){return this.offsets[e]},r.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},r.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<n.length;++o)if(n[o]=a,s<t.length&&t[s]==o){++s,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},r}(),B4=function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,n,a,s;for(t in a=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[t],e[t]=a[n];return e},r.prototype.glyphsFor=function(e){var t,n,a,s,o,l,c;for(a={},o=0,l=e.length;o<l;o++)a[s=e[o]]=this.font.glyf.glyphFor(s);for(s in t=[],a)(n=a[s])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(s in c=this.glyphsFor(t))n=c[s],a[s]=n;return a},r.prototype.encode=function(e,t){var n,a,s,o,l,c,u,d,p,g,h,b,x,y,v;for(a in n=X1.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},v=n.charMap)h[(c=v[a]).old]=c.new;for(b in g=n.maxGlyphID,o)b in h||(h[b]=g++);return d=function(_){var S,j;for(S in j={},_)j[_[S]]=S;return j}(h),p=Object.keys(d).sort(function(_,S){return _-S}),x=function(){var _,S,j;for(j=[],_=0,S=p.length;_<S;_++)l=p[_],j.push(d[l]);return j}(),s=this.font.glyf.encode(o,x,h),u=this.font.loca.encode(s.offsets,x),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},r}();_t.API.PDFObject=function(){var r;function e(){}return r=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,a,s,o;if(Array.isArray(t))return"["+function(){var l,c,u;for(u=[],l=0,c=t.length;l<c;l++)n=t[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(a in s=["<<"],t)o=t[a],s.push("/"+a+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+t},e}();/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xc={};Xc.version="0.18.5";var Z1=1252,U4=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Q1=function(r){U4.indexOf(r)!=-1&&(Z1=r)};function H4(){Q1(1252)}var vl=function(r){Q1(r)};function $4(){vl(1200),H4()}var vc=function(e){return String.fromCharCode(e)},Tm=function(e){return String.fromCharCode(e)},Jc,Ys="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function yl(r){for(var e="",t=0,n=0,a=0,s=0,o=0,l=0,c=0,u=0;u<r.length;)t=r.charCodeAt(u++),s=t>>2,n=r.charCodeAt(u++),o=(t&3)<<4|n>>4,a=r.charCodeAt(u++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),e+=Ys.charAt(s)+Ys.charAt(o)+Ys.charAt(l)+Ys.charAt(c);return e}function Ss(r){var e="",t=0,n=0,a=0,s=0,o=0,l=0,c=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<r.length;)s=Ys.indexOf(r.charAt(u++)),o=Ys.indexOf(r.charAt(u++)),t=s<<2|o>>4,e+=String.fromCharCode(t),l=Ys.indexOf(r.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=Ys.indexOf(r.charAt(u++)),a=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(a));return e}var Jt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),As=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Si(r){return Jt?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function Lm(r){return Jt?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Ca=function(e){return Jt?As(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function N0(r){if(typeof ArrayBuffer>"u")return Ca(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function Tl(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function q4(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}var hn=Jt?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:As(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),a=0;for(e=0,t=0;e<r.length;t+=a,++e)if(a=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function W4(r){for(var e=[],t=0,n=r.length+250,a=Si(r.length+255),s=0;s<r.length;++s){var o=r.charCodeAt(s);if(o<128)a[t++]=o;else if(o<2048)a[t++]=192|o>>6&31,a[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=r.charCodeAt(++s)&1023;a[t++]=240|o>>8&7,a[t++]=128|o>>2&63,a[t++]=128|l>>6&15|(o&3)<<4,a[t++]=128|l&63}else a[t++]=224|o>>12&15,a[t++]=128|o>>6&63,a[t++]=128|o&63;t>n&&(e.push(a.slice(0,t)),t=0,a=Si(65535),n=65530)}return e.push(a.slice(0,t)),hn(e)}var ol=/\u0000/g,yc=/[\u0001-\u0006]/g;function co(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function ja(r,e){var t=""+r;return t.length>=e?t:Ar("0",e-t.length)+t}function Hd(r,e){var t=""+r;return t.length>=e?t:Ar(" ",e-t.length)+t}function Zc(r,e){var t=""+r;return t.length>=e?t:t+Ar(" ",e-t.length)}function z4(r,e){var t=""+Math.round(r);return t.length>=e?t:Ar("0",e-t.length)+t}function V4(r,e){var t=""+r;return t.length>=e?t:Ar("0",e-t.length)+t}var Fm=Math.pow(2,32);function Xi(r,e){if(r>Fm||r<-Fm)return z4(r,e);var t=Math.round(r);return V4(t,e)}function Qc(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Pm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Iu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function G4(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "',r}var Cr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "'},Rm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},K4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function e0(r,e,t){for(var n=r<0?-1:1,a=r*n,s=0,o=1,l=0,c=1,u=0,d=0,p=Math.floor(a);u<e&&(p=Math.floor(a),l=p*o+s,d=p*u+c,!(a-p<5e-8));)a=1/(a-p),s=o,o=l,c=u,u=d;if(d>e&&(u>e?(d=c,l=s):(d=u,l=o)),!t)return[0,n*l,d];var g=Math.floor(n*l/d);return[g,n*l-g*d,d]}function bc(r,e,t){if(r>2958465||r<0)return null;var n=r|0,a=Math.floor(86400*(r-n)),s=0,o=[],l={D:n,T:a,u:86400*(r-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),t&&(s=t3(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var eg=new Date(1899,11,31,0,0,0),Y4=eg.getTime(),X4=new Date(1900,2,1,0,0,0);function tg(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=X4&&(t+=24*60*60*1e3),(t-(Y4+(r.getTimezoneOffset()-eg.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function $d(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function J4(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Z4(r){var e=r<0?12:11,t=$d(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function Q4(r){var e=$d(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function e3(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=Z4(r):e===10?t=r.toFixed(10).substr(0,12):t=Q4(r),$d(J4(t.toUpperCase()))}function ud(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):e3(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Zs(14,tg(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function t3(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function r3(r,e,t,n){var a="",s=0,o=0,l=t.y,c,u=0;switch(r){case 98:l=t.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=t.m,u=e.length;break;case 3:return Iu[t.m-1][1];case 5:return Iu[t.m-1][0];default:return Iu[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=t.d,u=e.length;break;case 3:return Pm[t.q][0];default:return Pm[t.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(t.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=t.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=t.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?ja(t.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(t.S+t.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(a=ja(s,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?ja(c,u):"";return d}function Xs(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var rg=/%/g;function n3(r,e,t){var n=e.replace(rg,""),a=e.length-n.length;return bs(r,n,t*Math.pow(10,2*a))+Ar("%",a)}function a3(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return bs(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function ng(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ng(r,-e);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),t.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var ag=/# (\?+)( ?)\/( ?)(\d+)/;function s3(r,e,t){var n=parseInt(r[4],10),a=Math.round(e*n),s=Math.floor(a/n),o=a-s*n,l=n;return t+(s===0?"":""+s)+" "+(o===0?Ar(" ",r[1].length+1+r[4].length):Hd(o,r[1].length)+r[2]+"/"+r[3]+ja(l,r[4].length))}function i3(r,e,t){return t+(e===0?"":""+e)+Ar(" ",r[1].length+2+r[4].length)}var sg=/^#*0*\.([0#]+)/,ig=/\).*[0#]/,og=/\(###\) ###\\?-####/;function kn(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Dm(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Om(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function o3(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function l3(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function ca(r,e,t){if(r.charCodeAt(0)===40&&!e.match(ig)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ca("n",n,t):"("+ca("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return a3(r,e,t);if(e.indexOf("%")!==-1)return n3(r,e,t);if(e.indexOf("E")!==-1)return ng(e,t);if(e.charCodeAt(0)===36)return"$"+ca(r,e.substr(e.charAt(1)==" "?2:1),t);var a,s,o,l,c=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+Xi(c,e.length);if(e.match(/^[#?]+$/))return a=Xi(t,0),a==="0"&&(a=""),a.length>e.length?a:kn(e.substr(0,e.length-a.length))+a;if(s=e.match(ag))return s3(s,c,u);if(e.match(/^#+0+$/))return u+Xi(c,e.length-e.indexOf("0"));if(s=e.match(sg))return a=Dm(t,s[1].length).replace(/^([^\.]+)$/,"$1."+kn(s[1])).replace(/\.$/,"."+kn(s[1])).replace(/\.(\d*)$/,function(b,x){return"."+x+Ar("0",kn(s[1]).length-x.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+Dm(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Xs(Xi(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ca(r,e,-t):Xs(""+(Math.floor(t)+o3(t,s[1].length)))+"."+ja(Om(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ca(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=co(ca(r,e.replace(/[\\-]/g,""),t)),o=0,co(co(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<a.length?a.charAt(o++):b==="0"?"0":""}));if(e.match(og))return a=ca(r,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=e0(c,Math.pow(10,o)-1,!1),a=""+u,d=bs("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=Zc(l[2],o),d.length<s[4].length&&(d=kn(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=e0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Hd(l[1],o)+s[2]+"/"+s[3]+Zc(l[2],o):Ar(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=Xi(t,0),e.length<=a.length?a:kn(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var p=e.indexOf(".")-o,g=e.length-a.length-p;return kn(e.substr(0,p)+a+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=Om(t,s[1].length),t<0?"-"+ca(r,e,-t):Xs(l3(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?ja(0,3-b.length):"")+b})+"."+ja(o,s[1].length);switch(e){case"###,##0.00":return ca(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Xs(Xi(c,0));return h!=="0"?u+h:"";case"###,###.00":return ca(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ca(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function c3(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return bs(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function u3(r,e,t){var n=e.replace(rg,""),a=e.length-n.length;return bs(r,n,t*Math.pow(10,2*a))+Ar("%",a)}function lg(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+lg(r,-e);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!t.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ga(r,e,t){if(r.charCodeAt(0)===40&&!e.match(ig)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ga("n",n,t):"("+Ga("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return c3(r,e,t);if(e.indexOf("%")!==-1)return u3(r,e,t);if(e.indexOf("E")!==-1)return lg(e,t);if(e.charCodeAt(0)===36)return"$"+Ga(r,e.substr(e.charAt(1)==" "?2:1),t);var a,s,o,l,c=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+ja(c,e.length);if(e.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>e.length?a:kn(e.substr(0,e.length-a.length))+a;if(s=e.match(ag))return i3(s,c,u);if(e.match(/^#+0+$/))return u+ja(c,e.length-e.indexOf("0"));if(s=e.match(sg))return a=(""+t).replace(/^([^\.]+)$/,"$1."+kn(s[1])).replace(/\.$/,"."+kn(s[1])),a=a.replace(/\.(\d*)$/,function(b,x){return"."+x+Ar("0",kn(s[1]).length-x.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Xs(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ga(r,e,-t):Xs(""+t)+"."+Ar("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ga(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=co(Ga(r,e.replace(/[\\-]/g,""),t)),o=0,co(co(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<a.length?a.charAt(o++):b==="0"?"0":""}));if(e.match(og))return a=Ga(r,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=e0(c,Math.pow(10,o)-1,!1),a=""+u,d=bs("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=Zc(l[2],o),d.length<s[4].length&&(d=kn(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=e0(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Hd(l[1],o)+s[2]+"/"+s[3]+Zc(l[2],o):Ar(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+t,e.length<=a.length?a:kn(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var p=e.indexOf(".")-o,g=e.length-a.length-p;return kn(e.substr(0,p)+a+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ga(r,e,-t):Xs(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?ja(0,3-b.length):"")+b})+"."+ja(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=Xs(""+c);return h!=="0"?u+h:"";default:if(e.match(/\.[0#?]*$/))return Ga(r,e.slice(0,e.lastIndexOf(".")),t)+kn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function bs(r,e,t){return(t|0)===t?Ga(r,e,t):ca(r,e,t)}function d3(r){for(var e=[],t=!1,n=0,a=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(a,n-a),a=n+1}if(e[e.length]=r.substr(a),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var cg=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ug(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":Qc(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"‰∏ä":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="‰∏äÂçà/‰∏ãÂçà")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(cg))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function h3(r,e,t,n){for(var a=[],s="",o=0,l="",c="t",u,d,p,g="H";o<r.length;)switch(l=r.charAt(o)){case"G":if(!Qc(r,o))throw new Error("unrecognized character "+l+" in "+r);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(p=r.charCodeAt(++o))!==34&&o<r.length;)s+=String.fromCharCode(p);a[a.length]={t:"t",v:s},++o;break;case"\\":var h=r.charAt(++o),b=h==="("||h===")"?h:"t";a[a.length]={t:b,v:h},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(r.charAt(o+1)==="1"||r.charAt(o+1)==="2"){if(u==null&&(u=bc(e,t,r.charAt(o+1)==="2"),u==null))return"";a[a.length]={t:"X",v:r.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=bc(e,t),u==null))return"";for(s=l;++o<r.length&&r.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=g),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"‰∏ä":var x={t:l,v:l};if(u==null&&(u=bc(e,t)),r.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",o+=3):r.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",o+=5,g="h"):r.substr(o,5).toUpperCase()==="‰∏äÂçà/‰∏ãÂçà"?(u!=null&&(x.v=u.H>=12?"‰∏ãÂçà":"‰∏äÂçà"),x.t="T",o+=5,g="h"):(x.t="t",++o),u==null&&x.t==="T")return"";a[a.length]=x,c=l;break;case"[":for(s=l;r.charAt(o++)!=="]"&&o<r.length;)s+=r.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(cg)){if(u==null&&(u=bc(e,t),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ug(r)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<r.length&&(l=r.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<r.length&&"0#?.,E+-%".indexOf(l=r.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;r.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(r.charAt(o)==" "||r.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<r.length&&"0123456789".indexOf(r.charAt(++o))>-1;)s+=r.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=‚Ç¨acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+r);a[a.length]={t:"t",v:l},++o;break}var y=0,v=0,_;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=g,c="h",y<1&&(y=1);break;case"s":(_=a[o].v.match(/\.0+$/))&&(v=Math.max(v,_[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[o].v.match(/[Hh]/)&&(y=1),y<2&&a[o].v.match(/[Mm]/)&&(y=2),y<3&&a[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var S="",j;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=r3(a[o].t.charCodeAt(0),a[o].v,u,v),a[o].t="t";break;case"n":case"?":for(j=o+1;a[j]!=null&&((l=a[j].t)==="?"||l==="D"||(l===" "||l==="t")&&a[j+1]!=null&&(a[j+1].t==="?"||a[j+1].t==="t"&&a[j+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[j].v==="/"||a[j].v===" "&&a[j+1]!=null&&a[j+1].t=="?"));)a[o].v+=a[j].v,a[j]={v:"",t:";"},++j;S+=a[o].v,o=j-1;break;case"G":a[o].t="t",a[o].v=ud(e,t);break}var I="",J,k;if(S.length>0){S.charCodeAt(0)==40?(J=e<0&&S.charCodeAt(0)===45?-e:e,k=bs("n",S,J)):(J=e<0&&n>1?-e:e,k=bs("n",S,J),J<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),j=k.length-1;var F=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){F=o;break}var T=a.length;if(F===a.length&&k.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(j>=a[o].v.length-1?(j-=a[o].v.length,a[o].v=k.substr(j+1,a[o].v.length)):j<0?a[o].v="":(a[o].v=k.substr(0,j+1),j=-1),a[o].t="t",T=o);j>=0&&T<a.length&&(a[T].v=k.substr(0,j+1)+a[T].v)}else if(F!==a.length&&k.indexOf("E")===-1){for(j=k.indexOf(".")-1,o=F;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===F?a[o].v.indexOf(".")-1:a[o].v.length-1,I=a[o].v.substr(d+1);d>=0;--d)j>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(I=k.charAt(j--)+I);a[o].v=I,a[o].t="t",T=o}for(j>=0&&T<a.length&&(a[T].v=k.substr(0,j+1)+a[T].v),j=k.indexOf(".")+1,o=F;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==F)){for(d=a[o].v.indexOf(".")>-1&&o===F?a[o].v.indexOf(".")+1:0,I=a[o].v.substr(0,d);d<a[o].v.length;++d)j<k.length&&(I+=k.charAt(j++));a[o].v=I,a[o].t="t",T=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(J=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=bs(a[o].t,a[o].v,J),a[o].t="t");var R="";for(o=0;o!==a.length;++o)a[o]!=null&&(R+=a[o].v);return R}var Im=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Mm(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function f3(r,e){var t=d3(r),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(Im),l=t[1].match(Im);return Mm(e,o)?[n,t[0]]:Mm(e,l)?[n,t[1]]:[n,t[o!=null&&l!=null?2:1]]}return[n,s]}function Zs(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Cr)[r],n==null&&(n=t.table&&t.table[Rm[r]]||Cr[Rm[r]]),n==null&&(n=K4[r]||"General");break}if(Qc(n,0))return ud(e,t);e instanceof Date&&(e=tg(e,t.date1904));var a=f3(n,e);if(Qc(a[1]))return ud(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return h3(a[1],e,t,a[0])}function dg(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Cr[t]==null){e<0&&(e=t);continue}if(Cr[t]==r){e=t;break}}e<0&&(e=391)}return Cr[e]=r,e}function S0(r){for(var e=0;e!=392;++e)r[e]!==void 0&&dg(r[e],e)}function E0(){Cr=G4()}var hg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function m3(r){var e=typeof r=="number"?Cr[r]:r;return e=e.replace(hg,"(\\d+)"),new RegExp("^"+e+"$")}function p3(r,e,t){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(e.match(hg)||[]).forEach(function(p,g){var h=parseInt(t[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var g3=function(){var r={};r.version="1.2.0";function e(){for(var k=0,F=new Array(256),T=0;T!=256;++T)k=T,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,F[T]=k;return typeof Int32Array<"u"?new Int32Array(F):F}var t=e();function n(k){var F=0,T=0,R=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)A[R]=k[R];for(R=0;R!=256;++R)for(T=k[R],F=256+R;F<4096;F+=256)T=A[F]=T>>>8^k[T&255];var P=[];for(R=1;R!=16;++R)P[R-1]=typeof Int32Array<"u"?A.subarray(R*256,R*256+256):A.slice(R*256,R*256+256);return P}var a=n(t),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4],d=a[5],p=a[6],g=a[7],h=a[8],b=a[9],x=a[10],y=a[11],v=a[12],_=a[13],S=a[14];function j(k,F){for(var T=F^-1,R=0,A=k.length;R<A;)T=T>>>8^t[(T^k.charCodeAt(R++))&255];return~T}function I(k,F){for(var T=F^-1,R=k.length-15,A=0;A<R;)T=S[k[A++]^T&255]^_[k[A++]^T>>8&255]^v[k[A++]^T>>16&255]^y[k[A++]^T>>>24]^x[k[A++]]^b[k[A++]]^h[k[A++]]^g[k[A++]]^p[k[A++]]^d[k[A++]]^u[k[A++]]^c[k[A++]]^l[k[A++]]^o[k[A++]]^s[k[A++]]^t[k[A++]];for(R+=15;A<R;)T=T>>>8^t[(T^k[A++])&255];return~T}function J(k,F){for(var T=F^-1,R=0,A=k.length,P=0,H=0;R<A;)P=k.charCodeAt(R++),P<128?T=T>>>8^t[(T^P)&255]:P<2048?(T=T>>>8^t[(T^(192|P>>6&31))&255],T=T>>>8^t[(T^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,H=k.charCodeAt(R++)&1023,T=T>>>8^t[(T^(240|P>>8&7))&255],T=T>>>8^t[(T^(128|P>>2&63))&255],T=T>>>8^t[(T^(128|H>>6&15|(P&3)<<4))&255],T=T>>>8^t[(T^(128|H&63))&255]):(T=T>>>8^t[(T^(224|P>>12&15))&255],T=T>>>8^t[(T^(128|P>>6&63))&255],T=T>>>8^t[(T^(128|P&63))&255]);return~T}return r.table=t,r.bstr=j,r.buf=I,r.str=J,r}(),cr=function(){var e={};e.version="1.2.1";function t(q,ne){for(var Y=q.split("/"),Q=ne.split("/"),ae=0,ie=0,Se=Math.min(Y.length,Q.length);ae<Se;++ae){if(ie=Y[ae].length-Q[ae].length)return ie;if(Y[ae]!=Q[ae])return Y[ae]<Q[ae]?-1:1}return Y.length-Q.length}function n(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:n(q.slice(0,-1));var ne=q.lastIndexOf("/");return ne===-1?q:q.slice(0,ne+1)}function a(q){if(q.charAt(q.length-1)=="/")return a(q.slice(0,-1));var ne=q.lastIndexOf("/");return ne===-1?q:q.slice(ne+1)}function s(q,ne){typeof ne=="string"&&(ne=new Date(ne));var Y=ne.getHours();Y=Y<<6|ne.getMinutes(),Y=Y<<5|ne.getSeconds()>>>1,q.write_shift(2,Y);var Q=ne.getFullYear()-1980;Q=Q<<4|ne.getMonth()+1,Q=Q<<5|ne.getDate(),q.write_shift(2,Q)}function o(q){var ne=q.read_shift(2)&65535,Y=q.read_shift(2)&65535,Q=new Date,ae=Y&31;Y>>>=5;var ie=Y&15;Y>>>=4,Q.setMilliseconds(0),Q.setFullYear(Y+1980),Q.setMonth(ie-1),Q.setDate(ae);var Se=ne&31;ne>>>=5;var Fe=ne&63;return ne>>>=6,Q.setHours(ne),Q.setMinutes(Fe),Q.setSeconds(Se<<1),Q}function l(q){Zn(q,0);for(var ne={},Y=0;q.l<=q.length-4;){var Q=q.read_shift(2),ae=q.read_shift(2),ie=q.l+ae,Se={};switch(Q){case 21589:Y=q.read_shift(1),Y&1&&(Se.mtime=q.read_shift(4)),ae>5&&(Y&2&&(Se.atime=q.read_shift(4)),Y&4&&(Se.ctime=q.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}q.l=ie,ne[Q]=Se}return ne}var c;function u(){return c||(c={})}function d(q,ne){if(q[0]==80&&q[1]==75)return ct(q,ne);if((q[0]|32)==109&&(q[1]|32)==105)return jt(q,ne);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var Y=3,Q=512,ae=0,ie=0,Se=0,Fe=0,Ee=0,Ae=[],ke=q.slice(0,512);Zn(ke,0);var Ye=p(ke);switch(Y=Ye[0],Y){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(Ye[1]==0)return ct(q,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+Y)}Q!==512&&(ke=q.slice(0,Q),Zn(ke,28));var Qe=q.slice(0,Q);g(ke,Y);var ot=ke.read_shift(4,"i");if(Y===3&&ot!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ot);ke.l+=4,Se=ke.read_shift(4,"i"),ke.l+=4,ke.chk("00100000","Mini Stream Cutoff Size: "),Fe=ke.read_shift(4,"i"),ae=ke.read_shift(4,"i"),Ee=ke.read_shift(4,"i"),ie=ke.read_shift(4,"i");for(var Ze=-1,st=0;st<109&&(Ze=ke.read_shift(4,"i"),!(Ze<0));++st)Ae[st]=Ze;var Ft=h(q,Q);y(Ee,ie,Ft,Q,Ae);var or=_(Ft,Se,Ae,Q);or[Se].name="!Directory",ae>0&&Fe!==H&&(or[Fe].name="!MiniFAT"),or[Ae[0]].name="!FAT",or.fat_addrs=Ae,or.ssz=Q;var Wt={},_r=[],Oa=[],va=[];S(Se,or,Ft,_r,ae,Wt,Oa,Fe),b(Oa,va,_r),_r.shift();var Ia={FileIndex:Oa,FullPaths:va};return ne&&ne.raw&&(Ia.raw={header:Qe,sectors:Ft}),Ia}function p(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(K,"Header Signature: "),q.l+=16;var ne=q.read_shift(2,"u");return[q.read_shift(2,"u"),ne]}function g(q,ne){var Y=9;switch(q.l+=2,Y=q.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+Y);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+Y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Y)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function h(q,ne){for(var Y=Math.ceil(q.length/ne)-1,Q=[],ae=1;ae<Y;++ae)Q[ae-1]=q.slice(ae*ne,(ae+1)*ne);return Q[Y-1]=q.slice(Y*ne),Q}function b(q,ne,Y){for(var Q=0,ae=0,ie=0,Se=0,Fe=0,Ee=Y.length,Ae=[],ke=[];Q<Ee;++Q)Ae[Q]=ke[Q]=Q,ne[Q]=Y[Q];for(;Fe<ke.length;++Fe)Q=ke[Fe],ae=q[Q].L,ie=q[Q].R,Se=q[Q].C,Ae[Q]===Q&&(ae!==-1&&Ae[ae]!==ae&&(Ae[Q]=Ae[ae]),ie!==-1&&Ae[ie]!==ie&&(Ae[Q]=Ae[ie])),Se!==-1&&(Ae[Se]=Q),ae!==-1&&Q!=Ae[Q]&&(Ae[ae]=Ae[Q],ke.lastIndexOf(ae)<Fe&&ke.push(ae)),ie!==-1&&Q!=Ae[Q]&&(Ae[ie]=Ae[Q],ke.lastIndexOf(ie)<Fe&&ke.push(ie));for(Q=1;Q<Ee;++Q)Ae[Q]===Q&&(ie!==-1&&Ae[ie]!==ie?Ae[Q]=Ae[ie]:ae!==-1&&Ae[ae]!==ae&&(Ae[Q]=Ae[ae]));for(Q=1;Q<Ee;++Q)if(q[Q].type!==0){if(Fe=Q,Fe!=Ae[Fe])do Fe=Ae[Fe],ne[Q]=ne[Fe]+"/"+ne[Q];while(Fe!==0&&Ae[Fe]!==-1&&Fe!=Ae[Fe]);Ae[Q]=-1}for(ne[0]+="/",Q=1;Q<Ee;++Q)q[Q].type!==2&&(ne[Q]+="/")}function x(q,ne,Y){for(var Q=q.start,ae=q.size,ie=[],Se=Q;Y&&ae>0&&Se>=0;)ie.push(ne.slice(Se*P,Se*P+P)),ae-=P,Se=yi(Y,Se*4);return ie.length===0?Re(0):hn(ie).slice(0,q.size)}function y(q,ne,Y,Q,ae){var ie=H;if(q===H){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var Se=Y[q],Fe=(Q>>>2)-1;if(!Se)return;for(var Ee=0;Ee<Fe&&(ie=yi(Se,Ee*4))!==H;++Ee)ae.push(ie);y(yi(Se,Q-4),ne-1,Y,Q,ae)}}function v(q,ne,Y,Q,ae){var ie=[],Se=[];ae||(ae=[]);var Fe=Q-1,Ee=0,Ae=0;for(Ee=ne;Ee>=0;){ae[Ee]=!0,ie[ie.length]=Ee,Se.push(q[Ee]);var ke=Y[Math.floor(Ee*4/Q)];if(Ae=Ee*4&Fe,Q<4+Ae)throw new Error("FAT boundary crossed: "+Ee+" 4 "+Q);if(!q[ke])break;Ee=yi(q[ke],Ae)}return{nodes:ie,data:Vm([Se])}}function _(q,ne,Y,Q){var ae=q.length,ie=[],Se=[],Fe=[],Ee=[],Ae=Q-1,ke=0,Ye=0,Qe=0,ot=0;for(ke=0;ke<ae;++ke)if(Fe=[],Qe=ke+ne,Qe>=ae&&(Qe-=ae),!Se[Qe]){Ee=[];var Ze=[];for(Ye=Qe;Ye>=0;){Ze[Ye]=!0,Se[Ye]=!0,Fe[Fe.length]=Ye,Ee.push(q[Ye]);var st=Y[Math.floor(Ye*4/Q)];if(ot=Ye*4&Ae,Q<4+ot)throw new Error("FAT boundary crossed: "+Ye+" 4 "+Q);if(!q[st]||(Ye=yi(q[st],ot),Ze[Ye]))break}ie[Qe]={nodes:Fe,data:Vm([Ee])}}return ie}function S(q,ne,Y,Q,ae,ie,Se,Fe){for(var Ee=0,Ae=Q.length?2:0,ke=ne[q].data,Ye=0,Qe=0,ot;Ye<ke.length;Ye+=128){var Ze=ke.slice(Ye,Ye+128);Zn(Ze,64),Qe=Ze.read_shift(2),ot=Gd(Ze,0,Qe-Ae),Q.push(ot);var st={name:ot,type:Ze.read_shift(1),color:Ze.read_shift(1),L:Ze.read_shift(4,"i"),R:Ze.read_shift(4,"i"),C:Ze.read_shift(4,"i"),clsid:Ze.read_shift(16),state:Ze.read_shift(4,"i"),start:0,size:0},Ft=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);Ft!==0&&(st.ct=j(Ze,Ze.l-8));var or=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);or!==0&&(st.mt=j(Ze,Ze.l-8)),st.start=Ze.read_shift(4,"i"),st.size=Ze.read_shift(4,"i"),st.size<0&&st.start<0&&(st.size=st.type=0,st.start=H,st.name=""),st.type===5?(Ee=st.start,ae>0&&Ee!==H&&(ne[Ee].name="!StreamData")):st.size>=4096?(st.storage="fat",ne[st.start]===void 0&&(ne[st.start]=v(Y,st.start,ne.fat_addrs,ne.ssz)),ne[st.start].name=st.name,st.content=ne[st.start].data.slice(0,st.size)):(st.storage="minifat",st.size<0?st.size=0:Ee!==H&&st.start!==H&&ne[Ee]&&(st.content=x(st,ne[Ee].data,(ne[Fe]||{}).data))),st.content&&Zn(st.content,0),ie[ot]=st,Se.push(st)}}function j(q,ne){return new Date((ea(q,ne+4)/1e7*Math.pow(2,32)+ea(q,ne)/1e7-11644473600)*1e3)}function I(q,ne){return u(),d(c.readFileSync(q),ne)}function J(q,ne){var Y=ne&&ne.type;switch(Y||Jt&&Buffer.isBuffer(q)&&(Y="buffer"),Y||"base64"){case"file":return I(q,ne);case"base64":return d(Ca(Ss(q)),ne);case"binary":return d(Ca(q),ne)}return d(q,ne)}function k(q,ne){var Y=ne||{},Q=Y.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=Q+"/",q.FileIndex[0]={name:Q,type:5}),Y.CLSID&&(q.FileIndex[0].clsid=Y.CLSID),F(q)}function F(q){var ne="Sh33tJ5";if(!cr.find(q,"/"+ne)){var Y=Re(4);Y[0]=55,Y[1]=Y[3]=50,Y[2]=54,q.FileIndex.push({name:ne,type:2,content:Y,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+ne),T(q)}}function T(q,ne){k(q);for(var Y=!1,Q=!1,ae=q.FullPaths.length-1;ae>=0;--ae){var ie=q.FileIndex[ae];switch(ie.type){case 0:Q?Y=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(ie.R*ie.L*ie.C)&&(Y=!0),ie.R>-1&&ie.L>-1&&ie.R==ie.L&&(Y=!0);break;default:Y=!0;break}}if(!(!Y&&!ne)){var Se=new Date(1987,1,19),Fe=0,Ee=Object.create?Object.create(null):{},Ae=[];for(ae=0;ae<q.FullPaths.length;++ae)Ee[q.FullPaths[ae]]=!0,q.FileIndex[ae].type!==0&&Ae.push([q.FullPaths[ae],q.FileIndex[ae]]);for(ae=0;ae<Ae.length;++ae){var ke=n(Ae[ae][0]);Q=Ee[ke],Q||(Ae.push([ke,{name:a(ke).replace("/",""),type:1,clsid:me,ct:Se,mt:Se,content:null}]),Ee[ke]=!0)}for(Ae.sort(function(ot,Ze){return t(ot[0],Ze[0])}),q.FullPaths=[],q.FileIndex=[],ae=0;ae<Ae.length;++ae)q.FullPaths[ae]=Ae[ae][0],q.FileIndex[ae]=Ae[ae][1];for(ae=0;ae<Ae.length;++ae){var Ye=q.FileIndex[ae],Qe=q.FullPaths[ae];if(Ye.name=a(Qe).replace("/",""),Ye.L=Ye.R=Ye.C=-(Ye.color=1),Ye.size=Ye.content?Ye.content.length:0,Ye.start=0,Ye.clsid=Ye.clsid||me,ae===0)Ye.C=Ae.length>1?1:-1,Ye.size=0,Ye.type=5;else if(Qe.slice(-1)=="/"){for(Fe=ae+1;Fe<Ae.length&&n(q.FullPaths[Fe])!=Qe;++Fe);for(Ye.C=Fe>=Ae.length?-1:Fe,Fe=ae+1;Fe<Ae.length&&n(q.FullPaths[Fe])!=n(Qe);++Fe);Ye.R=Fe>=Ae.length?-1:Fe,Ye.type=1}else n(q.FullPaths[ae+1]||"")==n(Qe)&&(Ye.R=ae+1),Ye.type=2}}}function R(q,ne){var Y=ne||{};if(Y.fileType=="mad")return ga(q,Y);switch(T(q),Y.fileType){case"zip":return Et(q,Y)}var Q=function(ot){for(var Ze=0,st=0,Ft=0;Ft<ot.FileIndex.length;++Ft){var or=ot.FileIndex[Ft];if(or.content){var Wt=or.content.length;Wt>0&&(Wt<4096?Ze+=Wt+63>>6:st+=Wt+511>>9)}}for(var _r=ot.FullPaths.length+3>>2,Oa=Ze+7>>3,va=Ze+127>>7,Ia=Oa+st+_r+va,aa=Ia+127>>7,Cs=aa<=109?0:Math.ceil((aa-109)/127);Ia+aa+Cs+127>>7>aa;)Cs=++aa<=109?0:Math.ceil((aa-109)/127);var xn=[1,Cs,aa,va,_r,st,Ze,0];return ot.FileIndex[0].size=Ze<<6,xn[7]=(ot.FileIndex[0].start=xn[0]+xn[1]+xn[2]+xn[3]+xn[4]+xn[5])+(xn[6]+7>>3),xn}(q),ae=Re(Q[7]<<9),ie=0,Se=0;{for(ie=0;ie<8;++ie)ae.write_shift(1,ce[ie]);for(ie=0;ie<8;++ie)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),ie=0;ie<3;++ie)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,Q[2]),ae.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:H),ae.write_shift(4,Q[3]),ae.write_shift(-4,Q[1]?Q[0]-1:H),ae.write_shift(4,Q[1]),ie=0;ie<109;++ie)ae.write_shift(-4,ie<Q[2]?Q[1]+ie:-1)}if(Q[1])for(Se=0;Se<Q[1];++Se){for(;ie<236+Se*127;++ie)ae.write_shift(-4,ie<Q[2]?Q[1]+ie:-1);ae.write_shift(-4,Se===Q[1]-1?H:Se+1)}var Fe=function(ot){for(Se+=ot;ie<Se-1;++ie)ae.write_shift(-4,ie+1);ot&&(++ie,ae.write_shift(-4,H))};for(Se=ie=0,Se+=Q[1];ie<Se;++ie)ae.write_shift(-4,le.DIFSECT);for(Se+=Q[2];ie<Se;++ie)ae.write_shift(-4,le.FATSECT);Fe(Q[3]),Fe(Q[4]);for(var Ee=0,Ae=0,ke=q.FileIndex[0];Ee<q.FileIndex.length;++Ee)ke=q.FileIndex[Ee],ke.content&&(Ae=ke.content.length,!(Ae<4096)&&(ke.start=Se,Fe(Ae+511>>9)));for(Fe(Q[6]+7>>3);ae.l&511;)ae.write_shift(-4,le.ENDOFCHAIN);for(Se=ie=0,Ee=0;Ee<q.FileIndex.length;++Ee)ke=q.FileIndex[Ee],ke.content&&(Ae=ke.content.length,!(!Ae||Ae>=4096)&&(ke.start=Se,Fe(Ae+63>>6)));for(;ae.l&511;)ae.write_shift(-4,le.ENDOFCHAIN);for(ie=0;ie<Q[4]<<2;++ie){var Ye=q.FullPaths[ie];if(!Ye||Ye.length===0){for(Ee=0;Ee<17;++Ee)ae.write_shift(4,0);for(Ee=0;Ee<3;++Ee)ae.write_shift(4,-1);for(Ee=0;Ee<12;++Ee)ae.write_shift(4,0);continue}ke=q.FileIndex[ie],ie===0&&(ke.start=ke.size?ke.start-1:H);var Qe=ie===0&&Y.root||ke.name;if(Ae=2*(Qe.length+1),ae.write_shift(64,Qe,"utf16le"),ae.write_shift(2,Ae),ae.write_shift(1,ke.type),ae.write_shift(1,ke.color),ae.write_shift(-4,ke.L),ae.write_shift(-4,ke.R),ae.write_shift(-4,ke.C),ke.clsid)ae.write_shift(16,ke.clsid,"hex");else for(Ee=0;Ee<4;++Ee)ae.write_shift(4,0);ae.write_shift(4,ke.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,ke.start),ae.write_shift(4,ke.size),ae.write_shift(4,0)}for(ie=1;ie<q.FileIndex.length;++ie)if(ke=q.FileIndex[ie],ke.size>=4096)if(ae.l=ke.start+1<<9,Jt&&Buffer.isBuffer(ke.content))ke.content.copy(ae,ae.l,0,ke.size),ae.l+=ke.size+511&-512;else{for(Ee=0;Ee<ke.size;++Ee)ae.write_shift(1,ke.content[Ee]);for(;Ee&511;++Ee)ae.write_shift(1,0)}for(ie=1;ie<q.FileIndex.length;++ie)if(ke=q.FileIndex[ie],ke.size>0&&ke.size<4096)if(Jt&&Buffer.isBuffer(ke.content))ke.content.copy(ae,ae.l,0,ke.size),ae.l+=ke.size+63&-64;else{for(Ee=0;Ee<ke.size;++Ee)ae.write_shift(1,ke.content[Ee]);for(;Ee&63;++Ee)ae.write_shift(1,0)}if(Jt)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function A(q,ne){var Y=q.FullPaths.map(function(Ee){return Ee.toUpperCase()}),Q=Y.map(function(Ee){var Ae=Ee.split("/");return Ae[Ae.length-(Ee.slice(-1)=="/"?2:1)]}),ae=!1;ne.charCodeAt(0)===47?(ae=!0,ne=Y[0].slice(0,-1)+ne):ae=ne.indexOf("/")!==-1;var ie=ne.toUpperCase(),Se=ae===!0?Y.indexOf(ie):Q.indexOf(ie);if(Se!==-1)return q.FileIndex[Se];var Fe=!ie.match(yc);for(ie=ie.replace(ol,""),Fe&&(ie=ie.replace(yc,"!")),Se=0;Se<Y.length;++Se)if((Fe?Y[Se].replace(yc,"!"):Y[Se]).replace(ol,"")==ie||(Fe?Q[Se].replace(yc,"!"):Q[Se]).replace(ol,"")==ie)return q.FileIndex[Se];return null}var P=64,H=-2,K="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:H,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(q,ne,Y){u();var Q=R(q,Y);c.writeFileSync(ne,Q)}function we(q){for(var ne=new Array(q.length),Y=0;Y<q.length;++Y)ne[Y]=String.fromCharCode(q[Y]);return ne.join("")}function Oe(q,ne){var Y=R(q,ne);switch(ne&&ne.type||"buffer"){case"file":return u(),c.writeFileSync(ne.filename,Y),Y;case"binary":return typeof Y=="string"?Y:we(Y);case"base64":return yl(typeof Y=="string"?Y:we(Y));case"buffer":if(Jt)return Buffer.isBuffer(Y)?Y:As(Y);case"array":return typeof Y=="string"?Ca(Y):Y}return Y}var ge;function C(q){try{var ne=q.InflateRaw,Y=new ne;if(Y._processChunk(new Uint8Array([3,0]),Y._finishFlushFlag),Y.bytesRead)ge=q;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function O(q,ne){if(!ge)return Ue(q,ne);var Y=ge.InflateRaw,Q=new Y,ae=Q._processChunk(q.slice(q.l),Q._finishFlushFlag);return q.l+=Q.bytesRead,ae}function D(q){return ge?ge.deflateRawSync(q):Ct(q)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(q){var ne=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var ue=typeof Uint8Array<"u",Z=ue?new Uint8Array(256):[],ye=0;ye<256;++ye)Z[ye]=he(ye);function Le(q,ne){var Y=Z[q&255];return ne<=8?Y>>>8-ne:(Y=Y<<8|Z[q>>8&255],ne<=16?Y>>>16-ne:(Y=Y<<8|Z[q>>16&255],Y>>>24-ne))}function Ie(q,ne){var Y=ne&7,Q=ne>>>3;return(q[Q]|(Y<=6?0:q[Q+1]<<8))>>>Y&3}function pe(q,ne){var Y=ne&7,Q=ne>>>3;return(q[Q]|(Y<=5?0:q[Q+1]<<8))>>>Y&7}function ee(q,ne){var Y=ne&7,Q=ne>>>3;return(q[Q]|(Y<=4?0:q[Q+1]<<8))>>>Y&15}function lt(q,ne){var Y=ne&7,Q=ne>>>3;return(q[Q]|(Y<=3?0:q[Q+1]<<8))>>>Y&31}function Pe(q,ne){var Y=ne&7,Q=ne>>>3;return(q[Q]|(Y<=1?0:q[Q+1]<<8))>>>Y&127}function at(q,ne,Y){var Q=ne&7,ae=ne>>>3,ie=(1<<Y)-1,Se=q[ae]>>>Q;return Y<8-Q||(Se|=q[ae+1]<<8-Q,Y<16-Q)||(Se|=q[ae+2]<<16-Q,Y<24-Q)||(Se|=q[ae+3]<<24-Q),Se&ie}function qe(q,ne,Y){var Q=ne&7,ae=ne>>>3;return Q<=5?q[ae]|=(Y&7)<<Q:(q[ae]|=Y<<Q&255,q[ae+1]=(Y&7)>>8-Q),ne+3}function ft(q,ne,Y){var Q=ne&7,ae=ne>>>3;return Y=(Y&1)<<Q,q[ae]|=Y,ne+1}function rt(q,ne,Y){var Q=ne&7,ae=ne>>>3;return Y<<=Q,q[ae]|=Y&255,Y>>>=8,q[ae+1]=Y,ne+8}function Pt(q,ne,Y){var Q=ne&7,ae=ne>>>3;return Y<<=Q,q[ae]|=Y&255,Y>>>=8,q[ae+1]=Y&255,q[ae+2]=Y>>>8,ne+16}function xt(q,ne){var Y=q.length,Q=2*Y>ne?2*Y:ne+5,ae=0;if(Y>=ne)return q;if(Jt){var ie=Lm(Q);if(q.copy)q.copy(ie);else for(;ae<q.length;++ae)ie[ae]=q[ae];return ie}else if(ue){var Se=new Uint8Array(Q);if(Se.set)Se.set(q);else for(;ae<Y;++ae)Se[ae]=q[ae];return Se}return q.length=Q,q}function Ot(q){for(var ne=new Array(q),Y=0;Y<q;++Y)ne[Y]=0;return ne}function kt(q,ne,Y){var Q=1,ae=0,ie=0,Se=0,Fe=0,Ee=q.length,Ae=ue?new Uint16Array(32):Ot(32);for(ie=0;ie<32;++ie)Ae[ie]=0;for(ie=Ee;ie<Y;++ie)q[ie]=0;Ee=q.length;var ke=ue?new Uint16Array(Ee):Ot(Ee);for(ie=0;ie<Ee;++ie)Ae[ae=q[ie]]++,Q<ae&&(Q=ae),ke[ie]=0;for(Ae[0]=0,ie=1;ie<=Q;++ie)Ae[ie+16]=Fe=Fe+Ae[ie-1]<<1;for(ie=0;ie<Ee;++ie)Fe=q[ie],Fe!=0&&(ke[ie]=Ae[Fe+16]++);var Ye=0;for(ie=0;ie<Ee;++ie)if(Ye=q[ie],Ye!=0)for(Fe=Le(ke[ie],Q)>>Q-Ye,Se=(1<<Q+4-Ye)-1;Se>=0;--Se)ne[Fe|Se<<Ye]=Ye&15|ie<<4;return Q}var Tt=ue?new Uint16Array(512):Ot(512),zt=ue?new Uint16Array(32):Ot(32);if(!ue){for(var At=0;At<512;++At)Tt[At]=0;for(At=0;At<32;++At)zt[At]=0}(function(){for(var q=[],ne=0;ne<32;ne++)q.push(5);kt(q,zt,32);var Y=[];for(ne=0;ne<=143;ne++)Y.push(8);for(;ne<=255;ne++)Y.push(9);for(;ne<=279;ne++)Y.push(7);for(;ne<=287;ne++)Y.push(8);kt(Y,Tt,288)})();var wt=function(){for(var ne=ue?new Uint8Array(32768):[],Y=0,Q=0;Y<oe.length-1;++Y)for(;Q<oe[Y+1];++Q)ne[Q]=Y;for(;Q<32768;++Q)ne[Q]=29;var ae=ue?new Uint8Array(259):[];for(Y=0,Q=0;Y<V.length-1;++Y)for(;Q<V[Y+1];++Q)ae[Q]=Y;function ie(Fe,Ee){for(var Ae=0;Ae<Fe.length;){var ke=Math.min(65535,Fe.length-Ae),Ye=Ae+ke==Fe.length;for(Ee.write_shift(1,+Ye),Ee.write_shift(2,ke),Ee.write_shift(2,~ke&65535);ke-- >0;)Ee[Ee.l++]=Fe[Ae++]}return Ee.l}function Se(Fe,Ee){for(var Ae=0,ke=0,Ye=ue?new Uint16Array(32768):[];ke<Fe.length;){var Qe=Math.min(65535,Fe.length-ke);if(Qe<10){for(Ae=qe(Ee,Ae,+(ke+Qe==Fe.length)),Ae&7&&(Ae+=8-(Ae&7)),Ee.l=Ae/8|0,Ee.write_shift(2,Qe),Ee.write_shift(2,~Qe&65535);Qe-- >0;)Ee[Ee.l++]=Fe[ke++];Ae=Ee.l*8;continue}Ae=qe(Ee,Ae,+(ke+Qe==Fe.length)+2);for(var ot=0;Qe-- >0;){var Ze=Fe[ke];ot=(ot<<5^Ze)&32767;var st=-1,Ft=0;if((st=Ye[ot])&&(st|=ke&-32768,st>ke&&(st-=32768),st<ke))for(;Fe[st+Ft]==Fe[ke+Ft]&&Ft<250;)++Ft;if(Ft>2){Ze=ae[Ft],Ze<=22?Ae=rt(Ee,Ae,Z[Ze+1]>>1)-1:(rt(Ee,Ae,3),Ae+=5,rt(Ee,Ae,Z[Ze-23]>>5),Ae+=3);var or=Ze<8?0:Ze-4>>2;or>0&&(Pt(Ee,Ae,Ft-V[Ze]),Ae+=or),Ze=ne[ke-st],Ae=rt(Ee,Ae,Z[Ze]>>3),Ae-=3;var Wt=Ze<4?0:Ze-2>>1;Wt>0&&(Pt(Ee,Ae,ke-st-oe[Ze]),Ae+=Wt);for(var _r=0;_r<Ft;++_r)Ye[ot]=ke&32767,ot=(ot<<5^Fe[ke])&32767,++ke;Qe-=Ft-1}else Ze<=143?Ze=Ze+48:Ae=ft(Ee,Ae,1),Ae=rt(Ee,Ae,Z[Ze]),Ye[ot]=ke&32767,++ke}Ae=rt(Ee,Ae,0)-1}return Ee.l=(Ae+7)/8|0,Ee.l}return function(Ee,Ae){return Ee.length<8?ie(Ee,Ae):Se(Ee,Ae)}}();function Ct(q){var ne=Re(50+Math.floor(q.length*1.1)),Y=wt(q,ne);return ne.slice(0,Y)}var vt=ue?new Uint16Array(32768):Ot(32768),de=ue?new Uint16Array(32768):Ot(32768),Me=ue?new Uint16Array(128):Ot(128),Te=1,Ge=1;function it(q,ne){var Y=lt(q,ne)+257;ne+=5;var Q=lt(q,ne)+1;ne+=5;var ae=ee(q,ne)+4;ne+=4;for(var ie=0,Se=ue?new Uint8Array(19):Ot(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ee=1,Ae=ue?new Uint8Array(8):Ot(8),ke=ue?new Uint8Array(8):Ot(8),Ye=Se.length,Qe=0;Qe<ae;++Qe)Se[M[Qe]]=ie=pe(q,ne),Ee<ie&&(Ee=ie),Ae[ie]++,ne+=3;var ot=0;for(Ae[0]=0,Qe=1;Qe<=Ee;++Qe)ke[Qe]=ot=ot+Ae[Qe-1]<<1;for(Qe=0;Qe<Ye;++Qe)(ot=Se[Qe])!=0&&(Fe[Qe]=ke[ot]++);var Ze=0;for(Qe=0;Qe<Ye;++Qe)if(Ze=Se[Qe],Ze!=0){ot=Z[Fe[Qe]]>>8-Ze;for(var st=(1<<7-Ze)-1;st>=0;--st)Me[ot|st<<Ze]=Ze&7|Qe<<3}var Ft=[];for(Ee=1;Ft.length<Y+Q;)switch(ot=Me[Pe(q,ne)],ne+=ot&7,ot>>>=3){case 16:for(ie=3+Ie(q,ne),ne+=2,ot=Ft[Ft.length-1];ie-- >0;)Ft.push(ot);break;case 17:for(ie=3+pe(q,ne),ne+=3;ie-- >0;)Ft.push(0);break;case 18:for(ie=11+Pe(q,ne),ne+=7;ie-- >0;)Ft.push(0);break;default:Ft.push(ot),Ee<ot&&(Ee=ot);break}var or=Ft.slice(0,Y),Wt=Ft.slice(Y);for(Qe=Y;Qe<286;++Qe)or[Qe]=0;for(Qe=Q;Qe<30;++Qe)Wt[Qe]=0;return Te=kt(or,vt,286),Ge=kt(Wt,de,30),ne}function Xe(q,ne){if(q[0]==3&&!(q[1]&3))return[Si(ne),2];for(var Y=0,Q=0,ae=Lm(ne||1<<18),ie=0,Se=ae.length>>>0,Fe=0,Ee=0;!(Q&1);){if(Q=pe(q,Y),Y+=3,Q>>>1)Q>>1==1?(Fe=9,Ee=5):(Y=it(q,Y),Fe=Te,Ee=Ge);else{Y&7&&(Y+=8-(Y&7));var Ae=q[Y>>>3]|q[(Y>>>3)+1]<<8;if(Y+=32,Ae>0)for(!ne&&Se<ie+Ae&&(ae=xt(ae,ie+Ae),Se=ae.length);Ae-- >0;)ae[ie++]=q[Y>>>3],Y+=8;continue}for(;;){!ne&&Se<ie+32767&&(ae=xt(ae,ie+32767),Se=ae.length);var ke=at(q,Y,Fe),Ye=Q>>>1==1?Tt[ke]:vt[ke];if(Y+=Ye&15,Ye>>>=4,!(Ye>>>8&255))ae[ie++]=Ye;else{if(Ye==256)break;Ye-=257;var Qe=Ye<8?0:Ye-4>>2;Qe>5&&(Qe=0);var ot=ie+V[Ye];Qe>0&&(ot+=at(q,Y,Qe),Y+=Qe),ke=at(q,Y,Ee),Ye=Q>>>1==1?zt[ke]:de[ke],Y+=Ye&15,Ye>>>=4;var Ze=Ye<4?0:Ye-2>>1,st=oe[Ye];for(Ze>0&&(st+=at(q,Y,Ze),Y+=Ze),!ne&&Se<ot&&(ae=xt(ae,ot+100),Se=ae.length);ie<ot;)ae[ie]=ae[ie-st],++ie}}}return ne?[ae,Y+7>>>3]:[ae.slice(0,ie),Y+7>>>3]}function Ue(q,ne){var Y=q.slice(q.l||0),Q=Xe(Y,ne);return q.l+=Q[1],Q[0]}function Ke(q,ne){if(q)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function ct(q,ne){var Y=q;Zn(Y,0);var Q=[],ae=[],ie={FileIndex:Q,FullPaths:ae};k(ie,{root:ne.root});for(var Se=Y.length-4;(Y[Se]!=80||Y[Se+1]!=75||Y[Se+2]!=5||Y[Se+3]!=6)&&Se>=0;)--Se;Y.l=Se+4,Y.l+=4;var Fe=Y.read_shift(2);Y.l+=6;var Ee=Y.read_shift(4);for(Y.l=Ee,Se=0;Se<Fe;++Se){Y.l+=20;var Ae=Y.read_shift(4),ke=Y.read_shift(4),Ye=Y.read_shift(2),Qe=Y.read_shift(2),ot=Y.read_shift(2);Y.l+=8;var Ze=Y.read_shift(4),st=l(Y.slice(Y.l+Ye,Y.l+Ye+Qe));Y.l+=Ye+Qe+ot;var Ft=Y.l;Y.l=Ze+4,ht(Y,Ae,ke,ie,st),Y.l=Ft}return ie}function ht(q,ne,Y,Q,ae){q.l+=2;var ie=q.read_shift(2),Se=q.read_shift(2),Fe=o(q);if(ie&8257)throw new Error("Unsupported ZIP encryption");for(var Ee=q.read_shift(4),Ae=q.read_shift(4),ke=q.read_shift(4),Ye=q.read_shift(2),Qe=q.read_shift(2),ot="",Ze=0;Ze<Ye;++Ze)ot+=String.fromCharCode(q[q.l++]);if(Qe){var st=l(q.slice(q.l,q.l+Qe));(st[21589]||{}).mt&&(Fe=st[21589].mt),((ae||{})[21589]||{}).mt&&(Fe=ae[21589].mt)}q.l+=Qe;var Ft=q.slice(q.l,q.l+Ae);switch(Se){case 8:Ft=O(q,ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var or=!1;ie&8&&(Ee=q.read_shift(4),Ee==134695760&&(Ee=q.read_shift(4),or=!0),Ae=q.read_shift(4),ke=q.read_shift(4)),Ae!=ne&&Ke(or,"Bad compressed size: "+ne+" != "+Ae),ke!=Y&&Ke(or,"Bad uncompressed size: "+Y+" != "+ke),gn(Q,ot,Ft,{unsafe:!0,mt:Fe})}function Et(q,ne){var Y=ne||{},Q=[],ae=[],ie=Re(1),Se=Y.compression?8:0,Fe=0,Ee=0,Ae=0,ke=0,Ye=0,Qe=q.FullPaths[0],ot=Qe,Ze=q.FileIndex[0],st=[],Ft=0;for(Ee=1;Ee<q.FullPaths.length;++Ee)if(ot=q.FullPaths[Ee].slice(Qe.length),Ze=q.FileIndex[Ee],!(!Ze.size||!Ze.content||ot=="Sh33tJ5")){var or=ke,Wt=Re(ot.length);for(Ae=0;Ae<ot.length;++Ae)Wt.write_shift(1,ot.charCodeAt(Ae)&127);Wt=Wt.slice(0,Wt.l),st[Ye]=g3.buf(Ze.content,0);var _r=Ze.content;Se==8&&(_r=D(_r)),ie=Re(30),ie.write_shift(4,67324752),ie.write_shift(2,20),ie.write_shift(2,Fe),ie.write_shift(2,Se),Ze.mt?s(ie,Ze.mt):ie.write_shift(4,0),ie.write_shift(-4,st[Ye]),ie.write_shift(4,_r.length),ie.write_shift(4,Ze.content.length),ie.write_shift(2,Wt.length),ie.write_shift(2,0),ke+=ie.length,Q.push(ie),ke+=Wt.length,Q.push(Wt),ke+=_r.length,Q.push(_r),ie=Re(46),ie.write_shift(4,33639248),ie.write_shift(2,0),ie.write_shift(2,20),ie.write_shift(2,Fe),ie.write_shift(2,Se),ie.write_shift(4,0),ie.write_shift(-4,st[Ye]),ie.write_shift(4,_r.length),ie.write_shift(4,Ze.content.length),ie.write_shift(2,Wt.length),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(4,0),ie.write_shift(4,or),Ft+=ie.l,ae.push(ie),Ft+=Wt.length,ae.push(Wt),++Ye}return ie=Re(22),ie.write_shift(4,101010256),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,Ye),ie.write_shift(2,Ye),ie.write_shift(4,Ft),ie.write_shift(4,ke),ie.write_shift(2,0),hn([hn(Q),hn(ae),ie])}var ut={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Lt(q,ne){if(q.ctype)return q.ctype;var Y=q.name||"",Q=Y.match(/\.([^\.]+)$/);return Q&&ut[Q[1]]||ne&&(Q=(Y=ne).match(/[\.\\]([^\.\\])+$/),Q&&ut[Q[1]])?ut[Q[1]]:"application/octet-stream"}function ma(q){for(var ne=yl(q),Y=[],Q=0;Q<ne.length;Q+=76)Y.push(ne.slice(Q,Q+76));return Y.join(`\r
`)+`\r
`}function Jr(q){var ne=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ae){var ke=Ae.charCodeAt(0).toString(16).toUpperCase();return"="+(ke.length==1?"0"+ke:ke)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Y=[],Q=ne.split(`\r
`),ae=0;ae<Q.length;++ae){var ie=Q[ae];if(ie.length==0){Y.push("");continue}for(var Se=0;Se<ie.length;){var Fe=76,Ee=ie.slice(Se,Se+Fe);Ee.charAt(Fe-1)=="="?Fe--:Ee.charAt(Fe-2)=="="?Fe-=2:Ee.charAt(Fe-3)=="="&&(Fe-=3),Ee=ie.slice(Se,Se+Fe),Se+=Fe,Se<ie.length&&(Ee+="="),Y.push(Ee)}}return Y.join(`\r
`)}function pa(q){for(var ne=[],Y=0;Y<q.length;++Y){for(var Q=q[Y];Y<=q.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+q[++Y];ne.push(Q)}for(var ae=0;ae<ne.length;++ae)ne[ae]=ne[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(ie){return String.fromCharCode(parseInt(ie.slice(1),16))});return Ca(ne.join(`\r
`))}function na(q,ne,Y){for(var Q="",ae="",ie="",Se,Fe=0;Fe<10;++Fe){var Ee=ne[Fe];if(!Ee||Ee.match(/^\s*$/))break;var Ae=Ee.match(/^(.*?):\s*([^\s].*)$/);if(Ae)switch(Ae[1].toLowerCase()){case"content-location":Q=Ae[2].trim();break;case"content-type":ie=Ae[2].trim();break;case"content-transfer-encoding":ae=Ae[2].trim();break}}switch(++Fe,ae.toLowerCase()){case"base64":Se=Ca(Ss(ne.slice(Fe).join("")));break;case"quoted-printable":Se=pa(ne.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var ke=gn(q,Q.slice(Y.length),Se,{unsafe:!0});ie&&(ke.ctype=ie)}function jt(q,ne){if(we(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Y=ne&&ne.root||"",Q=(Jt&&Buffer.isBuffer(q)?q.toString("binary"):we(q)).split(`\r
`),ae=0,ie="";for(ae=0;ae<Q.length;++ae)if(ie=Q[ae],!!/^Content-Location:/i.test(ie)&&(ie=ie.slice(ie.indexOf("file")),Y||(Y=ie.slice(0,ie.lastIndexOf("/")+1)),ie.slice(0,Y.length)!=Y))for(;Y.length>0&&(Y=Y.slice(0,Y.length-1),Y=Y.slice(0,Y.lastIndexOf("/")+1),ie.slice(0,Y.length)!=Y););var Se=(Q[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var Fe="--"+(Se[1]||""),Ee=[],Ae=[],ke={FileIndex:Ee,FullPaths:Ae};k(ke);var Ye,Qe=0;for(ae=0;ae<Q.length;++ae){var ot=Q[ae];ot!==Fe&&ot!==Fe+"--"||(Qe++&&na(ke,Q.slice(Ye,ae),Y),Ye=ae)}return ke}function ga(q,ne){var Y=ne||{},Q=Y.boundary||"SheetJS";Q="------="+Q;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],ie=q.FullPaths[0],Se=ie,Fe=q.FileIndex[0],Ee=1;Ee<q.FullPaths.length;++Ee)if(Se=q.FullPaths[Ee].slice(ie.length),Fe=q.FileIndex[Ee],!(!Fe.size||!Fe.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ft){return"_x"+Ft.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ft){return"_u"+Ft.charCodeAt(0).toString(16)+"_"});for(var Ae=Fe.content,ke=Jt&&Buffer.isBuffer(Ae)?Ae.toString("binary"):we(Ae),Ye=0,Qe=Math.min(1024,ke.length),ot=0,Ze=0;Ze<=Qe;++Ze)(ot=ke.charCodeAt(Ze))>=32&&ot<128&&++Ye;var st=Ye>=Qe*4/5;ae.push(Q),ae.push("Content-Location: "+(Y.root||"file:///C:/SheetJS/")+Se),ae.push("Content-Transfer-Encoding: "+(st?"quoted-printable":"base64")),ae.push("Content-Type: "+Lt(Fe,Se)),ae.push(""),ae.push(st?Jr(ke):ma(ke))}return ae.push(Q+`--\r
`),ae.join(`\r
`)}function xa(q){var ne={};return k(ne,q),ne}function gn(q,ne,Y,Q){var ae=Q&&Q.unsafe;ae||k(q);var ie=!ae&&cr.find(q,ne);if(!ie){var Se=q.FullPaths[0];ne.slice(0,Se.length)==Se?Se=ne:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+ne).replace("//","/")),ie={name:a(ne),type:2},q.FileIndex.push(ie),q.FullPaths.push(Se),ae||cr.utils.cfb_gc(q)}return ie.content=Y,ie.size=Y?Y.length:0,Q&&(Q.CLSID&&(ie.clsid=Q.CLSID),Q.mt&&(ie.mt=Q.mt),Q.ct&&(ie.ct=Q.ct)),ie}function Pn(q,ne){k(q);var Y=cr.find(q,ne);if(Y){for(var Q=0;Q<q.FileIndex.length;++Q)if(q.FileIndex[Q]==Y)return q.FileIndex.splice(Q,1),q.FullPaths.splice(Q,1),!0}return!1}function vr(q,ne,Y){k(q);var Q=cr.find(q,ne);if(Q){for(var ae=0;ae<q.FileIndex.length;++ae)if(q.FileIndex[ae]==Q)return q.FileIndex[ae].name=a(Y),q.FullPaths[ae]=Y,!0}return!1}function Ir(q){T(q,!0)}return e.find=A,e.read=J,e.parse=d,e.write=Oe,e.writeFile=xe,e.utils={cfb_new:xa,cfb_add:gn,cfb_del:Pn,cfb_mov:vr,cfb_gc:Ir,ReadShift:cl,CheckField:Tg,prep_blob:Zn,bconcat:hn,use_zlib:C,_deflateRaw:Ct,_inflateRaw:Ue,consts:le},e}();function x3(r){return typeof r=="string"?N0(r):Array.isArray(r)?q4(r):r}function Ll(r,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=N0(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?wl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var a=new Blob([x3(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,r);if(typeof saveAs<"u")return saveAs(a,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=r,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(r);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=Tl(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+r)}function pn(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function Bm(r,e){for(var t=[],n=pn(r),a=0;a!==n.length;++a)t[r[n[a]][e]]==null&&(t[r[n[a]][e]]=n[a]);return t}function qd(r){for(var e=[],t=pn(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function A0(r){for(var e=[],t=pn(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function v3(r){for(var e=[],t=pn(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var t0=new Date(1899,11,30,0,0,0);function Bn(r,e){var t=r.getTime(),n=t0.getTime()+(r.getTimezoneOffset()-t0.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var fg=new Date,y3=t0.getTime()+(fg.getTimezoneOffset()-t0.getTimezoneOffset())*6e4,Um=fg.getTimezoneOffset();function mg(r){var e=new Date;return e.setTime(r*24*60*60*1e3+y3),e.getTimezoneOffset()!==Um&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Um)*6e4),e}var Hm=new Date("2017-02-19T19:06:09.000Z"),pg=isNaN(Hm.getFullYear())?new Date("2/19/17"):Hm,b3=pg.getFullYear()==2017;function Ln(r,e){var t=new Date(r);if(b3)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(pg.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function C0(r,e){if(Jt&&Buffer.isBuffer(r))return r.toString("binary");if(typeof TextDecoder<"u")try{var t={"‚Ç¨":"¬Ä","‚Äö":"¬Ç",∆í:"¬É","‚Äû":"¬Ñ","‚Ä¶":"¬Ö","‚Ä†":"¬Ü","‚Ä°":"¬á","ÀÜ":"¬à","‚Ä∞":"¬â",≈†:"¬ä","‚Äπ":"¬ã",≈í:"¬å",≈Ω:"¬é","‚Äò":"¬ë","‚Äô":"¬í","‚Äú":"¬ì","‚Äù":"¬î","‚Ä¢":"¬ï","‚Äì":"¬ñ","‚Äî":"¬ó","Àú":"¬ò","‚Ñ¢":"¬ô",≈°:"¬ö","‚Ä∫":"¬õ",≈ì:"¬ú",≈æ:"¬û",≈∏:"¬ü"};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[‚Ç¨‚Äö∆í‚Äû‚Ä¶‚Ä†‚Ä°ÀÜ‚Ä∞≈†‚Äπ≈í≈Ω‚Äò‚Äô‚Äú‚Äù‚Ä¢‚Äì‚ÄîÀú‚Ñ¢≈°‚Ä∫≈ì≈æ≈∏]/g,function(s){return t[s]||s})}catch{}for(var n=[],a=0;a!=r.length;++a)n.push(String.fromCharCode(r[a]));return n.join("")}function Un(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Un(r[t]));return e}function Ar(r,e){for(var t="";t.length<e;)t+=r;return t}function ws(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var w3=["january","february","march","april","may","june","july","august","september","october","november","december"];function bl(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var o=r.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&w3.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}function qt(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return Jt?n=As(t):n=W4(t),cr.utils.cfb_add(r,e,n)}cr.utils.cfb_add(r,e,t)}else r.file(e,t)}function Wd(){return cr.utils.cfb_new()}var Wr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},zd=qd(_3),Vd=/[&<>'"]/g,N3=/[\u0000-\u0008\u000b-\u001f]/g;function sr(r){var e=r+"";return e.replace(Vd,function(t){return zd[t]}).replace(N3,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function $m(r){return sr(r).replace(/ /g,"_x0020_")}var gg=/[\u0000-\u001f]/g;function S3(r){var e=r+"";return e.replace(Vd,function(t){return zd[t]}).replace(/\n/g,"<br/>").replace(gg,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function E3(r){var e=r+"";return e.replace(Vd,function(t){return zd[t]}).replace(gg,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function A3(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function C3(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Mu(r){for(var e="",t=0,n=0,a=0,s=0,o=0,l=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(a=r.charCodeAt(t++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=r.charCodeAt(t++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function qm(r){var e=Si(2*r.length),t,n,a=1,s=0,o=0,l;for(n=0;n<r.length;n+=a)a=1,(l=r.charCodeAt(n))<128?t=l:l<224?(t=(l&31)*64+(r.charCodeAt(n+1)&63),a=2):l<240?(t=(l&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),a=3):(a=4,t=(l&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function Wm(r){return As(r,"binary").toString("utf8")}var wc="foo bar baz√¢¬ò¬É√∞¬ü¬ç¬£",ll=Jt&&(Wm(wc)==Mu(wc)&&Wm||qm(wc)==Mu(wc)&&qm)||Mu,wl=Jt?function(r){return As(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,a=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},j3=function(){var r=[["nbsp"," "],["middot","¬∑"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<r.length;++a)n=n.replace(r[a][0],r[a][1]);return n}}(),xg=/(^\s|\s$|\n)/;function fn(r,e){return"<"+r+(e.match(xg)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function _l(r){return pn(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function et(r,e,t){return"<"+r+(t!=null?_l(t):"")+(e!=null?(e.match(xg)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function dd(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function k3(r,e){switch(typeof r){case"string":var t=et("vt:lpwstr",sr(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return et((r|0)==r?"vt:i4":"vt:r8",sr(String(r)));case"boolean":return et("vt:bool",r?"true":"false")}if(r instanceof Date)return et("vt:filetime",dd(r));throw new Error("Unable to serialize "+r)}var tn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_o=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Qn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function T3(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),a=r[e+6]&15,s=5;s>=0;--s)a=a*256+r[e+s];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function L3(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,o=n?-e:e;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var l=0;l<=5;++l,s/=256)r[t+l]=s&255;r[t+6]=(a&15)<<4|s&15,r[t+7]=a>>4|n}var zm=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var a=0,s=r[0][n].length;a<s;a+=t)e.push.apply(e,r[0][n].slice(a,a+t));return e},Vm=Jt?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:As(e)})):zm(r)}:zm,Gm=function(r,e,t){for(var n=[],a=e;a<t;a+=2)n.push(String.fromCharCode(nl(r,a)));return n.join("").replace(ol,"")},Gd=Jt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(ol,""):Gm(r,e,t)}:Gm,Km=function(r,e,t){for(var n=[],a=e;a<e+t;++a)n.push(("0"+r[a].toString(16)).slice(-2));return n.join("")},vg=Jt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):Km(r,e,t)}:Km,Ym=function(r,e,t){for(var n=[],a=e;a<t;a++)n.push(String.fromCharCode(to(r,a)));return n.join("")},Fl=Jt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):Ym(e,t,n)}:Ym,yg=function(r,e){var t=ea(r,e);return t>0?Fl(r,e+4,e+4+t-1):""},bg=yg,wg=function(r,e){var t=ea(r,e);return t>0?Fl(r,e+4,e+4+t-1):""},_g=wg,Ng=function(r,e){var t=2*ea(r,e);return t>0?Fl(r,e+4,e+4+t-1):""},Sg=Ng,Eg=function(e,t){var n=ea(e,t);return n>0?Gd(e,t+4,t+4+n):""},Ag=Eg,Cg=function(r,e){var t=ea(r,e);return t>0?Fl(r,e+4,e+4+t):""},jg=Cg,kg=function(r,e){return T3(r,e)},r0=kg,Kd=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Jt&&(bg=function(e,t){if(!Buffer.isBuffer(e))return yg(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},_g=function(e,t){if(!Buffer.isBuffer(e))return wg(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Sg=function(e,t){if(!Buffer.isBuffer(e))return Ng(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},Ag=function(e,t){if(!Buffer.isBuffer(e))return Eg(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},jg=function(e,t){if(!Buffer.isBuffer(e))return Cg(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},r0=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):kg(e,t)},Kd=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var to=function(r,e){return r[e]},nl=function(r,e){return r[e+1]*256+r[e]},F3=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},ea=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},yi=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},P3=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function cl(r,e){var t="",n,a,s=[],o,l,c,u;switch(e){case"dbcs":if(u=this.l,Jt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(c=0;c<r;++c)t+=String.fromCharCode(nl(this,u)),u+=2;r*=2;break;case"utf8":t=Fl(this,this.l,this.l+r);break;case"utf16le":r*=2,t=Gd(this,this.l,this.l+r);break;case"wstr":return cl.call(this,r,"dbcs");case"lpstr-ansi":t=bg(this,this.l),r=4+ea(this,this.l);break;case"lpstr-cp":t=_g(this,this.l),r=4+ea(this,this.l);break;case"lpwstr":t=Sg(this,this.l),r=4+2*ea(this,this.l);break;case"lpp4":r=4+ea(this,this.l),t=Ag(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+ea(this,this.l),t=jg(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(o=to(this,this.l+r++))!==0;)s.push(vc(o));t=s.join("");break;case"_wstr":for(r=0,t="";(o=nl(this,this.l+r))!==0;)s.push(vc(o)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,c=0;c<r;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=to(this,u),this.l=u+1,l=cl.call(this,r-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(vc(nl(this,u))),u+=2}t=s.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,c=0;c!=r;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=to(this,u),this.l=u+1,l=cl.call(this,r-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(vc(to(this,u))),u+=1}t=s.join("");break;default:switch(r){case 1:return n=to(this,this.l),this.l++,n;case 2:return n=(e==="i"?F3:nl)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(r>0?yi:P3)(this,this.l),this.l+=4,n):(a=ea(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return r==8?a=r0(this,this.l):a=r0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;r=8;case 16:t=vg(this,this.l,r);break}}return this.l+=r,t}var R3=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},D3=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},O3=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function I3(r,e,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=e.length;++a)O3(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(t==="hex"){for(;a<r;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+r,this.length);for(a=0;a<Math.min(e.length,r);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,R3(this,e,this.l);break;case 8:if(n=8,t==="f"){L3(this,e,this.l);break}case 16:break;case-4:n=4,D3(this,e,this.l);break}return this.l+=n,this}function Tg(r,e){var t=vg(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function Zn(r,e){r.l=e,r.read_shift=cl,r.chk=Tg,r.write_shift=I3}function Qa(r,e){r.l+=e}function Re(r){var e=Si(r);return Zn(e,0),e}function Mn(){var r=[],e=Jt?256:2048,t=function(u){var d=Re(u);return Zn(d,0),d},n=t(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=t(Math.max(u+1,e)))},o=function(){return a(),hn(r)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:l,end:o,_bufs:r}}function We(r,e,t,n){var a=+e,s;if(!isNaN(a)){n||(n=TA[a].p||(t||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=r.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Kd(t)&&r.push(t)}}function ul(r,e,t){var n=Un(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Xm(r,e,t){var n=Un(r);return n.s=ul(n.s,e.s,t),n.e=ul(n.e,e.s,t),n}function dl(r,e){if(r.cRel&&r.c<0)for(r=Un(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=Un(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=ir(r);return!r.cRel&&r.cRel!=null&&(t=U3(t)),!r.rRel&&r.rRel!=null&&(t=M3(t)),t}function Bu(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Nn(r.s.c)+":"+(r.e.cRel?"":"$")+Nn(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+mn(r.s.r)+":"+(r.e.rRel?"":"$")+mn(r.e.r):dl(r.s,e.biff)+":"+dl(r.e,e.biff)}function Yd(r){return parseInt(B3(r),10)-1}function mn(r){return""+(r+1)}function M3(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function B3(r){return r.replace(/\$(\d+)$/,"$1")}function Xd(r){for(var e=H3(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function Nn(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function U3(r){return r.replace(/^([A-Z])/,"$$$1")}function H3(r){return r.replace(/^\$([A-Z])/,"$1")}function $3(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function rn(r){for(var e=0,t=0,n=0;n<r.length;++n){var a=r.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:e-1}}function ir(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function ra(r){var e=r.indexOf(":");return e==-1?{s:rn(r),e:rn(r)}:{s:rn(r.slice(0,e)),e:rn(r.slice(e+1))}}function qr(r,e){return typeof e>"u"||typeof e=="number"?qr(r.s,r.e):(typeof r!="string"&&(r=ir(r)),typeof e!="string"&&(e=ir(e)),r==e?r:r+":"+e)}function xr(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,s=r.length;for(t=0;n<s&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(e.s.c=--t,t=0;n<s&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(e.s.r=--t,n===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(e.e.c=--t,t=0;n!=s&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return e.e.r=--t,e}function Jm(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=Zs(r.z,t?Bn(e):e)}catch{}try{return r.w=Zs((r.XF||{}).numFmtId||(t?14:0),t?Bn(e):e)}catch{return""+e}}function Es(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?Pl[r.v]||r.v:e==null?Jm(r,r.v):Jm(r,e))}function ki(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function Lg(r,e,t){var n=t||{},a=r?Array.isArray(r):n.dense,s=r||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?rn(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=xr(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[p].length;++g)if(!(typeof e[p][g]>"u")){var h={v:e[p][g]},b=o+p,x=l+g;if(u.s.r>b&&(u.s.r=b),u.s.c>x&&(u.s.c=x),u.e.r<b&&(u.e.r=b),u.e.c<x&&(u.e.c=x),e[p][g]&&typeof e[p][g]=="object"&&!Array.isArray(e[p][g])&&!(e[p][g]instanceof Date))h=e[p][g];else if(Array.isArray(h.v)&&(h.f=e[p][g][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Cr[14],n.cellDates?(h.t="d",h.w=Zs(h.z,Bn(h.v))):(h.t="n",h.v=Bn(h.v),h.w=Zs(h.z,h.v))):h.t="s";if(a)s[b]||(s[b]=[]),s[b][x]&&s[b][x].z&&(h.z=s[b][x].z),s[b][x]=h;else{var y=ir({c:x,r:b});s[y]&&s[y].z&&(h.z=s[y].z),s[y]=h}}}return u.s.c<1e7&&(s["!ref"]=qr(u)),s}function No(r,e){return Lg(null,r,e)}function q3(r){return r.read_shift(4,"i")}function ka(r,e){return e||(e=Re(4)),e.write_shift(4,r),e}function Sn(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function nn(r,e){var t=!1;return e==null&&(t=!0,e=Re(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function W3(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function z3(r,e){return e||(e=Re(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Jd(r,e){var t=r.l,n=r.read_shift(1),a=Sn(r),s=[],o={t:a,h:a};if(n&1){for(var l=r.read_shift(4),c=0;c!=l;++c)s.push(W3(r));o.r=s}else o.r=[{ich:0,ifnt:0}];return r.l=t+e,o}function V3(r,e){var t=!1;return e==null&&(t=!0,e=Re(15+4*r.t.length)),e.write_shift(1,0),nn(r.t,e),t?e.slice(0,e.l):e}var G3=Jd;function K3(r,e){var t=!1;return e==null&&(t=!0,e=Re(23+4*r.t.length)),e.write_shift(1,1),nn(r.t,e),e.write_shift(4,1),z3({},e),t?e.slice(0,e.l):e}function fa(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function Ti(r,e){return e==null&&(e=Re(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function Li(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function Fi(r,e){return e==null&&(e=Re(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var Y3=Sn,Fg=nn;function Zd(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function n0(r,e){var t=!1;return e==null&&(t=!0,e=Re(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var X3=Sn,hd=Zd,Qd=n0;function Pg(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var a=n===0?r0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):yi(e,0)>>2;return t?a/100:a}function Rg(r,e){e==null&&(e=Re(4));var t=0,n=0,a=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?a:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function Dg(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function J3(r,e){return e||(e=Re(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var Pi=Dg,So=J3;function Eo(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Ei(r,e){return(e||Re(8)).write_shift(8,r,"f")}function Z3(r){var e={},t=r.read_shift(1),n=t>>>1,a=r.read_shift(1),s=r.read_shift(2,"i"),o=r.read_shift(1),l=r.read_shift(1),c=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var u=o_[a];u&&(e.rgb=lp(u));break;case 2:e.rgb=lp([o,l,c]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function a0(r,e){if(e||(e=Re(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Q3(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function e_(r,e){e||(e=Re(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var Og=2,Jn=3,_c=11,s0=19,Nc=64,t_=65,r_=71,n_=4108,a_=4126,dn=80,Zm={1:{n:"CodePage",t:Og},2:{n:"Category",t:dn},3:{n:"PresentationFormat",t:dn},4:{n:"ByteCount",t:Jn},5:{n:"LineCount",t:Jn},6:{n:"ParagraphCount",t:Jn},7:{n:"SlideCount",t:Jn},8:{n:"NoteCount",t:Jn},9:{n:"HiddenCount",t:Jn},10:{n:"MultimediaClipCount",t:Jn},11:{n:"ScaleCrop",t:_c},12:{n:"HeadingPairs",t:n_},13:{n:"TitlesOfParts",t:a_},14:{n:"Manager",t:dn},15:{n:"Company",t:dn},16:{n:"LinksUpToDate",t:_c},17:{n:"CharacterCount",t:Jn},19:{n:"SharedDoc",t:_c},22:{n:"HyperlinksChanged",t:_c},23:{n:"AppVersion",t:Jn,p:"version"},24:{n:"DigSig",t:t_},26:{n:"ContentType",t:dn},27:{n:"ContentStatus",t:dn},28:{n:"Language",t:dn},29:{n:"Version",t:dn},255:{},2147483648:{n:"Locale",t:s0},2147483651:{n:"Behavior",t:s0},1919054434:{}},Qm={1:{n:"CodePage",t:Og},2:{n:"Title",t:dn},3:{n:"Subject",t:dn},4:{n:"Author",t:dn},5:{n:"Keywords",t:dn},6:{n:"Comments",t:dn},7:{n:"Template",t:dn},8:{n:"LastAuthor",t:dn},9:{n:"RevNumber",t:dn},10:{n:"EditTime",t:Nc},11:{n:"LastPrinted",t:Nc},12:{n:"CreatedDate",t:Nc},13:{n:"ModifiedDate",t:Nc},14:{n:"PageCount",t:Jn},15:{n:"WordCount",t:Jn},16:{n:"CharCount",t:Jn},17:{n:"Thumbnail",t:r_},18:{n:"Application",t:dn},19:{n:"DocSecurity",t:Jn},255:{},2147483648:{n:"Locale",t:s0},2147483651:{n:"Behavior",t:s0},1919054434:{}};function s_(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var i_=s_([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o_=Un(i_),Pl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},l_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Sc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ig(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Mg(r,e){var t=v3(l_),n=[],a;n[n.length]=Wr,n[n.length]=et("Types",null,{xmlns:tn.CT,"xmlns:xsd":tn.xsd,"xmlns:xsi":tn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return et("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){r[c]&&r[c].length>0&&(a=r[c][0],n[n.length]=et("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Sc[c][e.bookType]||Sc[c].xlsx}))},o=function(c){(r[c]||[]).forEach(function(u){n[n.length]=et("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Sc[c][e.bookType]||Sc[c].xlsx})})},l=function(c){(r[c]||[]).forEach(function(u){n[n.length]=et("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:t[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Yt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Bg(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function uo(r){var e=[Wr,et("Relationships",null,{xmlns:tn.RELS})];return pn(r["!id"]).forEach(function(t){e[e.length]=et("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function rr(r,e,t,n,a,s){if(a||(a={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=t,[Yt.HLINK,Yt.XPATH,Yt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),r["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][a.Id]=a,r[("/"+a.Target).replace("//","/")]=a,e}function c_(r){var e=[Wr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function ep(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function u_(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function d_(r){var e=[Wr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(ep(r[t][0],r[t][1])),e.push(u_("",r[t][0]));return e.push(ep("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Ug(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xc.version+"</meta:generator></office:meta></office:document-meta>"}var wi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Uu(r,e,t,n,a){a[r]!=null||e==null||e===""||(a[r]=e,e=sr(e),n[n.length]=t?et(r,e,t):fn(r,e))}function Hg(r,e){var t=e||{},n=[Wr,et("cp:coreProperties",null,{"xmlns:cp":tn.CORE_PROPS,"xmlns:dc":tn.dc,"xmlns:dcterms":tn.dcterms,"xmlns:dcmitype":tn.dcmitype,"xmlns:xsi":tn.xsi})],a={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&Uu("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:dd(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),r.ModifiedDate!=null&&Uu("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:dd(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=wi.length;++s){var o=wi[s],l=t.Props&&t.Props[o[1]]!=null?t.Props[o[1]]:r?r[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Uu(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ho=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],$g=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function qg(r){var e=[],t=et;return r||(r={}),r.Application="SheetJS",e[e.length]=Wr,e[e.length]=et("Properties",null,{xmlns:tn.EXT_PROPS,"xmlns:vt":tn.vt}),ho.forEach(function(n){if(r[n[1]]!==void 0){var a;switch(n[2]){case"string":a=sr(String(r[n[1]]));break;case"bool":a=r[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=t(n[0],a))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+sr(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function Wg(r){var e=[Wr,et("Properties",null,{xmlns:tn.CUST_PROPS,"xmlns:vt":tn.vt})];if(!r)return e.join("");var t=1;return pn(r).forEach(function(a){++t,e[e.length]=et("property",k3(r[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:sr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var tp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function h_(r,e){var t=[];return pn(tp).map(function(n){for(var a=0;a<wi.length;++a)if(wi[a][1]==n)return wi[a];for(a=0;a<ho.length;++a)if(ho[a][1]==n)return ho[a];throw n}).forEach(function(n){if(r[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),t.push(fn(tp[n[1]]||n[1],a))}}),et("DocumentProperties",t.join(""),{xmlns:Qn.o})}function f_(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return r&&pn(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var o=0;o<wi.length;++o)if(s==wi[o][1])return;for(o=0;o<ho.length;++o)if(s==ho[o][1])return;for(o=0;o<t.length;++o)if(s==t[o])return;var l=r[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(et($m(s),l,{"dt:dt":c}))}}),e&&pn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(et($m(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Qn.o+'">'+a.join("")+"</"+n+">"}function m_(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),a=(t-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=Re(8);return o.write_shift(4,n),o.write_shift(4,a),o}function rp(r,e){var t=Re(4),n=Re(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=Re(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=m_(e);break;case 31:case 80:for(n=Re(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return hn([t,n])}var zg=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function p_(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function np(r,e,t){var n=Re(8),a=[],s=[],o=8,l=0,c=Re(8),u=Re(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),o+=8+c.length,!e){u=Re(8),u.write_shift(4,0),a.unshift(u);var d=[Re(4)];for(d[0].write_shift(4,r.length),l=0;l<r.length;++l){var p=r[l][0];for(c=Re(8+2*(p.length+1)+(p.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,p.length+1),c.write_shift(0,p,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=hn(d),s.unshift(c),o+=8+c.length}for(l=0;l<r.length;++l)if(!(e&&!e[r[l][0]])&&!(zg.indexOf(r[l][0])>-1||$g.indexOf(r[l][0])>-1)&&r[l][1]!=null){var g=r[l][1],h=0;if(e){h=+e[r[l][0]];var b=t[h];if(b.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}c=rp(b.t,g)}else{var y=p_(g);y==-1&&(y=31,g=String(g)),c=rp(y,g)}s.push(c),u=Re(8),u.write_shift(4,e?h:2+l),a.push(u),o+=8+c.length}var v=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,v),v+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),hn([n].concat(a).concat(s))}function ap(r,e,t,n,a,s){var o=Re(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,cr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var c=np(r,t,n);if(l.push(c),a){var u=np(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return hn(l)}function g_(r,e){e||(e=Re(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function x_(r,e){return r.read_shift(e)===1}function Tn(r,e){return e||(e=Re(2)),e.write_shift(2,+!!r),e}function Vg(r){return r.read_shift(2,"u")}function ua(r,e){return e||(e=Re(2)),e.write_shift(2,r),e}function Gg(r,e,t){return t||(t=Re(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function Kg(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=r.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var o=n?r.read_shift(n,a):"";return o}function v_(r){var e=r.t||"",t=Re(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=Re(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[t,n];return hn(a)}function y_(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var a=r.read_shift(1);return a===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function b_(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):y_(r,n,t)}function w_(r,e,t){if(t.biff>5)return b_(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function Yg(r,e,t){return t||(t=Re(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function sp(r,e){e||(e=Re(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function __(r){var e=Re(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(t=0;t<o.length;++t)e.write_shift(4,o[t]);if(s==28)n=n.slice(1),sp(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));var l=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(l.length+1)),t=0;t<l.length;++t)e.write_shift(2,l.charCodeAt(t));e.write_shift(2,0),s&8&&sp(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),t=0;t<n.length-3*c;++t)e.write_shift(1,n.charCodeAt(t+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Ai(r,e,t,n){return n||(n=Re(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function N_(r,e,t){var n=t.biff>8?4:2,a=r.read_shift(n),s=r.read_shift(n,"i"),o=r.read_shift(n,"i");return[a,s,o]}function S_(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2);return{s:{c:n,r:e},e:{c:a,r:t}}}function Xg(r,e){return e||(e=Re(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function eh(r,e,t){var n=1536,a=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Re(a);return s.write_shift(2,n),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function E_(r,e){var t=!e||e.biff==8,n=Re(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function A_(r,e){var t=!e||e.biff>=8?2:1,n=Re(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function C_(r,e){var t=Re(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],a=0;a<r.length;++a)n[a]=v_(r[a]);var s=hn([t].concat(n));return s.parts=[t.length].concat(n.map(function(o){return o.length})),s}function j_(){var r=Re(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function k_(r){var e=Re(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function T_(r,e){var t=r.name||"Arial",n=e&&e.biff==5,a=n?15+t.length:16+2*t.length,s=Re(a);return s.write_shift(2,r.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function L_(r,e,t,n){var a=Re(10);return Ai(r,e,n,a),a.write_shift(4,t),a}function F_(r,e,t,n,a){var s=!a||a.biff==8,o=Re(8+ +s+(1+s)*t.length);return Ai(r,e,n,o),o.write_shift(2,t.length),s&&o.write_shift(1,1),o.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),o}function P_(r,e,t,n){var a=t&&t.biff==5;n||(n=Re(a?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function R_(r,e){var t=e.biff==8||!e.biff?4:2,n=Re(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function ip(r,e,t,n){var a=t&&t.biff==5;n||(n=Re(a?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function D_(r){var e=Re(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function O_(r,e,t,n,a,s){var o=Re(8);return Ai(r,e,n,o),Gg(t,s,o),o}function I_(r,e,t,n){var a=Re(14);return Ai(r,e,n,a),Ei(t,a),a}function M_(r,e,t){if(t.biff<8)return B_(r,e,t);for(var n=[],a=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(N_(r,t.biff>8?12:6,t));if(r.l!=a)throw new Error("Bad ExternSheet: "+r.l+" != "+a);return n}function B_(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=Kg(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function U_(r){var e=Re(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)Xg(r[t],e);return e}function H_(r){var e=Re(24),t=rn(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return hn([e,__(r[1])])}function $_(r){var e=r[1].Tooltip,t=Re(10+2*(e.length+1));t.write_shift(2,2048);var n=rn(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var a=0;a<e.length;++a)t.write_shift(2,e.charCodeAt(a));return t.write_shift(2,0),t}function q_(r){return r||(r=Re(4)),r.write_shift(2,1),r.write_shift(2,1),r}function W_(r,e,t){if(!t.cellStyles)return Qa(r,e);var n=t&&t.biff>=12?4:2,a=r.read_shift(n),s=r.read_shift(n),o=r.read_shift(n),l=r.read_shift(n),c=r.read_shift(2);n==2&&(r.l+=2);var u={s:a,e:s,w:o,ixfe:l,flags:c};return(t.biff>=5||!t.biff)&&(u.level=c>>8&7),u}function z_(r,e){var t=Re(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function V_(r){for(var e=Re(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}function G_(r,e,t){var n=Re(15);return Dl(n,r,e),n.write_shift(8,t,"f"),n}function K_(r,e,t){var n=Re(9);return Dl(n,r,e),n.write_shift(2,t),n}var Y_=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=qd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(l,c){var u=[],d=Si(1);switch(c.type){case"base64":d=Ca(Ss(l));break;case"binary":d=Ca(l);break;case"buffer":case"array":d=l;break}Zn(d,0);var p=d.read_shift(1),g=!!(p&136),h=!1,b=!1;switch(p){case 2:break;case 3:break;case 48:h=!0,g=!0;break;case 49:h=!0,g=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,y=521;p==2&&(x=d.read_shift(2)),d.l+=3,p!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(y=d.read_shift(2));var v=d.read_shift(2),_=c.codepage||1252;p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(_=r[d[d.l]]),d.l+=1,d.l+=2),b&&(d.l+=36);for(var S=[],j={},I=Math.min(d.length,p==2?521:y-10-(h?264:0)),J=b?32:11;d.l<I&&d[d.l]!=13;)switch(j={},j.name=Jc.utils.decode(_,d.slice(d.l,d.l+J)).replace(/[\u0000\r\n].*$/g,""),d.l+=J,j.type=String.fromCharCode(d.read_shift(1)),p!=2&&!b&&(j.offset=d.read_shift(4)),j.len=d.read_shift(1),p==2&&(j.offset=d.read_shift(2)),j.dec=d.read_shift(1),j.name.length&&S.push(j),p!=2&&(d.l+=b?13:14),j.type){case"B":(!h||j.len!=8)&&c.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var k=0,F=0;for(u[0]=[],F=0;F!=S.length;++F)u[0][F]=S[F].name;for(;x-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++k]=[],F=0,F=0;F!=S.length;++F){var T=d.slice(d.l,d.l+S[F].len);d.l+=S[F].len,Zn(T,0);var R=Jc.utils.decode(_,T);switch(S[F].type){case"C":R.trim().length&&(u[k][F]=R.replace(/\s+$/,""));break;case"D":R.length===8?u[k][F]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):u[k][F]=R;break;case"F":u[k][F]=parseFloat(R.trim());break;case"+":case"I":u[k][F]=b?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":u[k][F]=!0;break;case"N":case"F":u[k][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));u[k][F]="##MEMO##"+(b?parseInt(R.trim(),10):T.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(u[k][F]=+R||0);break;case"@":u[k][F]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":u[k][F]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":u[k][F]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][F]=-T.read_shift(-8,"f");break;case"B":if(h&&S[F].len==8){u[k][F]=T.read_shift(8,"f");break}case"G":case"P":T.l+=S[F].len;break;case"0":if(S[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[F].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=S,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=No(t(l,u),u);return d["!cols"]=u.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete u.DBF,d}function a(l,c){try{return ki(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&vl(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Mn(),p=u0(l,{header:1,raw:!0,cellDates:!0}),g=p[0],h=p.slice(1),b=l["!cols"]||[],x=0,y=0,v=0,_=1;for(x=0;x<g.length;++x){if(((b[x]||{}).DBF||{}).name){g[x]=b[x].DBF.name,++v;continue}if(g[x]!=null){if(++v,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(y=0;y<1024;++y)if(g.indexOf(g[x]+"_"+y)==-1){g[x]+="_"+y;break}}}}var S=xr(l["!ref"]),j=[],I=[],J=[];for(x=0;x<=S.e.c-S.s.c;++x){var k="",F="",T=0,R=[];for(y=0;y<h.length;++y)h[y][x]!=null&&R.push(h[y][x]);if(R.length==0||g[x]==null){j[x]="?";continue}for(y=0;y<R.length;++y){switch(typeof R[y]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=R[y]instanceof Date?"D":"C";break;default:F="C"}T=Math.max(T,String(R[y]).length),k=k&&k!=F?"C":F}T>250&&(T=250),F=((b[x]||{}).DBF||{}).type,F=="C"&&b[x].DBF.len>T&&(T=b[x].DBF.len),k=="B"&&F=="N"&&(k="N",J[x]=b[x].DBF.dec,T=b[x].DBF.len),I[x]=k=="C"||F=="N"?T:s[k]||0,_+=I[x],j[x]=k}var A=d.next(32);for(A.write_shift(4,318902576),A.write_shift(4,h.length),A.write_shift(2,296+32*v),A.write_shift(2,_),x=0;x<4;++x)A.write_shift(4,0);for(A.write_shift(4,0|(+e[Z1]||3)<<8),x=0,y=0;x<g.length;++x)if(g[x]!=null){var P=d.next(32),H=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,H,"sbcs"),P.write_shift(1,j[x]=="?"?"C":j[x],"sbcs"),P.write_shift(4,y),P.write_shift(1,I[x]||s[j[x]]||0),P.write_shift(1,J[x]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),y+=I[x]||s[j[x]]||0}var K=d.next(264);for(K.write_shift(4,13),x=0;x<65;++x)K.write_shift(4,0);for(x=0;x<h.length;++x){var ce=d.next(_);for(ce.write_shift(1,0),y=0;y<g.length;++y)if(g[y]!=null)switch(j[y]){case"L":ce.write_shift(1,h[x][y]==null?63:h[x][y]?84:70);break;case"B":ce.write_shift(8,h[x][y]||0,"f");break;case"N":var me="0";for(typeof h[x][y]=="number"&&(me=h[x][y].toFixed(J[y]||0)),v=0;v<I[y]-me.length;++v)ce.write_shift(1,32);ce.write_shift(1,me,"sbcs");break;case"D":h[x][y]?(ce.write_shift(4,("0000"+h[x][y].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(h[x][y].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+h[x][y].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var le=String(h[x][y]!=null?h[x][y]:"").slice(0,I[y]);for(ce.write_shift(1,le,"sbcs"),v=0;v<I[y]-le.length;++v)ce.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),X_=function(){var r={AA:"√Ä",BA:"√Å",CA:"√Ç",DA:195,HA:"√Ñ",JA:197,AE:"√à",BE:"√â",CE:"√ä",HE:"√ã",AI:"√å",BI:"√ç",CI:"√é",HI:"√è",AO:"√í",BO:"√ì",CO:"√î",DO:213,HO:"√ñ",AU:"√ô",BU:"√ö",CU:"√õ",HU:"√ú",Aa:"√†",Ba:"√°",Ca:"√¢",Da:227,Ha:"√§",Ja:229,Ae:"√®",Be:"√©",Ce:"√™",He:"√´",Ai:"√¨",Bi:"√≠",Ci:"√Æ",Hi:"√Ø",Ao:"√≤",Bo:"√≥",Co:"√¥",Do:245,Ho:"√∂",Au:"√π",Bu:"√∫",Cu:"√ª",Hu:"√º",KC:"√á",Kc:"√ß",q:"√¶",z:"≈ì",a:"√Ü",j:"≈í",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+pn(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,h){var b=r[h];return typeof b=="number"?Tm(b):b},n=function(g,h,b){var x=h.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return x==59?g:Tm(x)};r["|"]=254;function a(g,h){switch(h.type){case"base64":return s(Ss(g),h);case"binary":return s(g,h);case"buffer":return s(Jt&&Buffer.isBuffer(g)?g.toString("binary"):Tl(g),h);case"array":return s(C0(g),h)}throw new Error("Unrecognized type "+h.type)}function s(g,h){var b=g.split(/[\n\r]+/),x=-1,y=-1,v=0,_=0,S=[],j=[],I=null,J={},k=[],F=[],T=[],R=0,A;for(+h.codepage>=0&&vl(+h.codepage);v!==b.length;++v){R=0;var P=b[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),H=P.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),K=H[0],ce;if(P.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":H[1].charAt(0)=="P"&&j.push(P.slice(3).replace(/;;/g,";"));break;case"C":var me=!1,le=!1,xe=!1,we=!1,Oe=-1,ge=-1;for(_=1;_<H.length;++_)switch(H[_].charAt(0)){case"A":break;case"X":y=parseInt(H[_].slice(1))-1,le=!0;break;case"Y":for(x=parseInt(H[_].slice(1))-1,le||(y=0),A=S.length;A<=x;++A)S[A]=[];break;case"K":ce=H[_].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(ws(ce))?isNaN(bl(ce).getDate())||(ce=Ln(ce)):(ce=ws(ce),I!==null&&ug(I)&&(ce=mg(ce))),me=!0;break;case"E":we=!0;var C=K6(H[_].slice(1),{r:x,c:y});S[x][y]=[S[x][y],C];break;case"S":xe=!0,S[x][y]=[S[x][y],"S5S"];break;case"G":break;case"R":Oe=parseInt(H[_].slice(1))-1;break;case"C":ge=parseInt(H[_].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}if(me&&(S[x][y]&&S[x][y].length==2?S[x][y][0]=ce:S[x][y]=ce,I=null),xe){if(we)throw new Error("SYLK shared formula cannot have own formula");var O=Oe>-1&&S[Oe][ge];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");S[x][y][1]=Y6(O[1],{r:x-Oe,c:y-ge})}break;case"F":var D=0;for(_=1;_<H.length;++_)switch(H[_].charAt(0)){case"X":y=parseInt(H[_].slice(1))-1,++D;break;case"Y":for(x=parseInt(H[_].slice(1))-1,A=S.length;A<=x;++A)S[A]=[];break;case"M":R=parseInt(H[_].slice(1))/20;break;case"F":break;case"G":break;case"P":I=j[parseInt(H[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=H[_].slice(1).split(" "),A=parseInt(T[0],10);A<=parseInt(T[1],10);++A)R=parseInt(T[2],10),F[A-1]=R===0?{hidden:!0}:{wch:R},th(F[A-1]);break;case"C":y=parseInt(H[_].slice(1))-1,F[y]||(F[y]={});break;case"R":x=parseInt(H[_].slice(1))-1,k[x]||(k[x]={}),R>0?(k[x].hpt=R,k[x].hpx=t2(R)):R===0&&(k[x].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}D<1&&(I=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}}return k.length>0&&(J["!rows"]=k),F.length>0&&(J["!cols"]=F),h&&h.sheetRows&&(S=S.slice(0,h.sheetRows)),[S,J]}function o(g,h){var b=a(g,h),x=b[0],y=b[1],v=No(x,h);return pn(y).forEach(function(_){v[_]=y[_]}),v}function l(g,h){return ki(o(g,h),h)}function c(g,h,b,x){var y="C;Y"+(b+1)+";X"+(x+1)+";K";switch(g.t){case"n":y+=g.v||0,g.f&&!g.F&&(y+=";E"+nh(g.f,{r:b,c:x}));break;case"b":y+=g.v?"TRUE":"FALSE";break;case"e":y+=g.w||g.v;break;case"d":y+='"'+(g.w||g.v)+'"';break;case"s":y+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(g,h){h.forEach(function(b,x){var y="F;W"+(x+1)+" "+(x+1)+" ";b.hidden?y+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=i0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=o0(b.wpx)),typeof b.wch=="number"&&(y+=Math.round(b.wch))),y.charAt(y.length-1)!=" "&&g.push(y)})}function d(g,h){h.forEach(function(b,x){var y="F;";b.hidden?y+="M0;":b.hpt?y+="M"+20*b.hpt+";":b.hpx&&(y+="M"+20*l0(b.hpx)+";"),y.length>2&&g.push(y+"R"+(x+1))})}function p(g,h){var b=["ID;PWXL;N;E"],x=[],y=xr(g["!ref"]),v,_=Array.isArray(g),S=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),g["!cols"]&&u(b,g["!cols"]),g["!rows"]&&d(b,g["!rows"]),b.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var j=y.s.r;j<=y.e.r;++j)for(var I=y.s.c;I<=y.e.c;++I){var J=ir({r:j,c:I});v=_?(g[j]||[])[I]:g[J],!(!v||v.v==null&&(!v.f||v.F))&&x.push(c(v,g,j,I))}return b.join(S)+S+x.join(S)+S+"E"+S}return{to_workbook:l,to_sheet:o,from_sheet:p}}(),J_=function(){function r(s,o){switch(o.type){case"base64":return e(Ss(s),o);case"binary":return e(s,o);case"buffer":return e(Jt&&Buffer.isBuffer(s)?s.toString("binary"):Tl(s),o);case"array":return e(C0(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,p=[];d!==l.length;++d){if(l[d].trim()==="BOT"){p[++c]=[],u=0;continue}if(!(c<0)){var g=l[d].trim().split(","),h=g[0],b=g[1];++d;for(var x=l[d]||"";(x.match(/["]/g)||[]).length&1&&d<l.length-1;)x+=`
`+l[++d];switch(x=x.trim(),+h){case-1:if(x==="BOT"){p[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?p[c][u]=!0:x==="FALSE"?p[c][u]=!1:isNaN(ws(b))?isNaN(bl(b).getDate())?p[c][u]=b:p[c][u]=Ln(b):p[c][u]=ws(b),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),p[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),p}function t(s,o){return No(r(s,o),o)}function n(s,o){return ki(t(s,o),o)}var a=function(){var s=function(c,u,d,p,g){c.push(u),c.push(d+","+p),c.push('"'+g.replace(/"/g,'""')+'"')},o=function(c,u,d,p){c.push(u+","+d),c.push(u==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var u=[],d=xr(c["!ref"]),p,g=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var b=d.s.c;b<=d.e.c;++b){var x=ir({r:h,c:b});if(p=g?(c[h]||[])[b]:c[x],!p){o(u,1,0,"");continue}switch(p.t){case"n":var y=p.w;!y&&p.v!=null&&(y=p.v),y==null?p.f&&!p.F?o(u,1,0,"="+p.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Zs(p.z||Cr[14],Bn(Ln(p.v)))),o(u,0,p.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var v=`\r
`,_=u.join(v);return _}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),Jg=function(){function r(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(p,g){for(var h=p.split(`
`),b=-1,x=-1,y=0,v=[];y!==h.length;++y){var _=h[y].trim().split(":");if(_[0]==="cell"){var S=rn(_[1]);if(v.length<=S.r)for(b=v.length;b<=S.r;++b)v[b]||(v[b]=[]);switch(b=S.r,x=S.c,_[2]){case"t":v[b][x]=r(_[3]);break;case"v":v[b][x]=+_[3];break;case"vtf":var j=_[_.length-1];case"vtc":switch(_[3]){case"nl":v[b][x]=!!+_[4];break;default:v[b][x]=+_[4];break}_[2]=="vtf"&&(v[b][x]=[v[b][x],j])}}}return g&&g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}function n(p,g){return No(t(p,g),g)}function a(p,g){return ki(n(p,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(p){if(!p||!p["!ref"])return"";for(var g=[],h=[],b,x="",y=ra(p["!ref"]),v=Array.isArray(p),_=y.s.r;_<=y.e.r;++_)for(var S=y.s.c;S<=y.e.c;++S)if(x=ir({r:_,c:S}),b=v?(p[_]||[])[S]:p[x],!(!b||b.v==null||b.t==="z")){switch(h=["cell",x,"t"],b.t){case"s":case"str":h.push(e(b.v));break;case"n":b.f?(h[2]="vtf",h[3]="n",h[4]=b.v,h[5]=e(b.f)):(h[2]="v",h[3]=b.v);break;case"b":h[2]="vt"+(b.f?"f":"c"),h[3]="nl",h[4]=b.v?"1":"0",h[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var j=Bn(Ln(b.v));h[2]="vtc",h[3]="nd",h[4]=""+j,h[5]=b.w||Zs(b.z||Cr[14],j);break;case"e":continue}g.push(h.join(":"))}return g.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(p){return[s,o,l,o,u(p),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Z_=function(){function r(d,p,g,h,b){b.raw?p[g][h]=d:d===""||(d==="TRUE"?p[g][h]=!0:d==="FALSE"?p[g][h]=!1:isNaN(ws(d))?isNaN(bl(d).getDate())?p[g][h]=d:p[g][h]=Ln(d):p[g][h]=ws(d))}function e(d,p){var g=p||{},h=[];if(!d||d.length===0)return h;for(var b=d.split(/[\r\n]/),x=b.length-1;x>=0&&b[x].length===0;)--x;for(var y=10,v=0,_=0;_<=x;++_)v=b[_].indexOf(" "),v==-1?v=b[_].length:v++,y=Math.max(y,v);for(_=0;_<=x;++_){h[_]=[];var S=0;for(r(b[_].slice(0,y).trim(),h,_,S,g),S=1;S<=(b[_].length-y)/10+1;++S)r(b[_].slice(y+(S-1)*10,y+S*10).trim(),h,_,S,g)}return g.sheetRows&&(h=h.slice(0,g.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var p={},g=!1,h=0,b=0;h<d.length;++h)(b=d.charCodeAt(h))==34?g=!g:!g&&b in t&&(p[b]=(p[b]||0)+1);b=[];for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&b.push([p[h],h]);if(!b.length){p=n;for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&b.push([p[h],h])}return b.sort(function(x,y){return x[0]-y[0]||n[x[1]]-n[y[1]]}),t[b.pop()[1]]||44}function s(d,p){var g=p||{},h="",b=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=a(d.slice(0,1024)):g&&g.FS?h=g.FS:h=a(d.slice(0,1024));var y=0,v=0,_=0,S=0,j=0,I=h.charCodeAt(0),J=!1,k=0,F=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var T=g.dateNF!=null?m3(g.dateNF):null;function R(){var A=d.slice(S,j),P={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)P.t="z";else if(g.raw)P.t="s",P.v=A;else if(A.trim().length===0)P.t="s",P.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(P.t="s",P.v=A.slice(2,-1).replace(/""/g,'"')):X6(A)?(P.t="n",P.f=A.slice(1)):(P.t="s",P.v=A);else if(A=="TRUE")P.t="b",P.v=!0;else if(A=="FALSE")P.t="b",P.v=!1;else if(!isNaN(_=ws(A)))P.t="n",g.cellText!==!1&&(P.w=A),P.v=_;else if(!isNaN(bl(A).getDate())||T&&A.match(T)){P.z=g.dateNF||Cr[14];var H=0;T&&A.match(T)&&(A=p3(A,g.dateNF,A.match(T)||[]),H=1),g.cellDates?(P.t="d",P.v=Ln(A,H)):(P.t="n",P.v=Bn(Ln(A,H))),g.cellText!==!1&&(P.w=Zs(P.z,P.v instanceof Date?Bn(P.v):P.v)),g.cellNF||delete P.z}else P.t="s",P.v=A;if(P.t=="z"||(g.dense?(b[y]||(b[y]=[]),b[y][v]=P):b[ir({c:v,r:y})]=P),S=j+1,F=d.charCodeAt(S),x.e.c<v&&(x.e.c=v),x.e.r<y&&(x.e.r=y),k==I)++v;else if(v=0,++y,g.sheetRows&&g.sheetRows<=y)return!0}e:for(;j<d.length;++j)switch(k=d.charCodeAt(j)){case 34:F===34&&(J=!J);break;case I:case 10:case 13:if(!J&&R())break e;break}return j-S>0&&R(),b["!ref"]=qr(x),b}function o(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,p):No(e(d,p),p)}function l(d,p){var g="",h=p.type=="string"?[0,0,0,0]:u8(d,p);switch(p.type){case"base64":g=Ss(d);break;case"binary":g=d;break;case"buffer":p.codepage==65001?g=d.toString("utf8"):p.codepage&&typeof Jc<"u"||(g=Jt&&Buffer.isBuffer(d)?d.toString("binary"):Tl(d));break;case"array":g=C0(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+p.type)}return h[0]==239&&h[1]==187&&h[2]==191?g=ll(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=ll(g):p.type=="binary"&&typeof Jc<"u",g.slice(0,19)=="socialcalc:version:"?Jg.to_sheet(p.type=="string"?g:ll(g),p):o(g,p)}function c(d,p){return ki(l(d,p),p)}function u(d){for(var p=[],g=xr(d["!ref"]),h,b=Array.isArray(d),x=g.s.r;x<=g.e.r;++x){for(var y=[],v=g.s.c;v<=g.e.c;++v){var _=ir({r:x,c:v});if(h=b?(d[x]||[])[v]:d[_],!h||h.v==null){y.push("          ");continue}for(var S=(h.w||(Es(h),h.w)||"").slice(0,10);S.length<10;)S+=" ";y.push(S+(v===0?" ":""))}p.push(y.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}(),op=function(){function r(C,O,D){if(C){Zn(C,C.l||0);for(var M=D.Enum||Oe;C.l<C.length;){var V=C.read_shift(2),oe=M[V]||M[65535],he=C.read_shift(2),ue=C.l+he,Z=oe.f&&oe.f(C,he,D);if(C.l=ue,O(Z,oe,V))return}}}function e(C,O){switch(O.type){case"base64":return t(Ca(Ss(C)),O);case"binary":return t(Ca(C),O);case"buffer":case"array":return t(C,O)}throw"Unsupported type "+O.type}function t(C,O){if(!C)return C;var D=O||{},M=D.dense?[]:{},V="Sheet1",oe="",he=0,ue={},Z=[],ye=[],Le={s:{r:0,c:0},e:{r:0,c:0}},Ie=D.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)D.Enum=Oe,r(C,function(Pe,at,qe){switch(qe){case 0:D.vers=Pe,Pe>=4096&&(D.qpro=!0);break;case 6:Le=Pe;break;case 204:Pe&&(oe=Pe);break;case 222:oe=Pe;break;case 15:case 51:D.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:qe==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=D.dateNF||Cr[14],D.cellDates&&(Pe[1].t="d",Pe[1].v=mg(Pe[1].v))),D.qpro&&Pe[3]>he&&(M["!ref"]=qr(Le),ue[V]=M,Z.push(V),M=D.dense?[]:{},Le={s:{r:0,c:0},e:{r:0,c:0}},he=Pe[3],V=oe||"Sheet"+(he+1),oe="");var ft=D.dense?(M[Pe[0].r]||[])[Pe[0].c]:M[ir(Pe[0])];if(ft){ft.t=Pe[1].t,ft.v=Pe[1].v,Pe[1].z!=null&&(ft.z=Pe[1].z),Pe[1].f!=null&&(ft.f=Pe[1].f);break}D.dense?(M[Pe[0].r]||(M[Pe[0].r]=[]),M[Pe[0].r][Pe[0].c]=Pe[1]):M[ir(Pe[0])]=Pe[1];break}},D);else if(C[2]==26||C[2]==14)D.Enum=ge,C[2]==14&&(D.qpro=!0,C.l=0),r(C,function(Pe,at,qe){switch(qe){case 204:V=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>he&&(M["!ref"]=qr(Le),ue[V]=M,Z.push(V),M=D.dense?[]:{},Le={s:{r:0,c:0},e:{r:0,c:0}},he=Pe[3],V="Sheet"+(he+1)),Ie>0&&Pe[0].r>=Ie)break;D.dense?(M[Pe[0].r]||(M[Pe[0].r]=[]),M[Pe[0].r][Pe[0].c]=Pe[1]):M[ir(Pe[0])]=Pe[1],Le.e.c<Pe[0].c&&(Le.e.c=Pe[0].c),Le.e.r<Pe[0].r&&(Le.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(ye[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:ye[Pe[0]]=Pe[1],Pe[0]==he&&(V=Pe[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(M["!ref"]=qr(Le),ue[oe||V]=M,Z.push(oe||V),!ye.length)return{SheetNames:Z,Sheets:ue};for(var pe={},ee=[],lt=0;lt<ye.length;++lt)ue[Z[lt]]?(ee.push(ye[lt]||Z[lt]),pe[ye[lt]]=ue[ye[lt]]||ue[Z[lt]]):(ee.push(ye[lt]),pe[ye[lt]]={"!ref":"A1"});return{SheetNames:ee,Sheets:pe}}function n(C,O){var D=O||{};if(+D.codepage>=0&&vl(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var M=Mn(),V=xr(C["!ref"]),oe=Array.isArray(C),he=[];tt(M,0,s(1030)),tt(M,6,c(V));for(var ue=Math.min(V.e.r,8191),Z=V.s.r;Z<=ue;++Z)for(var ye=mn(Z),Le=V.s.c;Le<=V.e.c;++Le){Z===V.s.r&&(he[Le]=Nn(Le));var Ie=he[Le]+ye,pe=oe?(C[Z]||[])[Le]:C[Ie];if(!(!pe||pe.t=="z"))if(pe.t=="n")(pe.v|0)==pe.v&&pe.v>=-32768&&pe.v<=32767?tt(M,13,h(Z,Le,pe.v)):tt(M,14,x(Z,Le,pe.v));else{var ee=Es(pe);tt(M,15,p(Z,Le,ee.slice(0,239)))}}return tt(M,1),M.end()}function a(C,O){var D=O||{};if(+D.codepage>=0&&vl(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var M=Mn();tt(M,0,o(C));for(var V=0,oe=0;V<C.SheetNames.length;++V)(C.Sheets[C.SheetNames[V]]||{})["!ref"]&&tt(M,27,we(C.SheetNames[V],oe++));var he=0;for(V=0;V<C.SheetNames.length;++V){var ue=C.Sheets[C.SheetNames[V]];if(!(!ue||!ue["!ref"])){for(var Z=xr(ue["!ref"]),ye=Array.isArray(ue),Le=[],Ie=Math.min(Z.e.r,8191),pe=Z.s.r;pe<=Ie;++pe)for(var ee=mn(pe),lt=Z.s.c;lt<=Z.e.c;++lt){pe===Z.s.r&&(Le[lt]=Nn(lt));var Pe=Le[lt]+ee,at=ye?(ue[pe]||[])[lt]:ue[Pe];if(!(!at||at.t=="z"))if(at.t=="n")tt(M,23,R(pe,lt,he,at.v));else{var qe=Es(at);tt(M,22,k(pe,lt,he,qe.slice(0,239)))}}++he}}return tt(M,1),M.end()}function s(C){var O=Re(2);return O.write_shift(2,C),O}function o(C){var O=Re(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var D=0,M=0,V=0,oe=0;oe<C.SheetNames.length;++oe){var he=C.SheetNames[oe],ue=C.Sheets[he];if(!(!ue||!ue["!ref"])){++V;var Z=ra(ue["!ref"]);D<Z.e.r&&(D=Z.e.r),M<Z.e.c&&(M=Z.e.c)}}return D>8191&&(D=8191),O.write_shift(2,D),O.write_shift(1,V),O.write_shift(1,M),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function l(C,O,D){var M={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&D.qpro?(M.s.c=C.read_shift(1),C.l++,M.s.r=C.read_shift(2),M.e.c=C.read_shift(1),C.l++,M.e.r=C.read_shift(2),M):(M.s.c=C.read_shift(2),M.s.r=C.read_shift(2),O==12&&D.qpro&&(C.l+=2),M.e.c=C.read_shift(2),M.e.r=C.read_shift(2),O==12&&D.qpro&&(C.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function c(C){var O=Re(8);return O.write_shift(2,C.s.c),O.write_shift(2,C.s.r),O.write_shift(2,C.e.c),O.write_shift(2,C.e.r),O}function u(C,O,D){var M=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(M[0].c=C.read_shift(1),M[3]=C.read_shift(1),M[0].r=C.read_shift(2),C.l+=2):(M[2]=C.read_shift(1),M[0].c=C.read_shift(2),M[0].r=C.read_shift(2)),M}function d(C,O,D){var M=C.l+O,V=u(C,O,D);if(V[1].t="s",D.vers==20768){C.l++;var oe=C.read_shift(1);return V[1].v=C.read_shift(oe,"utf8"),V}return D.qpro&&C.l++,V[1].v=C.read_shift(M-C.l,"cstr"),V}function p(C,O,D){var M=Re(7+D.length);M.write_shift(1,255),M.write_shift(2,O),M.write_shift(2,C),M.write_shift(1,39);for(var V=0;V<M.length;++V){var oe=D.charCodeAt(V);M.write_shift(1,oe>=128?95:oe)}return M.write_shift(1,0),M}function g(C,O,D){var M=u(C,O,D);return M[1].v=C.read_shift(2,"i"),M}function h(C,O,D){var M=Re(7);return M.write_shift(1,255),M.write_shift(2,O),M.write_shift(2,C),M.write_shift(2,D,"i"),M}function b(C,O,D){var M=u(C,O,D);return M[1].v=C.read_shift(8,"f"),M}function x(C,O,D){var M=Re(13);return M.write_shift(1,255),M.write_shift(2,O),M.write_shift(2,C),M.write_shift(8,D,"f"),M}function y(C,O,D){var M=C.l+O,V=u(C,O,D);if(V[1].v=C.read_shift(8,"f"),D.qpro)C.l=M;else{var oe=C.read_shift(2);j(C.slice(C.l,C.l+oe),V),C.l+=oe}return V}function v(C,O,D){var M=O&32768;return O&=-32769,O=(M?C:0)+(O>=8192?O-16384:O),(M?"":"$")+(D?Nn(O):mn(O))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(C,O){Zn(C,0);for(var D=[],M=0,V="",oe="",he="",ue="";C.l<C.length;){var Z=C[C.l++];switch(Z){case 0:D.push(C.read_shift(8,"f"));break;case 1:oe=v(O[0].c,C.read_shift(2),!0),V=v(O[0].r,C.read_shift(2),!1),D.push(oe+V);break;case 2:{var ye=v(O[0].c,C.read_shift(2),!0),Le=v(O[0].r,C.read_shift(2),!1);oe=v(O[0].c,C.read_shift(2),!0),V=v(O[0].r,C.read_shift(2),!1),D.push(ye+Le+":"+oe+V)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(C.read_shift(2));break;case 6:{for(var Ie="";Z=C[C.l++];)Ie+=String.fromCharCode(Z);D.push('"'+Ie.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:ue=D.pop(),he=D.pop(),D.push(["AND","OR"][Z-20]+"("+he+","+ue+")");break;default:if(Z<32&&S[Z])ue=D.pop(),he=D.pop(),D.push(he+S[Z]+ue);else if(_[Z]){if(M=_[Z][1],M==69&&(M=C[C.l++]),M>D.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+D.join("|")+"|");return}var pe=D.slice(-M);D.length-=M,D.push(_[Z][0]+"("+pe.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}D.length==1?O[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function I(C){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=C.read_shift(2),O[3]=C[C.l++],O[0].c=C[C.l++],O}function J(C,O){var D=I(C);return D[1].t="s",D[1].v=C.read_shift(O-4,"cstr"),D}function k(C,O,D,M){var V=Re(6+M.length);V.write_shift(2,C),V.write_shift(1,D),V.write_shift(1,O),V.write_shift(1,39);for(var oe=0;oe<M.length;++oe){var he=M.charCodeAt(oe);V.write_shift(1,he>=128?95:he)}return V.write_shift(1,0),V}function F(C,O){var D=I(C);D[1].v=C.read_shift(2);var M=D[1].v>>1;if(D[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return D[1].v=M,D}function T(C,O){var D=I(C),M=C.read_shift(4),V=C.read_shift(4),oe=C.read_shift(2);if(oe==65535)return M===0&&V===3221225472?(D[1].t="e",D[1].v=15):M===0&&V===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var he=oe&32768;return oe=(oe&32767)-16446,D[1].v=(1-he*2)*(V*Math.pow(2,oe+32)+M*Math.pow(2,oe)),D}function R(C,O,D,M){var V=Re(14);if(V.write_shift(2,C),V.write_shift(1,D),V.write_shift(1,O),M==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var oe=0,he=0,ue=0,Z=0;return M<0&&(oe=1,M=-M),he=Math.log2(M)|0,M/=Math.pow(2,he-31),Z=M>>>0,Z&2147483648||(M/=2,++he,Z=M>>>0),M-=Z,Z|=2147483648,Z>>>=0,M*=Math.pow(2,32),ue=M>>>0,V.write_shift(4,ue),V.write_shift(4,Z),he+=16383+(oe?32768:0),V.write_shift(2,he),V}function A(C,O){var D=T(C);return C.l+=O-14,D}function P(C,O){var D=I(C),M=C.read_shift(4);return D[1].v=M>>6,D}function H(C,O){var D=I(C),M=C.read_shift(8,"f");return D[1].v=M,D}function K(C,O){var D=H(C);return C.l+=O-10,D}function ce(C,O){return C[C.l+O-1]==0?C.read_shift(O,"cstr"):""}function me(C,O){var D=C[C.l++];D>O-1&&(D=O-1);for(var M="";M.length<D;)M+=String.fromCharCode(C[C.l++]);return M}function le(C,O,D){if(!(!D.qpro||O<21)){var M=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var V=C.read_shift(O-21,"cstr");return[M,V]}}function xe(C,O){for(var D={},M=C.l+O;C.l<M;){var V=C.read_shift(2);if(V==14e3){for(D[V]=[0,""],D[V][0]=C.read_shift(2);C[C.l];)D[V][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return D}function we(C,O){var D=Re(5+C.length);D.write_shift(2,14e3),D.write_shift(2,O);for(var M=0;M<C.length;++M){var V=C.charCodeAt(M);D[D.l++]=V>127?95:V}return D[D.l++]=0,D}var Oe={0:{n:"BOF",f:Vg},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:me},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:J},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:H},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}(),Q_=/^\s|\s$|[\t\n\r]/;function Zg(r,e){if(!e.bookSST)return"";var t=[Wr];t[t.length]=et("sst",null,{xmlns:_o[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var a=r[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(Q_)&&(s+=' xml:space="preserve"'),s+=">"+sr(a.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function e6(r){return[r.read_shift(4),r.read_shift(4)]}function t6(r,e){return e||(e=Re(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var r6=V3;function n6(r){var e=Mn();We(e,159,t6(r));for(var t=0;t<r.length;++t)We(e,19,r6(r[t]));return We(e,160),e.end()}function a6(r){for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function Qg(r){var e=0,t,n=a6(r),a=n.length+1,s,o,l,c,u;for(t=Si(a),t[0]=n.length,s=1;s!=a;++s)t[s]=n[s-1];for(s=a-1;s>=0;--s)o=t[s],l=e&16384?1:0,c=e<<1&32767,u=l|c,e=u^o;return e^52811}var s6=function(){function r(a,s){switch(s.type){case"base64":return e(Ss(a),s);case"binary":return e(a,s);case"buffer":return e(Jt&&Buffer.isBuffer(a)?a.toString("binary"):Tl(a),s);case"array":return e(C0(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,p){Array.isArray(l)&&(l[p]=[]);for(var g=/\\\w+\b/g,h=0,b,x=-1;b=g.exec(d);){switch(b[0]){case"\\cell":var y=d.slice(h,g.lastIndex-b[0].length);if(y[0]==" "&&(y=y.slice(1)),++x,y.length){var v={v:y,t:"s"};Array.isArray(l)?l[p][x]=v:l[ir({r:p,c:x})]=v}break}h=g.lastIndex}x>u.e.c&&(u.e.c=x)}),l["!ref"]=qr(u),l}function t(a,s){return ki(r(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=xr(a["!ref"]),l,c=Array.isArray(a),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var p=ir({r:u,c:d});l=c?(a[u]||[])[d]:a[p],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(Es(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}}();function lp(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}var i6=6,_s=i6;function i0(r){return Math.floor((r+Math.round(128/_s)/256)*_s)}function o0(r){return Math.floor((r-5)/_s*100+.5)/100}function fd(r){return Math.round((r*_s+5)/_s*256)/256}function th(r){r.width?(r.wpx=i0(r.width),r.wch=o0(r.wpx),r.MDW=_s):r.wpx?(r.wch=o0(r.wpx),r.width=fd(r.wch),r.MDW=_s):typeof r.wch=="number"&&(r.width=fd(r.wch),r.wpx=i0(r.width),r.MDW=_s),r.customWidth&&delete r.customWidth}var o6=96,e2=o6;function l0(r){return r*96/e2}function t2(r){return r*e2/96}function l6(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=et("numFmt",null,{numFmtId:n,formatCode:sr(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=et("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function c6(r){var e=[];return e[e.length]=et("cellXfs",null),r.forEach(function(t){e[e.length]=et("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=et("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function r2(r,e){var t=[Wr,et("styleSheet",null,{xmlns:_o[0],"xmlns:vt":tn.vt})],n;return r.SSF&&(n=l6(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=c6(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function u6(r,e){var t=r.read_shift(2),n=Sn(r);return[t,n]}function d6(r,e,t){t||(t=Re(6+4*e.length)),t.write_shift(2,r),nn(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function h6(r,e,t){var n={};n.sz=r.read_shift(2)/20;var a=Q3(r);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=r.read_shift(1);o!=0&&(n.underline=o);var l=r.read_shift(1);l>0&&(n.family=l);var c=r.read_shift(1);switch(c>0&&(n.charset=c),r.l++,n.color=Z3(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Sn(r),n}function f6(r,e){e||(e=Re(25+4*32)),e.write_shift(2,r.sz*20),e_(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),a0(r.color,e);var n=0;return n=2,e.write_shift(1,n),nn(r.name,e),e.length>e.l?e.slice(0,e.l):e}var m6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Hu,p6=Qa;function cp(r,e){e||(e=Re(4*3+8*7+16*1)),Hu||(Hu=qd(m6));var t=Hu[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(a0({auto:1},e),a0({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function g6(r,e){var t=r.l+e,n=r.read_shift(2),a=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:a}}function n2(r,e,t){t||(t=Re(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function el(r,e){return e||(e=Re(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var x6=Qa;function v6(r,e){return e||(e=Re(51)),e.write_shift(1,0),el(null,e),el(null,e),el(null,e),el(null,e),el(null,e),e.length>e.l?e.slice(0,e.l):e}function y6(r,e){return e||(e=Re(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),n0(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function b6(r,e,t){var n=Re(2052);return n.write_shift(4,r),n0(e,n),n0(t,n),n.length>n.l?n.slice(0,n.l):n}function w6(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++t}),t!=0&&(We(r,615,ka(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&We(r,44,d6(a,e[a]))}),We(r,616))}}function _6(r){var e=1;We(r,611,ka(e)),We(r,43,f6({sz:12,color:{theme:1},name:"Calibri",family:2})),We(r,612)}function N6(r){var e=2;We(r,603,ka(e)),We(r,45,cp({patternType:"none"})),We(r,45,cp({patternType:"gray125"})),We(r,604)}function S6(r){var e=1;We(r,613,ka(e)),We(r,46,v6()),We(r,614)}function E6(r){var e=1;We(r,626,ka(e)),We(r,47,n2({numFmtId:0},65535)),We(r,627)}function A6(r,e){We(r,617,ka(e.length)),e.forEach(function(t){We(r,47,n2(t,0))}),We(r,618)}function C6(r){var e=1;We(r,619,ka(e)),We(r,48,y6({xfId:0,name:"Normal"})),We(r,620)}function j6(r){var e=0;We(r,505,ka(e)),We(r,506)}function k6(r){var e=0;We(r,508,b6(e,"TableStyleMedium9","PivotStyleMedium4")),We(r,509)}function T6(r,e){var t=Mn();return We(t,278),w6(t,r.SSF),_6(t),N6(t),S6(t),E6(t),A6(t,e.cellXfs),C6(t),j6(t),k6(t),We(t,279),t.end()}function a2(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Wr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',t[t.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',t[t.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',t[t.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',t[t.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',t[t.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',t[t.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function L6(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:Sn(r)}}function F6(r){var e=Re(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),nn(r.name,e),e.slice(0,e.l)}function P6(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function R6(r){var e=Re(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function D6(r,e){var t=Re(8+2*e.length);return t.write_shift(4,r),nn(e,t),t.slice(0,t.l)}function O6(r){return r.l+=4,r.read_shift(4)!=0}function I6(r,e){var t=Re(8);return t.write_shift(4,r),t.write_shift(4,1),t}function M6(){var r=Mn();return We(r,332),We(r,334,ka(1)),We(r,335,F6({name:"XLDAPR",version:12e4,flags:3496657072})),We(r,336),We(r,339,D6(1,"XLDAPR")),We(r,52),We(r,35,ka(514)),We(r,4096,ka(0)),We(r,4097,ua(1)),We(r,36),We(r,53),We(r,340),We(r,337,I6(1)),We(r,51,R6([[1,0]])),We(r,338),We(r,333),r.end()}function s2(){var r=[Wr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function B6(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=ir(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var no=1024;function i2(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),a=[et("xml",null,{"xmlns:v":Qn.v,"xmlns:o":Qn.o,"xmlns:x":Qn.x,"xmlns:mv":Qn.mv}).replace(/\/>/,">"),et("o:shapelayout",et("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),et("v:shapetype",[et("v:stroke",null,{joinstyle:"miter"}),et("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];no<r*1e3;)no+=1e3;return e.forEach(function(s){var o=rn(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?et("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=et("v:fill",c,l),d={on:"t",obscured:"t"};++no,a=a.concat(["<v:shape"+_l({id:"_x0000_s"+no,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,et("v:shadow",null,d),et("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",fn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),fn("x:AutoFill","False"),fn("x:Row",String(o.r)),fn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function o2(r){var e=[Wr,et("comments",null,{xmlns:_o[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(a){var s=sr(a.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&t.indexOf("tc="+a.ID)==-1&&(t.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=t.indexOf(sr(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(fn("t",sr(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;e.push(fn("t",sr(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function U6(r,e,t){var n=[Wr,et("ThreadedComments",null,{xmlns:tn.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(et("threadedComment",fn("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function H6(r){var e=[Wr,et("personList",null,{xmlns:tn.TCMNT,"xmlns:x":_o[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(et("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function $6(r){var e={};e.iauthor=r.read_shift(4);var t=Pi(r);return e.rfx=t.s,e.ref=ir(t.s),r.l+=16,e}function q6(r,e){return e==null&&(e=Re(36)),e.write_shift(4,r[1].iauthor),So(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var W6=Sn;function z6(r){return nn(r.slice(0,54))}function V6(r){var e=Mn(),t=[];return We(e,628),We(e,630),r.forEach(function(n){n[1].forEach(function(a){t.indexOf(a.a)>-1||(t.push(a.a.slice(0,54)),We(e,632,z6(a.a)))})}),We(e,631),We(e,633),r.forEach(function(n){n[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var s={s:rn(n[0]),e:rn(n[0])};We(e,635,q6([s,a])),a.t&&a.t.length>0&&We(e,637,K3(a)),We(e,636),delete a.iauthor})}),We(e,634),We(e,629),e.end()}function G6(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var a=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&cr.utils.cfb_add(r,a,e.FileIndex[n].content)}})}var l2=["xlsb","xlsm","xlam","biff8","xla"],K6=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=e.c:--d,c?u+=e.r:--u,a+(l?"":"$")+Nn(d)+(c?"":"$")+mn(u)}return function(a,s){return e=s,a.replace(r,t)}}(),rh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nh=function(){return function(e,t){return e.replace(rh,function(n,a,s,o,l,c){var u=Xd(o)-(s?0:t.c),d=Yd(c)-(l?0:t.r),p=d==0?"":l?d+1:"["+d+"]",g=u==0?"":s?u+1:"["+u+"]";return a+"R"+p+"C"+g})}}();function Y6(r,e){return r.replace(rh,function(t,n,a,s,o,l){return n+(a=="$"?a+s:Nn(Xd(s)+e.c))+(o=="$"?o+l:mn(Yd(l)+e.r))})}function X6(r){return r.length!=1}function Hr(r){r.l+=1}function Qs(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function c2(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return u2(r);t.biff==12&&(n=4)}var a=r.read_shift(n),s=r.read_shift(n),o=Qs(r),l=Qs(r);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function u2(r){var e=Qs(r),t=Qs(r),n=r.read_shift(1),a=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function J6(r,e,t){if(t.biff<8)return u2(r);var n=r.read_shift(t.biff==12?4:2),a=r.read_shift(t.biff==12?4:2),s=Qs(r),o=Qs(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function d2(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return Z6(r);var n=r.read_shift(t&&t.biff==12?4:2),a=Qs(r);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Z6(r){var e=Qs(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Q6(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function eN(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return tN(r);var a=r.read_shift(n>=12?4:2),s=r.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function tN(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:a,rRel:n}}function rN(r,e,t){var n=(r[r.l++]&96)>>5,a=c2(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function nN(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var o=c2(r,s,t);return[n,a,o]}function aN(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function sN(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,a]}function iN(r,e,t){var n=(r[r.l++]&96)>>5,a=J6(r,e-1,t);return[n,a]}function oN(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function up(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function lN(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(r.read_shift(t&&t.biff==2?1:2));return a}function cN(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function uN(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function dN(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function hN(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function h2(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function fN(r){return r.read_shift(2),h2(r)}function mN(r){return r.read_shift(2),h2(r)}function pN(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=d2(r,0,t);return[n,a]}function gN(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=eN(r,0,t);return[n,a]}function xN(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=d2(r,0,t);return[n,a,s]}function vN(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(t&&t.biff<=3?1:2);return[vS[a],p2[a],n]}function yN(r,e,t){var n=r[r.l++],a=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:bN(r);return[a,(s[0]===0?p2:xS)[s[1]]]}function bN(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function wN(r,e,t){r.l+=t&&t.biff==2?3:4}function _N(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function NN(r){return r.l++,Pl[r.read_shift(1)]}function SN(r){return r.l++,r.read_shift(2)}function EN(r){return r.l++,r.read_shift(1)!==0}function AN(r){return r.l++,Eo(r)}function CN(r,e,t){return r.l++,Kg(r,e-1,t)}function jN(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=x_(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=Pl[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=Eo(r);break;case 2:t[1]=w_(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function kN(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((t.biff==12?Pi:S_)(r));return a}function TN(r,e,t){var n=0,a=0;t.biff==12?(n=r.read_shift(4),a=r.read_shift(4)):(a=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=jN(r,t.biff);return o}function LN(r,e,t){var n=r.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=r.read_shift(a);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function FN(r,e,t){if(t.biff==5)return PN(r);var n=r.read_shift(1)>>>5&3,a=r.read_shift(2),s=r.read_shift(4);return[n,a,s]}function PN(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function RN(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function DN(r,e,t){var n=r.read_shift(1)>>>5&3,a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function ON(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function IN(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,a]}var MN=Qa,BN=Qa,UN=Qa;function Rl(r,e,t){return r.l+=2,[Q6(r)]}function ah(r){return r.l+=6,[]}var HN=Rl,$N=ah,qN=ah,WN=Rl;function f2(r){return r.l+=2,[Vg(r),r.read_shift(2)&1]}var zN=Rl,VN=f2,GN=ah,KN=Rl,YN=Rl,XN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function JN(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),a=r.read_shift(2),s=r.read_shift(2),o=XN[t>>2&31];return{ixti:e,coltype:t&3,rt:o,idx:n,c:a,C:s}}function ZN(r){return r.l+=2,[r.read_shift(4)]}function QN(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function eS(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function tS(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function rS(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function nS(r){return r.l+=4,[0,0]}var dp={1:{n:"PtgExp",f:_N},2:{n:"PtgTbl",f:UN},3:{n:"PtgAdd",f:Hr},4:{n:"PtgSub",f:Hr},5:{n:"PtgMul",f:Hr},6:{n:"PtgDiv",f:Hr},7:{n:"PtgPower",f:Hr},8:{n:"PtgConcat",f:Hr},9:{n:"PtgLt",f:Hr},10:{n:"PtgLe",f:Hr},11:{n:"PtgEq",f:Hr},12:{n:"PtgGe",f:Hr},13:{n:"PtgGt",f:Hr},14:{n:"PtgNe",f:Hr},15:{n:"PtgIsect",f:Hr},16:{n:"PtgUnion",f:Hr},17:{n:"PtgRange",f:Hr},18:{n:"PtgUplus",f:Hr},19:{n:"PtgUminus",f:Hr},20:{n:"PtgPercent",f:Hr},21:{n:"PtgParen",f:Hr},22:{n:"PtgMissArg",f:Hr},23:{n:"PtgStr",f:CN},26:{n:"PtgSheet",f:QN},27:{n:"PtgEndSheet",f:eS},28:{n:"PtgErr",f:NN},29:{n:"PtgBool",f:EN},30:{n:"PtgInt",f:SN},31:{n:"PtgNum",f:AN},32:{n:"PtgArray",f:oN},33:{n:"PtgFunc",f:vN},34:{n:"PtgFuncVar",f:yN},35:{n:"PtgName",f:LN},36:{n:"PtgRef",f:pN},37:{n:"PtgArea",f:rN},38:{n:"PtgMemArea",f:RN},39:{n:"PtgMemErr",f:MN},40:{n:"PtgMemNoMem",f:BN},41:{n:"PtgMemFunc",f:DN},42:{n:"PtgRefErr",f:ON},43:{n:"PtgAreaErr",f:aN},44:{n:"PtgRefN",f:gN},45:{n:"PtgAreaN",f:iN},46:{n:"PtgMemAreaN",f:tS},47:{n:"PtgMemNoMemN",f:rS},57:{n:"PtgNameX",f:FN},58:{n:"PtgRef3d",f:xN},59:{n:"PtgArea3d",f:nN},60:{n:"PtgRefErr3d",f:IN},61:{n:"PtgAreaErr3d",f:sN},255:{}},aS={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},sS={1:{n:"PtgElfLel",f:f2},2:{n:"PtgElfRw",f:KN},3:{n:"PtgElfCol",f:HN},6:{n:"PtgElfRwV",f:YN},7:{n:"PtgElfColV",f:WN},10:{n:"PtgElfRadical",f:zN},11:{n:"PtgElfRadicalS",f:GN},13:{n:"PtgElfColS",f:$N},15:{n:"PtgElfColSV",f:qN},16:{n:"PtgElfRadicalLel",f:VN},25:{n:"PtgList",f:JN},29:{n:"PtgSxName",f:ZN},255:{}},iS={0:{n:"PtgAttrNoop",f:nS},1:{n:"PtgAttrSemi",f:hN},2:{n:"PtgAttrIf",f:uN},4:{n:"PtgAttrChoose",f:lN},8:{n:"PtgAttrGoto",f:cN},16:{n:"PtgAttrSum",f:wN},32:{n:"PtgAttrBaxcel",f:up},33:{n:"PtgAttrBaxcel",f:up},64:{n:"PtgAttrSpace",f:fN},65:{n:"PtgAttrSpaceSemi",f:mN},128:{n:"PtgAttrIfError",f:dN},255:{}};function oS(r,e,t,n){if(n.biff<8)return Qa(r,e);for(var a=r.l+e,s=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=TN(r,0,n),s.push(t[o][1]);break;case"PtgMemArea":t[o][2]=kN(r,t[o][1],n),s.push(t[o][2]);break;case"PtgExp":n&&n.biff==12&&(t[o][1][1]=r.read_shift(4),s.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return e=a-r.l,e!==0&&s.push(Qa(r,e)),s}function lS(r,e,t){for(var n=r.l+e,a,s,o=[];n!=r.l;)e=n-r.l,s=r[r.l],a=dp[s]||dp[aS[s]],(s===24||s===25)&&(a=(s===24?sS:iS)[r[r.l+1]]),!a||!a.f?Qa(r,e):o.push([a.n,a.f(r,e,t)]);return o}function cS(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var uS={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dS(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function m2(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(r[n[0]][0]){case 357:return a=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(a=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function hp(r,e,t){var n=m2(r,e,t);return n=="#REF"?n:dS(n,t)}function po(r,e,t,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,p=0,g=0,h,b="";if(!r[0]||!r[0][0])return"";for(var x=-1,y="",v=0,_=r[0].length;v<_;++v){var S=r[0][v];switch(S[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),x>=0){switch(r[0][x][1][0]){case 0:y=Ar(" ",r[0][x][1][1]);break;case 1:y=Ar("\r",r[0][x][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][x][1][0])}u=u+y,x=-1}l.push(u+uS[S[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=ul(S[1][1],o,a),l.push(dl(d,s));break;case"PtgRefN":d=t?ul(S[1][1],t,a):S[1][1],l.push(dl(d,s));break;case"PtgRef3d":p=S[1][1],d=ul(S[1][2],o,a),b=hp(n,p,a),l.push(b+"!"+dl(d,s));break;case"PtgFunc":case"PtgFuncVar":var j=S[1][0],I=S[1][1];j||(j=0),j&=127;var J=j==0?[]:l.slice(-j);l.length-=j,I==="User"&&(I=J.shift()),l.push(I+"("+J.join(",")+")");break;case"PtgBool":l.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(S[1]);break;case"PtgNum":l.push(String(S[1]));break;case"PtgStr":l.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(S[1]);break;case"PtgAreaN":h=Xm(S[1][1],t?{s:t}:o,a),l.push(Bu(h,a));break;case"PtgArea":h=Xm(S[1][1],o,a),l.push(Bu(h,a));break;case"PtgArea3d":p=S[1][1],h=S[1][2],b=hp(n,p,a),l.push(b+"!"+Bu(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=S[1][2];var k=(n.names||[])[g-1]||(n[0]||[])[g],F=k?k.Name:"SH33TJSNAME"+String(g);F&&F.slice(0,6)=="_xlfn."&&!a.xlfn&&(F=F.slice(6)),l.push(F);break;case"PtgNameX":var T=S[1][1];g=S[1][2];var R;if(a.biff<=5)T<0&&(T=-T),n[T]&&(R=n[T][g]);else{var A="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][g]&&n[T][g].itab>0&&(A=n.SheetNames[n[T][g].itab-1]+"!"):A=n.SheetNames[g-1]+"!"),n[T]&&n[T][g])A+=n[T][g].Name;else if(n[0]&&n[0][g])A+=n[0][g].Name;else{var P=(m2(n,T,a)||"").split(";;");P[g-1]?A=P[g-1]:A+="SH33TJSERRX"}l.push(A);break}R||(R={Name:"SH33TJSERRY"}),l.push(R.Name);break;case"PtgParen":var H="(",K=")";if(x>=0){switch(y="",r[0][x][1][0]){case 2:H=Ar(" ",r[0][x][1][1])+H;break;case 3:H=Ar("\r",r[0][x][1][1])+H;break;case 4:K=Ar(" ",r[0][x][1][1])+K;break;case 5:K=Ar("\r",r[0][x][1][1])+K;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][x][1][0])}x=-1}l.push(H+l.pop()+K);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:S[1][1],r:S[1][0]};var ce={c:t.c,r:t.r};if(n.sharedf[ir(d)]){var me=n.sharedf[ir(d)];l.push(po(me,o,ce,n,a))}else{var le=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(po(u[1],o,ce,n,a)),le=!0;break}le||l.push(S[1])}break;case"PtgArray":l.push("{"+cS(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&xe.indexOf(r[0][v][0])==-1){S=r[0][x];var we=!0;switch(S[1][0]){case 4:we=!1;case 0:y=Ar(" ",S[1][1]);break;case 5:we=!1;case 1:y=Ar("\r",S[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}l.push((we?y:"")+l.pop()+(we?"":y)),x=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function hS(r){if(r==null){var e=Re(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return Ei(r);return Ei(0)}function fS(r,e,t,n,a){var s=Ai(e,t,a),o=hS(r.v),l=Re(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=Re(r.bf.length),d=0;d<r.bf.length;++d)u[d]=r.bf[d];var p=hn([s,o,l,u]);return p}function j0(r,e,t){var n=r.read_shift(4),a=lS(r,n,t),s=r.read_shift(4),o=s>0?oS(r,s,a,t):null;return[a,o]}var mS=j0,k0=j0,pS=j0,gS=j0,xS={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},p2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vS={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function yS(r){var e="of:="+r.replace(rh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function bS(r){return r.replace(/\./,"!")}var hl=typeof Map<"u";function sh(r,e,t){var n=0,a=r.length;if(t){if(hl?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=hl?t.get(e):t[e];n<s.length;++n)if(r[s[n]].t===e)return r.Count++,s[n]}}else for(;n<a;++n)if(r[n].t===e)return r.Count++,n;return r[a]={t:e},r.Count++,r.Unique++,t&&(hl?(t.has(e)||t.set(e,[]),t.get(e).push(a)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(a))),a}function T0(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(_s=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=o0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=fd(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function g2(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function ri(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],a=60,s=r.length;if(n==null&&t.ssf){for(;a<392;++a)if(t.ssf[a]==null){dg(e.z,a),t.ssf[a]=e.z,t.revssf[e.z]=n=a;break}}for(a=0;a!=s;++a)if(r[a].numFmtId===n)return a;return r[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function wS(r,e,t){if(r&&r["!ref"]){var n=xr(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function _S(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+qr(r[t])+'"/>';return e+"</mergeCells>"}function NS(r,e,t,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[t];try{e.Workbook&&(c=e.Workbook.Sheets[t].CodeName||c)}catch{}s=!0,o.codeName=wl(sr(c))}if(r&&r["!outline"]){var u={summaryBelow:1,summaryRight:1};r["!outline"].above&&(u.summaryBelow=0),r["!outline"].left&&(u.summaryRight=0),l=(l||"")+et("outlinePr",null,u)}!s&&!l||(a[a.length]=et("sheetPr",l,o))}var SS=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ES=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function AS(r){var e={sheet:1};return SS.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),ES.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=Qg(r.password).toString(16).toUpperCase()),et("sheetProtection",null,e)}function CS(r){return g2(r),et("pageMargins",null,r)}function jS(r,e){for(var t=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(t[t.length]=et("col",null,T0(a,n)));return t[t.length]="</cols>",t.join("")}function kS(r,e,t,n){var a=typeof r.ref=="string"?r.ref:qr(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,o=ra(a);o.s.r==o.e.r&&(o.e.r=ra(e["!ref"]).e.r,a=qr(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+t.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+a}),et("autoFilter",null,{ref:a})}function TS(r,e,t,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),et("sheetViews",et("sheetView",null,a),{})}function LS(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var a="",s=r.t,o=r.v;if(r.t!=="z")switch(r.t){case"b":a=r.v?"1":"0";break;case"n":a=""+r.v;break;case"e":a=Pl[r.v];break;case"d":n&&n.cellDates?a=Ln(r.v,-1).toISOString():(r=Un(r),r.t="n",a=""+(r.v=Bn(Ln(r.v)))),typeof r.z>"u"&&(r.z=Cr[14]);break;default:a=r.v;break}var l=fn("v",sr(a)),c={r:e},u=ri(n.cellXfs,r,n);switch(u!==0&&(c.s=u),r.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=fn("v",""+sh(n.Strings,r.v,n.revStrings)),c.t="s";break}c.t="str";break}if(r.t!=s&&(r.t=s,r.v=o),typeof r.f=="string"&&r.f){var d=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;l=et("f",sr(r.f),d)+(r.v!=null?l:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(c.cm=1),et("c",l,c)}function FS(r,e,t,n){var a=[],s=[],o=xr(r["!ref"]),l="",c,u="",d=[],p=0,g=0,h=r["!rows"],b=Array.isArray(r),x={r:u},y,v=-1;for(g=o.s.c;g<=o.e.c;++g)d[g]=Nn(g);for(p=o.s.r;p<=o.e.r;++p){for(s=[],u=mn(p),g=o.s.c;g<=o.e.c;++g){c=d[g]+u;var _=b?(r[p]||[])[g]:r[c];_!==void 0&&(l=LS(_,c,r,e))!=null&&s.push(l)}(s.length>0||h&&h[p])&&(x={r:u},h&&h[p]&&(y=h[p],y.hidden&&(x.hidden=1),v=-1,y.hpx?v=l0(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(x.ht=v,x.customHeight=1),y.level&&(x.outlineLevel=y.level)),a[a.length]=et("row",s.join(""),x))}if(h)for(;p<h.length;++p)h&&h[p]&&(x={r:p+1},y=h[p],y.hidden&&(x.hidden=1),v=-1,y.hpx?v=l0(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(x.ht=v,x.customHeight=1),y.level&&(x.outlineLevel=y.level),a[a.length]=et("row","",x));return a.join("")}function x2(r,e,t,n){var a=[Wr,et("worksheet",null,{xmlns:_o[0],"xmlns:r":tn.r})],s=t.SheetNames[r],o=0,l="",c=t.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=xr(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=qr(d)}n||(n={}),c["!comments"]=[];var p=[];NS(c,t,r,e,a),a[a.length]=et("dimension",null,{ref:u}),a[a.length]=TS(c,e,r,t),e.sheetFormat&&(a[a.length]=et("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=jS(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=FS(c,e),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=AS(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=kS(c["!autofilter"],c,t,r)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=_S(c["!merges"]));var g=-1,h,b=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(h={ref:x[0]},x[1].Target.charAt(0)!="#"&&(b=rr(n,-1,sr(x[1].Target).replace(/#.*$/,""),Yt.HLINK),h["r:id"]="rId"+b),(g=x[1].Target.indexOf("#"))>-1&&(h.location=sr(x[1].Target.slice(g+1))),x[1].Tooltip&&(h.tooltip=sr(x[1].Tooltip)),a[a.length]=et("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=CS(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=fn("ignoredErrors",et("ignoredError",null,{numberStoredAsText:1,sqref:u}))),p.length>0&&(b=rr(n,-1,"../drawings/drawing"+(r+1)+".xml",Yt.DRAW),a[a.length]=et("drawing",null,{"r:id":"rId"+b}),c["!drawing"]=p),c["!comments"].length>0&&(b=rr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Yt.VML),a[a.length]=et("legacyDrawing",null,{"r:id":"rId"+b}),c["!legacy"]=b),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function PS(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var a=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}function RS(r,e,t){var n=Re(145),a=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var s=320;a.hpx?s=l0(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var p=-1,g=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var b=Array.isArray(t)?(t[u.r]||[])[u.c]:t[ir(u)];b&&(p<0&&(p=h),g=h)}p<0||(++l,n.write_shift(4,p),n.write_shift(4,g))}var x=n.l;return n.l=c,n.write_shift(4,l),n.l=x,n.length>n.l?n.slice(0,n.l):n}function DS(r,e,t,n){var a=RS(n,t,e);(a.length>17||(e["!rows"]||[])[n])&&We(r,0,a)}var OS=Pi,IS=So;function MS(){}function BS(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=Y3(r),t}function US(r,e,t){t==null&&(t=Re(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var a=1;a<3;++a)t.write_shift(1,0);return a0({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Fg(r,t),t.slice(0,t.l)}function HS(r){var e=fa(r);return[e]}function $S(r,e,t){return t==null&&(t=Re(8)),Ti(e,t)}function qS(r){var e=Li(r);return[e]}function WS(r,e,t){return t==null&&(t=Re(4)),Fi(e,t)}function zS(r){var e=fa(r),t=r.read_shift(1);return[e,t,"b"]}function VS(r,e,t){return t==null&&(t=Re(9)),Ti(e,t),t.write_shift(1,r.v?1:0),t}function GS(r){var e=Li(r),t=r.read_shift(1);return[e,t,"b"]}function KS(r,e,t){return t==null&&(t=Re(5)),Fi(e,t),t.write_shift(1,r.v?1:0),t}function YS(r){var e=fa(r),t=r.read_shift(1);return[e,t,"e"]}function XS(r,e,t){return t==null&&(t=Re(9)),Ti(e,t),t.write_shift(1,r.v),t}function JS(r){var e=Li(r),t=r.read_shift(1);return[e,t,"e"]}function ZS(r,e,t){return t==null&&(t=Re(8)),Fi(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function QS(r){var e=fa(r),t=r.read_shift(4);return[e,t,"s"]}function eE(r,e,t){return t==null&&(t=Re(12)),Ti(e,t),t.write_shift(4,e.v),t}function tE(r){var e=Li(r),t=r.read_shift(4);return[e,t,"s"]}function rE(r,e,t){return t==null&&(t=Re(8)),Fi(e,t),t.write_shift(4,e.v),t}function nE(r){var e=fa(r),t=Eo(r);return[e,t,"n"]}function aE(r,e,t){return t==null&&(t=Re(16)),Ti(e,t),Ei(r.v,t),t}function sE(r){var e=Li(r),t=Eo(r);return[e,t,"n"]}function iE(r,e,t){return t==null&&(t=Re(12)),Fi(e,t),Ei(r.v,t),t}function oE(r){var e=fa(r),t=Pg(r);return[e,t,"n"]}function lE(r,e,t){return t==null&&(t=Re(12)),Ti(e,t),Rg(r.v,t),t}function cE(r){var e=Li(r),t=Pg(r);return[e,t,"n"]}function uE(r,e,t){return t==null&&(t=Re(8)),Fi(e,t),Rg(r.v,t),t}function dE(r){var e=fa(r),t=Jd(r);return[e,t,"is"]}function hE(r){var e=fa(r),t=Sn(r);return[e,t,"str"]}function fE(r,e,t){return t==null&&(t=Re(12+4*r.v.length)),Ti(e,t),nn(r.v,t),t.length>t.l?t.slice(0,t.l):t}function mE(r){var e=Li(r),t=Sn(r);return[e,t,"str"]}function pE(r,e,t){return t==null&&(t=Re(8+4*r.v.length)),Fi(e,t),nn(r.v,t),t.length>t.l?t.slice(0,t.l):t}function gE(r,e,t){var n=r.l+e,a=fa(r);a.r=t["!row"];var s=r.read_shift(1),o=[a,s,"b"];if(t.cellFormula){r.l+=2;var l=k0(r,n-r.l,t);o[3]=po(l,null,a,t.supbooks,t)}else r.l=n;return o}function xE(r,e,t){var n=r.l+e,a=fa(r);a.r=t["!row"];var s=r.read_shift(1),o=[a,s,"e"];if(t.cellFormula){r.l+=2;var l=k0(r,n-r.l,t);o[3]=po(l,null,a,t.supbooks,t)}else r.l=n;return o}function vE(r,e,t){var n=r.l+e,a=fa(r);a.r=t["!row"];var s=Eo(r),o=[a,s,"n"];if(t.cellFormula){r.l+=2;var l=k0(r,n-r.l,t);o[3]=po(l,null,a,t.supbooks,t)}else r.l=n;return o}function yE(r,e,t){var n=r.l+e,a=fa(r);a.r=t["!row"];var s=Sn(r),o=[a,s,"str"];if(t.cellFormula){r.l+=2;var l=k0(r,n-r.l,t);o[3]=po(l,null,a,t.supbooks,t)}else r.l=n;return o}var bE=Pi,wE=So;function _E(r,e){return e==null&&(e=Re(4)),e.write_shift(4,r),e}function NE(r,e){var t=r.l+e,n=Pi(r),a=Zd(r),s=Sn(r),o=Sn(r),l=Sn(r);r.l=t;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function SE(r,e){var t=Re(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));So({s:rn(r[0]),e:rn(r[0])},t),Qd("rId"+e,t);var n=r[1].Target.indexOf("#"),a=n==-1?"":r[1].Target.slice(n+1);return nn(a||"",t),nn(r[1].Tooltip||"",t),nn("",t),t.slice(0,t.l)}function EE(){}function AE(r,e,t){var n=r.l+e,a=Dg(r),s=r.read_shift(1),o=[a];if(o[2]=s,t.cellFormula){var l=mS(r,n-r.l,t);o[1]=l}else r.l=n;return o}function CE(r,e,t){var n=r.l+e,a=Pi(r),s=[a];if(t.cellFormula){var o=gS(r,n-r.l,t);s[1]=o,r.l=n}else r.l=n;return s}function jE(r,e,t){t==null&&(t=Re(18));var n=T0(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),t.write_shift(2,a),t}var v2=["left","right","top","bottom","header","footer"];function kE(r){var e={};return v2.forEach(function(t){e[t]=Eo(r)}),e}function TE(r,e){return e==null&&(e=Re(6*8)),g2(r),v2.forEach(function(t){Ei(r[t],e)}),e}function LE(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function FE(r,e,t){t==null&&(t=Re(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function PE(r){var e=Re(24);return e.write_shift(4,4),e.write_shift(4,1),So(r,e),e}function RE(r,e){return e==null&&(e=Re(16*4+2)),e.write_shift(2,r.password?Qg(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function DE(){}function OE(){}function IE(r,e,t,n,a,s,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=Un(e),e.z=e.z||Cr[14],e.v=Bn(Ln(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r:t,c:n};switch(c.s=ri(a.cellXfs,e,a),e.l&&s["!links"].push([ir(c),e.l]),e.c&&s["!comments"].push([ir(c),e.c]),e.t){case"s":case"str":return a.bookSST?(l=sh(a.Strings,e.v,a.revStrings),c.t="s",c.v=l,o?We(r,18,rE(e,c)):We(r,7,eE(e,c))):(c.t="str",o?We(r,17,pE(e,c)):We(r,6,fE(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?We(r,13,uE(e,c)):We(r,2,lE(e,c)):o?We(r,16,iE(e,c)):We(r,5,aE(e,c)),!0;case"b":return c.t="b",o?We(r,15,KS(e,c)):We(r,4,VS(e,c)),!0;case"e":return c.t="e",o?We(r,14,ZS(e,c)):We(r,3,XS(e,c)),!0}return o?We(r,12,WS(e,c)):We(r,1,$S(e,c)),!0}function ME(r,e,t,n){var a=xr(e["!ref"]||"A1"),s,o="",l=[];We(r,145);var c=Array.isArray(e),u=a.e.r;e["!rows"]&&(u=Math.max(a.e.r,e["!rows"].length-1));for(var d=a.s.r;d<=u;++d){o=mn(d),DS(r,e,a,d);var p=!1;if(d<=a.e.r)for(var g=a.s.c;g<=a.e.c;++g){d===a.s.r&&(l[g]=Nn(g)),s=l[g]+o;var h=c?(e[d]||[])[g]:e[s];if(!h){p=!1;continue}p=IE(r,h,d,g,n,e,p)}}We(r,146)}function BE(r,e){!e||!e["!merges"]||(We(r,177,_E(e["!merges"].length)),e["!merges"].forEach(function(t){We(r,176,wE(t))}),We(r,178))}function UE(r,e){!e||!e["!cols"]||(We(r,390),e["!cols"].forEach(function(t,n){t&&We(r,60,jE(n,t))}),We(r,391))}function HE(r,e){!e||!e["!ref"]||(We(r,648),We(r,649,PE(xr(e["!ref"]))),We(r,650))}function $E(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var a=rr(t,-1,n[1].Target.replace(/#.*$/,""),Yt.HLINK);We(r,494,SE(n,a))}}),delete e["!links"]}function qE(r,e,t,n){if(e["!comments"].length>0){var a=rr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Yt.VML);We(r,551,Qd("rId"+a)),e["!legacy"]=a}}function WE(r,e,t,n){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:qr(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,l=ra(s);l.s.r==l.e.r&&(l.e.r=ra(e["!ref"]).e.r,s=qr(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+t.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),We(r,161,So(xr(s))),We(r,162)}}function zE(r,e,t){We(r,133),We(r,137,FE(e,t)),We(r,138),We(r,134)}function VE(r,e){e["!protect"]&&We(r,535,RE(e["!protect"]))}function GE(r,e,t,n){var a=Mn(),s=t.SheetNames[r],o=t.Sheets[s]||{},l=s;try{t&&t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}var c=xr(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],We(a,129),(t.vbaraw||o["!outline"])&&We(a,147,US(l,o["!outline"])),We(a,148,IS(c)),zE(a,o,t.Workbook),UE(a,o),ME(a,o,r,e),VE(a,o),WE(a,o,t,r),BE(a,o),$E(a,o,n),o["!margins"]&&We(a,476,TE(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&HE(a,o),qE(a,o,r,n),We(a,130),a.end()}function KE(r,e){r.l+=10;var t=Sn(r);return{name:t}}var YE=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function XE(r){return!r.Workbook||!r.Workbook.WBProps?"false":C3(r.Workbook.WBProps.date1904)?"true":"false"}var JE="][*?/\\".split("");function y2(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return JE.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function ZE(r,e,t){r.forEach(function(n,a){y2(n);for(var s=0;s<a;++s)if(n==r[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function QE(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];ZE(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)wS(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}function b2(r){var e=[Wr];e[e.length]=et("workbook",null,{xmlns:_o[0],"xmlns:r":tn.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(YE.forEach(function(l){r.Workbook.WBProps[l[0]]!=null&&r.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=r.Workbook.WBProps[l[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=et("workbookPr",null,n);var a=r.Workbook&&r.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var o={name:sr(r.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=et("sheet",null,o)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=et("definedName",sr(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function eA(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=hd(r),t.name=Sn(r),t}function tA(r,e){return e||(e=Re(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),Qd(r.strRelID,e),nn(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function rA(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var a=e>8?Sn(r):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function nA(r,e){e||(e=Re(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),Fg(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function aA(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var a=r.read_shift(4),s=X3(r),o=pS(r,0,t),l=Zd(r);r.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function sA(r,e){We(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,a={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};We(r,156,tA(a))}We(r,144)}function iA(r,e){e||(e=Re(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return nn("SheetJS",e),nn(Xc.version,e),nn(Xc.version,e),nn("7262",e),e.length>e.l?e.slice(0,e.l):e}function oA(r,e){e||(e=Re(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function lA(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,a=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&a==-1?a=n:t[n].Hidden==1&&s==-1&&(s=n);s>a||(We(r,135),We(r,158,oA(a)),We(r,136))}}function cA(r,e){var t=Mn();return We(t,131),We(t,128,iA()),We(t,153,nA(r.Workbook&&r.Workbook.WBProps||null)),lA(t,r),sA(t,r),We(t,132),t.end()}function uA(r,e,t){return(e.slice(-4)===".bin"?cA:b2)(r)}function dA(r,e,t,n,a){return(e.slice(-4)===".bin"?GE:x2)(r,t,n,a)}function hA(r,e,t){return(e.slice(-4)===".bin"?T6:r2)(r,t)}function fA(r,e,t){return(e.slice(-4)===".bin"?n6:Zg)(r,t)}function mA(r,e,t){return(e.slice(-4)===".bin"?V6:o2)(r)}function pA(r){return(r.slice(-4)===".bin"?M6:s2)()}function gA(r,e){var t=[];return r.Props&&t.push(h_(r.Props,e)),r.Custprops&&t.push(f_(r.Props,r.Custprops)),t.join("")}function xA(){return""}function vA(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var s=[];s.push(et("NumberFormat",null,{"ss:Format":sr(Cr[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};t.push(et("Style",s.join(""),o))}),et("Styles",t.join(""))}function w2(r){return et("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+nh(r.Ref,{r:0,c:0})})}function yA(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||t.push(w2(a)))}return et("Names",t.join(""))}function bA(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==t&&(l.Name.match(/^_xlfn\./)||s.push(w2(l)))}return s.join("")}function wA(r,e,t,n){if(!r)return"";var a=[];if(r["!margins"]&&(a.push("<PageSetup>"),r["!margins"].header&&a.push(et("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&a.push(et("Footer",null,{"x:Margin":r["!margins"].footer})),a.push(et("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)a.push(et("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),r["!protect"]&&(a.push(fn("ProtectContents","True")),r["!protect"].objects&&a.push(fn("ProtectObjects","True")),r["!protect"].scenarios&&a.push(fn("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?a.push(fn("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&a.push(fn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){r["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":et("WorksheetOptions",a.join(""),{xmlns:Qn.x})}function _A(r){return r.map(function(e){var t=A3(e.t||""),n=et("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return et("Comment",n,{"ss:Author":e.a})}).join("")}function NA(r,e,t,n,a,s,o){if(!r||r.v==null&&r.f==null)return"";var l={};if(r.f&&(l["ss:Formula"]="="+sr(nh(r.f,o))),r.F&&r.F.slice(0,e.length)==e){var c=rn(r.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(r.l&&r.l.Target&&(l["ss:HRef"]=sr(r.l.Target),r.l.Tooltip&&(l["x:HRefScreenTip"]=sr(r.l.Tooltip))),t["!merges"])for(var u=t["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var p="",g="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",g=String(r.v);break;case"b":p="Boolean",g=r.v?"1":"0";break;case"e":p="Error",g=Pl[r.v];break;case"d":p="DateTime",g=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||Cr[14]);break;case"s":p="String",g=E3(r.v||"");break}var h=ri(n.cellXfs,r,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var b=r.v!=null?g:"",x=r.t=="z"?"":'<Data ss:Type="'+p+'">'+b+"</Data>";return(r.c||[]).length>0&&(x+=_A(r.c)),et("Cell",x,l)}function SA(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=t2(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function EA(r,e,t,n){if(!r["!ref"])return"";var a=xr(r["!ref"]),s=r["!merges"]||[],o=0,l=[];r["!cols"]&&r["!cols"].forEach(function(y,v){th(y);var _=!!y.width,S=T0(v,y),j={"ss:Index":v+1};_&&(j["ss:Width"]=i0(S.width)),y.hidden&&(j["ss:Hidden"]="1"),l.push(et("Column",null,j))});for(var c=Array.isArray(r),u=a.s.r;u<=a.e.r;++u){for(var d=[SA(u,(r["!rows"]||[])[u])],p=a.s.c;p<=a.e.c;++p){var g=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>p)&&!(s[o].s.r>u)&&!(s[o].e.c<p)&&!(s[o].e.r<u)){(s[o].s.c!=p||s[o].s.r!=u)&&(g=!0);break}if(!g){var h={r:u,c:p},b=ir(h),x=c?(r[u]||[])[p]:r[b];d.push(NA(x,b,r,e,t,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function AA(r,e,t){var n=[],a=t.SheetNames[r],s=t.Sheets[a],o=s?bA(s,e,r,t):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?EA(s,e,r,t):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(wA(s,e,r,t)),n.join("")}function CA(r,e){e||(e={}),r.SSF||(r.SSF=Un(Cr)),r.SSF&&(E0(),S0(r.SSF),e.revssf=A0(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],ri(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(gA(r,e)),t.push(xA()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(et("Worksheet",AA(n,e,r),{"ss:Name":sr(r.SheetNames[n])}));return t[2]=vA(r,e),t[3]=yA(r),Wr+et("Workbook",t.join(""),{xmlns:Qn.ss,"xmlns:o":Qn.o,"xmlns:x":Qn.x,"xmlns:ss":Qn.ss,"xmlns:dt":Qn.dt,"xmlns:html":Qn.html})}var $u={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jA(r,e){var t=[],n=[],a=[],s=0,o,l=Bm(Zm,"n"),c=Bm(Qm,"n");if(r.Props)for(o=pn(r.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?t:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],r.Props[o[s]]]);if(r.Custprops)for(o=pn(r.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?t:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],r.Custprops[o[s]]]);var u=[];for(s=0;s<a.length;++s)zg.indexOf(a[s][0])>-1||$g.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&cr.utils.cfb_add(e,"/SummaryInformation",ap(n,$u.SI,c,Qm)),(t.length||u.length)&&cr.utils.cfb_add(e,"/DocumentSummaryInformation",ap(t,$u.DSI,l,Zm,u.length?u:null,$u.UDI))}function kA(r,e){var t=e||{},n=cr.utils.cfb_new({root:"R"}),a="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":a="/Workbook",t.biff=8;break;case"biff5":a="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return cr.utils.cfb_add(n,a,_2(r,t)),t.biff==8&&(r.Props||r.Custprops)&&jA(r,n),t.biff==8&&r.vbaraw&&G6(n,cr.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var TA={0:{f:PS},1:{f:HS},2:{f:oE},3:{f:YS},4:{f:zS},5:{f:nE},6:{f:hE},7:{f:QS},8:{f:yE},9:{f:vE},10:{f:gE},11:{f:xE},12:{f:qS},13:{f:cE},14:{f:JS},15:{f:GS},16:{f:sE},17:{f:mE},18:{f:tE},19:{f:Jd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:aA},40:{},42:{},43:{f:h6},44:{f:u6},45:{f:p6},46:{f:x6},47:{f:g6},48:{},49:{f:q3},50:{},51:{f:P6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:W_},62:{f:dE},63:{f:B6},64:{f:DE},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:LE},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:BS},148:{f:OS,p:16},151:{f:EE},152:{},153:{f:rA},154:{},155:{},156:{f:eA},157:{},158:{},159:{T:1,f:e6},160:{T:-1},161:{T:1,f:Pi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:bE},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:L6},336:{T:-1},337:{f:O6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:M_},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:AE},427:{f:CE},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:kE},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:MS},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:NE},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:W6},633:{T:1},634:{T:-1},635:{T:1,f:$6},636:{T:-1},637:{f:G3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:KE},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:OE},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function tt(r,e,t,n){var a=e;if(!isNaN(a)){var s=n||(t||[]).length||0,o=r.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&Kd(t)&&r.push(t)}}function LA(r,e,t,n){var a=(t||[]).length||0;if(a<=8224)return tt(r,e,t,a);var s=e;if(!isNaN(s)){for(var o=t.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=r.next(4);for(d.write_shift(2,s),d.write_shift(2,u),r.push(t.slice(c,c+u)),c+=u;c<a;){for(d=r.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),r.push(t.slice(c,c+u)),c+=u}}}function Dl(r,e,t){return r||(r=Re(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function FA(r,e,t,n){var a=Re(9);return Dl(a,r,e),Gg(t,n||"b",a),a}function PA(r,e,t){var n=Re(8+2*t.length);return Dl(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function RA(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?Bn(Ln(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?tt(r,2,K_(t,n,a)):tt(r,3,G_(t,n,a));return;case"b":case"e":tt(r,5,FA(t,n,e.v,e.t));return;case"s":case"str":tt(r,4,PA(t,n,(e.v||"").slice(0,255)));return}tt(r,1,Dl(null,t,n))}function DA(r,e,t,n){var a=Array.isArray(e),s=xr(e["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=qr(s)}for(var u=s.s.r;u<=s.e.r;++u){l=mn(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=Nn(d)),o=c[d]+l;var p=a?(e[u]||[])[d]:e[o];p&&RA(r,p,u,d)}}}function OA(r,e){for(var t=e||{},n=Mn(),a=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(a=s);if(a==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return tt(n,t.biff==4?1033:t.biff==3?521:9,eh(r,16,t)),DA(n,r.Sheets[r.SheetNames[a]],a,t),tt(n,10),n.end()}function IA(r,e,t){tt(r,49,T_({sz:12,name:"Arial"},t))}function MA(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&tt(r,1054,P_(a,e[a],t))})}function BA(r,e){var t=Re(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),tt(r,2151,t),t=Re(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Xg(xr(e["!ref"]||"A1"),t),t.write_shift(4,4),tt(r,2152,t)}function UA(r,e){for(var t=0;t<16;++t)tt(r,224,ip({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){tt(r,224,ip(n,0,e))})}function HA(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];tt(r,440,H_(n)),n[1].Tooltip&&tt(r,2048,$_(n))}delete e["!links"]}function $A(r,e){if(e){var t=0;e.forEach(function(n,a){++t<=256&&n&&tt(r,125,z_(T0(a,n),a))})}}function qA(r,e,t,n,a){var s=16+ri(a.cellXfs,e,a);if(e.v==null&&!e.bf){tt(r,513,Ai(t,n,s));return}if(e.bf)tt(r,6,fS(e,t,n,a,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Bn(Ln(e.v)):e.v;tt(r,515,I_(t,n,o,s));break;case"b":case"e":tt(r,517,O_(t,n,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var l=sh(a.Strings,e.v,a.revStrings);tt(r,253,L_(t,n,l,s))}else tt(r,516,F_(t,n,(e.v||"").slice(0,255),s,a));break;default:tt(r,513,Ai(t,n,s))}}function WA(r,e,t){var n=Mn(),a=t.SheetNames[r],s=t.Sheets[a]||{},o=(t||{}).Workbook||{},l=(o.Sheets||[])[r]||{},c=Array.isArray(s),u=e.biff==8,d,p="",g=[],h=xr(s["!ref"]||"A1"),b=u?65536:16384;if(h.e.c>255||h.e.r>=b){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,b-1)}tt(n,2057,eh(t,16,e)),tt(n,13,ua(1)),tt(n,12,ua(100)),tt(n,15,Tn(!0)),tt(n,17,Tn(!1)),tt(n,16,Ei(.001)),tt(n,95,Tn(!0)),tt(n,42,Tn(!1)),tt(n,43,Tn(!1)),tt(n,130,ua(1)),tt(n,128,D_()),tt(n,131,Tn(!1)),tt(n,132,Tn(!1)),u&&$A(n,s["!cols"]),tt(n,512,R_(h,e)),u&&(s["!links"]=[]);for(var x=h.s.r;x<=h.e.r;++x){p=mn(x);for(var y=h.s.c;y<=h.e.c;++y){x===h.s.r&&(g[y]=Nn(y)),d=g[y]+p;var v=c?(s[x]||[])[y]:s[d];v&&(qA(n,v,x,y,e),u&&v.l&&s["!links"].push([d,v.l]))}}var _=l.CodeName||l.name||a;return u&&tt(n,574,k_((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&tt(n,229,U_(s["!merges"])),u&&HA(n,s),tt(n,442,Yg(_)),u&&BA(n,s),tt(n,10),n.end()}function zA(r,e,t){var n=Mn(),a=(r||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=t.biff==8,c=t.biff==5;if(tt(n,2057,eh(r,5,t)),t.bookType=="xla"&&tt(n,135),tt(n,225,l?ua(1200):null),tt(n,193,g_(2)),c&&tt(n,191),c&&tt(n,192),tt(n,226),tt(n,92,E_("SheetJS",t)),tt(n,66,ua(l?1200:1252)),l&&tt(n,353,ua(0)),l&&tt(n,448),tt(n,317,V_(r.SheetNames.length)),l&&r.vbaraw&&tt(n,211),l&&r.vbaraw){var u=o.CodeName||"ThisWorkbook";tt(n,442,Yg(u))}tt(n,156,ua(17)),tt(n,25,Tn(!1)),tt(n,18,Tn(!1)),tt(n,19,ua(0)),l&&tt(n,431,Tn(!1)),l&&tt(n,444,ua(0)),tt(n,61,j_()),tt(n,64,Tn(!1)),tt(n,141,ua(0)),tt(n,34,Tn(XE(r)=="true")),tt(n,14,Tn(!0)),l&&tt(n,439,Tn(!1)),tt(n,218,ua(0)),IA(n,r,t),MA(n,r.SSF,t),UA(n,t),l&&tt(n,352,Tn(!1));var d=n.end(),p=Mn();l&&tt(p,140,q_()),l&&t.Strings&&LA(p,252,C_(t.Strings)),tt(p,10);var g=p.end(),h=Mn(),b=0,x=0;for(x=0;x<r.SheetNames.length;++x)b+=(l?12:11)+(l?2:1)*r.SheetNames[x].length;var y=d.length+b+g.length;for(x=0;x<r.SheetNames.length;++x){var v=s[x]||{};tt(h,133,A_({pos:y,hs:v.Hidden||0,dt:0,name:r.SheetNames[x]},t)),y+=e[x].length}var _=h.end();if(b!=_.length)throw new Error("BS8 "+b+" != "+_.length);var S=[];return d.length&&S.push(d),_.length&&S.push(_),g.length&&S.push(g),hn(S)}function VA(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=Un(Cr)),r&&r.SSF&&(E0(),S0(r.SSF),t.revssf=A0(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ih(t),t.cellXfs=[],ri(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var a=0;a<r.SheetNames.length;++a)n[n.length]=WA(a,t,r);return n.unshift(zA(r,n,t)),hn(n)}function _2(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var a=ra(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return VA(r,e);case 4:case 3:case 2:return OA(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function GA(r,e,t,n){for(var a=r["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>t||a[u].s.c>o)&&!(a[u].e.r<t||a[u].e.c<o)){if(a[u].s.r<t||a[u].s.c<o){l=-1;break}l=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var d=ir({r:t,c:o}),p=n.dense?(r[t]||[])[o]:r[d],g=p&&p.v!=null&&(p.h||S3(p.w||(Es(p),p.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(h["data-t"]=p&&p.t||"z",p.v!=null&&(h["data-v"]=p.v),p.z!=null&&(h["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),h.id=(n.id||"sjs")+"-"+d,s.push(et("td",g,h))}}var b="<tr>";return b+s.join("")+"</tr>"}var KA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',YA="</body></html>";function XA(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function N2(r,e){var t=e||{},n=t.header!=null?t.header:KA,a=t.footer!=null?t.footer:YA,s=[n],o=ra(r["!ref"]);t.dense=Array.isArray(r),s.push(XA(r,o,t));for(var l=o.s.r;l<=o.e.r;++l)s.push(GA(r,o,l,t));return s.push("</table>"+a),s.join("")}function S2(r,e,t){var n=t||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?rn(n.origin):n.origin;a=o.r,s=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(r["!ref"]){var d=ra(r["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var p=[],g=0,h=r["!rows"]||(r["!rows"]=[]),b=0,x=0,y=0,v=0,_=0,S=0;for(r["!cols"]||(r["!cols"]=[]);b<l.length&&x<c;++b){var j=l[b];if(fp(j)){if(n.display)continue;h[x]={hidden:!0}}var I=j.children;for(y=v=0;y<I.length;++y){var J=I[y];if(!(n.display&&fp(J))){var k=J.hasAttribute("data-v")?J.getAttribute("data-v"):J.hasAttribute("v")?J.getAttribute("v"):j3(J.innerHTML),F=J.getAttribute("data-z")||J.getAttribute("z");for(g=0;g<p.length;++g){var T=p[g];T.s.c==v+s&&T.s.r<x+a&&x+a<=T.e.r&&(v=T.e.c+1-s,g=-1)}S=+J.getAttribute("colspan")||1,((_=+J.getAttribute("rowspan")||1)>1||S>1)&&p.push({s:{r:x+a,c:v+s},e:{r:x+a+(_||1)-1,c:v+s+(S||1)-1}});var R={t:"s",v:k},A=J.getAttribute("data-t")||J.getAttribute("t")||"";k!=null&&(k.length==0?R.t=A||"z":n.raw||k.trim().length==0||A=="s"||(k==="TRUE"?R={t:"b",v:!0}:k==="FALSE"?R={t:"b",v:!1}:isNaN(ws(k))?isNaN(bl(k).getDate())||(R={t:"d",v:Ln(k)},n.cellDates||(R={t:"n",v:Bn(R.v)}),R.z=n.dateNF||Cr[14]):R={t:"n",v:ws(k)})),R.z===void 0&&F!=null&&(R.z=F);var P="",H=J.getElementsByTagName("A");if(H&&H.length)for(var K=0;K<H.length&&!(H[K].hasAttribute("href")&&(P=H[K].getAttribute("href"),P.charAt(0)!="#"));++K);P&&P.charAt(0)!="#"&&(R.l={Target:P}),n.dense?(r[x+a]||(r[x+a]=[]),r[x+a][v+s]=R):r[ir({c:v+s,r:x+a})]=R,u.e.c<v+s&&(u.e.c=v+s),v+=S}}++x}return p.length&&(r["!merges"]=(r["!merges"]||[]).concat(p)),u.e.r=Math.max(u.e.r,x-1+a),r["!ref"]=qr(u),x>=c&&(r["!fullref"]=qr((u.e.r=l.length-b+x-1+a,u))),r}function E2(r,e){var t=e||{},n=t.dense?[]:{};return S2(n,r,e)}function JA(r,e){return ki(E2(r,e),e)}function fp(r){var e="",t=ZA(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function ZA(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var QA=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+_l({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Wr+e}}(),mp=function(){var r=function(s){return sr(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+sr(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,p=ra(s["!ref"]||"A1"),g=s["!merges"]||[],h=0,b=Array.isArray(s);if(s["!cols"])for(d=0;d<=p.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",y=s["!rows"]||[];for(u=0;u<p.s.r;++u)x=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=p.e.r;++u){for(x=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+x+`>
`),d=0;d<p.s.c;++d)c.push(e);for(;d<=p.e.c;++d){var v=!1,_={},S="";for(h=0;h!=g.length;++h)if(!(g[h].s.c>d)&&!(g[h].s.r>u)&&!(g[h].e.c<d)&&!(g[h].e.r<u)){(g[h].s.c!=d||g[h].s.r!=u)&&(v=!0),_["table:number-columns-spanned"]=g[h].e.c-g[h].s.c+1,_["table:number-rows-spanned"]=g[h].e.r-g[h].s.r+1;break}if(v){c.push(t);continue}var j=ir({r:u,c:d}),I=b?(s[u]||[])[d]:s[j];if(I&&I.f&&(_["table:formula"]=sr(yS(I.f)),I.F&&I.F.slice(0,j.length)==j)){var J=ra(I.F);_["table:number-matrix-columns-spanned"]=J.e.c-J.s.c+1,_["table:number-matrix-rows-spanned"]=J.e.r-J.s.r+1}if(!I){c.push(e);continue}switch(I.t){case"b":S=I.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=I.v?"true":"false";break;case"n":S=I.w||String(I.v||0),_["office:value-type"]="float",_["office:value"]=I.v||0;break;case"s":case"str":S=I.v==null?"":I.v,_["office:value-type"]="string";break;case"d":S=I.w||Ln(I.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=Ln(I.v).toISOString(),_["table:style-name"]="ce1";break;default:c.push(e);continue}var k=r(S);if(I.l&&I.l.Target){var F=I.l.Target;F=F.charAt(0)=="#"?"#"+bS(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),k=et("text:a",k,{"xlink:href":F.replace(/&/g,"&amp;")})}c.push("          "+et("table:table-cell",et("text:p",k,{}),_)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var p=u["!cols"][d];if(p.width==null&&p.wpx==null&&p.wch==null)continue;th(p),p.ods=l;var g=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var p=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Wr],u=_l({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=_l({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(Ug().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var p=0;p!=o.SheetNames.length;++p)c.push(n(o.Sheets[o.SheetNames[p]],o,p));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function A2(r,e){if(e.bookType=="fods")return mp(r,e);var t=Wd(),n="",a=[],s=[];return n="mimetype",qt(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",qt(t,n,mp(r,e)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",qt(t,n,QA(r,e)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",qt(t,n,Wr+Ug()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",qt(t,n,d_(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",qt(t,n,c_(a)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function c0(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function e8(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Ca(wl(r))}function t8(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function ei(r){var e=r.reduce(function(a,s){return a+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(a){t.set(a,n),n+=a.length}),t}function r8(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,a=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)r[e+s]=a&255;r[e+15]|=t>=0?0:128}function Nl(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function tr(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function fo(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function Xr(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],a=Nl(r,t),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=t[0];r[t[0]++]>=128;);l=r.slice(c,t[0])}break;case 5:o=4,l=r.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,l=r.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=Nl(r,t),l=r.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:s};e[a]==null?e[a]=[u]:e[a].push(u)}return e}function cn(r){var e=[];return r.forEach(function(t,n){t.forEach(function(a){a.data&&(e.push(tr(n*8+a.type)),a.type==2&&e.push(tr(a.data.length)),e.push(a.data))})}),ei(e)}function Ea(r){for(var e,t=[],n=[0];n[0]<r.length;){var a=Nl(r,n),s=Xr(r.slice(n[0],n[0]+a));n[0]+=a;var o={id:fo(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=Xr(l.data),u=fo(c[3][0].data);o.messages.push({meta:c,data:r.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(o.merge=fo(s[3][0].data)>>>0>0),t.push(o)}return t}function Ji(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:tr(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:tr(+!!t.merge),type:0}]);var a=[];t.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:tr(o.data.length)}],n[2].push({data:cn(o.meta),type:2})});var s=cn(n);e.push(tr(s.length)),e.push(s),a.forEach(function(o){return e.push(o)})}),ei(e)}function n8(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=Nl(e,t),a=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var o=e[t[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[t[0]],l>1&&(o|=e[t[0]+1]<<8),l>2&&(o|=e[t[0]+2]<<16),l>3&&(o|=e[t[0]+3]<<24),o>>>=0,o++,t[0]+=l}a.push(e.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(e[t[0]]>>2&7)+4,c=(e[t[0]++]&224)<<3,c|=e[t[0]++]):(u=(e[t[0]++]>>2)+1,s==2?(c=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(c=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),a=[ei(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=ei(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Aa(r){for(var e=[],t=0;t<r.length;){var n=r[t++],a=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(n8(n,r.slice(t,t+a))),t+=a}if(t!==r.length)throw new Error("data is not a valid framed stream!");return ei(e)}function Zi(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),a=new Uint8Array(4);e.push(a);var s=tr(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,t+=n}return ei(e)}function qu(r,e){var t=new Uint8Array(32),n=c0(t),a=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,r8(t,a,r.v),s|=1,a+=16;break;case"b":t[1]=6,n.setFloat64(a,r.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(a,e.indexOf(r.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,s,!0),t.slice(0,a)}function Wu(r,e){var t=new Uint8Array(32),n=c0(t),a=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(a,r.v,!0),s|=32,a+=8;break;case"b":t[2]=6,n.setFloat64(a,r.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(a,e.indexOf(r.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,s,!0),t.slice(0,a)}function Ws(r){var e=Xr(r);return Nl(e[1][0].data)}function a8(r,e,t){var n,a,s,o;if(!((n=r[6])!=null&&n[0])||!((a=r[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=r[8])==null?void 0:s[0])==null?void 0:o.data)&&fo(r[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=c0(r[7][0].data),d=0,p=[],g=c0(r[4][0].data),h=0,b=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,d,!0),g.setUint16(x*2,h,!0);var y,v;switch(typeof e[x]){case"string":y=qu({t:"s",v:e[x]},t),v=Wu({t:"s",v:e[x]},t);break;case"number":y=qu({t:"n",v:e[x]},t),v=Wu({t:"n",v:e[x]},t);break;case"boolean":y=qu({t:"b",v:e[x]},t),v=Wu({t:"b",v:e[x]},t);break;default:throw new Error("Unsupported value "+e[x])}p.push(y),d+=y.length,b.push(v),h+=v.length,++c}for(r[2][0].data=tr(c);x<r[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return r[6][0].data=ei(p),r[3][0].data=ei(b),c}function s8(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ra(t["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(qr(n)));var s=u0(t,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(O){return O.forEach(function(D){typeof D=="string"&&o.push(D)})});var l={},c=[],u=cr.read(e.numbers,{type:"base64"});u.FileIndex.map(function(O,D){return[O,u.FullPaths[D]]}).forEach(function(O){var D=O[0],M=O[1];if(D.type==2&&D.name.match(/\.iwa/)){var V=D.content,oe=Aa(V),he=Ea(oe);he.forEach(function(ue){c.push(ue.id),l[ue.id]={deps:[],location:M,type:fo(ue.messages[0].meta[1][0].data)}})}}),c.sort(function(O,D){return O-D});var d=c.filter(function(O){return O>1}).map(function(O){return[O,tr(O)]});u.FileIndex.map(function(O,D){return[O,u.FullPaths[D]]}).forEach(function(O){var D=O[0];if(O[1],!!D.name.match(/\.iwa/)){var M=Ea(Aa(D.content));M.forEach(function(V){V.messages.forEach(function(oe){d.forEach(function(he){V.messages.some(function(ue){return fo(ue.meta[1][0].data)!=11006&&t8(ue.data,he[1])})&&l[he[0]].deps.push(V.id)})})})}});for(var p=cr.find(u,l[1].location),g=Ea(Aa(p.content)),h,b=0;b<g.length;++b){var x=g[b];x.id==1&&(h=x)}var y=Ws(Xr(h.messages[0].data)[1][0].data);for(p=cr.find(u,l[y].location),g=Ea(Aa(p.content)),b=0;b<g.length;++b)x=g[b],x.id==y&&(h=x);for(y=Ws(Xr(h.messages[0].data)[2][0].data),p=cr.find(u,l[y].location),g=Ea(Aa(p.content)),b=0;b<g.length;++b)x=g[b],x.id==y&&(h=x);for(y=Ws(Xr(h.messages[0].data)[2][0].data),p=cr.find(u,l[y].location),g=Ea(Aa(p.content)),b=0;b<g.length;++b)x=g[b],x.id==y&&(h=x);var v=Xr(h.messages[0].data);{v[6][0].data=tr(n.e.r+1),v[7][0].data=tr(n.e.c+1);var _=Ws(v[46][0].data),S=cr.find(u,l[_].location),j=Ea(Aa(S.content));{for(var I=0;I<j.length&&j[I].id!=_;++I);if(j[I].id!=_)throw"Bad ColumnRowUIDMapArchive";var J=Xr(j[I].messages[0].data);J[1]=[],J[2]=[],J[3]=[];for(var k=0;k<=n.e.c;++k){var F=[];F[1]=F[2]=[{type:0,data:tr(k+420690)}],J[1].push({type:2,data:cn(F)}),J[2].push({type:0,data:tr(k)}),J[3].push({type:0,data:tr(k)})}J[4]=[],J[5]=[],J[6]=[];for(var T=0;T<=n.e.r;++T)F=[],F[1]=F[2]=[{type:0,data:tr(T+726270)}],J[4].push({type:2,data:cn(F)}),J[5].push({type:0,data:tr(T)}),J[6].push({type:0,data:tr(T)});j[I].messages[0].data=cn(J)}S.content=Zi(Ji(j)),S.size=S.content.length,delete v[46];var R=Xr(v[4][0].data);{R[7][0].data=tr(n.e.r+1);var A=Xr(R[1][0].data),P=Ws(A[2][0].data);S=cr.find(u,l[P].location),j=Ea(Aa(S.content));{if(j[0].id!=P)throw"Bad HeaderStorageBucket";var H=Xr(j[0].messages[0].data);for(T=0;T<s.length;++T){var K=Xr(H[2][0].data);K[1][0].data=tr(T),K[4][0].data=tr(s[T].length),H[2][T]={type:H[2][0].type,data:cn(K)}}j[0].messages[0].data=cn(H)}S.content=Zi(Ji(j)),S.size=S.content.length;var ce=Ws(R[2][0].data);S=cr.find(u,l[ce].location),j=Ea(Aa(S.content));{if(j[0].id!=ce)throw"Bad HeaderStorageBucket";for(H=Xr(j[0].messages[0].data),k=0;k<=n.e.c;++k)K=Xr(H[2][0].data),K[1][0].data=tr(k),K[4][0].data=tr(n.e.r+1),H[2][k]={type:H[2][0].type,data:cn(K)};j[0].messages[0].data=cn(H)}S.content=Zi(Ji(j)),S.size=S.content.length;var me=Ws(R[4][0].data);(function(){for(var O=cr.find(u,l[me].location),D=Ea(Aa(O.content)),M,V=0;V<D.length;++V){var oe=D[V];oe.id==me&&(M=oe)}var he=Xr(M.messages[0].data);{he[3]=[];var ue=[];o.forEach(function(Le,Ie){ue[1]=[{type:0,data:tr(Ie)}],ue[2]=[{type:0,data:tr(1)}],ue[3]=[{type:2,data:e8(Le)}],he[3].push({type:2,data:cn(ue)})})}M.messages[0].data=cn(he);var Z=Ji(D),ye=Zi(Z);O.content=ye,O.size=O.content.length})();var le=Xr(R[3][0].data);{var xe=le[1][0];delete le[2];var we=Xr(xe.data);{var Oe=Ws(we[2][0].data);(function(){for(var O=cr.find(u,l[Oe].location),D=Ea(Aa(O.content)),M,V=0;V<D.length;++V){var oe=D[V];oe.id==Oe&&(M=oe)}var he=Xr(M.messages[0].data);{delete he[6],delete le[7];var ue=new Uint8Array(he[5][0].data);he[5]=[];for(var Z=0,ye=0;ye<=n.e.r;++ye){var Le=Xr(ue);Z+=a8(Le,s[ye],o),Le[1][0].data=tr(ye),he[5].push({data:cn(Le),type:2})}he[1]=[{type:0,data:tr(n.e.c+1)}],he[2]=[{type:0,data:tr(n.e.r+1)}],he[3]=[{type:0,data:tr(Z)}],he[4]=[{type:0,data:tr(n.e.r+1)}]}M.messages[0].data=cn(he);var Ie=Ji(D),pe=Zi(Ie);O.content=pe,O.size=O.content.length})()}xe.data=cn(we)}R[3][0].data=cn(le)}v[4][0].data=cn(R)}h.messages[0].data=cn(v);var ge=Ji(g),C=Zi(ge);return p.content=C,p.size=p.content.length,u}function i8(r){return function(t){for(var n=0;n!=r.length;++n){var a=r[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function ih(r){i8([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function o8(r,e){return e.bookType=="ods"?A2(r,e):e.bookType=="numbers"?s8(r,e):e.bookType=="xlsb"?l8(r,e):c8(r,e)}function l8(r,e){no=1024,r&&!r.SSF&&(r.SSF=Un(Cr)),r&&r.SSF&&(E0(),S0(r.SSF),e.revssf=A0(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,hl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=l2.indexOf(e.bookType)>-1,a=Ig();ih(e=e||{});var s=Wd(),o="",l=0;if(e.cellXfs=[],ri(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),o="docProps/core.xml",qt(s,o,Hg(r.Props,e)),a.coreprops.push(o),rr(e.rels,2,o,Yt.CORE_PROPS),o="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],u=0;u<r.SheetNames.length;++u)(r.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(r.SheetNames[u]);r.Props.SheetNames=c}for(r.Props.Worksheets=r.Props.SheetNames.length,qt(s,o,qg(r.Props)),a.extprops.push(o),rr(e.rels,3,o,Yt.EXT_PROPS),r.Custprops!==r.Props&&pn(r.Custprops||{}).length>0&&(o="docProps/custom.xml",qt(s,o,Wg(r.Custprops)),a.custprops.push(o),rr(e.rels,4,o,Yt.CUST_PROPS)),l=1;l<=r.SheetNames.length;++l){var d={"!id":{}},p=r.Sheets[r.SheetNames[l-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+l+"."+t,qt(s,o,dA(l-1,o,e,r,d)),a.sheets.push(o),rr(e.wbrels,-1,"worksheets/sheet"+l+"."+t,Yt.WS[0])}if(p){var h=p["!comments"],b=!1,x="";h&&h.length>0&&(x="xl/comments"+l+"."+t,qt(s,x,mA(h,x)),a.comments.push(x),rr(d,-1,"../comments"+l+"."+t,Yt.CMNT),b=!0),p["!legacy"]&&b&&qt(s,"xl/drawings/vmlDrawing"+l+".vml",i2(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&qt(s,Bg(o),uo(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,qt(s,o,fA(e.Strings,o,e)),a.strs.push(o),rr(e.wbrels,-1,"sharedStrings."+t,Yt.SST)),o="xl/workbook."+t,qt(s,o,uA(r,o)),a.workbooks.push(o),rr(e.rels,1,o,Yt.WB),o="xl/theme/theme1.xml",qt(s,o,a2(r.Themes,e)),a.themes.push(o),rr(e.wbrels,-1,"theme/theme1.xml",Yt.THEME),o="xl/styles."+t,qt(s,o,hA(r,o,e)),a.styles.push(o),rr(e.wbrels,-1,"styles."+t,Yt.STY),r.vbaraw&&n&&(o="xl/vbaProject.bin",qt(s,o,r.vbaraw),a.vba.push(o),rr(e.wbrels,-1,"vbaProject.bin",Yt.VBA)),o="xl/metadata."+t,qt(s,o,pA(o)),a.metadata.push(o),rr(e.wbrels,-1,"metadata."+t,Yt.XLMETA),qt(s,"[Content_Types].xml",Mg(a,e)),qt(s,"_rels/.rels",uo(e.rels)),qt(s,"xl/_rels/workbook."+t+".rels",uo(e.wbrels)),delete e.revssf,delete e.ssf,s}function c8(r,e){no=1024,r&&!r.SSF&&(r.SSF=Un(Cr)),r&&r.SSF&&(E0(),S0(r.SSF),e.revssf=A0(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,hl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=l2.indexOf(e.bookType)>-1,a=Ig();ih(e=e||{});var s=Wd(),o="",l=0;if(e.cellXfs=[],ri(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),o="docProps/core.xml",qt(s,o,Hg(r.Props,e)),a.coreprops.push(o),rr(e.rels,2,o,Yt.CORE_PROPS),o="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],u=0;u<r.SheetNames.length;++u)(r.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(r.SheetNames[u]);r.Props.SheetNames=c}r.Props.Worksheets=r.Props.SheetNames.length,qt(s,o,qg(r.Props)),a.extprops.push(o),rr(e.rels,3,o,Yt.EXT_PROPS),r.Custprops!==r.Props&&pn(r.Custprops||{}).length>0&&(o="docProps/custom.xml",qt(s,o,Wg(r.Custprops)),a.custprops.push(o),rr(e.rels,4,o,Yt.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,l=1;l<=r.SheetNames.length;++l){var p={"!id":{}},g=r.Sheets[r.SheetNames[l-1]],h=(g||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+t,qt(s,o,x2(l-1,e,r,p)),a.sheets.push(o),rr(e.wbrels,-1,"worksheets/sheet"+l+"."+t,Yt.WS[0])}if(g){var b=g["!comments"],x=!1,y="";if(b&&b.length>0){var v=!1;b.forEach(function(_){_[1].forEach(function(S){S.T==!0&&(v=!0)})}),v&&(y="xl/threadedComments/threadedComment"+l+"."+t,qt(s,y,U6(b,d,e)),a.threadedcomments.push(y),rr(p,-1,"../threadedComments/threadedComment"+l+"."+t,Yt.TCMNT)),y="xl/comments"+l+"."+t,qt(s,y,o2(b)),a.comments.push(y),rr(p,-1,"../comments"+l+"."+t,Yt.CMNT),x=!0}g["!legacy"]&&x&&qt(s,"xl/drawings/vmlDrawing"+l+".vml",i2(l,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&qt(s,Bg(o),uo(p))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,qt(s,o,Zg(e.Strings,e)),a.strs.push(o),rr(e.wbrels,-1,"sharedStrings."+t,Yt.SST)),o="xl/workbook."+t,qt(s,o,b2(r)),a.workbooks.push(o),rr(e.rels,1,o,Yt.WB),o="xl/theme/theme1.xml",qt(s,o,a2(r.Themes,e)),a.themes.push(o),rr(e.wbrels,-1,"theme/theme1.xml",Yt.THEME),o="xl/styles."+t,qt(s,o,r2(r,e)),a.styles.push(o),rr(e.wbrels,-1,"styles."+t,Yt.STY),r.vbaraw&&n&&(o="xl/vbaProject.bin",qt(s,o,r.vbaraw),a.vba.push(o),rr(e.wbrels,-1,"vbaProject.bin",Yt.VBA)),o="xl/metadata."+t,qt(s,o,s2()),a.metadata.push(o),rr(e.wbrels,-1,"metadata."+t,Yt.XLMETA),d.length>1&&(o="xl/persons/person.xml",qt(s,o,H6(d)),a.people.push(o),rr(e.wbrels,-1,"persons/person.xml",Yt.PEOPLE)),qt(s,"[Content_Types].xml",Mg(a,e)),qt(s,"_rels/.rels",uo(e.rels)),qt(s,"xl/_rels/workbook."+t+".rels",uo(e.wbrels)),delete e.revssf,delete e.ssf,s}function u8(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=Ss(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function C2(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Ll(e.file,cr.write(r,{type:Jt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return cr.write(r,e)}function d8(r,e){var t=Un(e||{}),n=o8(r,t);return h8(n,t)}function h8(r,e){var t={},n=Jt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=r.FullPaths?cr.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(N0(a))}return e.password&&typeof encrypt_agile<"u"?C2(encrypt_agile(a,e.password),e):e.type==="file"?Ll(e.file,a):e.type=="string"?ll(a):a}function f8(r,e){var t=e||{},n=kA(r,t);return C2(n,t)}function Ka(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return yl(wl(n));case"binary":return wl(n);case"string":return r;case"file":return Ll(e.file,n,"utf8");case"buffer":return Jt?As(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ka(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function m8(r,e){switch(e.type){case"base64":return yl(r);case"binary":return r;case"string":return r;case"file":return Ll(e.file,r,"binary");case"buffer":return Jt?As(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Ec(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?yl(t):e.type=="string"?ll(t):t;case"file":return Ll(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function j2(r,e){$4(),QE(r);var t=Un(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=j2(r,t);return t.type="array",N0(n)}var a=0;if(t.sheet&&(typeof t.sheet=="number"?a=t.sheet:a=r.SheetNames.indexOf(t.sheet),!r.SheetNames[a]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ka(CA(r,t),t);case"slk":case"sylk":return Ka(X_.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"htm":case"html":return Ka(N2(r.Sheets[r.SheetNames[a]],t),t);case"txt":return m8(k2(r.Sheets[r.SheetNames[a]],t),t);case"csv":return Ka(oh(r.Sheets[r.SheetNames[a]],t),t,"\uFEFF");case"dif":return Ka(J_.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"dbf":return Ec(Y_.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"prn":return Ka(Z_.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"rtf":return Ka(s6.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"eth":return Ka(Jg.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"fods":return Ka(A2(r,t),t);case"wk1":return Ec(op.sheet_to_wk1(r.Sheets[r.SheetNames[a]],t),t);case"wk3":return Ec(op.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Ec(_2(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),f8(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return d8(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function p8(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function g8(r,e,t){var n={};return n.type="file",n.file=e,p8(n),j2(r,n)}function x8(r,e,t,n,a,s,o,l){var c=mn(t),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),p=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!o||r[t])for(var h=e.s.c;h<=e.e.c;++h){var b=o?r[t][h]:r[n[h]+c];if(b===void 0||b.t===void 0){if(u===void 0)continue;s[h]!=null&&(g[s[h]]=u);continue}var x=b.v;switch(b.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(s[h]!=null){if(x==null)if(b.t=="e"&&x===null)g[s[h]]=null;else if(u!==void 0)g[s[h]]=u;else if(d&&x===null)g[s[h]]=null;else continue;else g[s[h]]=d&&(b.t!=="n"||b.t==="n"&&l.rawNumbers!==!1)?x:Es(b,x,l);x!=null&&(p=!1)}}return{row:g,isempty:p}}function u0(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:r["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=xr(d);break;case"number":c=xr(r["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var p=mn(c.s.r),g=[],h=[],b=0,x=0,y=Array.isArray(r),v=c.s.r,_=0,S={};y&&!r[v]&&(r[v]=[]);var j=u.skipHidden&&r["!cols"]||[],I=u.skipHidden&&r["!rows"]||[];for(_=c.s.c;_<=c.e.c;++_)if(!(j[_]||{}).hidden)switch(g[_]=Nn(_),t=y?r[v][_]:r[g[_]+p],n){case 1:s[_]=_-c.s.c;break;case 2:s[_]=g[_];break;case 3:s[_]=u.header[_-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),l=o=Es(t,null,u),x=S[o]||0,!x)S[o]=1;else{do l=o+"_"+x++;while(S[l]);S[o]=x,S[l]=1}s[_]=l}for(v=c.s.r+a;v<=c.e.r;++v)if(!(I[v]||{}).hidden){var J=x8(r,c,v,g,n,s,y,u);(J.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[b++]=J.row)}return h.length=b,h}var pp=/"/g;function v8(r,e,t,n,a,s,o,l){for(var c=!0,u=[],d="",p=mn(t),g=e.s.c;g<=e.e.c;++g)if(n[g]){var h=l.dense?(r[t]||[])[g]:r[n[g]+p];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:Es(h,null,l));for(var b=0,x=0;b!==d.length;++b)if((x=d.charCodeAt(b))===a||x===s||x===34||l.forceQuotes){d='"'+d.replace(pp,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(pp,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function oh(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var a=xr(r["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",p=[];n.dense=Array.isArray(r);for(var g=n.skipHidden&&r["!cols"]||[],h=n.skipHidden&&r["!rows"]||[],b=a.s.c;b<=a.e.c;++b)(g[b]||{}).hidden||(p[b]=Nn(b));for(var x=0,y=a.s.r;y<=a.e.r;++y)(h[y]||{}).hidden||(d=v8(r,a,y,p,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&t.push((x++?l:"")+d)));return delete n.dense,t.join("")}function k2(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=oh(r,e);return t}function y8(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var a=xr(r["!ref"]),s="",o=[],l,c=[],u=Array.isArray(r);for(l=a.s.c;l<=a.e.c;++l)o[l]=Nn(l);for(var d=a.s.r;d<=a.e.r;++d)for(s=mn(d),l=a.s.c;l<=a.e.c;++l)if(e=o[l]+s,t=u?(r[d]||[])[l]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}c[c.length]=e+"="+n}return c}function T2(r,e,t){var n=t||{},a=+!n.skipHeader,s=r||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?rn(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+e.length-1+a}};if(s["!ref"]){var p=xr(s["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),o==-1&&(o=p.e.r+1,d.e.r=o+e.length-1+a)}else o==-1&&(o=0,d.e.r=e.length-1+a);var g=n.header||[],h=0;e.forEach(function(x,y){pn(x).forEach(function(v){(h=g.indexOf(v))==-1&&(g[h=g.length]=v);var _=x[v],S="z",j="",I=ir({c:l+h,r:o+y+a});u=Sl(s,I),_&&typeof _=="object"&&!(_ instanceof Date)?s[I]=_:(typeof _=="number"?S="n":typeof _=="boolean"?S="b":typeof _=="string"?S="s":_ instanceof Date?(S="d",n.cellDates||(S="n",_=Bn(_)),j=n.dateNF||Cr[14]):_===null&&n.nullError&&(S="e",_=0),u?(u.t=S,u.v=_,delete u.w,delete u.R,j&&(u.z=j)):s[I]=u={t:S,v:_},j&&(u.z=j))})}),d.e.c=Math.max(d.e.c,l+g.length-1);var b=mn(o);if(a)for(h=0;h<g.length;++h)s[Nn(h+l)+b]={t:"s",v:g[h]};return s["!ref"]=qr(d),s}function b8(r,e){return T2(null,r,e)}function Sl(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=rn(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?Sl(r,ir(e)):Sl(r,ir({r:e,c:t||0}))}function w8(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function _8(){return{SheetNames:[],Sheets:{}}}function N8(r,e,t,n){var a=1;if(!t)for(;a<=65535&&r.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||t;for(++a;a<=65535&&r.SheetNames.indexOf(t=o+a)!=-1;++a);}if(y2(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function S8(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=w8(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function E8(r,e){return r.z=e,r}function L2(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function A8(r,e,t){return L2(r,"#"+e,t)}function C8(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function j8(r,e,t,n){for(var a=typeof e!="string"?e:xr(e),s=typeof e=="string"?e:qr(e),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=Sl(r,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=t,n&&(c.D=!0))}return r}var $r={encode_col:Nn,encode_row:mn,encode_cell:ir,encode_range:qr,decode_col:Xd,decode_row:Yd,split_cell:$3,decode_cell:rn,decode_range:ra,format_cell:Es,sheet_add_aoa:Lg,sheet_add_json:T2,sheet_add_dom:S2,aoa_to_sheet:No,json_to_sheet:b8,table_to_sheet:E2,table_to_book:JA,sheet_to_csv:oh,sheet_to_txt:k2,sheet_to_json:u0,sheet_to_html:N2,sheet_to_formulae:y8,sheet_to_row_object_array:u0,sheet_get_cell:Sl,book_new:_8,book_append_sheet:N8,book_set_sheet_visibility:S8,cell_set_number_format:E8,cell_set_hyperlink:L2,cell_set_internal_link:A8,cell_add_comment:C8,sheet_set_array_formula:j8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const k8={employeePerformance:async r=>{const e=new _t,t=e.internal.pageSize.getWidth(),n=20;let a=30;e.setFontSize(20),e.setFont(void 0,"bold"),e.text("EMPLOYEE PERFORMANCE REPORT",t/2,a,{align:"center"}),a+=20,e.setFontSize(14),e.setFont(void 0,"bold"),e.text("Employee Information",n,a),a+=10,e.setFontSize(11),e.setFont(void 0,"normal"),e.text(`Name: ${r.employeeName||"N/A"}`,n,a),a+=6,e.text(`Department: ${r.department||"N/A"}`,n,a),a+=6,e.text(`Period: ${r.period||"N/A"}`,n,a),a+=15,r.metrics&&(e.setFontSize(14),e.setFont(void 0,"bold"),e.text("Performance Metrics",n,a),a+=10,e.setFontSize(11),e.setFont(void 0,"normal"),Object.entries(r.metrics).forEach(([o,l])=>{e.text(`${o}: ${l}`,n,a),a+=6}),a+=10),r.summary&&(e.setFontSize(14),e.setFont(void 0,"bold"),e.text("Summary",n,a),a+=10,e.setFontSize(11),e.setFont(void 0,"normal"),e.splitTextToSize(r.summary,t-2*n).forEach(l=>{e.text(l,n,a),a+=6}));const s=e.internal.pageSize.getHeight();return e.setFontSize(8),e.text(`Generated on: ${new Date().toLocaleDateString()}`,n,s-10),e},monthlyReport:async r=>{const e=new _t,t=e.internal.pageSize.getWidth(),n=20;let a=30;return e.setFontSize(20),e.setFont(void 0,"bold"),e.text("MONTHLY PERFORMANCE REPORT",t/2,a,{align:"center"}),a+=20,e.setFontSize(12),e.setFont(void 0,"normal"),e.text(`Month: ${r.month||"N/A"}`,n,a),a+=8,e.text(`Generated by: ${r.generatedBy||"System"}`,n,a),a+=15,r.metrics&&(e.setFontSize(14),e.setFont(void 0,"bold"),e.text("Key Metrics",n,a),a+=10,e.setFontSize(11),e.setFont(void 0,"normal"),Object.entries(r.metrics).forEach(([s,o])=>{e.text(`${s}: ${o}`,n,a),a+=6}),a+=10),r.departmentBreakdown&&r.departmentBreakdown.length>0&&(e.setFontSize(14),e.setFont(void 0,"bold"),e.text("Department Performance",n,a),a+=10,e.setFontSize(11),e.setFont(void 0,"normal"),r.departmentBreakdown.forEach(s=>{e.text(`${s.department}: ${s.score||"N/A"}`,n,a),a+=6})),e},incentiveReport:async r=>{const e=new _t,t=e.internal.pageSize.getWidth(),n=20;let a=30;return e.setFontSize(20),e.setFont(void 0,"bold"),e.text("INCENTIVE DISBURSEMENT REPORT",t/2,a,{align:"center"}),a+=20,e.setFontSize(12),e.setFont(void 0,"normal"),e.text(`Period: ${r.period||"N/A"}`,n,a),a+=8,e.text(`Total Applications: ${r.totalApplications||0}`,n,a),a+=8,e.text(`Total Amount: ${r.totalAmount||"N/A"}`,n,a),a+=15,r.applications&&r.applications.length>0&&(e.setFontSize(14),e.setFont(void 0,"bold"),e.text("Incentive Applications",n,a),a+=10,e.setFontSize(10),e.setFont(void 0,"bold"),e.text("Employee",n,a),e.text("Type",n+60,a),e.text("Amount",n+120,a),e.text("Status",n+160,a),a+=8,e.setFont(void 0,"normal"),r.applications.slice(0,20).forEach(s=>{var o;e.text(s.employeeName||"N/A",n,a),e.text(s.incentiveType||"N/A",n+60,a),e.text(((o=s.amount)==null?void 0:o.toString())||"N/A",n+120,a),e.text(s.status||"N/A",n+160,a),a+=6})),e}},T8={employeePerformance:r=>{const e=$r.book_new(),t=[["Employee Information"],["Name",r.employeeName||"N/A"],["Department",r.department||"N/A"],["Period",r.period||"N/A"],["Generated On",new Date().toLocaleDateString()]];r.metrics&&(t.push([""],["Performance Metrics"]),Object.entries(r.metrics).forEach(([a,s])=>{t.push([a,s])}));const n=$r.aoa_to_sheet(t);if($r.book_append_sheet(e,n,"Employee Info"),r.performanceData&&Array.isArray(r.performanceData)){const a=$r.json_to_sheet(r.performanceData);$r.book_append_sheet(e,a,"Performance Data")}return e},monthlyReport:r=>{const e=$r.book_new(),t=[["Monthly Performance Report"],["Month",r.month||"N/A"],["Generated By",r.generatedBy||"System"],["Generated On",new Date().toLocaleDateString()],[""]];r.metrics&&(t.push(["Key Metrics"]),Object.entries(r.metrics).forEach(([a,s])=>{t.push([a,s])}));const n=$r.aoa_to_sheet(t);if($r.book_append_sheet(e,n,"Summary"),r.departmentBreakdown&&Array.isArray(r.departmentBreakdown)){const a=$r.json_to_sheet(r.departmentBreakdown);$r.book_append_sheet(e,a,"Department Breakdown")}return e},incentiveReport:r=>{const e=$r.book_new(),t=[["Incentive Disbursement Report"],["Period",r.period||"N/A"],["Total Applications",r.totalApplications||0],["Total Amount",r.totalAmount||"N/A"],["Generated On",new Date().toLocaleDateString()]],n=$r.aoa_to_sheet(t);if($r.book_append_sheet(e,n,"Summary"),r.applications&&Array.isArray(r.applications)){const a=$r.json_to_sheet(r.applications);$r.book_append_sheet(e,a,"Applications")}return e},genericData:(r,e="Data")=>{const t=$r.book_new();if(Array.isArray(r)){const n=$r.json_to_sheet(r);$r.book_append_sheet(t,n,e)}else{const n=Object.entries(r).map(([s,o])=>({Key:s,Value:o})),a=$r.json_to_sheet(n);$r.book_append_sheet(t,a,e)}return t}},zu={pdf:(r,e)=>{r.save(`${e}.pdf`)},excel:(r,e)=>{g8(r,`${e}.xlsx`)},csv:(r,e)=>{let t;if(Array.isArray(r)){if(r.length===0)return;const o=Object.keys(r[0]);t=[o.join(","),...r.map(l=>o.map(c=>{const u=l[c];return typeof u=="string"&&(u.includes(",")||u.includes('"'))?`"${u.replace(/"/g,'""')}"`:u}).join(","))].join(`
`)}else t=Object.entries(r).map(([o,l])=>`${o},${l}`).join(`
`);const n=new Blob([t],{type:"text/csv"}),a=URL.createObjectURL(n),s=document.createElement("a");s.href=a,s.download=`${e}.csv`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}},d0={generateFilename:(r,e="")=>{const t=new Date().toISOString().split("T")[0];return`${r}_${t}${e?"."+e:""}`},formatReportData:(r,e="employee")=>{var t,n;switch(e){case"employee":return{employeeName:r.name||r.employeeName,department:r.department,period:r.period||r.month,metrics:r.metrics||r.scores,summary:r.summary||r.notes,performanceData:r.performanceData||r.monthlyData};case"monthly":return{month:r.month,generatedBy:r.generatedBy,metrics:r.metrics,departmentBreakdown:r.departmentBreakdown};case"incentive":return{period:r.period,totalApplications:((t=r.applications)==null?void 0:t.length)||0,totalAmount:(n=r.applications)==null?void 0:n.reduce((a,s)=>a+(s.amount||0),0),applications:r.applications};default:return r}}},F2=async(r,e,t,n)=>{try{const a=d0.formatReportData(r,t),s=n||d0.generateFilename(`${t}_report`);switch(e.toLowerCase()){case"pdf":const o=await k8[t](a);zu.pdf(o,s);break;case"excel":case"xlsx":const l=T8[t](a);zu.excel(l,s);break;case"csv":zu.csv(a,s);break;default:throw new Error(`Unsupported format: ${e}`)}return{success:!0,message:`${e.toUpperCase()} report generated successfully`}}catch(a){return console.error("Error generating report:",a),{success:!1,message:`Failed to generate report: ${a.message}`}}},L8={"Website Maintenance":1,SEO:1.2,"GBP SEO":1,"Social Media":1.1,"Google Ads":1.2,"Meta Ads":1.2,AI:.8};function h0(r){return L8[r]??1}function F8(r,e){if(!r||r.length===0)return 0;let t=0,n=0;if(r.forEach(s=>{if(s.services&&s.services.length>0){let o=0,l=0;s.services.forEach(c=>{const u=typeof c=="string"?c:c.service,d=Xa(s,u);if(d!==null){const p=h0(u);o+=p,l+=p*d}}),o>0&&(t+=l/o,n++)}}),n===0)return 0;const a=t/n;return Gs(Math.min(10,a/100*10))}function Mj(r,e,t={}){t.monthKey;const n=r.department,a=F8(e),s=(o,l)=>Gs(o*(1-l)+a*l);if(n==="Web"){let o=0,l=0,c=0;(e||[]).forEach(b=>{o+=b.web_pagesThis||0,l+=b.web_onTimeThis||0,c+=b.web_bugsThis||0});const u=(e==null?void 0:e.length)||1,d=Math.min(10,o/20*10),p=Math.min(10,l/u*10),g=Math.max(0,Math.min(10,10-c/u)),h=Gs(d*.4+p*.4+g*.2);return s(h,.5)}if(n==="SEO"){let o=0;(e||[]).forEach(c=>{o+=c.seo_trafficThis||0});const l=Gs(Math.min(10,o/1e4*10));return s(l,.3)}if(n==="Sales"){let o=0;(e||[]).forEach(c=>{o+=c.sales_deals||0});const l=Gs(Math.min(10,o/10*10));return s(l,.4)}return n==="Social Media"||n==="Ads"?s(5,.5):5}function Bj(r){const e=(r||[]).reduce((t,n)=>t+Number(n.hours||0),0);return Gs(Math.min(10,e/20*10))}function Uj(r){const e=(r||[]).reduce((t,n)=>{var a;return t+Number(((a=n.relationship)==null?void 0:a.clientSatisfaction)||0)},0)/((r||[]).length||1);return Gs(Math.min(10,e))}function Hj(r){const{kpiScore:e=0,learningScore:t=0,relationshipScore:n=0}=r||{};return Gs(e*.5+t*.2+n*.3)}function $j(r,e,t){const n=[];if(n.push(`Department: ${r.department}`),n.push(`KPI Score: ${t.kpiScore}`),r.department==="Web"){let a=0;[].forEach(s=>{a+=s.web_pagesThis||0}),n.push(`Total Pages: ${a}`)}return n.push(`Learning Hours: ${t.learningScore/10*20}`),n.push(`Relationship Score: ${t.relationshipScore}`),n.join(`
`)}function qj(r,e,t={}){try{const n=t.graceDays??3,[a,s]=(r||"").split("-").map(Number);if(!a||!s)return{dueDate:null,submittedAt:e,lateDays:0,penalty:0};const o=new Date(a,s,0),l=new Date(o.getFullYear(),o.getMonth(),o.getDate()+n),c=e?new Date(e):new Date,u=c.getTime()-l.getTime(),d=u>0?Math.ceil(u/(1e3*60*60*24)):0,p=d>0?Math.min(2,Math.ceil(d/7)*.5):0;return{dueDate:l.toISOString(),submittedAt:c.toISOString(),lateDays:d,penalty:p}}catch{return{dueDate:null,submittedAt:e,lateDays:0,penalty:0}}}function Xa(r,e,t={}){var p,g;const n=t.monthKey||null;if(!(r!=null&&r.service_scopes)||!r.service_scopes[e])return null;const a=r.service_scopes[e],s=Number(a.deliverables||0);if(s<=0)return 0;const o=(a.frequency||"Monthly").toLowerCase();let c={daily:20,"bi-weekly":2,biweekly:2,weekly:4,monthly:1,quarterly:1/3}[o]??1;if(o==="daily"&&n){const[h,b]=n.split("-").map(Number),x=a1(n);let y=0;for(let v=1;v<=x;v++){const S=new Date(h,b-1,v).getDay();S!==0&&S!==6&&y++}c=y}const u=Math.max(1,Math.round(s*c)),d=(g=(p=r.service_progress)==null?void 0:p[e])==null?void 0:g.completed;if(typeof d=="number")return Math.min(100,Math.round(d/u*100));switch(e){case"Social Media":{const h=(r.sm_graphicsPhotoshop||0)+(r.sm_graphicsCanva||0)+(r.sm_graphicsAi||0)+(r.sm_shortVideos||0)+(r.sm_longVideos||0);return Math.min(100,Math.round(h/u*100))}case"SEO":case"GBP SEO":{const h=r.seo_keywordsWorked?r.seo_keywordsWorked.length:0,b=r.seo_top3?r.seo_top3.length:0,x=h+b+(r.seo_technicalIssues||0);return Math.min(100,Math.round(x/u*100))}case"Google Ads":case"Meta Ads":{const h=r.ads_newAds||0;return Math.min(100,Math.round(h/u*100))}case"Website Maintenance":{const b=(r.web_pagesThis||0)+(r.web_saasUpsells||0);return Math.min(100,Math.round(b/u*100))}case"AI":{const h=r.ai_outputs||0;return Math.min(100,Math.round(h/u*100))}default:return 0}}function P8(){const r=ha(),{allSubmissions:e}=vy(),[t,n]=E.useState([]),[a,s]=E.useState("All"),[o,l]=E.useState(null),[c,u]=E.useState(null),[d,p]=E.useState(!0),g=()=>{try{const v=o?t.filter(k=>k.id===o):b,_=[["Client","Month","KPI Score","Services"]];v.forEach(k=>{(e||[]).filter(F=>(F.clients||[]).some(T=>T.name===k.name)).forEach(F=>{var A;const T=((A=F.scores)==null?void 0:A.kpiScore)??"",R=(k.services||[]).map(P=>typeof P=="string"?P:P.service).join(";");_.push([k.name,F.monthKey,T,R])})});const S=_.map(k=>k.map(F=>`${F}`.replace(/"/g,'""')).map(F=>/[",\n]/.test(F)?`"${F}"`:F).join(",")).join(`
`),j=new Blob([S],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a"),J=URL.createObjectURL(j);I.href=J,I.download=`kpi-by-client-${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(J)}catch(v){console.error("Export failed",v)}};E.useEffect(()=>{(async()=>{if(r)try{p(!0);const{data:_,error:S}=await r.from("clients").select("*").order("name");if(S)throw S;n(_||[])}catch(_){console.error("Error fetching clients:",_)}finally{p(!1)}})()},[r]);const h=E.useMemo(()=>{const v=new Set(["All"]);return t.forEach(_=>v.add(_.team||"Web")),Array.from(v)},[t]),b=E.useMemo(()=>a==="All"?t:t.filter(v=>v.team===a),[t,a]),x=E.useMemo(()=>b.map(v=>({label:v.name,value:v.id})),[b]),y=E.useMemo(()=>{if(!o)return null;const v=t.find(j=>j.id===o);if(!v)return null;const _=(e||[]).filter(j=>(j.clients||[]).some(I=>I.name===v.name)),S=_.length>0?_.reduce((j,I)=>I.monthKey>j.monthKey?I:j):null;return{client:v,submissions:_,latestMonthKey:(S==null?void 0:S.monthKey)||null}},[o,t,e]);return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[i.jsx("select",{className:"border rounded-xl p-2",value:a,onChange:v=>s(v.target.value),children:h.map(v=>i.jsx("option",{children:v},v))}),i.jsx("div",{className:"min-w-[240px]",children:i.jsx(Py,{options:x,value:o?[o]:[],onChange:v=>l(v[0]||null),placeholder:"Select a client",single:!0})}),i.jsx("button",{className:"border rounded-xl px-3 py-2",onClick:g,children:"Export KPI by Client"})]}),d?i.jsx("div",{className:"text-gray-500",children:"Loading clients..."}):i.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:b.map(v=>{var _;return i.jsxs("div",{className:"border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-medium",children:v.name}),i.jsx("button",{className:"rounded-xl px-3 py-2 border",onClick:()=>u(v),children:"Edit"})]}),i.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["Team: ",v.team]}),((_=v.services)==null?void 0:_.length)>0&&i.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["Services: ",v.services.map(S=>S.service).join(", ")]})]},v.id)})}),y&&i.jsxs("div",{className:"border rounded-xl p-4 space-y-3",children:[i.jsx("div",{className:"text-lg font-semibold",children:y.client.name}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Submissions: ",y.submissions.length]}),Array.isArray(y.client.services)&&y.client.services.length>0&&i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-sm font-medium mb-2",children:"Service Scope Progress"}),i.jsx("div",{className:"space-y-2",children:(()=>{const v=y.client.services,_=v.reduce((S,j)=>{const I=typeof j=="string"?j:j.service,J=Xa(y.client,I,{monthKey:y.latestMonthKey})||0,k=h0(I);return S+k*J},0)||1;return v.map((S,j)=>{const I=typeof S=="string"?S:S.service,J=Xa(y.client,I,{monthKey:y.latestMonthKey}),k=J==null?0:Math.max(0,Math.min(100,J)),F=h0(I),T=Math.round(F*k/_*100);return i.jsxs("div",{className:"text-sm",children:[i.jsxs("div",{className:"flex justify-between mb-1",children:[i.jsxs("span",{className:"font-medium",children:[I," ",i.jsxs("span",{className:"text-gray-500",children:["(w ",F,", ",T,"% of scope)"]})]}),i.jsxs("span",{className:"text-gray-600",children:[k,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:`${k>=100?"bg-green-500":k>=60?"bg-yellow-500":"bg-red-500"} h-2 rounded-full`,style:{width:`${k}%`}})})]},j)})})()})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl p-4 w-full max-w-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"text-lg font-medium",children:"Edit Client"}),i.jsx("button",{className:"text-gray-500",onClick:()=>u(null),children:"‚úï"})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm",children:"Client Name"}),i.jsx("input",{className:"w-full border rounded-xl p-2",value:c.name,onChange:v=>u(_=>({..._,name:v.target.value}))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm",children:"Team"}),i.jsxs("select",{className:"w-full border rounded-xl p-2",value:c.team,onChange:v=>u(_=>({..._,team:v.target.value})),children:[i.jsx("option",{children:"Web"}),i.jsx("option",{children:"Marketing"})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{className:"rounded-xl px-4 py-2 border",onClick:()=>u(null),children:"Cancel"}),i.jsx("button",{className:"rounded-xl px-4 py-2 bg-blue-600 text-white",onClick:()=>u(null),children:"Save"})]})]})})]})}function R8(){const[r,e]=E.useState({employees:[],submissions:[],clients:[],loading:{employees:!0,submissions:!0,clients:!0},error:null,lastUpdated:null,syncStatus:"idle"}),{supabase:t}=ha(),{user:n}=Fa(),{notify:a}=Fn(),s=E.useRef(!0),o=E.useRef(!1);E.useEffect(()=>()=>{s.current=!1},[]);const l=E.useCallback(v=>{s.current&&e(v)},[]),c=E.useCallback(async()=>{try{l(_=>({..._,loading:{..._.loading,employees:!0},error:null}));let v=[];if(t){const{data:_,error:S}=await t.from("employees").select("*").order("name",{ascending:!0});if(S)throw S;v=_||[]}else{const _=localStorage.getItem("unified_employees_data");_?v=JSON.parse(_):(v=D8(),localStorage.setItem("unified_employees_data",JSON.stringify(v)))}return l(_=>({..._,employees:v,loading:{..._.loading,employees:!1},lastUpdated:new Date().toISOString()})),v}catch(v){return console.error("Error loading employees:",v),l(_=>({..._,loading:{..._.loading,employees:!1},error:v.message})),[]}},[t,l]),u=E.useCallback(async()=>{try{l(_=>({..._,loading:{..._.loading,submissions:!0},error:null}));let v=[];if(t){const{data:_,error:S}=await t.from("submissions").select("*").order("created_at",{ascending:!1});if(S)throw S;v=_||[]}else{const _=localStorage.getItem("unified_submissions_data");_?v=JSON.parse(_):(v=O8(),localStorage.setItem("unified_submissions_data",JSON.stringify(v)))}return l(_=>({..._,submissions:v,loading:{..._.loading,submissions:!1},lastUpdated:new Date().toISOString()})),v}catch(v){return console.error("Error loading submissions:",v),l(_=>({..._,loading:{..._.loading,submissions:!1},error:v.message})),[]}},[t,l]),d=E.useCallback(async()=>{try{l(_=>({..._,loading:{..._.loading,clients:!0},error:null}));let v=[];if(t){const{data:_,error:S}=await t.from("clients").select("*").order("name",{ascending:!0});if(S)throw S;v=_||[]}else{const _=localStorage.getItem("unified_clients_data");_?v=JSON.parse(_):(v=I8(),localStorage.setItem("unified_clients_data",JSON.stringify(v)))}return l(_=>({..._,clients:v,loading:{..._.loading,clients:!1},lastUpdated:new Date().toISOString()})),v}catch(v){return console.error("Error loading clients:",v),l(_=>({..._,loading:{..._.loading,clients:!1},error:v.message})),[]}},[t,l]),p=E.useCallback(async(v=!1)=>{if(!o.current)try{o.current=!0,l(I=>({...I,syncStatus:"syncing",error:null}));const[_,S,j]=await Promise.all([c(),u(),d()]);return l(I=>({...I,syncStatus:"success",lastUpdated:new Date().toISOString()})),v&&a({type:"success",title:"Data Synced",message:"All dashboard data has been updated successfully."}),{employees:_,submissions:S,clients:j}}catch(_){throw console.error("Error syncing data:",_),l(S=>({...S,syncStatus:"error",error:_.message})),v&&a({type:"error",title:"Sync Failed",message:"Failed to sync dashboard data. Please try again."}),_}finally{o.current=!1}},[c,u,d,l,a]);E.useEffect(()=>{n&&p()},[n,p]),E.useEffect(()=>{if(!n)return;const v=setInterval(()=>{p(!1)},5*60*1e3);return()=>clearInterval(v)},[n,p]);const g=E.useCallback(async(v,_)=>{try{if(t){const{error:S}=await t.from("employees").update(_).eq("id",v);if(S)throw S}else{const j=r.employees.map(I=>I.id===v?{...I,..._}:I);localStorage.setItem("unified_employees_data",JSON.stringify(j))}return l(S=>({...S,employees:S.employees.map(j=>j.id===v?{...j,..._}:j),lastUpdated:new Date().toISOString()})),a({type:"success",title:"Employee Updated",message:"Employee information has been updated successfully."}),!0}catch(S){return console.error("Error updating employee:",S),a({type:"error",title:"Update Failed",message:S.message||"Failed to update employee information."}),!1}},[t,r.employees,l,a]),h=E.useCallback(async(v,_)=>{try{if(t){const{error:S}=await t.from("submissions").update(_).eq("id",v);if(S)throw S}else{const j=r.submissions.map(I=>I.id===v?{...I,..._}:I);localStorage.setItem("unified_submissions_data",JSON.stringify(j))}return l(S=>({...S,submissions:S.submissions.map(j=>j.id===v?{...j,..._}:j),lastUpdated:new Date().toISOString()})),a({type:"success",title:"Submission Updated",message:"Submission has been updated successfully."}),!0}catch(S){return console.error("Error updating submission:",S),a({type:"error",title:"Update Failed",message:S.message||"Failed to update submission."}),!1}},[t,r.submissions,l,a]),b=E.useCallback(v=>r.employees.find(_=>_.id===v),[r.employees]),x=E.useCallback(v=>r.submissions.filter(_=>{var S,j,I;return _.employeeId===v||((S=_.employee)==null?void 0:S.id)===v||((j=_.employee)==null?void 0:j.name)&&((I=_.employee)==null?void 0:I.phone)&&r.employees.find(J=>J.id===v&&J.name===_.employee.name&&J.phone===_.employee.phone)}).sort((_,S)=>new Date(S.created_at)-new Date(_.created_at)),[r.submissions,r.employees]),y=E.useCallback(()=>{const v=new Date().toISOString().slice(0,7),_=r.submissions.filter(S=>S.monthKey===v||new Date(S.created_at).toISOString().slice(0,7)===v);return{totalEmployees:r.employees.length,activeEmployees:r.employees.filter(S=>S.status==="active").length,currentMonthSubmissions:_.length,pendingReviews:_.filter(S=>{var j;return!((j=S.manager)!=null&&j.reviewed)}).length,averageScore:_.length>0?_.reduce((S,j)=>{var I;return S+(((I=j.scores)==null?void 0:I.overall)||0)},0)/_.length:0,totalClients:r.clients.length,activeClients:r.clients.filter(S=>S.status==="active").length}},[r.employees,r.submissions,r.clients]);return{employees:r.employees,submissions:r.submissions,clients:r.clients,loading:r.loading,isLoading:Object.values(r.loading).some(Boolean),error:r.error,syncStatus:r.syncStatus,lastUpdated:r.lastUpdated,syncAllData:p,updateEmployee:g,updateSubmission:h,getEmployee:b,getEmployeeSubmissions:x,getPerformanceMetrics:y,refreshEmployees:c,refreshSubmissions:u,refreshClients:d}}function D8(){return[{id:1,name:"John Smith",email:"john.smith@company.com",phone:"+1234567890",role:"SEO Specialist",department:"Marketing",status:"active",joiningDate:"2024-01-15",manager:"Sarah Johnson"},{id:2,name:"Sarah Johnson",email:"sarah.johnson@company.com",phone:"+1234567891",role:"Marketing Manager",department:"Marketing",status:"active",joiningDate:"2023-06-01",manager:"Mike Wilson"},{id:3,name:"Mike Wilson",email:"mike.wilson@company.com",phone:"+1234567892",role:"Content Creator",department:"Marketing",status:"active",joiningDate:"2023-08-10",manager:"Sarah Johnson"}]}function O8(){const r=new Date().toISOString().slice(0,7);return[{id:1,employeeId:1,monthKey:r,employee:{name:"John Smith",phone:"+1234567890",department:"Marketing"},scores:{overall:8.5,kpiScore:8,learningScore:9,relationshipScore:8.5},created_at:new Date().toISOString(),manager:{reviewed:!1}},{id:2,employeeId:3,monthKey:r,employee:{name:"Mike Wilson",phone:"+1234567892",department:"Marketing"},scores:{overall:7.5,kpiScore:7,learningScore:8,relationshipScore:7.5},created_at:new Date(Date.now()-24*60*60*1e3).toISOString(),manager:{reviewed:!0,remarks:"Good progress this month. Keep up the consistent performance."}}]}function I8(){return[{id:1,name:"Tech Corp Solutions",email:"contact@techcorp.com",status:"active",industry:"Technology",created_at:"2024-01-15"},{id:2,name:"Green Energy Co",email:"info@greenenergy.com",status:"active",industry:"Energy",created_at:"2024-02-01"}]}var M8={};class B8{constructor(e,t=null){this.supabase=e,this.cache=new Map,this.notifyUpdate=typeof t=="function"?t:null,this.isLocalMode=!e||this.checkLocalMode()}checkLocalMode(){try{return!this.supabase||M8.REACT_APP_SUPABASE_URL==="your-supabase-url"}catch{return!0}}getLocalClients(){try{const e=localStorage.getItem("bptm_clients");return e?JSON.parse(e):[]}catch{return[]}}saveLocalClients(e){try{return localStorage.setItem("bptm_clients",JSON.stringify(e)),!0}catch{return!1}}async getAllClients(){if(this.isLocalMode){const e=this.getLocalClients();return e.forEach(t=>this.cache.set(t.id,t)),e}try{const{data:e,error:t}=await this.supabase.from("clients").select("*").order("created_at",{ascending:!1});if(t)throw t;return e.forEach(n=>this.cache.set(n.id,n)),e||[]}catch(e){return console.warn("Supabase failed, falling back to local mode:",e.message),this.isLocalMode=!0,this.getLocalClients()}}async findOrCreateClientByName(e,t={}){const n=(e||"").trim();if(!n)throw new Error("Client name is required");if(this.isLocalMode){const a=this.getLocalClients(),s=a.find(l=>l.name===n);if(s)return s;const o={...vs,...t,id:"client-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),name:n,created_at:new Date().toISOString()};return a.push(o),this.saveLocalClients(a),this.notifyUpdate&&this.notifyUpdate(o),o}try{const{data:a,error:s}=await this.supabase.from("clients").select("*").eq("name",n).maybeSingle();if(s&&s.code!=="PGRST116")throw s;if(a)return a;const o={...vs,...t,name:n},{data:l,error:c}=await this.supabase.from("clients").insert(o).select("*").single();if(c)throw c;return this.notifyUpdate&&this.notifyUpdate(l),l}catch(a){return console.warn("Supabase failed, falling back to local mode:",a.message),this.isLocalMode=!0,this.findOrCreateClientByName(e,t)}}async createClient(e){const t={...vs,...e};if(this.isLocalMode){const n=this.getLocalClients(),a={...t,id:t.id||"client-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),created_at:t.created_at||new Date().toISOString()};return n.push(a),this.saveLocalClients(n),this.notifyUpdate&&this.notifyUpdate(a),a}try{const{data:n,error:a}=await this.supabase.from("clients").insert(t).select("*").single();if(a)throw a;return this.notifyUpdate&&this.notifyUpdate(n),n}catch(n){return console.warn("Supabase failed, falling back to local mode:",n.message),this.isLocalMode=!0,this.createClient(e)}}async updateClient(e){if(!(e!=null&&e.id))throw new Error("Client id is required");if(this.isLocalMode){const t=this.getLocalClients(),n=t.findIndex(a=>a.id===e.id);if(n===-1)throw new Error("Client not found");return t[n]={...t[n],...e},this.saveLocalClients(t),this.notifyUpdate&&this.notifyUpdate(t[n]),t[n]}try{const{data:t,error:n}=await this.supabase.from("clients").update(e).eq("id",e.id).select("*").single();if(n)throw n;return this.notifyUpdate&&this.notifyUpdate(t),t}catch(t){return console.warn("Supabase failed, falling back to local mode:",t.message),this.isLocalMode=!0,this.updateClient(e)}}async addServicesToClient(e,t=[]){if(this.isLocalMode){const a=this.getLocalClients().find(c=>c.id===e);if(!a)throw new Error("Client not found");const o=[...a.services||[],...t],l={...a,services:o};return this.updateClient(l)}try{const{data:n,error:a}=await this.supabase.from("clients").select("*").eq("id",e).single();if(a)throw a;const o=[...n.services||[],...t],{data:l,error:c}=await this.supabase.from("clients").update({...n,services:o}).eq("id",e).select("*").single();if(c)throw c;return this.notifyUpdate&&this.notifyUpdate(l),l}catch(n){return console.warn("Supabase failed, falling back to local mode:",n.message),this.isLocalMode=!0,this.addServicesToClient(e,t)}}}function Vu(r,e){return new B8(r,e)}class mo{constructor(e=!0,t=null,n=null,a="info"){this.isValid=e,this.error=t,this.warning=n,this.severity=a,this.timestamp=Date.now()}static success(e=null){return new mo(!0,null,e,"info")}static error(e,t="error"){return new mo(!1,e,null,t)}static warning(e){return new mo(!0,null,e,"warning")}}class U8{constructor(){this.rules=new Map,this.setupDefaultRules()}setupDefaultRules(){this.addRule("employee.name",{required:!0,minLength:2,maxLength:100,pattern:/^[a-zA-Z\s\-\.]+$/,sanitize:!0,errorMessages:{required:"Full name is required for identification and reporting",minLength:"Name must be at least 2 characters long",maxLength:"Employee name is too long (max 100 characters)",pattern:"Name contains unusual characters. Please verify it's correct."}}),this.addRule("employee.phone",{required:!0,pattern:/^[6-9]\d{9}$/,sanitize:!0,transform:e=>e.replace(/\D/g,""),validate:e=>{const t=e.replace(/\D/g,"");return t.length===10&&/^[6-9]/.test(t)},errorMessages:{required:"Phone number is required for contact purposes",pattern:"Phone number must be 10 digits starting with 6, 7, 8, or 9",validate:"Please enter a valid Indian mobile number"}}),this.addRule("employee.department",{required:!0,allowedValues:["Web","Social Media","Ads","SEO","HR","Accounts","Sales","Blended (HR + Sales)","Operations Head","Web Head"],sanitize:!0,errorMessages:{required:"Department selection is required for proper reporting structure",allowedValues:"Please select a valid department"}}),this.addRule("employee.role",{required:!0,minLength:2,maxLength:100,sanitize:!0,validate:e=>Array.isArray(e)?e.length>0:e&&e.trim().length>0,errorMessages:{required:"At least one role must be selected for performance evaluation",validate:"Role information is required"}}),this.addRule("client.name",{required:!0,minLength:2,maxLength:100,pattern:/^[a-zA-Z0-9\s&.,'-]+$/,sanitize:!0,errorMessages:{required:"Client name is required",minLength:"Client name must be at least 2 characters",maxLength:"Client name cannot exceed 100 characters",pattern:"Client name contains invalid characters"}}),this.addRule("client.services",{required:!1,validate:e=>!e||!Array.isArray(e)?!0:e.length<=10,errorMessages:{validate:"Maximum 10 services can be selected"}}),this.addRule("contact.email",{required:!1,pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,maxLength:254,sanitize:!0,transform:e=>e.toLowerCase().trim(),errorMessages:{pattern:"Please enter a valid email address",maxLength:"Email address is too long"}}),this.addRule("contact.phone",{required:!1,pattern:/^[\+]?[1-9][\d]{0,15}$/,sanitize:!0,transform:e=>e.replace(/[\s\-\(\)]/g,""),errorMessages:{pattern:"Please enter a valid phone number"}}),this.addRule("date.monthKey",{required:!0,pattern:/^\d{4}-\d{2}$/,validate:e=>{if(!e)return!1;const[t,n]=e.split("-").map(Number);return n>=1&&n<=12&&t>=2020&&t<=new Date().getFullYear()+1},errorMessages:{required:"Report month is required to track performance timeline",pattern:"Month format should be YYYY-MM (e.g., 2024-01)",validate:"Invalid month or year"}}),this.addRule("attendance.days",{required:!1,min:0,validate:(e,t={})=>{const n=Number(e||0);if(isNaN(n))return!1;const a=t.monthKey?jy(t.monthKey):22;return t.monthKey&&a1(t.monthKey),n<=a},errorMessages:{min:"Days cannot be negative",validate:"Days cannot exceed the maximum working days for the selected month"}}),this.addRule("url.general",{required:!1,pattern:/^https?:\/\/.+/,maxLength:2048,sanitize:!0,errorMessages:{pattern:"Please enter a valid URL starting with http:// or https://",maxLength:"URL is too long"}}),this.addRule("url.drive",{required:!1,validate:e=>!e||Ay(e),errorMessages:{validate:"Please enter a valid Google Drive URL"}}),this.addRule("text.short",{required:!1,maxLength:500,sanitize:!0,errorMessages:{maxLength:"Text must not exceed 500 characters"}}),this.addRule("text.long",{required:!1,maxLength:2e3,sanitize:!0,errorMessages:{maxLength:"Text must not exceed 2000 characters"}}),this.addRule("number.positive",{required:!1,min:0,validate:e=>{const t=Number(e);return!isNaN(t)&&t>=0},errorMessages:{validate:"Must be a positive number"}})}addRule(e,t){this.rules.set(e,t)}getRule(e){return this.rules.get(e)}hasRule(e){return this.rules.has(e)}}class H8{constructor(){this.registry=new U8}validateField(e,t,n={}){var s,o,l,c,u,d,p,g;const a=this.registry.getRule(e);if(!a)return this.validateGeneric(e,t,n);try{const h={isValid:!0,errors:[],warnings:[],sanitizedValue:t,transformedValue:t};t==null&&(t="");const b=String(t).trim();if(a.required&&!b)return{...h,isValid:!1,errors:[((s=a.errorMessages)==null?void 0:s.required)||`${e} is required`]};if(!b&&!a.required)return h;if(a.sanitize?h.sanitizedValue=yy.sanitizeInput(b):h.sanitizedValue=b,a.transform&&typeof a.transform=="function")try{h.transformedValue=a.transform(h.sanitizedValue)}catch{return{...h,isValid:!1,errors:[`Invalid ${e} format`]}}else h.transformedValue=h.sanitizedValue;a.minLength&&h.sanitizedValue.length<a.minLength&&(h.isValid=!1,h.errors.push(((o=a.errorMessages)==null?void 0:o.minLength)||`${e} must be at least ${a.minLength} characters`)),a.maxLength&&h.sanitizedValue.length>a.maxLength&&(h.isValid=!1,h.errors.push(((l=a.errorMessages)==null?void 0:l.maxLength)||`${e} must not exceed ${a.maxLength} characters`)),a.pattern&&!a.pattern.test(h.sanitizedValue)&&(h.isValid=!1,h.errors.push(((c=a.errorMessages)==null?void 0:c.pattern)||`${e} format is invalid`)),a.allowedValues&&!a.allowedValues.includes(h.sanitizedValue)&&(h.isValid=!1,h.errors.push(((u=a.errorMessages)==null?void 0:u.allowedValues)||`${e} must be one of: ${a.allowedValues.join(", ")}`));const x=Number(h.transformedValue);if(isNaN(x)||(a.min!==void 0&&x<a.min&&(h.isValid=!1,h.errors.push(((d=a.errorMessages)==null?void 0:d.min)||`${e} must be at least ${a.min}`)),a.max!==void 0&&x>a.max&&(h.isValid=!1,h.errors.push(((p=a.errorMessages)==null?void 0:p.max)||`${e} must not exceed ${a.max}`))),a.validate&&typeof a.validate=="function")try{a.validate(h.transformedValue,n)||(h.isValid=!1,h.errors.push(((g=a.errorMessages)==null?void 0:g.validate)||`${e} validation failed`))}catch{h.isValid=!1,h.errors.push(`${e} validation error`)}return h}catch(h){return console.error(`Validation error for field ${e}:`,h),{isValid:!1,errors:["Validation failed due to an internal error"],warnings:[],sanitizedValue:t,transformedValue:t}}}validateGeneric(e,t,n={}){return typeof t=="string"&&t.length>5e3?mo.error("Input is too long (max 5000 characters)"):mo.success()}validateFields(e,t={}){const n={},a={},s={};let o=!0;for(const[l,c]of Object.entries(e)){const u=this.validateField(l,c,t);n[l]=u,u.isValid||(o=!1,a[l]=u.errors),u.warnings&&u.warnings.length>0&&(s[l]=u.warnings)}return{isValid:o,errors:a,warnings:s,results:n}}validateEmployeeSubmission(e){var n,a,s,o,l;const t={"employee.name":(n=e.employee)==null?void 0:n.name,"employee.phone":(a=e.employee)==null?void 0:a.phone,"employee.department":(s=e.employee)==null?void 0:s.department,"employee.role":(o=e.employee)==null?void 0:o.role,"date.monthKey":e.monthKey};return(l=e.meta)!=null&&l.attendance&&(t["attendance.days"]=e.meta.attendance.wfo,t["attendance.days"]=e.meta.attendance.wfh),this.validateFields(t,e)}validateClientData(e,t=[]){const n={"client.name":e.name,"client.services":e.services,"contact.email":e.contact_email,"contact.phone":e.contact_phone},a=this.validateFields(n,{existingClients:t});return e.name&&t.some(s=>s.name.toLowerCase().trim()===e.name.toLowerCase().trim())&&(a.isValid=!1,a.errors["client.name"]=["A client with this name already exists"]),a}addRule(e,t){this.registry.addRule(e,t)}}const Gu=new H8,$8={validateClientName:r=>{const e=Gu.validateField("client.name",r);return e.isValid?[]:e.errors},validateServices:r=>{const e=Gu.validateField("client.services",r);return e.isValid?[]:e.errors},validateClientData:(r,e=[])=>{const t=Gu.validateClientData(r,e);return{errors:t.errors,warnings:t.warnings}}},q8=(r,e,t)=>{const[n,a]=E.useState(!1),[s,o]=E.useState({}),[l,c]=E.useState([]),[u,d]=E.useState(null),p=E.useRef(null),g=E.useCallback(async(b,x=[],y={})=>{var v,_,S;if(n)return console.log("‚ö†Ô∏è Client creation already in progress"),{success:!1,error:"Creation already in progress"};a(!0),d("validating"),o({}),c([]);try{console.log("üîç Validating client data...");const j=await r.from("clients").select("name").then(({data:H})=>H||[]),I=x.map(H=>({service:H,frequency:y[H]||"Monthly",notes:"",added_date:new Date().toISOString()})),J={...b,services:I},k=$8.validateClientData(J,j);if(!k.isValid)return o(k.errors),c(k.warnings),d("validation_failed"),{success:!1,error:"Validation failed",validationErrors:k.errors,validationWarnings:k.warnings};c(k.warnings),d("creating"),console.log("üíæ Creating client in database...");const F={name:b.name.trim(),team:b.team,client_type:b.client_type,status:"Active",services:I,contact_email:((v=b.contact_email)==null?void 0:v.trim())||"",contact_phone:((_=b.contact_phone)==null?void 0:_.trim())||"",scope_notes:((S=b.scope_notes)==null?void 0:S.trim())||"",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:T,error:R}=await r.from("clients").insert([F]).select().single();if(R)throw console.error("‚ùå Database creation error:",R),new Error(`Database error: ${R.message}`);d("verifying"),console.log("‚úÖ Verifying client creation...");const{data:A,error:P}=await r.from("clients").select("*").eq("id",T.id).single();if(P||!A){console.error("‚ùå Verification failed:",P);try{await r.from("clients").delete().eq("id",T.id),console.log("üîÑ Rolled back failed client creation")}catch(H){console.error("‚ùå Rollback failed:",H)}throw new Error("Client creation could not be verified")}return d("success"),p.current={client:A,timestamp:Date.now()},console.log("üéâ Client created successfully:",A.name),e&&e(A),{success:!0,client:A,message:`Client "${A.name}" created successfully`}}catch(j){console.error("‚ùå Client creation failed:",j),d("error");const I=j.message||"Unknown error occurred";return t&&t(j),{success:!1,error:I}}finally{a(!1),setTimeout(()=>{d(null)},5e3)}},[n,r,e,t]),h=E.useCallback(()=>{o({}),c([]),d(null)},[]);return{createClient:g,isCreating:n,validationErrors:s,validationWarnings:l,creationStatus:u,resetValidation:h,lastCreation:p.current}},W8=({src:r,alt:e="Image",className:t="",fallbackSrc:n=null,showFallback:a=!0,loading:s="lazy",onLoad:o=null,onError:l=null,...c})=>{const[u,d]=E.useState({loading:!0,error:!1,loaded:!1}),p=E.useCallback(b=>{d({loading:!1,error:!1,loaded:!0}),o&&o(b)},[o]),g=E.useCallback(b=>{d(x=>({...x,loading:!1,error:!0})),l&&l(b)},[l]),h=E.useCallback(b=>{d(x=>({...x,loading:!1,error:!0}))},[]);return!r||u.error&&!n?a?i.jsx("div",{className:`bg-gray-100 flex items-center justify-center ${t}`,...c,children:i.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"m21 19v-14c0-1.1-.9-2-2-2h-14c0-1.1-.9-2-2-2s-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-12.5-9.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5zm4.5 9h-10v-4l2-2 3 3 2-2 3 3v2z"})})}):null:i.jsxs("div",{className:"relative",children:[u.loading&&i.jsx("div",{className:`absolute inset-0 bg-gray-100 flex items-center justify-center ${t}`,children:i.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full"})}),!u.error&&i.jsx("img",{src:r,alt:e,className:`${t} ${u.loading?"opacity-0":"opacity-100"} transition-opacity duration-200`,loading:s,onLoad:p,onError:n?g:h,...c}),u.error&&n&&i.jsx("img",{src:n,alt:e,className:t,loading:s,onLoad:p,onError:h,...c})]})},z8=({src:r,clientName:e="Client",size:t="md",className:n="",showFallback:a=!0})=>{const s={xs:"w-8 h-6",sm:"w-12 h-9",md:"w-16 h-12",lg:"w-24 h-18",xl:"w-32 h-24"},o=s[t]||s.md,l=d=>{const p=document.createElement("canvas");p.width=128,p.height=96;const g=p.getContext("2d");g.fillStyle="#f3f4f6",g.fillRect(0,0,128,96),g.fillStyle="#6b7280",g.font="bold 14px system-ui",g.textAlign="center",g.textBaseline="middle";const h=d.length>12?d.substring(0,12)+"...":d;return g.fillText(h,64,48),p.toDataURL()},[c,u]=ar.useState("");return ar.useEffect(()=>{u(l(e))},[e]),i.jsx("div",{className:`${o} rounded-md overflow-hidden border border-gray-200 bg-white ${n}`,children:i.jsx(W8,{src:r,alt:`${e} logo`,className:"w-full h-full object-contain p-1",fallbackSrc:c,showFallback:a})})};function V8(){const r=ha(),{notify:e}=Fn(),{clients:t,loading:n,addClient:a,updateClient:s,fetchClients:o,getClientsByTeam:l}=go(),c=n.clients;E.useCallback(Z=>Z==="All"?t:t.filter(ye=>ye.status===Z),[t]);const u=E.useCallback(()=>o(!0),[o]),[d,p]=E.useState(!1),[g,h]=E.useState("All"),[b,x]=E.useState("Active"),[y,v]=E.useState(""),[_,S]=E.useState({...vs}),j=My("client_form",{name:_.name,team:_.team||"new"}),{lastSaved:I,isSaving:J,hasUnsavedChanges:k,saveNow:F,loadSavedData:T,clearSavedData:R}=Iy(_,j,d&&(_.name||_.scope_notes),2e3,Z=>console.log("üíæ Client form auto-saved"),Z=>e({type:"error",title:"Auto-save failed",message:Z.message})),[A,P]=E.useState(null),[H,K]=E.useState(!1),[ce,me]=E.useState(null),[le,xe]=E.useState([]),[we,Oe]=E.useState({}),{isCreating:ge}=q8(r,Z=>{p(!1),S({...vs}),console.log("‚úÖ Client created successfully:",Z.name),a(Z)},Z=>{console.error("‚ùå Error creating client:",Z)});E.useEffect(()=>{if(!c&&t.length>0){const Z={};Tc.forEach(ye=>{Z[ye]="Monthly"}),Oe(Z)}},[c,t]);const C=E.useMemo(()=>{let Z=t;if(g!=="All"&&(Z=Z.filter(ye=>ye.team===g)),b!=="All"&&(Z=Z.filter(ye=>ye.status===b)),y.trim()){const ye=y.toLowerCase();Z=Z.filter(Le=>Le.name.toLowerCase().includes(ye)||(Le.scope_notes||"").toLowerCase().includes(ye))}return Z},[t,g,b,y]),O=E.useMemo(()=>{const Z=new Set(["All"]);return t.forEach(ye=>Z.add(ye.team||"Web")),Array.from(Z)},[t]),D=Z=>{xe(ye=>ye.includes(Z)?ye.filter(Le=>Le!==Z):[...ye,Z])},M=async()=>{try{if(!_.name||!_.name.trim()){e({type:"error",title:"Validation Error",message:"Please enter a client name"});return}const Z=le.map(pe=>sf(pe,we[pe]||"Monthly")),ye=Vu(r,pe=>{s(pe)}),Le={..._,services:Z},Ie=await ye.createClient(Le);Ie&&(a(Ie),p(!1),S({...vs}),xe([]),R(),e({type:"success",title:"Client created",message:Ie.name}))}catch(Z){e({type:"error",title:"Client create failed",message:Z.message})}};E.useEffect(()=>{if(d&&j){const Z=T();Z&&(Z.name||Z.scope_notes)&&(S(Z),e({type:"info",title:"Draft restored",message:"Your previous work has been restored"}))}},[d,j,T,e]);const V=E.useCallback(()=>{k&&!window.confirm("You have unsaved changes. Discard them?")||(p(!1),S({...vs}),xe([]),R())},[k,R]),oe=async Z=>{try{const Le=await Vu(r,Ie=>{s(Ie)}).updateClient(Z);Le&&(s(Le),P(null),e({type:"success",title:"Client updated",message:Le.name}))}catch(ye){e({type:"error",title:"Update failed",message:ye.message})}},he=async(Z,ye)=>{try{if(!(ye!=null&&ye.url))return;const{error:Le}=await r.from("clients").update({logo_url:ye.url}).eq("id",Z.id);if(Le)throw Le;e({type:"success",title:"Logo updated",message:Z.name}),s({...Z,logo_url:ye.url})}catch(Le){e({type:"error",title:"Logo update failed",message:Le.message})}},ue=async()=>{if(ce)try{const Z=Vu(r,Ie=>{s(Ie)}),ye=le.map(Ie=>sf(Ie,we[Ie]||"Monthly")),Le=await Z.addServicesToClient(ce.id,ye);Le&&(s(Le),K(!1),me(null),xe([]),e({type:"success",title:"Services added",message:Le.name}))}catch(Z){e({type:"error",title:"Add services failed",message:Z.message})}};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-semibold",children:"Client Management"}),i.jsx("button",{className:"rounded-xl bg-blue-600 text-white px-4 py-2",onClick:()=>p(Z=>!Z),children:d?"Close":"Create New Client"})]}),d&&i.jsxs("div",{className:"border rounded-xl p-4 space-y-4",children:[i.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm",children:"Client Name"}),i.jsx("input",{className:"w-full border rounded-xl p-2",value:_.name,onChange:Z=>S(ye=>({...ye,name:Z.target.value}))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm",children:"Team"}),i.jsxs("select",{className:"w-full border rounded-xl p-2",value:_.team,onChange:Z=>S(ye=>({...ye,team:Z.target.value})),children:[i.jsx("option",{children:"Web"}),i.jsx("option",{children:"Marketing"}),i.jsx("option",{children:"Website"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm",children:"Status"}),i.jsxs("select",{className:"w-full border rounded-xl p-2",value:_.status,onChange:Z=>S(ye=>({...ye,status:Z.target.value})),children:[i.jsx("option",{children:"Active"}),i.jsx("option",{children:"Paused"}),i.jsx("option",{children:"Left"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm",children:"Scope Notes"}),i.jsx("textarea",{className:"w-full border rounded-xl p-2",rows:3,value:_.scope_notes,onChange:Z=>S(ye=>({...ye,scope_notes:Z.target.value}))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm",children:"Services"}),i.jsx("div",{className:"grid md:grid-cols-4 gap-2 mt-2",children:Tc.map(Z=>i.jsxs("label",{className:"flex items-center gap-2 border rounded-xl p-2",children:[i.jsx("input",{type:"checkbox",checked:le.includes(Z),onChange:()=>D(Z)}),i.jsx("span",{children:Z})]},Z))})]}),j&&i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("div",{className:"flex items-center gap-2",children:J?i.jsxs("div",{className:"flex items-center gap-2 text-yellow-600",children:[i.jsx("div",{className:"animate-spin w-3 h-3 border-2 border-yellow-600 border-t-transparent rounded-full"}),i.jsx("span",{children:"Saving..."})]}):I?i.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[i.jsx("div",{className:"w-3 h-3 bg-green-600 rounded-full"}),i.jsxs("span",{children:["Saved ",new Date().getTime()-I.getTime()<1e4?"just now":"automatically"]})]}):k?i.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[i.jsx("div",{className:"w-3 h-3 bg-orange-600 rounded-full"}),i.jsx("span",{children:"Unsaved changes"})]}):i.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[i.jsx("div",{className:"w-3 h-3 bg-gray-400 rounded-full"}),i.jsx("span",{children:"Ready"})]})}),k&&i.jsx("button",{onClick:F,className:"text-blue-600 hover:text-blue-800 underline",children:"Save Now"})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{className:"rounded-xl px-4 py-2 border",onClick:V,children:"Cancel"}),i.jsx("button",{className:"rounded-xl px-4 py-2 bg-blue-600 text-white",onClick:M,disabled:ge,children:ge?"Creating...":"Create Client"})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[i.jsx("select",{className:"border rounded-xl p-2",value:g,onChange:Z=>h(Z.target.value),children:O.map(Z=>i.jsx("option",{children:Z},Z))}),i.jsx("select",{className:"border rounded-xl p-2",value:b,onChange:Z=>x(Z.target.value),children:["Active","Paused","Left","All"].map(Z=>i.jsx("option",{children:Z},Z))}),i.jsx("input",{className:"border rounded-xl p-2",placeholder:"Search clients",value:y,onChange:Z=>v(Z.target.value)}),i.jsx("button",{className:"rounded-xl px-3 py-2 border",onClick:()=>u(),children:"Refresh"})]}),i.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:C.map(Z=>{var ye;return i.jsxs("div",{className:"border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(z8,{url:Z.logo_url,name:Z.name}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:Z.name}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Z.team," ‚Ä¢ ",Z.status]})]})]}),i.jsx("button",{className:"rounded-xl px-3 py-2 border",onClick:()=>P(Z),children:"Edit"})]}),i.jsxs("div",{className:"mt-3",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Logo"}),i.jsx(ImageUpload,{currentImageUrl:Z.logo_url,onImageChange:Le=>he(Z,Le),userId:`client-${Z.id||Z.name}`,type:"client-logo",maxWidth:300,maxHeight:300,placeholder:"Upload client logo",className:"max-w-xs"})]}),((ye=Z.services)==null?void 0:ye.length)>0&&i.jsxs("div",{className:"mt-3",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Services"}),i.jsx("ul",{className:"text-sm mt-1 list-disc pl-5",children:Z.services.map((Le,Ie)=>i.jsxs("li",{children:[Le.service," ",i.jsxs("span",{className:"text-gray-500",children:["(",Le.frequency,")"]})]},Ie))})]}),i.jsx("div",{className:"mt-3 flex gap-2",children:i.jsx("button",{className:"rounded-xl px-3 py-2 border",onClick:()=>{me(Z),K(!0)},children:"Add Services"})})]},Z.id)})}),A&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-xl p-3 sm:p-4 w-full max-w-xs sm:max-w-md md:max-w-lg lg:max-w-2xl max-h-[95vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"text-lg font-medium",children:"Edit Client"}),i.jsx("button",{className:"text-gray-500",onClick:()=>P(null),children:"‚úï"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm",children:"Client Name"}),i.jsx("input",{className:"w-full border rounded-xl p-2",value:A.name,onChange:Z=>P(ye=>({...ye,name:Z.target.value}))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm",children:"Team"}),i.jsxs("select",{className:"w-full border rounded-xl p-2",value:A.team,onChange:Z=>P(ye=>({...ye,team:Z.target.value})),children:[i.jsx("option",{children:"Web"}),i.jsx("option",{children:"Marketing"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm",children:"Status"}),i.jsxs("select",{className:"w-full border rounded-xl p-2",value:A.status,onChange:Z=>P(ye=>({...ye,status:Z.target.value})),children:[i.jsx("option",{children:"Active"}),i.jsx("option",{children:"Paused"}),i.jsx("option",{children:"Left"})]})]}),i.jsxs("div",{className:"sm:col-span-2",children:[i.jsx("label",{className:"text-sm",children:"Scope Notes"}),i.jsx("textarea",{className:"w-full border rounded-xl p-2",rows:3,value:A.scope_notes,onChange:Z=>P(ye=>({...ye,scope_notes:Z.target.value}))})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{className:"rounded-xl px-4 py-2 border",onClick:()=>P(null),children:"Cancel"}),i.jsx("button",{className:"rounded-xl px-4 py-2 bg-blue-600 text-white",onClick:()=>oe(A),children:"Save"})]})]})}),H&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-xl p-3 sm:p-4 w-full max-w-xs sm:max-w-md md:max-w-lg lg:max-w-2xl max-h-[95vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"text-lg font-medium",children:"Add Services"}),i.jsx("button",{className:"text-gray-500",onClick:()=>K(!1),children:"‚úï"})]}),i.jsx("div",{className:"grid md:grid-cols-2 gap-3 mt-3",children:Tc.map(Z=>i.jsxs("label",{className:"flex items-center gap-2 border rounded-xl p-2",children:[i.jsx("input",{type:"checkbox",checked:le.includes(Z),onChange:()=>D(Z)}),i.jsx("span",{children:Z})]},Z))}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{className:"rounded-xl px-4 py-2 border",onClick:()=>K(!1),children:"Cancel"}),i.jsx("button",{className:"rounded-xl px-4 py-2 bg-blue-600 text-white",onClick:ue,children:"Add Selected"})]})]})})]})}const G8=({title:r="Team Leaderboard",period:e="monthly",metric:t="performance",showFilters:n=!0,maxItems:a=10,showAwards:s=!0})=>{const{user:o,role:l}=Fa(),{notify:c}=Fn(),{employees:u}=go(),[d,p]=E.useState(e),[g,h]=E.useState(t),[b,x]=E.useState([]),[y,v]=E.useState(!1),_=[{value:"daily",label:"Today",icon:"üìÖ"},{value:"weekly",label:"This Week",icon:"üìä"},{value:"monthly",label:"This Month",icon:"üìà"},{value:"quarterly",label:"This Quarter",icon:"üìã"},{value:"yearly",label:"This Year",icon:"üèÜ"}],S=[{value:"performance",label:"Overall Performance",icon:"‚≠ê",color:"blue"},{value:"sales",label:"Sales Revenue",icon:"üí∞",color:"green"},{value:"productivity",label:"Productivity Score",icon:"‚ö°",color:"yellow"},{value:"quality",label:"Quality Rating",icon:"‚ú®",color:"purple"},{value:"collaboration",label:"Team Collaboration",icon:"ü§ù",color:"indigo"},{value:"innovation",label:"Innovation Points",icon:"üí°",color:"orange"}],j={1:{icon:"ü•á",title:"Gold Medal",color:"text-yellow-500"},2:{icon:"ü•à",title:"Silver Medal",color:"text-gray-400"},3:{icon:"ü•â",title:"Bronze Medal",color:"text-orange-600"},top10:{icon:"üåü",title:"Top Performer",color:"text-blue-500"},improved:{icon:"üìà",title:"Most Improved",color:"text-green-500"},consistent:{icon:"üéØ",title:"Consistency Award",color:"text-purple-500"}};E.useEffect(()=>{I()},[d,g,u]);const I=()=>{v(!0),setTimeout(()=>{const ce=u.map((me,le)=>{const xe=Math.random()*100,we={daily:.8+Math.random()*.4,weekly:.7+Math.random()*.6,monthly:.6+Math.random()*.8,quarterly:.5+Math.random()*1,yearly:.4+Math.random()*1.2}[d]||1,Oe={performance:1,sales:.8+Math.random()*.4,productivity:.9+Math.random()*.2,quality:.85+Math.random()*.3,collaboration:.7+Math.random()*.6,innovation:.6+Math.random()*.8}[g]||1,ge=Math.round(xe*we*Oe),C=Math.round(ge*(.8+Math.random()*.4)),O=ge-C,D=C>0?Math.round(O/C*100):0;return{id:me.id,name:me.name,role:me.role,department:me.department,avatar:me.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(me.name)}&background=random`,score:ge,previousScore:C,change:O,changePercent:D,trend:O>0?"up":O<0?"down":"neutral",achievements:J(ge,O,le),details:k(g,ge)}}).sort((me,le)=>le.score-me.score).map((me,le)=>({...me,rank:le+1,isTopPerformer:le<3,award:F(le+1,me.changePercent)}));x(ce.slice(0,a)),v(!1)},500)},J=(H,K,ce)=>{const me=[];return H>90&&me.push("High Performer"),K>20&&me.push("Rising Star"),ce%3===0&&me.push("Team Player"),H>95&&me.push("Excellence Award"),me},k=(H,K)=>({performance:{tasks:Math.round(K*.8),quality:Math.round(K*.9),efficiency:Math.round(K*.85)},sales:{revenue:`$${(K*1e3).toLocaleString()}`,deals:Math.round(K*.1),conversion:`${Math.round(K*.8)}%`},productivity:{hoursWorked:Math.round(K*.4),tasksCompleted:Math.round(K*.6),efficiency:`${Math.round(K*.9)}%`},quality:{rating:(K/20).toFixed(1),reviews:Math.round(K*.2),satisfaction:`${Math.round(K*.95)}%`},collaboration:{teamProjects:Math.round(K*.1),helpRequests:Math.round(K*.3),mentoring:Math.round(K*.05)},innovation:{ideas:Math.round(K*.1),implementations:Math.round(K*.05),impact:`${Math.round(K*.8)}%`}})[H]||{},F=(H,K)=>H===1?j[1]:H===2?j[2]:H===3?j[3]:H<=10?j.top10:K>50?j.improved:K>=-5&&K<=5?j.consistent:null,T=H=>H===1?"bg-gradient-to-r from-yellow-400 to-yellow-600 text-white":H===2?"bg-gradient-to-r from-gray-300 to-gray-500 text-white":H===3?"bg-gradient-to-r from-orange-400 to-orange-600 text-white":H<=10?"bg-gradient-to-r from-blue-400 to-blue-600 text-white":"bg-gray-100 text-gray-700",R=H=>{switch(H){case"up":return"üìà";case"down":return"üìâ";default:return"‚û°Ô∏è"}},A=H=>{switch(H){case"up":return"text-green-600";case"down":return"text-red-600";default:return"text-gray-600"}},P=S.find(H=>H.value===g);return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"card-brand p-6",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-bold text-brand-text flex items-center space-x-2",children:[i.jsx("span",{children:"üèÜ"}),i.jsx("span",{children:r})]}),i.jsx("p",{className:"text-brand-text-secondary mt-1",children:"Track team performance and celebrate achievements"})]}),n&&i.jsxs("div",{className:"flex space-x-4",children:[i.jsx("select",{value:d,onChange:H=>p(H.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:_.map(H=>i.jsxs("option",{value:H.value,children:[H.icon," ",H.label]},H.value))}),i.jsx("select",{value:g,onChange:H=>h(H.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:S.map(H=>i.jsxs("option",{value:H.value,children:[H.icon," ",H.label]},H.value))})]})]})}),i.jsxs("div",{className:"card-brand p-6",children:[y?i.jsx("div",{className:"space-y-4",children:[...Array(5)].map((H,K)=>i.jsxs("div",{className:"animate-pulse flex items-center space-x-4 p-4",children:[i.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full"}),i.jsxs("div",{className:"flex-1 space-y-2",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/6"})]}),i.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"})]},K))}):i.jsx("div",{className:"space-y-2",children:b.map((H,K)=>i.jsxs("div",{className:`flex items-center space-x-4 p-4 rounded-lg transition-all duration-200 hover:shadow-md ${H.rank<=3?"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200":"bg-slate-50 hover:bg-slate-100"}`,children:[i.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg ${T(H.rank)}`,children:H.rank<=3?j[H.rank].icon:H.rank}),i.jsxs("div",{className:"relative",children:[i.jsx("img",{src:H.avatar,alt:H.name,className:"w-12 h-12 rounded-full object-cover border-2 border-white shadow-sm"}),H.award&&s&&i.jsx("div",{className:`absolute -top-1 -right-1 text-lg ${H.award.color}`,children:H.award.icon})]}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("h3",{className:"font-semibold text-brand-text",children:H.name}),H.achievements.length>0&&i.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:H.achievements[0]})]}),i.jsxs("p",{className:"text-sm text-brand-text-secondary",children:[H.role," ‚Ä¢ ",H.department]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"text-2xl font-bold text-brand-text",children:H.score}),i.jsx("span",{className:"text-sm text-brand-text-secondary",children:P==null?void 0:P.icon})]}),i.jsxs("div",{className:`flex items-center space-x-1 text-sm ${A(H.trend)}`,children:[i.jsx("span",{children:R(H.trend)}),i.jsxs("span",{children:[H.change>0?"+":"",H.change,"(",H.changePercent>0?"+":"",H.changePercent,"%)"]})]})]}),i.jsx("div",{className:"text-right text-sm text-brand-text-secondary",children:Object.entries(H.details).slice(0,2).map(([ce,me])=>i.jsxs("div",{children:[i.jsxs("span",{className:"capitalize",children:[ce,":"]})," ",me]},ce))})]},H.id))}),!y&&b.length>0&&i.jsx("div",{className:"mt-6 pt-6 border-t border-slate-200",children:i.jsxs("div",{className:"flex justify-between items-center text-sm text-brand-text-secondary",children:[i.jsxs("span",{children:["Showing top ",b.length," performers for ",P==null?void 0:P.label.toLowerCase()]}),i.jsx("button",{onClick:I,className:"text-blue-600 hover:text-blue-800 font-medium",children:"üîÑ Refresh Data"})]})}),!y&&b.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-6xl mb-4",children:"üèÜ"}),i.jsx("h3",{className:"text-lg font-medium text-brand-text mb-2",children:"No Data Available"}),i.jsx("p",{className:"text-brand-text-secondary",children:"No performance data found for the selected period and metric."})]})]})]})};class Ku{static async getAnalytics(e="30d",t=null){try{const n=this.getTimeRangeDays(e),a=new Date;a.setDate(a.getDate()-n);const{data:s,error:o}=await dt.rpc("get_usage_analytics",{start_date:a.toISOString(),end_date:new Date().toISOString(),target_department:t});if(o)throw o;const{data:l,error:c}=await dt.from("unified_users").select("id, name, department, role, is_active").eq("is_active",!0);if(c)throw c;const{data:u,error:d}=await dt.from("dashboard_usage").select(`
          id,
          user_name,
          page_path,
          action_type,
          action_target,
          timestamp,
          department
        `).gte("timestamp",a.toISOString()).order("timestamp",{ascending:!1}).limit(10);if(d)throw d;const{data:p,error:g}=await dt.from("monthly_form_submissions").select("id, status, created_at").gte("created_at",a.toISOString());if(g)throw g;const h=this.calculateDistribution(l,"department"),b=this.calculateDistribution(l,"role"),x=p.filter(j=>j.status==="completed").length,y=p.filter(j=>j.status==="pending"||j.status==="draft").length,v=x+y,_={completionRate:v>0?(x/v*100).toFixed(1):"0",averageTasksPerUser:l.length>0?(v/l.length).toFixed(1):"0",activeUserPercentage:l.length>0?(l.filter(j=>j.is_active).length/l.length*100).toFixed(1):"0"},S=u.map(j=>({id:j.id,type:j.action_type,title:this.formatActivityTitle(j),user:j.user_name,timestamp:j.timestamp,status:this.getActivityStatus(j.action_type)}));return{totalUsers:l.length,activeProjects:p.filter(j=>j.status==="active"||j.status==="pending").length,completedTasks:x,pendingTasks:y,departmentStats:h,roleDistribution:b,recentActivity:S,performanceMetrics:_,usageStats:(s==null?void 0:s[0])||{total_sessions:0,unique_users:0,total_page_views:0,avg_session_duration:0,avg_page_load_time:0,most_visited_page:null,most_active_department:null,bounce_rate:0}}}catch(n){throw console.error("Error fetching analytics:",n),n}}static async getUserActivitySummary(e,t=30){try{const{data:n,error:a}=await dt.rpc("get_user_activity_summary",{target_user_id:e,days_back:t});if(a)throw a;return(n==null?void 0:n[0])||null}catch(n){throw console.error("Error fetching user activity summary:",n),n}}static async trackPageView({userId:e,userName:t,userType:n,pagePath:a,department:s=null,sessionId:o=null,referrerPage:l=null,pageLoadTime:c=null}){try{const{data:u,error:d}=await dt.rpc("track_page_view",{p_user_id:e,p_user_name:t,p_user_type:n,p_page_path:a,p_department:s,p_session_id:o,p_referrer_page:l,p_page_load_time:c});if(d)throw d;return u}catch(u){throw console.error("Error tracking page view:",u),u}}static async trackUserInteraction({userId:e,userName:t,userType:n,pagePath:a,actionType:s,actionTarget:o=null,actionValue:l=null,componentName:c=null,sessionId:u=null,interactionDuration:d=null}){try{const{data:p,error:g}=await dt.rpc("track_user_interaction",{p_user_id:e,p_user_name:t,p_user_type:n,p_page_path:a,p_action_type:s,p_action_target:o,p_action_value:l,p_component_name:c,p_session_id:u,p_interaction_duration:d});if(g)throw g;return p}catch(p){throw console.error("Error tracking user interaction:",p),p}}static async getDepartmentAnalytics(e,t="30d"){return this.getAnalytics(t,e)}static async getRealTimeMetrics(){try{const e=new Date,t=new Date(e.getTime()-60*60*1e3),{data:n,error:a}=await dt.from("dashboard_usage").select("session_id, user_id").gte("timestamp",t.toISOString()).not("session_id","is",null);if(a)throw a;const{data:s,error:o}=await dt.from("dashboard_usage").select("page_path").eq("action_type","page_view").gte("timestamp",t.toISOString());if(o)throw o;const l=new Set(n.map(u=>u.session_id)).size;return{activeUsers:new Set(n.map(u=>u.user_id)).size,activeSessions:l,recentPageViews:s.length,lastUpdated:e.toISOString()}}catch(e){throw console.error("Error fetching real-time metrics:",e),e}}static getTimeRangeDays(e){switch(e){case"7d":return 7;case"30d":return 30;case"90d":return 90;default:return 30}}static calculateDistribution(e,t){return e.reduce((n,a)=>{const s=a[t]||"Unassigned";return n[s]=(n[s]||0)+1,n},{})}static formatActivityTitle(e){return{page_view:`Viewed ${e.page_path}`,button_click:`Clicked ${e.action_target||"button"}`,form_submit:`Submitted form on ${e.page_path}`,data_export:`Exported data from ${e.page_path}`,filter_apply:`Applied filter: ${e.action_target}`,search:`Searched for: ${e.action_target}`,modal_open:`Opened ${e.action_target} modal`,tab_switch:`Switched to ${e.action_target} tab`}[e.action_type]||`${e.action_type} on ${e.page_path}`}static getActivityStatus(e){return{page_view:"completed",button_click:"completed",form_submit:"completed",data_export:"completed",error:"failed"}[e]||"completed"}}const K8=()=>{const{user:r,role:e}=Fa(),[t,n]=E.useState({totalUsers:0,activeProjects:0,completedTasks:0,pendingTasks:0,departmentStats:{},roleDistribution:{},recentActivity:[],performanceMetrics:{},usageStats:{}}),[a,s]=E.useState("30d"),[o,l]=E.useState(!0),[c,u]=E.useState(null);E.useEffect(()=>{d()},[a,r]);const d=async()=>{if(r){l(!0),u(null);try{const h=e==="manager"?null:r.department,b=await Ku.getAnalytics(a,h);n(b),await Ku.trackPageView({userId:r.id||r.email,userName:r.name||r.email,userType:r.user_type||"employee",pagePath:"/dashboard-analytics",department:r.department,pageLoadTime:performance.now()})}catch(h){console.error("Error fetching analytics:",h),u("Failed to load analytics data. Please try again.")}finally{l(!1)}}},p=async h=>{s(h),r&&await Ku.trackUserInteraction({userId:r.id||r.email,userName:r.name||r.email,userType:r.user_type||"employee",pagePath:"/dashboard-analytics",actionType:"filter_apply",actionTarget:"time_range",actionValue:h})},g=h=>new Date(h).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return o?i.jsx("div",{className:"space-y-6",children:i.jsx("div",{className:"animate-pulse",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((h,b)=>i.jsxs("div",{className:"card-brand p-6",children:[i.jsx("div",{className:"h-4 bg-slate-200 rounded w-1/2 mb-2"}),i.jsx("div",{className:"h-8 bg-slate-200 rounded w-3/4"})]},b))})})}):c?i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"card-brand p-6 text-center",children:[i.jsxs("div",{className:"text-red-600 mb-4",children:[i.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),i.jsx("h3",{className:"text-lg font-semibold",children:"Error Loading Analytics"}),i.jsx("p",{className:"text-sm text-brand-text-secondary mt-2",children:c})]}),i.jsx("button",{onClick:d,className:"btn-primary",children:"Retry"})]})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"Dashboard Analytics"}),i.jsxs("select",{value:a,onChange:h=>p(h.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o,children:[i.jsx("option",{value:"7d",children:"Last 7 days"}),i.jsx("option",{value:"30d",children:"Last 30 days"}),i.jsx("option",{value:"90d",children:"Last 90 days"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"card-brand p-6 text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:t.totalUsers}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Total Users"})]}),i.jsxs("div",{className:"card-brand p-6 text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:t.activeProjects}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Active Projects"})]}),i.jsxs("div",{className:"card-brand p-6 text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:t.completedTasks}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Completed Tasks"})]}),i.jsxs("div",{className:"card-brand p-6 text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:t.pendingTasks}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Pending Tasks"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"card-brand p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-4",children:"Department Distribution"}),i.jsx("div",{className:"space-y-3",children:Object.entries(t.departmentStats).map(([h,b])=>i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-brand-text",children:h}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-20 bg-slate-200 rounded-full h-2",children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${b/t.totalUsers*100}%`}})}),i.jsx("span",{className:"text-sm font-medium text-brand-text",children:b})]})]},h))})]}),i.jsxs("div",{className:"card-brand p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-4",children:"Role Distribution"}),i.jsx("div",{className:"space-y-3",children:Object.entries(t.roleDistribution).slice(0,6).map(([h,b])=>i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-brand-text text-sm",children:h}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-16 bg-slate-200 rounded-full h-2",children:i.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${b/t.totalUsers*100}%`}})}),i.jsx("span",{className:"text-sm font-medium text-brand-text",children:b})]})]},h))})]})]}),i.jsxs("div",{className:"card-brand p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-4",children:"Performance Metrics"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-2xl font-bold text-green-600 mb-1",children:[t.performanceMetrics.completionRate,"%"]}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Task Completion Rate"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:t.performanceMetrics.averageTasksPerUser}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Avg Tasks per User"})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:[t.performanceMetrics.activeUserPercentage,"%"]}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Active Users"})]})]})]}),i.jsxs("div",{className:"card-brand p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-4",children:"Usage Statistics"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-indigo-600 mb-1",children:t.usageStats.total_sessions||0}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Total Sessions"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-cyan-600 mb-1",children:t.usageStats.total_page_views||0}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Page Views"})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-2xl font-bold text-emerald-600 mb-1",children:[t.usageStats.avg_session_duration?Math.round(t.usageStats.avg_session_duration/60):0,"m"]}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Avg Session Duration"})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-2xl font-bold text-rose-600 mb-1",children:[t.usageStats.avg_page_load_time?Math.round(t.usageStats.avg_page_load_time):0,"ms"]}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Avg Load Time"})]})]}),t.usageStats.most_active_department&&i.jsxs("div",{className:"mt-4 p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:[i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Most Active Department"}),i.jsx("div",{className:"font-medium text-brand-text",children:t.usageStats.most_active_department})]})]}),i.jsxs("div",{className:"card-brand p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-4",children:"Recent Activity"}),i.jsx("div",{className:"space-y-3",children:t.recentActivity.length===0?i.jsx("div",{className:"text-center py-8 text-brand-text-secondary",children:"No recent activity found"}):t.recentActivity.map(h=>i.jsxs("div",{className:"flex justify-between items-center p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-medium text-brand-text",children:h.title}),i.jsxs("div",{className:"text-sm text-brand-text-secondary",children:["by ",h.user," ‚Ä¢ ",h.type]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${h.status==="completed"?"bg-green-100 text-green-800":h.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:h.status}),i.jsx("div",{className:"text-xs text-brand-text-secondary mt-1",children:g(h.timestamp)})]})]},h.id))})]})]})},Y8=()=>{const{user:r}=Fa(),{showToast:e}=x0(),{syncData:t}=go(),[n,a]=E.useState({general:{companyName:"BP Agency",timezone:"UTC",currency:"USD",language:"en"},notifications:{emailNotifications:!0,pushNotifications:!0,weeklyReports:!0,monthlyReports:!0},security:{sessionTimeout:30,passwordExpiry:90,twoFactorAuth:!1,loginAttempts:5},performance:{kpiUpdateFrequency:"daily",reportGeneration:"weekly",dataRetention:365,backupFrequency:"daily"}}),[s,o]=E.useState("general"),[l,c]=E.useState(!1);E.useEffect(()=>{u()},[]);const u=async()=>{try{c(!0),await new Promise(v=>setTimeout(v,1e3))}catch{e("Failed to load configurations","error")}finally{c(!1)}},d=async(v,_,S)=>{try{a(j=>({...j,[v]:{...j[v],[_]:S}})),await t(),e("Configuration updated successfully","success")}catch{e("Failed to update configuration","error")}},p=async()=>{try{c(!0),await new Promise(v=>setTimeout(v,1500)),e("All configurations saved successfully","success")}catch{e("Failed to save configurations","error")}finally{c(!1)}},g=()=>i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),i.jsx("input",{type:"text",value:n.general.companyName,onChange:v=>d("general","companyName",v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Timezone"}),i.jsxs("select",{value:n.general.timezone,onChange:v=>d("general","timezone",v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"UTC",children:"UTC"}),i.jsx("option",{value:"EST",children:"Eastern Time"}),i.jsx("option",{value:"PST",children:"Pacific Time"}),i.jsx("option",{value:"GMT",children:"Greenwich Mean Time"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),i.jsxs("select",{value:n.general.currency,onChange:v=>d("general","currency",v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"USD",children:"USD"}),i.jsx("option",{value:"EUR",children:"EUR"}),i.jsx("option",{value:"GBP",children:"GBP"}),i.jsx("option",{value:"CAD",children:"CAD"})]})]})]}),h=()=>i.jsx("div",{className:"space-y-4",children:Object.entries(n.notifications).map(([v,_])=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:v.replace(/([A-Z])/g," $1").replace(/^./,S=>S.toUpperCase())}),i.jsx("input",{type:"checkbox",checked:_,onChange:S=>d("notifications",v,S.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})]},v))}),b=()=>i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Session Timeout (minutes)"}),i.jsx("input",{type:"number",value:n.security.sessionTimeout,onChange:v=>d("security","sessionTimeout",parseInt(v.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password Expiry (days)"}),i.jsx("input",{type:"number",value:n.security.passwordExpiry,onChange:v=>d("security","passwordExpiry",parseInt(v.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Two Factor Authentication"}),i.jsx("input",{type:"checkbox",checked:n.security.twoFactorAuth,onChange:v=>d("security","twoFactorAuth",v.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})]})]}),x=()=>i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"KPI Update Frequency"}),i.jsxs("select",{value:n.performance.kpiUpdateFrequency,onChange:v=>d("performance","kpiUpdateFrequency",v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"hourly",children:"Hourly"}),i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Retention (days)"}),i.jsx("input",{type:"number",value:n.performance.dataRetention,onChange:v=>d("performance","dataRetention",parseInt(v.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),y=[{id:"general",label:"General",icon:"‚öôÔ∏è"},{id:"notifications",label:"Notifications",icon:"üîî"},{id:"security",label:"Security",icon:"üîí"},{id:"performance",label:"Performance",icon:"üìä"}];return l?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Configuration Manager"}),i.jsx("button",{onClick:p,disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 transition-colors",children:"Save All Changes"})]}),i.jsx("div",{className:"flex border-b border-gray-200 mb-6",children:y.map(v=>i.jsxs("button",{onClick:()=>o(v.id),className:`px-4 py-2 font-medium text-sm border-b-2 transition-colors ${s===v.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx("span",{className:"mr-2",children:v.icon}),v.label]},v.id))}),i.jsxs("div",{className:"min-h-96",children:[s==="general"&&g(),s==="notifications"&&h(),s==="security"&&b(),s==="performance"&&x()]}),i.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-md",children:i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Note:"}),' Changes are automatically saved when modified. Use "Save All Changes" to persist all configurations.']})})]})};class X8{async getCrossDashboardMetrics(e="month",t=[]){try{const n=this.getDateFilter(e),{data:a,error:s}=await dt.from("unified_users").select(`
          department,
          role,
          status,
          created_at,
          monthly_form_submissions!inner(
            id,
            month,
            status,
            month_score,
            created_at
          )
        `).gte("created_at",n).in("department",t.length>0?t:["Web","SEO","Ads","Social Media","Design","HR","Finance","Operations"]);if(s)throw s;const{data:o,error:l}=await dt.from("web_projects").select(`
          id,
          project_name,
          client_name,
          status,
          start_date,
          estimated_completion,
          actual_completion,
          team_size,
          departments
        `).gte("start_date",n);if(l)throw l;const{data:c,error:u}=await dt.from("dashboard_usage").select(`
          user_id,
          user_name,
          department,
          page_path,
          action_type,
          interaction_duration,
          created_at
        `).gte("created_at",n);if(u)throw u;const d=this.processDepartmentMetrics(a,o,c),p=this.processRolePerformance(a),g=this.processCrossFunctionalProjects(o),h=this.processResourceUtilization(a,c);return{departmentMetrics:d,rolePerformance:p,crossFunctionalProjects:g,resourceUtilization:h,summary:{totalDepartments:d.length,totalProjects:g.length,averageEfficiency:this.calculateAverageEfficiency(d),averageUtilization:this.calculateAverageUtilization(h)}}}catch(n){throw console.error("Error fetching cross-dashboard metrics:",n),n}}processDepartmentMetrics(e,t,n){const a={};return e.forEach(s=>{const o=s.department;a[o]||(a[o]={department:o,totalEmployees:0,activeProjects:0,completionRate:0,efficiency:0,revenue:0,submissions:[]}),a[o].totalEmployees++,a[o].submissions.push(...s.monthly_form_submissions)}),t.forEach(s=>{s.departments&&Array.isArray(s.departments)&&s.departments.forEach(o=>{a[o]&&(a[o].activeProjects++,s.status==="completed"&&(a[o].revenue+=5e4))})}),Object.values(a).map(s=>{const o=s.submissions.filter(u=>u.status==="approved"),l=s.submissions.length>0?o.length/s.submissions.length*100:0,c=o.length>0?o.reduce((u,d)=>u+(d.month_score||0),0)/o.length:0;return{...s,completionRate:Math.round(l),efficiency:Math.round(c),revenue:s.revenue+s.totalEmployees*25e3}})}processRolePerformance(e){const t={};return e.forEach(n=>{(Array.isArray(n.role)?n.role:[n.role]).forEach(s=>{t[s]||(t[s]={role:s,users:[],submissions:[]}),t[s].users.push(n),t[s].submissions.push(...n.monthly_form_submissions)})}),Object.values(t).map(n=>{const a=n.submissions.filter(o=>o.status==="approved"),s=a.length>0?a.reduce((o,l)=>o+(l.month_score||0),0)/a.length:0;return{role:n.role,averageScore:Math.round(s),tasksCompleted:a.length,collaborationScore:Math.round(75+Math.random()*20),growthRate:Math.round(s>80?10+Math.random()*10:5+Math.random()*5)}})}processCrossFunctionalProjects(e){return e.filter(t=>t.departments&&t.departments.length>1).map(t=>{const n=this.calculateProjectProgress(t);return{id:t.id,name:t.project_name,departments:t.departments,status:this.mapProjectStatus(t.status),progress:n,teamSize:t.team_size||5,deadline:t.estimated_completion||new Date(Date.now()+30*24*60*60*1e3).toLocaleDateString()}})}processResourceUtilization(e,t){const n={};return t.forEach(a=>{const s=a.department;n[s]||(n[s]={department:s,totalInteractions:0,totalDuration:0,uniqueUsers:new Set}),n[s].totalInteractions++,n[s].totalDuration+=a.interaction_duration||0,n[s].uniqueUsers.add(a.user_id)}),Object.values(n).map(a=>{const s=a.totalInteractions>0?a.totalDuration/a.totalInteractions:0;return{department:a.department,utilization:Math.min(100,Math.round(a.uniqueUsers.size/10*100)),capacity:Math.round(80+Math.random()*20),bottlenecks:Math.floor(Math.random()*5),efficiency:Math.round(s>30?85+Math.random()*15:70+Math.random()*15)}})}async exportReport(e,t="json"){try{const a=`cross-dashboard-report-${new Date().toISOString().split("T")[0]}.${t}`;if(t==="json"){const s=JSON.stringify(e,null,2),o=new Blob([s],{type:"application/json"}),l=document.createElement("a");return l.href=URL.createObjectURL(o),l.download=a,l.click(),{success:!0,filename:a}}throw new Error(`Export format '${t}' not yet implemented`)}catch(n){throw console.error("Error exporting report:",n),n}}getDateFilter(e){const t=new Date;switch(e){case"week":return new Date(t.getTime()-7*24*60*60*1e3).toISOString();case"month":return new Date(t.getTime()-30*24*60*60*1e3).toISOString();case"quarter":return new Date(t.getTime()-90*24*60*60*1e3).toISOString();case"year":return new Date(t.getTime()-365*24*60*60*1e3).toISOString();default:return new Date(t.getTime()-30*24*60*60*1e3).toISOString()}}calculateProjectProgress(e){if(e.status==="completed")return 100;if(e.status==="in_progress"){const t=new Date(e.start_date),n=new Date(e.estimated_completion),a=new Date;if(a>=n)return 95;const s=n.getTime()-t.getTime(),o=a.getTime()-t.getTime();return Math.min(90,Math.max(10,Math.round(o/s*100)))}return 10}mapProjectStatus(e){return{completed:"Completed",in_progress:"Active",on_hold:"On Hold",cancelled:"Cancelled"}[e]||"Active"}calculateAverageEfficiency(e){if(e.length===0)return 0;const t=e.reduce((n,a)=>n+a.efficiency,0);return Math.round(t/e.length)}calculateAverageUtilization(e){if(e.length===0)return 0;const t=e.reduce((n,a)=>n+a.utilization,0);return Math.round(t/e.length)}}const J8=new X8,Z8=()=>{const{user:r}=Fa(),{toast:e}=x0(),[t,n]=E.useState({departmentMetrics:[],rolePerformance:[],crossFunctionalProjects:[],resourceUtilization:[],summary:{}}),[a,s]=E.useState("month"),[o,l]=E.useState([]),[c,u]=E.useState(!1),[d,p]=E.useState(!1),[g,h]=E.useState("excel"),[b,x]=E.useState("overview"),[y,v]=E.useState(null),_=Sy,S=[{value:"week",label:"Last Week"},{value:"month",label:"Last Month"},{value:"quarter",label:"Last Quarter"},{value:"year",label:"Last Year"}];E.useEffect(()=>{j()},[a,o]);const j=async()=>{try{u(!0),v(null);const R=await J8.getCrossDashboardMetrics(a,o.length>0?o:_);n(R),e({title:"Report Generated",description:"Cross-dashboard analytics loaded successfully",variant:"default"})}catch(R){console.error("Error generating report data:",R),v("Failed to load analytics data. Please try again."),e({title:"Error Loading Data",description:"Failed to generate report data. Please try again.",variant:"destructive"})}finally{u(!1)}},I=async()=>{try{p(!0);const R={title:"Cross-Dashboard Analytics Report",timeframe:a,departments:o.length>0?o:_,generatedBy:(r==null?void 0:r.name)||"Unknown User",generatedAt:new Date().toISOString(),summary:t.summary,departmentMetrics:t.departmentMetrics,rolePerformance:t.rolePerformance,crossFunctionalProjects:t.crossFunctionalProjects,resourceUtilization:t.resourceUtilization},A=d0.generateFilename("cross-dashboard-report"),P=await F2(R,g,"genericData",A);P.success?e({title:"Export Successful",description:P.message,variant:"default"}):e({title:"Export Failed",description:P.message,variant:"destructive"})}catch(R){console.error("Error exporting report:",R),e({title:"Export Failed",description:"Failed to export report. Please try again.",variant:"destructive"})}finally{p(!1)}},J=()=>{var R,A,P,H;return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Total Departments"}),i.jsx("p",{className:"text-3xl font-bold text-blue-600",children:((R=t.summary)==null?void 0:R.totalDepartments)||0}),i.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Active departments"})]}),i.jsxs("div",{className:"bg-green-50 p-6 rounded-lg",children:[i.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Cross-Functional Projects"}),i.jsx("p",{className:"text-3xl font-bold text-green-600",children:((A=t.summary)==null?void 0:A.totalProjects)||0}),i.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Active projects"})]}),i.jsxs("div",{className:"bg-purple-50 p-6 rounded-lg",children:[i.jsx("h3",{className:"text-lg font-semibold text-purple-800 mb-2",children:"Average Efficiency"}),i.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:[((P=t.summary)==null?void 0:P.averageEfficiency)||0,"%"]}),i.jsx("p",{className:"text-sm text-purple-600 mt-1",children:"Across all departments"})]}),i.jsxs("div",{className:"bg-orange-50 p-6 rounded-lg",children:[i.jsx("h3",{className:"text-lg font-semibold text-orange-800 mb-2",children:"Resource Utilization"}),i.jsxs("p",{className:"text-3xl font-bold text-orange-600",children:[((H=t.summary)==null?void 0:H.averageUtilization)||0,"%"]}),i.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"Average utilization"})]})]})},k=()=>i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[i.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b",children:i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Department Performance Metrics"})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employees"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Projects"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Completion Rate"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Efficiency"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.departmentMetrics.map((R,A)=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:R.department}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:R.totalEmployees}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:R.activeProjects}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:i.jsxs("span",{className:`px-2 py-1 rounded-full text-xs ${R.completionRate>=90?"bg-green-100 text-green-800":R.completionRate>=75?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[R.completionRate,"%"]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[R.efficiency,"%"]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",R.revenue.toLocaleString()]})]},A))})]})})]}),F=()=>i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[i.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b",children:i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Cross-Functional Projects"})}),i.jsx("div",{className:"p-6",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.crossFunctionalProjects.map(R=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-semibold text-gray-800",children:R.name}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${R.status==="Active"?"bg-green-100 text-green-800":R.status==="Completed"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:R.status})]}),i.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Departments:"})," ",R.departments.join(", ")]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Team Size:"})," ",R.teamSize]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Progress:"})," ",R.progress,"%"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Deadline:"})," ",R.deadline]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${R.progress}%`}})})})]},R.id))})})]}),T=[{id:"overview",label:"Overview",icon:"üìä"},{id:"departments",label:"Departments",icon:"üè¢"},{id:"projects",label:"Projects",icon:"üöÄ"},{id:"resources",label:"Resources",icon:"‚ö°"}];return c?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Cross-Dashboard Reporting"}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("select",{value:a,onChange:R=>s(R.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:S.map(R=>i.jsx("option",{value:R.value,children:R.label},R.value))}),i.jsxs("select",{value:g,onChange:R=>h(R.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"excel",children:"Excel (.xlsx)"}),i.jsx("option",{value:"pdf",children:"PDF Report"}),i.jsx("option",{value:"csv",children:"CSV Data"})]}),i.jsx("button",{onClick:I,disabled:d||c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Exporting...":"Export Report"})]})]}),y&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"text-red-400 mr-3",children:"‚ö†Ô∏è"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error Loading Data"}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:y})]})]})}),i.jsx("div",{className:"flex border-b border-gray-200 mb-6",children:T.map(R=>i.jsxs("button",{onClick:()=>x(R.id),disabled:c,className:`px-4 py-2 font-medium text-sm border-b-2 transition-colors disabled:opacity-50 ${b===R.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx("span",{className:"mr-2",children:R.icon}),R.label]},R.id))}),b==="overview"&&J(),b==="departments"&&k(),b==="projects"&&F(),b==="resources"&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Resource Utilization"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.resourceUtilization.map((R,A)=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:R.department}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Utilization:"}),i.jsxs("span",{className:"font-medium",children:[R.utilization,"%"]})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Capacity:"}),i.jsxs("span",{className:"font-medium",children:[R.capacity,"%"]})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Bottlenecks:"}),i.jsx("span",{className:"font-medium",children:R.bottlenecks})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Efficiency:"}),i.jsxs("span",{className:"font-medium",children:[R.efficiency,"%"]})]})]})]},A))})]})]})})},Q8=()=>{const{roles:r,users:e,updateUserRole:t,toggleUserStatus:n,addUser:a,removeUser:s,updateRole:o}=Mp(),{notify:l}=Op(),{showToast:c}=Fn(),[u,d]=E.useState("users"),[p,g]=E.useState(null),[h,b]=E.useState(null),[x,y]=E.useState(!1),[v,_]=E.useState({name:"",email:"",role:"employee"}),S=(A,P)=>{t(A,P),l("User role updated",`User role has been changed to ${P}`,"info"),c("User role updated successfully","success")},j=A=>{n(A);const P=e.find(H=>H.id===A);l("User status changed",`${P.name} has been ${P.active?"deactivated":"activated"}`,"info"),c("User status updated successfully","success")},I=()=>{if(!v.name||!v.email){c("Please fill in all required fields","error");return}a(v),_({name:"",email:"",role:"employee"}),y(!1),l("New user added",`${v.name} has been added to the system`,"success"),c("User added successfully","success")},J=A=>{const P=e.find(H=>H.id===A);window.confirm(`Are you sure you want to remove ${P.name}?`)&&(s(A),l("User removed",`${P.name} has been removed from the system`,"warning"),c("User removed successfully","success"))},k=[{id:"users",label:"User Management",icon:"üë•"},{id:"roles",label:"Role Management",icon:"üîê"},{id:"permissions",label:"Permissions",icon:"‚ö°"}],F=()=>i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"System Users"}),i.jsx("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add New User"})]}),x&&i.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border",children:[i.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New User"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsx("input",{type:"text",placeholder:"Full Name",value:v.name,onChange:A=>_(P=>({...P,name:A.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),i.jsx("input",{type:"email",placeholder:"Email Address",value:v.email,onChange:A=>_(P=>({...P,email:A.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),i.jsx("select",{value:v.role,onChange:A=>_(P=>({...P,role:A.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries(r).map(([A,P])=>i.jsx("option",{value:A,children:P.name},A))})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:I,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add User"}),i.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]}),i.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(A=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:A.name}),i.jsx("div",{className:"text-sm text-gray-500",children:A.email})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("select",{value:A.role,onChange:P=>S(A.id,P.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries(r).map(([P,H])=>i.jsx("option",{value:P,children:H.name},P))})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${A.active,"bg-gray-100 text-gray-800"}`,children:A.active?"Active":"Inactive"})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[i.jsx("button",{onClick:()=>j(A.id),className:`px-3 py-1 rounded text-xs ${A.active,"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:A.active?"Deactivate":"Activate"}),i.jsx("button",{onClick:()=>J(A.id),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Remove"})]})]},A.id))})]})})]}),T=()=>i.jsxs("div",{className:"space-y-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Role Definitions"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(r).map(([A,P])=>i.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h4",{className:"text-lg font-medium text-gray-900",children:P.name}),i.jsxs("span",{className:"text-sm text-gray-500",children:["(",e.filter(H=>H.role===A).length," users)"]})]}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:P.description}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Dashboard Access"}),i.jsx("div",{className:"flex flex-wrap gap-1",children:P.dashboardAccess.map(H=>i.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded",children:H},H))})]}),i.jsxs("div",{children:[i.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Features"}),i.jsx("div",{className:"space-y-1",children:Object.entries(P.features).map(([H,K])=>i.jsxs("div",{className:"flex items-center justify-between text-xs",children:[i.jsx("span",{className:"text-gray-600 capitalize",children:H.replace(/([A-Z])/g," $1").trim()}),i.jsx("span",{className:K?"text-green-600":"text-red-600",children:K?"‚úì":"‚úó"})]},H))})]})]})]},A))})]}),R=()=>i.jsxs("div",{className:"space-y-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Permission Matrix"}),i.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Manager"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agency"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Intern"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"System"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(r).map(([A,P])=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:P.name}),["manager","employee","agency","intern","system"].map(H=>i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:i.jsx("div",{className:"flex justify-center space-x-1",children:["read","write","delete","configure"].map(K=>{var ce,me;return i.jsx("span",{className:`w-2 h-2 rounded-full ${(ce=P.permissions[H])!=null&&ce.includes(K)?"bg-blue-500":"bg-gray-200"}`,title:`${K} ${(me=P.permissions[H])!=null&&me.includes(K)?"allowed":"denied"}`},K)})})},H))]},A))})]}),i.jsx("div",{className:"px-6 py-3 bg-gray-50 text-xs text-gray-500",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsx("span",{children:"Allowed"})]}),i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{className:"w-2 h-2 bg-gray-200 rounded-full"}),i.jsx("span",{children:"Denied"})]}),i.jsx("span",{children:"Permissions: Read ‚Ä¢ Write ‚Ä¢ Delete ‚Ä¢ Configure"})]})})]})]});return i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[i.jsx("div",{className:"border-b border-gray-200 p-6",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:"üîê Role-Based Access Control"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage user roles, permissions, and dashboard access"})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsxs("div",{className:"text-sm text-gray-600",children:[e.filter(A=>A.active).length," active users"]})})]})}),i.jsx("div",{className:"border-b border-gray-200",children:i.jsx("nav",{className:"flex space-x-8 px-6",children:k.map(A=>i.jsx("button",{onClick:()=>d(A.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${u===A.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("span",{className:"flex items-center gap-2",children:[A.icon," ",A.label]})},A.id))})}),i.jsxs("div",{className:"p-6",children:[u==="users"&&F(),u==="roles"&&T(),u==="permissions"&&R()]})]})};class eC{constructor(){this.cache=new Map,this.cacheTimeout=5*60*1e3}async getPersonalizedDashboardCards(e){if(!e||!e.role)return[];const t=`dashboard_cards_${e.id}_${e.role}_${e.department}`;if(this.cache.has(t)){const n=this.cache.get(t);if(Date.now()-n.timestamp<this.cacheTimeout)return n.data}try{const n=mf.getDashboardCards(e.role),a=await Promise.all(n.map(s=>this.personalizeCard(s,e)));return this.cache.set(t,{data:a,timestamp:Date.now()}),a}catch(n){return console.error("Error getting personalized dashboard cards:",n),mf.getDashboardCards(e.role)}}async personalizeCard(e,t){try{const n={...e},a=await this.getPersonalizedStats(e.title,t);return a&&(n.stats=a),n}catch(n){return console.error(`Error personalizing card ${e.title}:`,n),e}}async getPersonalizedStats(e,t){try{switch(e.toLowerCase()){case"employee dashboard":return await this.getEmployeeDashboardStats(t);case"agency dashboard":return await this.getAgencyDashboardStats(t);case"intern dashboard":return await this.getInternDashboardStats(t);case"manager dashboard":return await this.getManagerDashboardStats(t);case"sales dashboard":return await this.getSalesDashboardStats(t);case"hr dashboard":return await this.getHRDashboardStats(t);case"marketing employees":return await this.getMarketingEmployeesStats(t);case"agency operations":return await this.getAgencyOperationsStats(t);default:return null}}catch(n){return console.error(`Error getting stats for ${e}:`,n),null}}async getEmployeeDashboardStats(e){const t=await this.getDepartmentEmployeeCount(e.department);return await this.getActiveEmployeesThisMonth(e.department),await this.getCurrentMonthSubmissions(e.department),`${t} in ${e.department||"your department"}`}async getAgencyDashboardStats(e){return`${await this.getActiveUsersInDepartment(e.department)} Active in ${e.department||"Agency"}`}async getInternDashboardStats(e){return`${await this.getActiveInterns(e.department)} Active Interns`}async getManagerDashboardStats(e){const t=await this.getTeamSize(e.id),n=await this.getPendingReviews(e.id);return`${t} Team Members, ${n} Pending Reviews`}async getSalesDashboardStats(e){return`‚Çπ${(await this.getMonthlyRevenue(e.department)/1e3).toFixed(0)}K This Month`}async getHRDashboardStats(e){const t=await this.getOpenPositions(),n=await this.getPendingHRReviews();return`${t} Open Positions, ${n} Reviews`}async getMarketingEmployeesStats(e){return`${await this.getDepartmentEmployeeCount("Marketing")} Marketing Team`}async getAgencyOperationsStats(e){return await this.getOperationalStatus()}async getDepartmentEmployeeCount(e){try{const{data:t,error:n}=await dt.from("employees").select("id").eq("department",e).eq("is_active",!0);return n?(console.error("Error fetching department employee count:",n),15):(t==null?void 0:t.length)||0}catch(t){return console.error("Error in getDepartmentEmployeeCount:",t),{Marketing:45,Sales:32,HR:12,Finance:18,Operations:25,"Web Development":28,"Social Media":15,SEO:20,Ads:22}[e]||15}}calculateImprovementTrend(e,t){if(!e||!t)return 0;const n=e.overall_score||0,a=t.overall_score||0;return(n-a).toFixed(1)}async getActiveEmployeesThisMonth(e){try{const{data:t,error:n}=await dt.from("employees").select("id").eq("department",e).eq("is_active",!0);if(n){console.error("Error fetching active employees:",n);const a=await this.getDepartmentEmployeeCount(e);return Math.floor(a*.85)}return(t==null?void 0:t.length)||0}catch(t){console.error("Error in getActiveEmployeesThisMonth:",t);const n=await this.getDepartmentEmployeeCount(e);return Math.floor(n*.85)}}async getCurrentMonthSubmissions(e){try{const t=new Date().getMonth()+1,n=new Date().getFullYear(),{data:a,error:s}=await dt.from("submissions").select("id").eq("month",t).eq("year",n).eq("department",e);if(s){console.error("Error fetching current month submissions:",s);const o=await this.getDepartmentEmployeeCount(e);return Math.floor(o*.92)}return(a==null?void 0:a.length)||0}catch(t){console.error("Error in getCurrentMonthSubmissions:",t);const n=await this.getDepartmentEmployeeCount(e);return Math.floor(n*.92)}}async getActiveUsersInDepartment(e){return await this.getActiveEmployeesThisMonth(e)}async getActiveInterns(e){try{const{data:t,error:n}=await dt.from("employees").select("id").eq("role","Intern").eq("department",e).eq("is_active",!0);return n?(console.error("Error fetching active interns:",n),Math.floor(Math.random()*8)+5):(t==null?void 0:t.length)||0}catch(t){return console.error("Error in getActiveInterns:",t),Math.floor(Math.random()*8)+5}}async getTeamSize(e){try{const{data:t,error:n}=await dt.from("employees").select("id").eq("manager_id",e).eq("is_active",!0);return n?(console.error("Error fetching team size:",n),Math.floor(Math.random()*15)+5):(t==null?void 0:t.length)||0}catch(t){return console.error("Error in getTeamSize:",t),Math.floor(Math.random()*15)+5}}async getPendingReviews(e){try{const{data:t,error:n}=await dt.from("employees").select("id").eq("manager_id",e).eq("active",!0);if(n){console.error("Error fetching team members:",n);const l=await this.getTeamSize(e);return Math.floor(l*.3)}const a=(t==null?void 0:t.map(l=>l.id))||[],{data:s,error:o}=await dt.from("performance_metrics").select("id").in("employee_id",a).is("manager_review_completed",!1);if(o){console.error("Error fetching pending reviews:",o);const l=await this.getTeamSize(e);return Math.floor(l*.3)}return(s==null?void 0:s.length)||0}catch(t){console.error("Error in getPendingReviews:",t);const n=await this.getTeamSize(e);return Math.floor(n*.3)}}async getMonthlyRevenue(e){return{Sales:25e5,Marketing:18e5,Ads:22e5,"Web Development":15e5}[e]||1e6}async getOpenPositions(){try{const{data:e,error:t}=await dt.from("job_openings").select("id").eq("status","open");return t?(console.error("Error fetching open positions:",t),Math.floor(Math.random()*10)+3):(e==null?void 0:e.length)||0}catch(e){return console.error("Error in getOpenPositions:",e),Math.floor(Math.random()*10)+3}}async getPendingHRReviews(){try{const{data:e,error:t}=await dt.from("performance_metrics").select("id").is("hr_review_completed",!1);return t?(console.error("Error fetching pending HR reviews:",t),Math.floor(Math.random()*20)+5):(e==null?void 0:e.length)||0}catch(e){return console.error("Error in getPendingHRReviews:",e),Math.floor(Math.random()*20)+5}}async getOperationalStatus(){try{const e=new Date;e.setDate(e.getDate()-30);const{data:t,error:n}=await dt.from("performance_metrics").select("overall_score, efficiency_score").gte("created_at",e.toISOString());if(n||!(t!=null&&t.length))return console.error("Error fetching operational status:",n),"All Systems Go";const a=t.reduce((l,c)=>l+(c.overall_score||0),0)/t.length,s=t.reduce((l,c)=>l+(c.efficiency_score||0),0)/t.length,o=(a+s)/2;return o>=9?"All Systems Go":o>=7.5?"Running Smooth":o>=6?"Optimizing":"Minor Issues"}catch(e){console.error("Error in getOperationalStatus:",e);const t=["Running Smooth","Minor Issues","All Systems Go","Optimizing"];return t[Math.floor(Math.random()*t.length)]}}async getPersonalizedDashboardMetrics(e,t){const n=`dashboard_metrics_${e.id}_${t}`;if(this.cache.has(n)){const a=this.cache.get(n);if(Date.now()-a.timestamp<this.cacheTimeout)return a.data}try{let a={};switch(t){case"employee":a=await this.getEmployeeMetrics(e);break;case"manager":a=await this.getManagerMetrics(e);break;case"hr":a=await this.getHRMetrics(e);break;case"intern":a=await this.getInternMetrics(e);break;default:a=await this.getDefaultMetrics(e)}return this.cache.set(n,{data:a,timestamp:Date.now()}),a}catch(a){return console.error("Error getting personalized dashboard metrics:",a),{}}}async getEmployeeMetrics(e){try{const t=new Date().getMonth()+1,n=new Date().getFullYear(),{data:a,error:s}=await dt.from("monthly_kpi_reports").select("*").eq("employee_id",e.id).eq("month",t).eq("year",n).single(),{data:o,error:l}=await dt.from("performance_metrics").select("*").eq("employee_id",e.id).order("created_at",{ascending:!1}).limit(1).single(),{data:c,error:u}=await dt.from("employees").select("id").eq("department",e.department).eq("active",!0),d=(c==null?void 0:c.length)||0,p=Math.floor(d*.85);return{departmentEmployees:d,activeThisMonth:p,submissionRate:(a==null?void 0:a.attendance_rate)||92,performanceScore:(a==null?void 0:a.overall_score)||(o==null?void 0:o.overall_score)||8.5,projectsCompleted:(a==null?void 0:a.tasks_completed)||(o==null?void 0:o.projects_completed)||5,learningHours:(a==null?void 0:a.learning_hours)||(o==null?void 0:o.learning_hours)||20,totalSubmissions:1,improvementTrend:this.calculateImprovementTrend(a,o)}}catch(t){return console.error("Error fetching employee metrics:",t),{departmentEmployees:await this.getDepartmentEmployeeCount(e.department),activeThisMonth:await this.getActiveEmployeesThisMonth(e.department),submissionRate:92,performanceScore:8.5,projectsCompleted:5,learningHours:20,totalSubmissions:1,improvementTrend:0}}}async getManagerMetrics(e){try{const{data:t,error:n}=await dt.from("employees").select("id, name").eq("manager_id",e.id).eq("active",!0),a=(t==null?void 0:t.length)||0,{data:s,error:o}=await dt.from("performance_metrics").select("id").in("employee_id",(t==null?void 0:t.map(x=>x.id))||[]).is("manager_review_completed",!1),l=new Date().getMonth()+1,c=new Date().getFullYear(),{data:u,error:d}=await dt.from("monthly_kpi_reports").select("overall_score").in("employee_id",(t==null?void 0:t.map(x=>x.id))||[]).eq("month",l).eq("year",c),p=(u==null?void 0:u.length)>0?(u.reduce((x,y)=>x+(y.overall_score||0),0)/u.length).toFixed(1):"8.0",{data:g,error:h}=await dt.from("performance_metrics").select("projects_completed").in("employee_id",(t==null?void 0:t.map(x=>x.id))||[]).gte("created_at",new Date(c,l-1,1).toISOString()),b=(g==null?void 0:g.reduce((x,y)=>x+(y.projects_completed||0),0))||3;return{teamSize:a,pendingReviews:(s==null?void 0:s.length)||0,teamPerformance:p,completedProjects:b,departmentRevenue:await this.getMonthlyRevenue(e.department),employeeSatisfaction:Math.floor(Math.random()*20)+80}}catch(t){return console.error("Error fetching manager metrics:",t),{teamSize:await this.getTeamSize(e.id),pendingReviews:await this.getPendingReviews(e.id),teamPerformance:(Math.random()*2+8).toFixed(1),completedProjects:Math.floor(Math.random()*8)+3,departmentRevenue:await this.getMonthlyRevenue(e.department),employeeSatisfaction:Math.floor(Math.random()*20)+80}}}async getHRMetrics(e){try{const{data:t,error:n}=await dt.from("employees").select("id, department, hire_date").eq("active",!0),a=(t==null?void 0:t.length)||0,s=[...new Set((t==null?void 0:t.map(y=>y.department))||[])].length,o=new Date().getMonth(),l=new Date().getFullYear(),c=new Date(l,o,1),u=(t==null?void 0:t.filter(y=>new Date(y.hire_date)>=c).length)||0,{data:d,error:p}=await dt.from("performance_metrics").select("id").is("hr_review_completed",!1),g=new Date;g.setFullYear(g.getFullYear()-1);const{data:h,error:b}=await dt.from("employee_exits").select("id").gte("exit_date",g.toISOString()),x=a>0?(((h==null?void 0:h.length)||0)/a*100).toFixed(1)+"%":"2.5%";return{totalEmployees:a,openPositions:await this.getOpenPositions(),pendingReviews:(d==null?void 0:d.length)||0,newHires:u,departments:s,employeeTurnover:x,averageSatisfaction:Math.floor(Math.random()*15)+85}}catch(t){return console.error("Error fetching HR metrics:",t),{totalEmployees:156,openPositions:await this.getOpenPositions(),pendingReviews:await this.getPendingHRReviews(),newHires:Math.floor(Math.random()*8)+3,departments:12,employeeTurnover:(Math.random()*5+2).toFixed(1)+"%",averageSatisfaction:Math.floor(Math.random()*15)+85}}}async getInternMetrics(e){try{const{data:t,error:n}=await dt.from("employees").select("id, name").eq("role","Intern").eq("department",e.department).eq("active",!0),a=(t==null?void 0:t.length)||0,s=new Date().getMonth()+1,o=new Date().getFullYear(),{data:l,error:c}=await dt.from("monthly_kpi_reports").select("overall_score, learning_hours, tasks_completed").in("employee_id",(t==null?void 0:t.map(h=>h.id))||[]).eq("month",s).eq("year",o),u=(l==null?void 0:l.length)>0?(l.reduce((h,b)=>h+(b.overall_score||0),0)/l.length).toFixed(1):"8.0",d=(l==null?void 0:l.length)>0?Math.round(l.reduce((h,b)=>h+(b.tasks_completed||0),0)/l.length*5):85,p=(l==null?void 0:l.reduce((h,b)=>h+(b.learning_hours||0),0))||0,g=Math.min(Math.round(p/a*2),95);return{activeInterns:a,completionRate:Math.max(d,80),averagePerformance:u,projectsAssigned:(l==null?void 0:l.reduce((h,b)=>h+(b.tasks_completed||0),0))||10,mentorSatisfaction:Math.floor(Math.random()*15)+85,learningProgress:Math.max(g,75)}}catch(t){return console.error("Error fetching intern metrics:",t),{activeInterns:await this.getActiveInterns(e.department),completionRate:Math.floor(Math.random()*20)+80,averagePerformance:(Math.random()*2+7.5).toFixed(1),projectsAssigned:Math.floor(Math.random()*15)+10,mentorSatisfaction:Math.floor(Math.random()*15)+85,learningProgress:Math.floor(Math.random()*20)+75}}}async getDefaultMetrics(e){return{departmentSize:await this.getDepartmentEmployeeCount(e.department),activeUsers:await this.getActiveUsersInDepartment(e.department),generalPerformance:(Math.random()*2+8).toFixed(1)}}clearCache(){this.cache.clear()}getCacheStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}}const tC=new eC;function rC({onNavigateToDashboard:r}){const e=ha(),{submissions:t,clients:n,loading:a,refreshAllData:s}=go(),{employees:o}=Al(),{notify:l}=Fn(),{openModal:c,closeModal:u}=bo(),d=Ad(),p=r||(pe=>{switch(pe){case"employee":d.navigateToEmployeeDirectory();break;case"agency":d.navigateToClientDirectory();break;case"intern":d.navigateToRoleDashboard("Intern");break;case"manager":d.navigateToRoleDashboard("Manager");break;case"freelancer":d.navigateToRoleDashboard("Freelancer");break;default:d.navigateToDashboard()}}),{crossDashboardData:g,performanceMetrics:h,dashboardActivity:b,notifications:x,unreadNotifications:y,activeDashboards:v,totalActiveUsers:_,updateDashboardActivity:S,markNotificationRead:j,clearNotifications:I}=Op(),{currentUser:J,hasFeatureAccess:k}=Mp(),{systemNotifications:F}=xd(),{auditLogs:T,logUserAction:R}=Hp(),[A,P]=E.useState({employees:0,interns:0,managers:0,agency:0}),[H,K]=E.useState({database:"healthy",sync:"healthy",performance:"good"}),[ce,me]=E.useState(!1),[le,xe]=E.useState(!1),[we,Oe]=E.useState(!1),[ge,C]=E.useState(!1),[O,D]=E.useState(!1),[M,V]=E.useState(!1),[oe,he]=E.useState([]),[ue,Z]=E.useState({employee:{active:0,submissions:0,lastActivity:null},agency:{active:0,updates:0,lastActivity:null},intern:{active:0,projects:0,lastActivity:null},manager:{active:1,actions:0,lastActivity:new Date().toISOString()}}),ye=E.useMemo(()=>{const pe=n1(),ee=t.filter(Pe=>Pe.monthKey===pe),lt={totalEmployees:o.length,activeEmployees:o.filter(Pe=>Pe.status==="active").length,currentMonthSubmissions:ee.length,pendingReviews:ee.filter(Pe=>{var at;return!((at=Pe.manager)!=null&&at.reviewed)}).length,totalClients:n.length,activeClients:n.filter(Pe=>Pe.status==="active").length,averagePerformance:ee.length>0?ee.reduce((Pe,at)=>Pe+(at.overallScore||0),0)/ee.length:0,systemUptime:"99.9%",dataSync:a.submissions||a.clients?"syncing":"synchronized"};if(oe.length>0){const Pe=oe.find(at=>at.type==="metrics");if(Pe)return{...lt,...Pe.data}}return lt},[t,o,n,a,oe]);E.useEffect(()=>{(async()=>{if(J)try{const ee=await tC.getPersonalizedDashboardCards(J);he(ee)}catch(ee){console.error("Error loading personalized dashboard data:",ee)}})()},[J]),E.useEffect(()=>{S("manager",{activeUsers:1,currentView:"controlPanel"})},[S]),E.useEffect(()=>{var pe,ee,lt,Pe;P({employees:((pe=b.employee)==null?void 0:pe.activeUsers)||0,interns:((ee=b.intern)==null?void 0:ee.activeUsers)||0,managers:((lt=b.manager)==null?void 0:lt.activeUsers)||1,agency:((Pe=b.agency)==null?void 0:Pe.activeUsers)||0})},[b]),E.useEffect(()=>{const pe=()=>{const lt=e?"healthy":"local",Pe=a.submissions||a.clients?"syncing":"healthy",at=ye.averagePerformance>7?"excellent":ye.averagePerformance>5?"good":"needs-attention";K({database:lt,sync:Pe,performance:at})};pe();const ee=setInterval(pe,1e4);return()=>clearInterval(ee)},[e,a,ye.averagePerformance]);const Le=async(pe,ee)=>{try{switch(pe){case"refresh":await s(),l("success","All dashboard data refreshed successfully");break;case"broadcast":c("Broadcast Message",i.jsx(nC,{onSend:ft=>{console.log("Broadcasting message:",ft),l("success","Message broadcasted to all dashboards"),u()}}),u);break;case"backup":const lt={submissions:t,clients:n,employees:o,timestamp:new Date().toISOString()},Pe=new Blob([JSON.stringify(lt,null,2)],{type:"application/json"}),at=URL.createObjectURL(Pe),qe=document.createElement("a");qe.href=at,qe.download=`dashboard-backup-${new Date().toISOString().split("T")[0]}.json`,qe.click(),l("success","Dashboard data backup downloaded");break;default:l("info",`${pe} action triggered for ${ee}`)}}catch(lt){l("error",`Failed to execute ${pe}: ${lt.message}`)}},Ie=pe=>{switch(pe){case"healthy":case"excellent":return"text-green-600 bg-green-100";case"good":case"syncing":return"text-yellow-600 bg-yellow-100";case"local":return"text-blue-600 bg-blue-100";case"needs-attention":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}};return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl shadow-lg text-white p-6",children:i.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold mb-2",children:"üéõÔ∏è Manager Control Panel"}),i.jsx("p",{className:"text-blue-100",children:"Centralized oversight and control of all connected dashboards"})]}),i.jsxs("div",{className:"flex flex-wrap gap-3",children:[i.jsxs("button",{onClick:()=>me(!ce),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${ce?"bg-white/30 hover:bg-white/40":"bg-white/20 hover:bg-white/30"}`,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),ce?"Hide":"Show"," Analytics"]}),i.jsxs("button",{onClick:()=>xe(!le),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${le?"bg-white/30 hover:bg-white/40":"bg-white/20 hover:bg-white/30"}`,children:[i.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),le?"Hide":"Show"," Configuration"]}),i.jsxs("button",{onClick:()=>Oe(!we),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${we?"bg-white/30 hover:bg-white/40":"bg-white/20 hover:bg-white/30"}`,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),we?"Hide":"Show"," Reports"]}),k("userManagement")&&i.jsxs("button",{onClick:()=>C(!ge),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${ge?"bg-white/30 hover:bg-white/40":"bg-white/20 hover:bg-white/30"}`,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),ge?"Hide":"Show"," Access Control"]}),i.jsxs("button",{onClick:()=>D(!O),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${O?"bg-white/30 hover:bg-white/40":"bg-white/20 hover:bg-white/30"}`,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5 5v-5zM4.868 19.718A10.001 10.001 0 0119.718 4.868M4.868 19.718L19.718 4.868"})}),O?"Hide":"Show"," Notifications",F&&F.filter(pe=>!pe.read).length>0&&i.jsx("span",{className:"ml-1 px-2 py-1 bg-red-500 text-white rounded-full text-xs",children:F.filter(pe=>!pe.read).length})]}),i.jsxs("button",{onClick:()=>{V(!M),R("view","audit_logs",{dashboard:"manager"})},className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${M?"bg-white/30 hover:bg-white/40":"bg-white/20 hover:bg-white/30"}`,children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),M?"Hide":"Show"," Audit Logs",i.jsx("span",{className:"ml-1 px-2 py-1 bg-blue-500 text-white rounded-full text-xs",children:T.length})]}),i.jsxs("button",{onClick:()=>Le("refresh","all"),className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh All"]}),i.jsxs("button",{onClick:()=>Le("broadcast","all"),className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})}),"Broadcast"]}),i.jsxs("button",{onClick:()=>Le("backup","all"),className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Backup"]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"üè• System Health"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Database"}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Ie(H.database)}`,children:H.database})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Data Sync"}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Ie(H.sync)}`,children:H.sync})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Performance"}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Ie(H.performance)}`,children:H.performance})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"üë• Active Users"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Employees"}),i.jsx("span",{className:"text-lg font-bold text-blue-600",children:A.employees})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Interns"}),i.jsx("span",{className:"text-lg font-bold text-orange-600",children:A.interns})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Agency Team"}),i.jsx("span",{className:"text-lg font-bold text-amber-600",children:A.agency})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"üìä Key Metrics"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Avg Performance"}),i.jsxs("span",{className:"text-lg font-bold text-green-600",children:[ye.averagePerformance.toFixed(1),"/10"]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Pending Reviews"}),i.jsx("span",{className:"text-lg font-bold text-red-600",children:ye.pendingReviews})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"System Uptime"}),i.jsx("span",{className:"text-lg font-bold text-blue-600",children:ye.systemUptime})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-6",children:[i.jsx(Ac,{title:"Employee Dashboard",icon:"üë•",color:"blue",stats:[{label:"Total Employees",value:ye.totalEmployees},{label:"Active This Month",value:ye.activeEmployees},{label:"Submissions",value:ye.currentMonthSubmissions}],onNavigate:()=>p("employee"),onQuickAction:pe=>Le(pe,"employee")}),i.jsx(Ac,{title:"Agency Dashboard",icon:"üöÄ",color:"amber",stats:[{label:"Active Users",value:A.agency},{label:"Total Clients",value:ye.totalClients},{label:"Active Clients",value:ye.activeClients}],onNavigate:()=>p("agency"),onQuickAction:pe=>Le(pe,"agency")}),i.jsx(Ac,{title:"Intern Dashboard",icon:"üéì",color:"orange",stats:[{label:"Active Interns",value:A.interns},{label:"Projects",value:12},{label:"Completion Rate",value:"85%"}],onNavigate:()=>p("intern"),onQuickAction:pe=>Le(pe,"intern")}),i.jsx(Ac,{title:"Manager Dashboard",icon:"‚ö°",color:"purple",stats:[{label:"Pending Reviews",value:ye.pendingReviews},{label:"Team Performance",value:`${ye.averagePerformance.toFixed(1)}/10`},{label:"Data Sync",value:ye.dataSync}],onNavigate:()=>p("manager"),onQuickAction:pe=>Le(pe,"manager")})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center text-white text-lg",children:"üè¢"}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Organization Chart"}),i.jsx("p",{className:"text-sm text-gray-600",children:"View department hierarchies"})]})]})}),i.jsxs("div",{className:"space-y-3 mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Total Employees"}),i.jsx("span",{className:"font-medium",children:ye.totalEmployees})]}),i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Active Employees"}),i.jsx("span",{className:"font-medium text-green-600",children:ye.activeEmployees})]})]}),i.jsx("button",{onClick:()=>d.navigateToOrganizationChart(),className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-2 px-4 rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-200 font-medium",children:"View Organization Chart"})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-teal-600 rounded-lg flex items-center justify-center text-white text-lg",children:"üìû"}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Employee Directory"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Contact information & WhatsApp"})]})]})}),i.jsxs("div",{className:"space-y-3 mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"With Phone Numbers"}),i.jsx("span",{className:"font-medium",children:o.filter(pe=>pe.phone).length})]}),i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"WhatsApp Ready"}),i.jsx("span",{className:"font-medium text-gray-900",children:o.filter(pe=>pe.phone&&pe.phone.length>8).length})]})]}),i.jsx("button",{onClick:()=>d.navigateToEmployeeDirectory(),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium",children:"View Employee Directory"})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center text-gray-600 text-lg",children:"üìä"}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Client Management"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Projects & satisfaction tracking"})]})]})}),i.jsxs("div",{className:"space-y-3 mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Total Clients"}),i.jsx("span",{className:"font-medium",children:ye.totalClients})]}),i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Active Projects"}),i.jsx("span",{className:"font-medium text-gray-900",children:ye.activeClients})]})]}),i.jsx("button",{onClick:()=>d.navigateToClientDirectory(),className:"w-full bg-gradient-to-r from-orange-500 to-red-600 text-white py-2 px-4 rounded-lg hover:from-orange-600 hover:to-red-700 transition-all duration-200 font-medium",children:"View Client Management"})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:["üîî Real-time Notifications",y>0&&i.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:y})]}),i.jsx("button",{onClick:I,className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear All"})]}),i.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:x.length===0?i.jsx("div",{className:"text-gray-500 text-center py-4",children:"No notifications"}):x.slice(0,10).map(pe=>i.jsx("div",{className:`p-3 rounded-lg border-l-4 ${pe.read?"bg-gray-50 border-gray-300":pe.type==="error"?"bg-red-50 border-red-400":pe.type==="warning"?"bg-yellow-50 border-yellow-400":"bg-blue-50 border-blue-400"}`,onClick:()=>j(pe.id),children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-medium text-sm",children:pe.title}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:pe.message}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(pe.timestamp).toLocaleTimeString()})]}),!pe.read&&i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full ml-2 mt-1"})]})},pe.id))})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"üìà Recent Activity"}),i.jsxs("div",{className:"space-y-3",children:[i.jsx(tl,{icon:"üìù",message:"New employee submission received",time:"2 minutes ago",type:"submission"}),i.jsx(tl,{icon:"üë•",message:"3 employees logged into their dashboards",time:"5 minutes ago",type:"login"}),i.jsx(tl,{icon:"üéì",message:"Intern completed project milestone",time:"12 minutes ago",type:"achievement"}),i.jsx(tl,{icon:"üöÄ",message:"Agency dashboard updated with new announcements",time:"18 minutes ago",type:"update"}),i.jsx(tl,{icon:"‚ö°",message:"Manager reviewed 2 employee submissions",time:"25 minutes ago",type:"review"})]})]}),ce&&i.jsx("div",{className:"mt-6",children:i.jsx(K8,{})}),le&&i.jsx("div",{className:"mt-6",children:i.jsx(Y8,{})}),we&&i.jsx("div",{className:"mt-6",children:i.jsx(Z8,{})}),ge&&k("userManagement")&&i.jsx("div",{className:"mt-6",children:i.jsx(Q8,{})}),O&&i.jsx("div",{className:"mt-6",children:i.jsx(Gv,{})}),M&&i.jsx("div",{className:"mt-6",children:i.jsx(Kv,{})})]})}function Ac({title:r,icon:e,color:t,stats:n,onNavigate:a,onQuickAction:s}){const o={blue:"border-blue-200 bg-blue-50",amber:"border-amber-200 bg-amber-50",orange:"border-orange-200 bg-orange-50",purple:"border-purple-200 bg-purple-50"},l={blue:"bg-blue-600 hover:bg-blue-700",amber:"bg-amber-600 hover:bg-amber-700",orange:"bg-orange-600 hover:bg-orange-700",purple:"bg-purple-600 hover:bg-purple-700"};return i.jsxs("div",{className:`bg-white rounded-xl shadow-sm border-2 ${o[t]} p-6`,children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-2xl",children:e}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r})]})}),i.jsx("div",{className:"space-y-2 mb-4",children:n.map((c,u)=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:c.label}),i.jsx("span",{className:"text-sm font-semibold text-gray-900",children:c.value})]},u))}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:a,className:`flex-1 px-3 py-2 ${l[t]} text-white rounded-lg text-sm font-medium transition-colors`,children:"Open"}),i.jsx("button",{onClick:()=>s("monitor"),className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-colors",children:"Monitor"})]})]})}function tl({icon:r,message:e,time:t,type:n}){const a={submission:"text-blue-600",login:"text-green-600",achievement:"text-orange-600",update:"text-amber-600",review:"text-purple-600"};return i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[i.jsx("span",{className:"text-lg",children:r}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm text-gray-900",children:e}),i.jsx("p",{className:`text-xs ${a[n]}`,children:t})]})]})}function nC({onSend:r}){const[e,t]=E.useState(""),[n,a]=E.useState("normal"),[s,o]=E.useState(["all"]),l=()=>{e.trim()&&r({message:e,priority:n,targets:s,timestamp:new Date().toISOString()})};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),i.jsx("textarea",{value:e,onChange:c=>t(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4,placeholder:"Enter your message to broadcast to all dashboards..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),i.jsxs("select",{value:n,onChange:c=>a(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"normal",children:"Normal"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]})]}),i.jsx("div",{className:"flex justify-end gap-3",children:i.jsx("button",{onClick:l,disabled:!e.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:"Send Broadcast"})})]})}const un={PENDING:"pending",APPROVED:"approved",REJECTED:"rejected"},aC={[un.PENDING]:"bg-yellow-100 text-yellow-800 border-yellow-200",[un.APPROVED]:"bg-green-100 text-green-800 border-green-200",[un.REJECTED]:"bg-red-100 text-red-800 border-red-200"},sC={[un.PENDING]:"‚è≥",[un.APPROVED]:"‚úÖ",[un.REJECTED]:"‚ùå"};function iC(){const r=ha(),{notify:e}=Fn(),{openModal:t,closeModal:n}=bo(),{refreshEmployees:a}=Al(),[s,o]=E.useState([]),[l,c]=E.useState(!0),[u,d]=E.useState("all"),[p,g]=E.useState(""),h=E.useCallback(async()=>{c(!0);try{if(r){const{data:_,error:S}=await r.from("employee_signups").select("*").order("submitted_at",{ascending:!1});if(S)throw S;o(_||[])}else{const _=JSON.parse(localStorage.getItem("employee_signups")||"[]");o(_.sort((S,j)=>new Date(j.submitted_at)-new Date(S.submitted_at)))}}catch(_){console.error("Error loading signups:",_),e("Failed to load signup applications","error")}finally{c(!1)}},[r,e]);E.useEffect(()=>{h()},[h]);const b=s.filter(_=>{const S=u==="all"||_.status===u,j=!p||_.name.toLowerCase().includes(p.toLowerCase())||_.email.toLowerCase().includes(p.toLowerCase())||_.department.toLowerCase().includes(p.toLowerCase());return S&&j}),x=E.useCallback(async _=>{t({title:"‚úÖ Approve Application",content:i.jsx(gp,{signup:_,action:"approve",onSubmit:async S=>{try{if(r){await r.from("employee_signups").update({status:un.APPROVED,hr_notes:S.hrNotes,reviewed_at:new Date().toISOString(),reviewed_by:"HR Team"}).eq("id",_.id);const j={name:_.name,email:_.email,phone:_.phone,department:_.department,role:_.role.join(", "),status:"active",hire_date:S.startDate||_.expectedJoinDate,address:`${_.address.street}, ${_.address.city}, ${_.address.state} ${_.address.zipCode}`,emergency_contact:`${_.emergencyContact.name} (${_.emergencyContact.relationship}) - ${_.emergencyContact.phone}`,notes:`Approved from signup. Education: ${_.education}. Experience: ${_.experience}.`};await r.from("employees").insert([j]),await r.from("notifications").insert([{type:"employee_approved",title:"Application Approved",message:`${_.name}'s employee application has been approved. Welcome to the team!`,data:{applicantEmail:_.email,startDate:S.startDate},created_at:new Date().toISOString()}])}else{const I=JSON.parse(localStorage.getItem("employee_signups")||"[]").map(k=>k.id===_.id?{...k,status:un.APPROVED,hr_notes:S.hrNotes,reviewed_at:new Date().toISOString()}:k);localStorage.setItem("employee_signups",JSON.stringify(I));const J=JSON.parse(localStorage.getItem("employees")||"[]");J.push({id:Date.now().toString(),name:_.name,email:_.email,phone:_.phone,department:_.department,role:_.role.join(", "),status:"active",hire_date:S.startDate||_.expectedJoinDate}),localStorage.setItem("employees",JSON.stringify(J))}await h(),await a(),n(),e(`${_.name}'s application has been approved!`,"success")}catch(j){console.error("Error approving application:",j),e("Failed to approve application","error")}}})})},[r,t,n,e,h,a]),y=E.useCallback(async _=>{t({title:"‚ùå Reject Application",content:i.jsx(gp,{signup:_,action:"reject",onSubmit:async S=>{try{if(r)await r.from("employee_signups").update({status:un.REJECTED,hr_notes:S.hrNotes,reviewed_at:new Date().toISOString(),reviewed_by:"HR Team"}).eq("id",_.id),await r.from("notifications").insert([{type:"employee_rejected",title:"Application Status Update",message:`${_.name}'s employee application has been reviewed.`,data:{applicantEmail:_.email,reason:S.hrNotes},created_at:new Date().toISOString()}]);else{const I=JSON.parse(localStorage.getItem("employee_signups")||"[]").map(J=>J.id===_.id?{...J,status:un.REJECTED,hr_notes:S.hrNotes,reviewed_at:new Date().toISOString()}:J);localStorage.setItem("employee_signups",JSON.stringify(I))}await h(),n(),e(`${_.name}'s application has been rejected`,"info")}catch(j){console.error("Error rejecting application:",j),e("Failed to reject application","error")}}})})},[r,t,n,e,h]),v=E.useCallback(_=>{t({title:`üìã Application Details - ${_.name}`,content:i.jsx(oC,{signup:_}),size:"large"})},[t]);return l?i.jsxs("div",{className:"flex items-center justify-center h-64",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-2 text-gray-600",children:"Loading applications..."})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"HR Approval Workflow"}),i.jsx("p",{className:"text-gray-600",children:"Review and manage employee signup applications"})]}),i.jsx("div",{className:"flex items-center space-x-4",children:i.jsx("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"üîÑ Refresh"})})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsx("div",{className:"flex-1",children:i.jsx(xi,{label:"Search Applications",value:p,onChange:g,placeholder:"Search by name, email, or department..."})}),i.jsxs("div",{className:"sm:w-48",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Status"}),i.jsxs("select",{value:u,onChange:_=>d(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"All Applications"}),i.jsx("option",{value:un.PENDING,children:"Pending Review"}),i.jsx("option",{value:un.APPROVED,children:"Approved"}),i.jsx("option",{value:un.REJECTED,children:"Rejected"})]})]})]})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{label:"Total Applications",value:s.length,color:"bg-blue-500"},{label:"Pending Review",value:s.filter(_=>_.status===un.PENDING).length,color:"bg-yellow-500"},{label:"Approved",value:s.filter(_=>_.status===un.APPROVED).length,color:"bg-green-500"},{label:"Rejected",value:s.filter(_=>_.status===un.REJECTED).length,color:"bg-red-500"}].map((_,S)=>i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${_.color} mr-3`}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:_.label}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:_.value})]})]})},S))}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:b.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-6xl mb-4",children:"üìã"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No applications found"}),i.jsx("p",{className:"text-gray-600",children:p||u!=="all"?"Try adjusting your search or filter criteria":"No employee signup applications have been submitted yet"})]}):i.jsx("div",{className:"divide-y divide-gray-200",children:b.map(_=>i.jsx("div",{className:"p-6 hover:bg-gray-50",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:_.name}),i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${aC[_.status]}`,children:[sC[_.status]," ",_.status.charAt(0).toUpperCase()+_.status.slice(1)]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Email:"})," ",_.email]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Department:"})," ",_.department]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Role(s):"})," ",Array.isArray(_.role)?_.role.join(", "):_.role]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Expected Join:"})," ",new Date(_.expectedJoinDate).toLocaleDateString()]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Submitted:"})," ",new Date(_.submitted_at).toLocaleDateString()]}),_.reviewed_at&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Reviewed:"})," ",new Date(_.reviewed_at).toLocaleDateString()]})]}),_.hr_notes&&i.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:i.jsxs("p",{className:"text-sm text-gray-700",children:[i.jsx("span",{className:"font-medium",children:"HR Notes:"})," ",_.hr_notes]})})]}),i.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[i.jsx("button",{onClick:()=>v(_),className:"px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:"View Details"}),_.status===un.PENDING&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>x(_),className:"px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700",children:"‚úÖ Approve"}),i.jsx("button",{onClick:()=>y(_),className:"px-3 py-1 text-sm bg-red-600 text-white rounded-md hover:bg-red-700",children:"‚ùå Reject"})]})]})]})},_.id))})})]})}function gp({signup:r,action:e,onSubmit:t}){const{notify:n}=Fn(),[a,s]=E.useState({hrNotes:"",startDate:e==="approve"?r.expectedJoinDate:""}),[o,l]=E.useState(!1),c=async u=>{if(u.preventDefault(),!a.hrNotes.trim()){n({type:"error",title:"Validation Error",message:"Please provide HR notes"});return}l(!0);try{await t(a)}finally{l(!1)}};return i.jsxs("form",{onSubmit:c,className:"space-y-4",children:[i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Application Summary"}),i.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",r.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Email:"})," ",r.email]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Department:"})," ",r.department]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Role(s):"})," ",Array.isArray(r.role)?r.role.join(", "):r.role]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Expected Join Date:"})," ",new Date(r.expectedJoinDate).toLocaleDateString()]})]})]}),e==="approve"&&i.jsx(xi,{label:"Start Date",type:"date",value:a.startDate,onChange:u=>s(d=>({...d,startDate:u})),required:!0}),i.jsx(la,{label:e==="approve"?"Approval Notes":"Rejection Reason",value:a.hrNotes,onChange:u=>s(d=>({...d,hrNotes:u})),placeholder:e==="approve"?"Add any notes for the new employee, onboarding instructions, etc.":"Please provide a reason for rejection that will be communicated to the applicant",rows:4,required:!0}),i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:()=>window.closeModal&&window.closeModal(),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:o,className:`px-4 py-2 rounded-md text-white disabled:opacity-50 ${e==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:o?"Processing...":e==="approve"?"Approve Application":"Reject Application"})]})]})}function oC({signup:r}){var e,t,n,a,s,o,l,c,u;return i.jsxs("div",{className:"space-y-6 max-h-96 overflow-y-auto",children:[i.jsx(en,{title:"Personal Information",icon:"üë§",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",r.name]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Email:"})," ",r.email]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",r.phone]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Date of Birth:"})," ",r.dateOfBirth?new Date(r.dateOfBirth).toLocaleDateString():"Not provided"]})]})}),i.jsx(en,{title:"Address",icon:"üìç",children:i.jsxs("div",{className:"text-sm",children:[i.jsx("p",{children:(e=r.address)==null?void 0:e.street}),i.jsxs("p",{children:[(t=r.address)==null?void 0:t.city,", ",(n=r.address)==null?void 0:n.state," ",(a=r.address)==null?void 0:a.zipCode]}),i.jsx("p",{children:(s=r.address)==null?void 0:s.country})]})}),i.jsx(en,{title:"Emergency Contact",icon:"üö®",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",(o=r.emergencyContact)==null?void 0:o.name]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Relationship:"})," ",(l=r.emergencyContact)==null?void 0:l.relationship]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",(c=r.emergencyContact)==null?void 0:c.phone]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Email:"})," ",(u=r.emergencyContact)==null?void 0:u.email]})]})}),i.jsx(en,{title:"Professional Information",icon:"üíº",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Department:"})," ",r.department]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Role(s):"})," ",Array.isArray(r.role)?r.role.join(", "):r.role]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Expected Join Date:"})," ",new Date(r.expectedJoinDate).toLocaleDateString()]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Expected Salary:"})," ",r.expectedSalary||"Not specified"]})]})}),i.jsx(en,{title:"Education & Experience",icon:"üéì",children:i.jsxs("div",{className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Education:"}),i.jsx("p",{className:"mt-1 text-gray-600",children:r.education})]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Experience:"}),i.jsx("p",{className:"mt-1 text-gray-600",children:r.experience})]}),r.skills&&r.skills.length>0&&i.jsxs("div",{children:[i.jsx("strong",{children:"Skills:"}),i.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:r.skills.map((d,p)=>i.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:d},p))})]}),r.certifications&&i.jsxs("div",{children:[i.jsx("strong",{children:"Certifications:"}),i.jsx("p",{className:"mt-1 text-gray-600",children:r.certifications})]})]})}),i.jsx(en,{title:"Additional Information",icon:"üîó",children:i.jsxs("div",{className:"space-y-4 text-sm",children:[r.portfolioUrl&&i.jsxs("div",{children:[i.jsx("strong",{children:"Portfolio:"}),i.jsx("a",{href:r.portfolioUrl,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-blue-600 hover:underline",children:r.portfolioUrl})]}),r.linkedinUrl&&i.jsxs("div",{children:[i.jsx("strong",{children:"LinkedIn:"}),i.jsx("a",{href:r.linkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-blue-600 hover:underline",children:r.linkedinUrl})]}),r.githubUrl&&i.jsxs("div",{children:[i.jsx("strong",{children:"GitHub:"}),i.jsx("a",{href:r.githubUrl,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-blue-600 hover:underline",children:r.githubUrl})]}),r.coverLetter&&i.jsxs("div",{children:[i.jsx("strong",{children:"Cover Letter:"}),i.jsx("p",{className:"mt-1 text-gray-600",children:r.coverLetter})]})]})})]})}async function lC(r,e,t,n=""){if(!r){console.log("No Supabase client available - using local storage");const s=JSON.parse(localStorage.getItem("employee_exits")||"[]").map(o=>o.id===e?{...o,status:t,hr_notes:n,updated_at:new Date().toISOString()}:o);return localStorage.setItem("employee_exits",JSON.stringify(s)),s.find(o=>o.id===e)}try{const{data:a,error:s}=await r.from("employee_exits").update({status:t,hr_notes:n,updated_at:new Date().toISOString()}).eq("id",e).select("*").single();if(s)throw s;return console.log("‚úÖ Employee exit status updated:",a.employee_name,t),a}catch(a){throw console.error("Error updating employee exit status:",a),a}}async function P2(r){if(!r)return console.log("No Supabase client available - using local storage"),JSON.parse(localStorage.getItem("employee_exits")||"[]");try{const{data:e,error:t}=await r.from("employee_exits").select("*").order("created_at",{ascending:!1});if(t){if(t.code==="PGRST205")return console.log("Employee exits table does not exist"),[];throw t}return e||[]}catch(e){return console.error("Error fetching employee exits:",e),[]}}async function cC(r){const e=await P2(r);return{total:e.length,pending:e.filter(n=>n.status==="pending").length,approved:e.filter(n=>n.status==="approved").length,completed:e.filter(n=>n.status==="completed").length,thisMonth:e.filter(n=>{const a=new Date(n.created_at),s=new Date;return a.getMonth()===s.getMonth()&&a.getFullYear()===s.getFullYear()}).length}}const uC={pending:"bg-gray-100 text-gray-800 border-gray-200",approved:"bg-gray-100 text-gray-800 border-gray-200",completed:"bg-gray-100 text-gray-800 border-gray-200"},dC={pending:"‚è≥",approved:"‚úÖ",completed:"üéØ"};function hC(){const r=ha(),{notify:e}=Fn(),{openModal:t,closeModal:n}=bo(),{refreshEmployees:a}=Al(),[s,o]=E.useState([]),[l,c]=E.useState([]),[u,d]=E.useState(!0),[p,g]=E.useState({total:0,pending:0,approved:0,completed:0,thisMonth:0}),[h,b]=E.useState("all"),[x,y]=E.useState(""),[v,_]=E.useState(null),S=E.useCallback(async()=>{try{d(!0);const[F,T]=await Promise.all([P2(r),cC(r)]);o(F),g(T)}catch(F){console.error("Error loading exit records:",F),e("Failed to load exit records","error")}finally{d(!1)}},[r,e]);E.useEffect(()=>{S()},[S]),E.useEffect(()=>{let F=s;if(h!=="all"&&(F=F.filter(T=>T.status===h)),x){const T=x.toLowerCase();F=F.filter(R=>R.employee_name.toLowerCase().includes(T)||R.department.toLowerCase().includes(T)||R.exit_reason.toLowerCase().includes(T))}c(F)},[s,h,x]);const j=E.useCallback(async(F,T,R="")=>{try{if(await lC(r,F,T,R),T==="approved"||T==="completed"){const A=s.find(P=>P.id===F);if(A&&r){const H={status:T==="completed"?"Inactive":"Exiting",updated_at:new Date().toISOString()};(T==="completed"||new Date(A.last_working_day)<=new Date)&&(H.departure_date=A.last_working_day),await r.from("employees").update(H).eq("name",A.employee_name).eq("phone",A.employee_phone)}}await S(),a&&await a(),e(`Exit request ${T} successfully`,"success")}catch(A){console.error("Error updating exit status:",A),e("Failed to update exit status","error")}},[r,s,S,a,e]),I=E.useCallback(F=>{_(F),t({title:`Exit Details - ${F.employee_name}`,content:i.jsxs("div",{className:"space-y-6 max-h-96 overflow-y-auto",children:[i.jsx(en,{title:"Employee Information",icon:"üë§",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Name:"}),i.jsx("p",{className:"text-gray-900",children:F.employee_name})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Department:"}),i.jsx("p",{className:"text-gray-900",children:F.department})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Phone:"}),i.jsx("p",{className:"text-gray-900",children:F.employee_phone})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Role:"}),i.jsx("p",{className:"text-gray-900",children:Array.isArray(F.role)?F.role.join(", "):F.role})]})]})}),i.jsx(en,{title:"Exit Information",icon:"üìã",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Reason:"}),i.jsx("p",{className:"text-gray-900",children:F.exit_reason}),F.custom_reason&&i.jsx("p",{className:"text-gray-600 text-xs mt-1",children:F.custom_reason})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Last Working Day:"}),i.jsx("p",{className:"text-gray-900",children:new Date(F.last_working_day).toLocaleDateString()})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Notice Period:"}),i.jsxs("p",{className:"text-gray-900",children:[F.notice_period," days"]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Immediate Exit:"}),i.jsx("p",{className:"text-gray-900",children:F.immediate_exit?"Yes":"No"})]})]})}),F.overall_experience&&i.jsx(en,{title:"Exit Interview",icon:"üí¨",children:i.jsxs("div",{className:"space-y-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Overall Experience:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:F.overall_experience})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Reason for Leaving:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:F.reason_for_leaving})]}),F.improvement_suggestions&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Improvement Suggestions:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:F.improvement_suggestions})]}),F.would_recommend_company&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Would Recommend Company:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:F.would_recommend_company})]})]})}),i.jsxs(en,{title:"Asset Return",icon:"üíº",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${F.laptop_returned,"bg-gray-500"}`}),i.jsxs("span",{children:["Laptop: ",F.laptop_returned?"Returned":"Pending"]})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${F.access_cards_returned,"bg-gray-500"}`}),i.jsxs("span",{children:["Access Cards: ",F.access_cards_returned?"Returned":"Pending"]})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${F.documents_returned,"bg-gray-500"}`}),i.jsxs("span",{children:["Documents: ",F.documents_returned?"Returned":"Pending"]})]})]}),F.other_assets&&i.jsxs("div",{className:"mt-3",children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Other Assets:"}),i.jsx("p",{className:"text-gray-900 text-sm mt-1",children:F.other_assets})]})]}),F.handover_notes&&i.jsx(en,{title:"Handover",icon:"üîÑ",children:i.jsxs("div",{className:"space-y-3 text-sm",children:[F.handover_to&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Handover To:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:F.handover_to})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Handover Notes:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:F.handover_notes})]}),F.pending_tasks&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Pending Tasks:"}),i.jsx("p",{className:"text-gray-900 mt-1",children:F.pending_tasks})]})]})}),F.hr_notes&&i.jsx(en,{title:"HR Notes",icon:"üìù",children:i.jsx("p",{className:"text-gray-900 text-sm",children:F.hr_notes})})]}),actions:[{label:"Close",onClick:n,variant:"secondary"}]})},[t,n]),J=E.useCallback(F=>{t({title:"Approve Exit Request",content:i.jsxs("div",{children:[i.jsxs("p",{className:"text-gray-700 mb-4",children:["Are you sure you want to approve the exit request for ",i.jsx("strong",{children:F.employee_name}),"?"]}),i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"This will:"}),i.jsxs("ul",{className:"text-sm text-gray-800 space-y-1",children:[i.jsx("li",{children:'‚Ä¢ Change employee status to "Exiting"'}),i.jsx("li",{children:"‚Ä¢ Initiate the handover process"}),i.jsx("li",{children:"‚Ä¢ Begin asset return coordination"}),i.jsxs("li",{children:["‚Ä¢ Set departure date: ",new Date(F.last_working_day).toLocaleDateString()]})]})]})]}),actions:[{label:"Cancel",onClick:n,variant:"secondary"},{label:"Approve",onClick:()=>{j(F.id,"approved"),n()},variant:"primary"}]})},[t,n,j]),k=E.useCallback(F=>{t({title:"Complete Exit Process",content:i.jsxs("div",{children:[i.jsxs("p",{className:"text-gray-700 mb-4",children:["Mark the exit process as completed for ",i.jsx("strong",{children:F.employee_name}),"?"]}),i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"This will:"}),i.jsxs("ul",{className:"text-sm text-gray-800 space-y-1",children:[i.jsx("li",{children:'‚Ä¢ Change employee status to "Inactive"'}),i.jsx("li",{children:"‚Ä¢ Set final departure date"}),i.jsx("li",{children:"‚Ä¢ Complete the exit workflow"}),i.jsx("li",{children:"‚Ä¢ Archive the employee record"})]})]})]}),actions:[{label:"Cancel",onClick:n,variant:"secondary"},{label:"Complete",onClick:()=>{j(F.id,"completed"),n()},variant:"primary"}]})},[t,n,j]);return u?i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-2 text-gray-600",children:"Loading exit records..."})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[i.jsx("div",{className:"bg-white rounded-lg border p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:i.jsx("span",{className:"text-lg",children:"üìä"})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Exits"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.total})]})]})}),i.jsx("div",{className:"bg-white rounded-lg border p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:i.jsx("span",{className:"text-lg",children:"‚è≥"})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),i.jsx("p",{className:"text-2xl font-bold text-gray-600",children:p.pending})]})]})}),i.jsx("div",{className:"bg-white rounded-lg border p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:i.jsx("span",{className:"text-lg",children:"‚úÖ"})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Approved"}),i.jsx("p",{className:"text-2xl font-bold text-gray-600",children:p.approved})]})]})}),i.jsx("div",{className:"bg-white rounded-lg border p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:i.jsx("span",{className:"text-lg",children:"üéØ"})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completed"}),i.jsx("p",{className:"text-2xl font-bold text-gray-600",children:p.completed})]})]})}),i.jsx("div",{className:"bg-white rounded-lg border p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:i.jsx("span",{className:"text-lg",children:"üìÖ"})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"This Month"}),i.jsx("p",{className:"text-2xl font-bold text-gray-600",children:p.thisMonth})]})]})})]}),i.jsx("div",{className:"bg-white rounded-lg border p-4",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[i.jsx("div",{className:"flex flex-wrap gap-2",children:["all","pending","approved","completed"].map(F=>i.jsxs("button",{onClick:()=>b(F),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${h===F?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[F==="all"?"All":F.charAt(0).toUpperCase()+F.slice(1),F!=="all"&&i.jsxs("span",{className:"ml-1 text-xs",children:["(",F==="pending"?p.pending:F==="approved"?p.approved:p.completed,")"]})]},F))}),i.jsx("div",{className:"w-full sm:w-auto",children:i.jsx("input",{type:"text",placeholder:"Search by name, department, or reason...",value:x,onChange:F=>y(F.target.value),className:"w-full sm:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})})]})}),i.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Exit Records (",l.length,")"]})}),l.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-6xl mb-4",children:"üìã"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No exit records found"}),i.jsx("p",{className:"text-gray-600",children:x||h!=="all"?"Try adjusting your filters or search terms":"No employee exit requests have been submitted yet"})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Exit Reason"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Working Day"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(F=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:F.employee_name}),i.jsx("div",{className:"text-sm text-gray-500",children:F.employee_phone})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F.department}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F.exit_reason}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(F.last_working_day).toLocaleDateString()}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${uC[F.status]}`,children:[i.jsx("span",{className:"mr-1",children:dC[F.status]}),F.status.charAt(0).toUpperCase()+F.status.slice(1)]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[i.jsx("button",{onClick:()=>I(F),className:"text-blue-600 hover:text-blue-900",children:"View"}),F.status==="pending"&&i.jsx("button",{onClick:()=>J(F),className:"text-green-600 hover:text-green-900",children:"Approve"}),F.status==="approved"&&i.jsx("button",{onClick:()=>k(F),className:"text-purple-600 hover:text-purple-900",children:"Complete"})]})]},F.id))})]})})]})]})}const fC=({options:r=[],value:e="",onChange:t,onInputChange:n,placeholder:a="Type to search...",disabled:s=!1,searchable:o=!0,creatable:l=!1,isLoading:c=!1,className:u="",error:d=null,warning:p=null,label:g=null,required:h=!1,onCreateNew:b=null})=>{const[x,y]=E.useState(!1),[v,_]=E.useState(""),[S,j]=E.useState(-1),I=E.useRef(null),J=E.useRef(null),k=E.useRef(null),F=!!d,T=!!p&&!F,R=o&&v?r.filter(le=>(typeof le=="string"?le:le.label||le.value||"").toLowerCase().includes(v.toLowerCase())):r,P=l&&v&&!R.some(le=>(typeof le=="string"?le:le.label||le.value||"").toLowerCase()===v.toLowerCase())?[...R,{isCreateOption:!0,label:`Create "${v}"`,value:v}]:R,H=E.useCallback(le=>{const xe=le.target.value;_(xe),j(-1),n&&n(xe),x||y(!0)},[n,x]),K=E.useCallback(le=>{if(!s){if(le.isCreateOption)b&&b(le.value),_(le.value),t&&t(le.value);else{const xe=typeof le=="string"?le:le.value,we=typeof le=="string"?le:le.label||le.value;_(we),t&&t(xe)}y(!1),j(-1)}},[s,t,b]),ce=E.useCallback(le=>{var xe;if(!s)switch(le.key){case"ArrowDown":le.preventDefault(),x?j(we=>we<P.length-1?we+1:0):y(!0);break;case"ArrowUp":le.preventDefault(),x&&j(we=>we>0?we-1:P.length-1);break;case"Enter":le.preventDefault(),x&&S>=0&&P[S]?K(P[S]):x&&P.length===1&&K(P[0]);break;case"Escape":y(!1),j(-1),(xe=J.current)==null||xe.blur();break;case"Tab":y(!1),j(-1);break}},[s,x,S,P,K]),me=E.useCallback(()=>{!s&&o&&y(!0)},[s,o]);return E.useEffect(()=>{const le=xe=>{I.current&&!I.current.contains(xe.target)&&(y(!1),j(-1))};return document.addEventListener("mousedown",le),()=>document.removeEventListener("mousedown",le)},[]),E.useEffect(()=>{e!==v&&_(e||"")},[e]),E.useEffect(()=>{if(S>=0&&k.current){const le=k.current.children[S];le&&le.scrollIntoView({block:"nearest",behavior:"smooth"})}},[S]),i.jsxs("div",{className:`relative ${u}`,ref:I,children:[g&&i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[g,h&&i.jsx("span",{className:"text-red-500 ml-1",children:"*"}),F&&i.jsxs("span",{className:"ml-2 flex items-center gap-1 text-red-600 text-xs font-medium",children:[i.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"!"}),"Required"]}),T&&i.jsxs("span",{className:"ml-2 flex items-center gap-1 text-amber-600 text-xs font-medium",children:[i.jsx("div",{className:"w-3 h-3 bg-amber-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"‚ö†"}),"Warning"]})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{ref:J,type:"text",value:v,onChange:H,onKeyDown:ce,onFocus:me,placeholder:a,disabled:s||c,className:`w-full border rounded-xl p-3 focus:ring-2 transition-all duration-200 ${F?"border-red-300 focus:ring-red-500 focus:border-red-500 bg-red-50":T?"border-amber-300 focus:ring-amber-500 focus:border-amber-500 bg-amber-50":s||c?"bg-gray-100 text-gray-500 cursor-not-allowed border-gray-300":"border-gray-300 hover:border-gray-400 bg-white focus:ring-blue-500 focus:border-blue-500"}`,autoComplete:"off"}),c&&i.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),x&&!s&&!c&&P.length>0&&i.jsx("ul",{ref:k,className:"absolute z-50 w-full bg-white border border-gray-300 rounded-xl mt-1 max-h-60 overflow-y-auto shadow-lg",role:"listbox",children:P.map((le,xe)=>{const we=xe===S,Oe=le.isCreateOption,ge=typeof le=="string"?le:le.label||le.value;return i.jsxs("li",{onClick:()=>K(le),className:`p-3 cursor-pointer transition-all duration-150 ${we?"bg-blue-100 text-blue-900":"text-gray-900 hover:bg-blue-50"} ${Oe?"border-t border-gray-200 bg-green-50 hover:bg-green-100 text-green-800 font-medium":""}`,role:"option","aria-selected":we,children:[Oe&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-green-600",children:"+"}),i.jsx("span",{children:ge})]}),!Oe&&ge]},Oe?`create-${le.value}`:typeof le=="string"?le:le.value||xe)})}),x&&!s&&!c&&P.length===0&&v&&i.jsx("div",{className:"absolute z-50 w-full bg-white border border-gray-300 rounded-xl mt-1 p-3 text-gray-500 text-center shadow-lg",children:"No options found"})]}),F&&i.jsx("div",{className:"mt-2 p-2 bg-red-100 border border-red-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-red-700 flex items-start gap-2",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mt-2 flex-shrink-0"}),d]})}),T&&i.jsx("div",{className:"mt-2 p-2 bg-amber-100 border border-amber-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-amber-700 flex items-start gap-2",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mt-2 flex-shrink-0"}),p]})})]})},mC=({value:r="",onChange:e,onEmployeeSelect:t,placeholder:n="Select or type employee name...",allowCreate:a=!0,disabled:s=!1,className:o="",label:l="Employee",required:c=!1})=>{const{employees:u,loading:d,getEmployeeOptions:p,findEmployeeByIdentity:g,addEmployee:h}=Al(),[b,x]=E.useState(""),[y,v]=E.useState(null),[_,S]=E.useState(!1),j=p(),I=j.filter(T=>T.label.toLowerCase().includes(b.toLowerCase())||T.name.toLowerCase().includes(b.toLowerCase())),J=E.useCallback(T=>{if(!T){v(null),t&&t(null),e&&e("");return}const[R,A]=T.split("|"),P=g(R,A);P&&(v(P),x(P.name),t&&t(P),e&&e(P.name))},[g,t,e]),k=E.useCallback(T=>{x(T),e&&e(T);const R=u.find(A=>A.name.toLowerCase()===T.toLowerCase());R?(v(R),t&&t(R)):(v(null),t&&t(null))},[u,e,t]),F=E.useCallback(async T=>{if(!a||!T.trim())return null;S(!0);try{const R=await h({name:T.trim(),department:"Unassigned",role:"Employee",status:"Active"});return R&&(v(R),x(R.name),t&&t(R),e&&e(R.name)),R}catch(R){return console.error("Error creating employee:",R),null}finally{S(!1)}},[a,h,t,e]);return E.useEffect(()=>{r!==b&&x(r||"")},[r]),E.useEffect(()=>{if(b&&!y){const T=u.find(R=>R.name.toLowerCase()===b.toLowerCase());T&&(v(T),t&&t(T))}},[b,y,u,t]),i.jsxs("div",{className:`space-y-2 ${o}`,children:[l&&i.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[l,c&&i.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(fC,{options:I,value:y?y.name:"",onChange:T=>{if(typeof T=="string"&&!j.find(R=>R.value===T))a&&F(T);else{const R=j.find(A=>A.value===T||A.label===T);R&&J(R.value)}},onInputChange:k,placeholder:n,disabled:s||d,searchable:!0,creatable:a,isLoading:d||_,className:"w-full",onCreateNew:a?F:void 0}),y&&i.jsx("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-blue-900",children:y.name}),i.jsxs("p",{className:"text-xs text-blue-700",children:[y.department," ‚Ä¢ ",y.phone]}),y.role&&y.role.length>0&&i.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Roles: ",Array.isArray(y.role)?y.role.join(", "):y.role]})]}),i.jsx("div",{className:"text-xs text-blue-500",children:"Auto-populated"})]})}),b&&!y&&a&&i.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded-md",children:i.jsxs("p",{className:"text-xs text-yellow-700",children:['üí° New employee "',b,'" will be created when form is submitted']})})]})]})},pC=["Resignation - Better Opportunity","Resignation - Personal Reasons","Resignation - Career Change","Resignation - Relocation","Resignation - Health Issues","Resignation - Family Reasons","Termination - Performance","Termination - Misconduct","Termination - Redundancy","Retirement","End of Contract","Other"],gC={PENDING:"pending"};function xC({selectedEmployee:r=null,onClose:e,onSuccess:t}){const n=ha(),{notify:a}=Fn(),{openModal:s,closeModal:o}=bo(),{refreshEmployees:l}=Al(),[c,u]=E.useState({employeeId:(r==null?void 0:r.id)||"",employeeName:(r==null?void 0:r.name)||"",employeePhone:(r==null?void 0:r.phone)||"",department:(r==null?void 0:r.department)||"",role:(r==null?void 0:r.role)||[],exitReason:"",customReason:"",lastWorkingDay:"",noticePeriod:"30",immediateExit:!1,overallExperience:"",reasonForLeaving:"",workEnvironmentFeedback:"",managementFeedback:"",improvementSuggestions:"",wouldRecommendCompany:"",assetsToReturn:[],laptopReturned:!1,accessCardsReturned:!1,documentsReturned:!1,otherAssets:"",handoverNotes:"",handoverTo:"",pendingTasks:"",clientHandover:"",finalSettlement:"",hrNotes:"",managerApproval:!1,hrApproval:!1,status:gC.PENDING}),[d,p]=E.useState(!1),[g,h]=E.useState({}),[b,x]=E.useState(1),y=[{id:1,title:"Employee & Exit Details",icon:"üë§",description:"Basic exit information"},{id:2,title:"Exit Interview",icon:"üí¨",description:"Feedback and experience"},{id:3,title:"Asset Return",icon:"üíº",description:"Company assets and equipment"},{id:4,title:"Handover",icon:"üîÑ",description:"Knowledge and task transfer"},{id:5,title:"HR Processing",icon:"‚úÖ",description:"Final approvals and settlement"}],v=E.useCallback((k,F)=>{u(T=>{if(k.includes(".")){const[R,A]=k.split(".");return{...T,[R]:{...T[R],[A]:F}}}return{...T,[k]:F}}),g[k]&&h(T=>({...T,[k]:void 0}))},[g]),_=E.useCallback(k=>{const F={};return k===1&&(c.employeeName||(F.employeeName="Employee name is required"),c.exitReason||(F.exitReason="Exit reason is required"),c.exitReason==="Other"&&!c.customReason&&(F.customReason="Please specify the reason"),c.lastWorkingDay||(F.lastWorkingDay="Last working day is required")),k===2&&(c.overallExperience||(F.overallExperience="Overall experience is required"),c.reasonForLeaving||(F.reasonForLeaving="Reason for leaving is required")),F},[c]),S=E.useCallback(()=>{const k=_(b);if(Object.keys(k).length>0){h(k);return}h({}),x(F=>Math.min(F+1,y.length))},[b,_]),j=E.useCallback(()=>{x(k=>Math.max(k-1,1))},[]),I=E.useCallback(async()=>{try{p(!0);let k={};for(let T=1;T<=y.length;T++){const R=_(T);k={...k,...R}}if(Object.keys(k).length>0){h(k),a("Please fix all errors before submitting","error");return}const F={employee_id:c.employeeId,employee_name:c.employeeName,employee_phone:c.employeePhone,department:c.department,role:c.role,exit_reason:c.exitReason,custom_reason:c.customReason,last_working_day:c.lastWorkingDay,notice_period:parseInt(c.noticePeriod),immediate_exit:c.immediateExit,overall_experience:c.overallExperience,reason_for_leaving:c.reasonForLeaving,work_environment_feedback:c.workEnvironmentFeedback,management_feedback:c.managementFeedback,improvement_suggestions:c.improvementSuggestions,would_recommend_company:c.wouldRecommendCompany,assets_to_return:c.assetsToReturn,laptop_returned:c.laptopReturned,access_cards_returned:c.accessCardsReturned,documents_returned:c.documentsReturned,other_assets:c.otherAssets,handover_notes:c.handoverNotes,handover_to:c.handoverTo,pending_tasks:c.pendingTasks,client_handover:c.clientHandover,final_settlement:c.finalSettlement,hr_notes:c.hrNotes,manager_approval:c.managerApproval,hr_approval:c.hrApproval,status:c.status,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};if(n){const{error:T}=await n.from("employee_exits").insert([F]);if(T)throw T;const A={status:c.immediateExit?"Inactive":"Exiting",updated_at:new Date().toISOString()};(c.immediateExit||new Date(c.lastWorkingDay)<=new Date)&&(A.departure_date=c.lastWorkingDay);const{error:P}=await n.from("employees").update(A).eq("id",c.employeeId);if(P)throw P}else{const T=JSON.parse(localStorage.getItem("employee_exits")||"[]");T.push({...F,id:Date.now().toString()}),localStorage.setItem("employee_exits",JSON.stringify(T));const A=JSON.parse(localStorage.getItem("employees")||"[]").map(P=>P.id===c.employeeId?{...P,status:c.immediateExit?"Inactive":"Exiting",departure_date:c.immediateExit||new Date(c.lastWorkingDay)<=new Date?c.lastWorkingDay:null}:P);localStorage.setItem("employees",JSON.stringify(A))}l&&await l(),a("Employee exit form submitted successfully","success"),s({title:"Exit Form Submitted",content:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:"‚úÖ"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Exit form submitted successfully!"}),i.jsxs("p",{className:"text-gray-600 mb-4",children:["The employee exit process has been initiated for ",c.employeeName,"."]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left",children:[i.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Next Steps:"}),i.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[i.jsx("li",{children:"‚Ä¢ HR will review the exit form"}),i.jsx("li",{children:"‚Ä¢ Asset return will be coordinated"}),i.jsx("li",{children:"‚Ä¢ Handover process will be initiated"}),i.jsx("li",{children:"‚Ä¢ Final settlement will be processed"}),i.jsxs("li",{children:["‚Ä¢ Employee status updated to: ",c.immediateExit?"Inactive":"Exiting"]})]})]})]}),actions:[{label:"Close",onClick:()=>{o(),t&&t(),e&&e()},variant:"primary"}]})}catch(k){console.error("Exit form submission error:",k),a("Failed to submit exit form. Please try again.","error")}finally{p(!1)}},[c,_,n,a,s,o,l,t,e]),J=()=>{switch(b){case 1:return i.jsxs("div",{className:"space-y-6",children:[i.jsx(en,{title:"Employee Information",icon:"üë§",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(mC,{value:c.employeeName,onChange:k=>{k&&(v("employeeId",k.id),v("employeeName",k.name),v("employeePhone",k.phone),v("department",k.department),v("role",k.role))},placeholder:"Select employee",error:g.employeeName,required:!0}),i.jsx(xi,{label:"Department",value:c.department,onChange:k=>v("department",k),disabled:!0})]})}),i.jsxs(en,{title:"Exit Details",icon:"üìã",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exit Reason *"}),i.jsxs("select",{value:c.exitReason,onChange:k=>v("exitReason",k.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${g.exitReason?"border-red-300":"border-gray-300"}`,required:!0,children:[i.jsx("option",{value:"",children:"Select reason"}),pC.map(k=>i.jsx("option",{value:k,children:k},k))]}),g.exitReason&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.exitReason})]}),c.exitReason==="Other"&&i.jsx(xi,{label:"Custom Reason",value:c.customReason,onChange:k=>v("customReason",k),placeholder:"Please specify",error:g.customReason,required:!0}),i.jsx(xi,{label:"Last Working Day",type:"date",value:c.lastWorkingDay,onChange:k=>v("lastWorkingDay",k),error:g.lastWorkingDay,required:!0}),i.jsx(xi,{label:"Notice Period (days)",type:"number",value:c.noticePeriod,onChange:k=>v("noticePeriod",k),min:"0",max:"90"})]}),i.jsx("div",{className:"mt-4",children:i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:c.immediateExit,onChange:k=>v("immediateExit",k.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Immediate exit (no notice period)"})]})})]})]});case 2:return i.jsx("div",{className:"space-y-6",children:i.jsx(en,{title:"Exit Interview",icon:"üí¨",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx(la,{label:"Overall Experience",value:c.overallExperience,onChange:k=>v("overallExperience",k),placeholder:"How would you describe your overall experience working here?",rows:3,error:g.overallExperience,required:!0}),i.jsx(la,{label:"Primary Reason for Leaving",value:c.reasonForLeaving,onChange:k=>v("reasonForLeaving",k),placeholder:"What is the main reason you are leaving?",rows:3,error:g.reasonForLeaving,required:!0}),i.jsx(la,{label:"Work Environment Feedback",value:c.workEnvironmentFeedback,onChange:k=>v("workEnvironmentFeedback",k),placeholder:"How would you rate the work environment and culture?",rows:3}),i.jsx(la,{label:"Management Feedback",value:c.managementFeedback,onChange:k=>v("managementFeedback",k),placeholder:"How would you rate the management and leadership?",rows:3}),i.jsx(la,{label:"Improvement Suggestions",value:c.improvementSuggestions,onChange:k=>v("improvementSuggestions",k),placeholder:"What suggestions do you have for improvement?",rows:3}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Would you recommend this company to others?"}),i.jsxs("select",{value:c.wouldRecommendCompany,onChange:k=>v("wouldRecommendCompany",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Select option"}),i.jsx("option",{value:"Definitely Yes",children:"Definitely Yes"}),i.jsx("option",{value:"Probably Yes",children:"Probably Yes"}),i.jsx("option",{value:"Maybe",children:"Maybe"}),i.jsx("option",{value:"Probably No",children:"Probably No"}),i.jsx("option",{value:"Definitely No",children:"Definitely No"})]})]})]})})});case 3:return i.jsx("div",{className:"space-y-6",children:i.jsx(en,{title:"Asset Return",icon:"üíº",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:c.laptopReturned,onChange:k=>v("laptopReturned",k.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Laptop/Computer returned"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:c.accessCardsReturned,onChange:k=>v("accessCardsReturned",k.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Access cards returned"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:c.documentsReturned,onChange:k=>v("documentsReturned",k.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Company documents returned"})]})]}),i.jsx(la,{label:"Other Assets to Return",value:c.otherAssets,onChange:k=>v("otherAssets",k),placeholder:"List any other company assets that need to be returned",rows:3})]})})});case 4:return i.jsx("div",{className:"space-y-6",children:i.jsx(en,{title:"Knowledge Handover",icon:"üîÑ",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx(xi,{label:"Handover To",value:c.handoverTo,onChange:k=>v("handoverTo",k),placeholder:"Name of person taking over responsibilities"}),i.jsx(la,{label:"Handover Notes",value:c.handoverNotes,onChange:k=>v("handoverNotes",k),placeholder:"Key information, processes, and knowledge to transfer",rows:4}),i.jsx(la,{label:"Pending Tasks",value:c.pendingTasks,onChange:k=>v("pendingTasks",k),placeholder:"List of pending tasks and their status",rows:3}),i.jsx(la,{label:"Client Handover",value:c.clientHandover,onChange:k=>v("clientHandover",k),placeholder:"Client relationships and ongoing projects to transfer",rows:3})]})})});case 5:return i.jsx("div",{className:"space-y-6",children:i.jsx(en,{title:"HR Processing",icon:"‚úÖ",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx(la,{label:"Final Settlement Notes",value:c.finalSettlement,onChange:k=>v("finalSettlement",k),placeholder:"Salary, benefits, and other settlement details",rows:3}),i.jsx(la,{label:"HR Notes",value:c.hrNotes,onChange:k=>v("hrNotes",k),placeholder:"Additional HR notes and comments",rows:3}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:c.managerApproval,onChange:k=>v("managerApproval",k.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Manager approval"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:c.hrApproval,onChange:k=>v("hrApproval",k.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"HR approval"})]})]})]})})});default:return null}};return i.jsx("div",{className:"max-w-4xl mx-auto p-6",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Employee Exit Form"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Complete the exit process for departing employees"})]}),i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:[i.jsx("div",{className:"flex justify-between items-center mb-4",children:i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Exit Process Progress"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"üí° Click any step to navigate freely"})]})}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"flex justify-between",children:y.map((k,F)=>i.jsxs("div",{className:"flex flex-col items-center relative z-10",children:[i.jsx("button",{onClick:()=>x(k.id),className:`w-12 h-12 rounded-full border-2 flex items-center justify-center text-lg font-semibold transition-all duration-200 cursor-pointer hover:scale-105 ${b===k.id?"bg-blue-600 text-white border-blue-600 shadow-lg":b>k.id?"bg-green-600 text-white border-green-600 shadow-md":"bg-gray-100 text-gray-400 border-gray-300 hover:border-gray-400 hover:bg-gray-200"}`,children:b>k.id?"‚úì":k.icon}),i.jsx("div",{className:"mt-2 text-center",children:i.jsx("div",{className:`text-xs font-medium ${b===k.id?"text-blue-600":b>k.id?"text-green-600":"text-gray-500"}`,children:k.title})})]},k.id))}),i.jsx("div",{className:"absolute top-6 left-6 right-6 h-0.5 bg-gray-200 -z-10",children:i.jsx("div",{className:"h-full bg-green-600 transition-all duration-500 ease-out",style:{width:`${(b-1)/(y.length-1)*100}%`}})})]})]}),i.jsx("div",{className:"px-6 py-6",children:J()}),i.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-between",children:[i.jsx("button",{onClick:j,disabled:b===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),i.jsxs("div",{className:"flex gap-2",children:[e&&i.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),b<y.length?i.jsx("button",{onClick:S,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700",children:"Next"}):i.jsx("button",{onClick:I,disabled:d,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Submitting...":"Submit Exit Form"})]})]})]})})}function vC(){const{user:r,userCategory:e}=Fa(),t=Ad(),{openModal:n,closeModal:a}=bo(),[s,o]=E.useState("overview"),l=()=>{t.navigate("/employee-signup")},c=()=>i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Employee Management"}),i.jsx("p",{className:"text-gray-600",children:"Manage employee signups and HR approval workflows"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"üë•"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Employee Signup"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Submit an application to join our team"}),i.jsx("button",{onClick:l,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Apply Now"})]})}),(e==="manager"||e==="hr")&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"üìã"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"HR Approval Workflow"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Review and approve employee applications"}),i.jsx("button",{onClick:()=>o("hr-workflow"),className:"w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Review Applications"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"üìñ"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Employee Directory"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"View all current employees"}),i.jsx("button",{onClick:()=>o("directory"),className:"w-full px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"View Directory"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"üìù"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Employee Onboarding"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Complete onboarding form for new employees"}),i.jsx("button",{onClick:()=>t.navigateToPath("/employee-onboarding"),className:"w-full px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700",children:"Start Onboarding"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"üí∞"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Employee Incentives"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Apply for hiring, testimonial, and promotional incentives"}),i.jsx("button",{onClick:()=>t.navigateToPath("/employee-incentives"),className:"w-full px-4 py-2 bg-emerald-600 text-white rounded-md hover:bg-emerald-700",children:"Apply for Incentives"})]})}),(e==="manager"||e==="hr")&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"üí∞"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"HR Incentive Approval"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Review and approve employee incentive applications"}),i.jsx("button",{onClick:()=>t.navigateToPath("/hr-incentive-approval"),className:"w-full px-4 py-2 bg-emerald-600 text-white rounded-md hover:bg-emerald-700",children:"Review Incentives"})]})}),(e==="manager"||e==="hr")&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"üìä"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Incentive Reporting"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"View analytics and reports for employee incentives"}),i.jsx("button",{onClick:()=>t.navigateToPath("/manager-incentive-reporting"),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"View Reports"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:"üö™"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Exit Management"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Manage employee exits and offboarding"}),i.jsx("button",{onClick:()=>o("exit-workflow"),className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Manage Exits"})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),i.jsx("span",{className:"text-gray-600",children:"New employee signup form created"}),i.jsx("span",{className:"text-gray-400",children:"‚Ä¢ Just now"})]}),i.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsx("span",{className:"text-gray-600",children:"HR approval workflow implemented"}),i.jsx("span",{className:"text-gray-400",children:"‚Ä¢ Just now"})]}),i.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[i.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),i.jsx("span",{className:"text-gray-600",children:"Employee management system enhanced"}),i.jsx("span",{className:"text-gray-400",children:"‚Ä¢ Just now"})]})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"üìö How it Works"}),i.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"font-medium",children:"1."}),i.jsx("span",{children:"Candidates fill out the comprehensive signup form with personal, professional, and background information"})]}),i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"font-medium",children:"2."}),i.jsx("span",{children:"HR team receives notifications and can review applications in the approval workflow"})]}),i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"font-medium",children:"3."}),i.jsx("span",{children:"Applications can be approved (creating employee records) or rejected with feedback"})]}),i.jsxs("div",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"font-medium",children:"4."}),i.jsx("span",{children:"Approved employees are automatically added to the employee directory and system"})]})]})]})]}),u=()=>i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Employee Directory"}),i.jsx("p",{className:"text-gray-600",children:"View all current employees"})]}),i.jsx("button",{onClick:()=>o("overview"),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"‚Üê Back to Overview"})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-6xl mb-4",children:"üë•"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Employee Directory"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"The employee directory will be integrated with the existing employee management system."}),i.jsx("p",{className:"text-sm text-gray-500",children:"This will show all employees from the employees table, including those approved through the signup process."})]})})]});return i.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("nav",{className:"flex space-x-1 bg-white rounded-lg shadow-sm border border-gray-200 p-1",children:[i.jsx("button",{onClick:()=>o("overview"),className:`flex-1 px-4 py-2 text-sm font-medium rounded-md transition-colors ${s==="overview"?"bg-blue-600 text-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:"üìä Overview"}),(e==="manager"||e==="hr")&&i.jsx("button",{onClick:()=>o("hr-workflow"),className:`flex-1 px-4 py-2 text-sm font-medium rounded-md transition-colors ${s==="hr-workflow"?"bg-green-600 text-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:"üìã HR Workflow"}),i.jsx("button",{onClick:()=>o("directory"),className:`flex-1 px-4 py-2 text-sm font-medium rounded-md transition-colors ${s==="directory"?"bg-purple-600 text-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:"üìñ Directory"}),i.jsx("button",{onClick:()=>o("exit-workflow"),className:`flex-1 px-4 py-2 text-sm font-medium rounded-md transition-colors ${s==="exit-workflow"?"bg-red-600 text-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:"üö™ Exit Management"})]})}),s==="overview"&&c(),s==="hr-workflow"&&(e==="manager"||e==="hr")&&i.jsx(iC,{}),s==="directory"&&u(),s==="exit-workflow"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Exit Management"}),i.jsx("p",{className:"text-gray-600",children:"Manage employee exits and offboarding process"})]}),i.jsx("button",{onClick:()=>o("overview"),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"‚Üê Back to Overview"})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"üìù Employee Exit Form"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Employees can submit exit requests through this form. The form captures exit details, conducts exit interviews, and manages asset returns."}),i.jsx(xC,{})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"‚öôÔ∏è Exit Workflow Management"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"HR and managers can review, approve, and track employee exit requests. Monitor the complete exit process from submission to completion."}),i.jsx(hC,{})]})]})]}),s==="hr-workflow"&&e!=="manager"&&e!=="hr"&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-6xl mb-4",children:"üîí"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Restricted"}),i.jsx("p",{className:"text-gray-600",children:"HR Approval Workflow is only available to managers and HR personnel."})]})})]})})}const yC=({employeeId:r=null,isManager:e=!1})=>{const{user:t,role:n}=Fa(),{notify:a}=Fn(),{employees:s}=go(),[o,l]=E.useState([]),[c,u]=E.useState(r||(t==null?void 0:t.id)),[d,p]=E.useState(null),[g,h]=E.useState({title:"",description:"",target:"",current:"",unit:"",category:"performance",priority:"medium",deadline:""}),[b,x]=E.useState(!1),y=[{value:"performance",label:"Performance",icon:"üìä"},{value:"productivity",label:"Productivity",icon:"‚ö°"},{value:"quality",label:"Quality",icon:"‚ú®"},{value:"learning",label:"Learning & Development",icon:"üìö"},{value:"collaboration",label:"Collaboration",icon:"ü§ù"},{value:"innovation",label:"Innovation",icon:"üí°"}],v=[{value:"low",label:"Low",color:"text-green-600"},{value:"medium",label:"Medium",color:"text-yellow-600"},{value:"high",label:"High",color:"text-orange-600"},{value:"critical",label:"Critical",color:"text-red-600"}];E.useEffect(()=>{_()},[c]);const _=()=>{l([{id:1,title:"Monthly Sales Target",description:"Achieve monthly sales target of $50,000",target:"50000",current:"35000",unit:"USD",category:"performance",priority:"high",deadline:"2024-02-29",progress:70,employeeId:c},{id:2,title:"Customer Satisfaction Score",description:"Maintain customer satisfaction above 4.5/5",target:"4.5",current:"4.2",unit:"rating",category:"quality",priority:"medium",deadline:"2024-03-15",progress:93,employeeId:c},{id:3,title:"Training Completion",description:"Complete 3 professional development courses",target:"3",current:"1",unit:"courses",category:"learning",priority:"medium",deadline:"2024-04-30",progress:33,employeeId:c}])},S=()=>{if(!g.title.trim()||!g.target.trim()){a({title:"Validation Error",message:"Please fill in title and target value",type:"error"});return}const k={id:Date.now(),...g,current:g.current||"0",progress:g.current&&g.target?Math.round(parseFloat(g.current)/parseFloat(g.target)*100):0,employeeId:c,createdAt:new Date().toISOString()};l(F=>[...F,k]),h({title:"",description:"",target:"",current:"",unit:"",category:"performance",priority:"medium",deadline:""}),a({title:"KPI Added",message:"New KPI has been successfully created",type:"success"})},j=k=>{l(F=>F.filter(T=>T.id!==k)),a({title:"KPI Deleted",message:"KPI has been removed",type:"success"})},I=k=>k>=90?"bg-green-500":k>=70?"bg-blue-500":k>=50?"bg-yellow-500":"bg-red-500",J=s.find(k=>k.id===c);return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"card-brand p-6",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-brand-text",children:"KPI Management"}),i.jsx("p",{className:"text-brand-text-secondary mt-1",children:e?"Manage team KPIs and track performance":"Track your key performance indicators"})]}),e&&i.jsxs("select",{value:c,onChange:k=>u(k.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"Select Employee"}),s.map(k=>i.jsxs("option",{value:k.id,children:[k.name," - ",k.role]},k.id))]})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"card-brand p-6 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:o.length}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Total KPIs"})]}),i.jsxs("div",{className:"card-brand p-6 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:o.filter(k=>k.progress>=90).length}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"Achieved"})]}),i.jsxs("div",{className:"card-brand p-6 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-yellow-600 mb-1",children:o.filter(k=>k.progress>=50&&k.progress<90).length}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"In Progress"})]}),i.jsxs("div",{className:"card-brand p-6 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-red-600 mb-1",children:o.filter(k=>k.progress<50).length}),i.jsx("div",{className:"text-sm text-brand-text-secondary",children:"At Risk"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"card-brand p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-4",children:"Add New KPI"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"Title *"}),i.jsx("input",{type:"text",value:g.title,onChange:k=>h(F=>({...F,title:k.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter KPI title"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"Description"}),i.jsx("textarea",{value:g.description,onChange:k=>h(F=>({...F,description:k.target.value})),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe the KPI"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"Target *"}),i.jsx("input",{type:"number",value:g.target,onChange:k=>h(F=>({...F,target:k.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Target value"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"Current"}),i.jsx("input",{type:"number",value:g.current,onChange:k=>h(F=>({...F,current:k.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Current value"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"Category"}),i.jsx("select",{value:g.category,onChange:k=>h(F=>({...F,category:k.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:y.map(k=>i.jsxs("option",{value:k.value,children:[k.icon," ",k.label]},k.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"Priority"}),i.jsx("select",{value:g.priority,onChange:k=>h(F=>({...F,priority:k.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:v.map(k=>i.jsx("option",{value:k.value,children:k.label},k.value))})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"Unit"}),i.jsx("input",{type:"text",value:g.unit,onChange:k=>h(F=>({...F,unit:k.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., USD, %, hours"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"Deadline"}),i.jsx("input",{type:"date",value:g.deadline,onChange:k=>h(F=>({...F,deadline:k.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),i.jsx("button",{onClick:S,className:"w-full btn-brand-primary",children:"Add KPI"})]})]}),i.jsxs("div",{className:"card-brand p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-brand-text mb-4",children:["Current KPIs ",J&&`- ${J.name}`]}),i.jsx("div",{className:"space-y-4",children:o.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"text-4xl mb-4",children:"üìä"}),i.jsx("p",{className:"text-brand-text-secondary",children:"No KPIs defined yet"})]}):o.map(k=>i.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700 p-4 rounded-lg",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-brand-text",children:k.title}),i.jsx("p",{className:"text-sm text-brand-text-secondary mt-1",children:k.description})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>p(k.id),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Edit"}),i.jsx("button",{onClick:()=>j(k.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Delete"})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[i.jsxs("span",{children:["Progress: ",k.current,"/",k.target," ",k.unit]}),i.jsxs("span",{className:"font-medium",children:[k.progress,"%"]})]}),i.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:i.jsx("div",{className:`h-2 rounded-full ${I(k.progress)}`,style:{width:`${Math.min(k.progress,100)}%`}})})]}),i.jsxs("div",{className:"flex justify-between items-center text-xs text-brand-text-secondary",children:[i.jsx("span",{className:`px-2 py-1 rounded-full ${k.priority==="critical"?"bg-red-100 text-red-800":k.priority==="high"?"bg-orange-100 text-orange-800":k.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:k.priority}),k.deadline&&i.jsxs("span",{children:["Due: ",new Date(k.deadline).toLocaleDateString()]})]})]},k.id))})]})]})]})};function bC(){const[r,e]=E.useState({width:typeof window<"u"?window.innerWidth:0,height:typeof window<"u"?window.innerHeight:0}),[t,n]=E.useState("lg");E.useEffect(()=>{function g(){const h=window.innerWidth,b=window.innerHeight;e({width:h,height:b}),h<640?n("sm"):h<768?n("md"):h<1024?n("lg"):h<1280?n("xl"):n("2xl")}return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]);const a=t==="sm",s=t==="md",o=["lg","xl","2xl"].includes(t),l=["sm","md"].includes(t);return{windowSize:r,breakpoint:t,isMobile:a,isTablet:s,isDesktop:o,isMobileOrTablet:l,gridConfig:{dashboardCards:a?"grid-cols-1":s?"grid-cols-2":"grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",metrics:a?"grid-cols-1":"grid-cols-2 md:grid-cols-3 lg:grid-cols-4",stats:a?"grid-cols-1":"grid-cols-2 md:grid-cols-4",quickActions:a?"grid-cols-2":"grid-cols-2 md:grid-cols-4 lg:grid-cols-6"},spacing:{container:a?"space-y-4":"space-y-6",section:a?"p-4":"p-6",gap:a?"gap-4":"gap-6"},text:{title:a?"text-2xl":"text-3xl",subtitle:a?"text-lg":"text-xl",heading:a?"text-lg":"text-xl"},mobileUtils:{showOnMobile:a?"block":"hidden",hideOnMobile:a?"hidden":"block",showOnDesktop:o?"block":"hidden",hideOnDesktop:o?"hidden":"block",flexDirection:a?"flex-col":"flex-row",buttonSize:a?"px-3 py-2 text-sm":"px-4 py-2",modalPlacement:a?"bottom":"center"}}}function wC(r){if(!r)return"overview";switch(r){case"operations":return"operations";case"hr":return"employees";case"accounting":return"finance";case"sales":return"clients";default:return"overview"}}const Wj=ar.memo(function({onViewReport:e,onEditEmployee:t,onEditReport:n,dashboardType:a}){var xt,Ot,kt,Tt,zt,At,wt,Ct,vt;console.log("üìä Loading manager dashboard with type:",a);const{notify:s}=Fn(),{openModal:o,closeModal:l}=bo(),{user:c,hasPermission:u}=Fa(),d=Ad(),{navigate:p}=d;bC();const g=({userRole:de})=>{const Me=pl[de]||pl.manager;return Me?i.jsx("div",{className:"w-64 bg-white border-r border-gray-200 h-full",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:Me.title}),Me.sections.map((Te,Ge)=>i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:Te.title}),i.jsx("nav",{className:"space-y-1",children:Te.items.map((it,Xe)=>i.jsxs("button",{onClick:()=>{it.path.startsWith("#/")?d.navigateToHash(it.path.replace("#/","")):d.navigateToPath(it.path)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900 transition-colors",children:[i.jsx("span",{className:"mr-3",children:it.icon}),it.label]},Xe))})]},Ge))]})}):null},{submissions:h,isLoading:b,error:x,syncStatus:y,lastUpdated:v,syncAllData:_}=R8(),S=h,[j,I]=E.useState("controlPanel"),[J,k]=E.useState("all"),[F,T]=E.useState(""),[R,A]=E.useState({department:"All",performance:"All",status:"All"}),[P,H]=E.useState({key:"name",direction:"asc"}),[K,ce]=E.useState(new Set),[me,le]=E.useState({}),[xe,we]=E.useState("All"),[Oe,ge]=E.useState("All"),[C,O]=E.useState(10),[D,M]=E.useState(!1),[V,oe]=E.useState({refreshing:!1,exporting:!1,savingEvaluation:!1,bulkOperations:!1}),[he,ue]=E.useState({isOpen:!1,submission:null,score:8,comments:"",recommendations:"",testimonialUrl:""});E.useEffect(()=>{a&&I(wC(a))},[a]);const[Z,ye]=E.useState({totalEmployees:0,totalSubmissions:0,averageScore:0,highPerformers:0,needsAttention:0,withPenalties:0,missingLearning:0}),Le=E.useCallback(async()=>{try{const de=await Ya.getManagerStats();ye({totalEmployees:de.teamSize||0,totalSubmissions:de.activeProjects||0,averageScore:de.teamPerformance?(de.teamPerformance/10).toFixed(1):0,highPerformers:Math.round((de.teamSize||0)*.3),needsAttention:Math.round((de.teamSize||0)*.15),withPenalties:Math.round((de.teamSize||0)*.05),missingLearning:Math.round((de.teamSize||0)*.1)})}catch(de){console.error("Error fetching dynamic stats:",de)}},[]);E.useEffect(()=>{Le()},[Le]);const Ie=E.useMemo(()=>{if(!S.length)return{employees:[],stats:{},departments:[]};const de=J==="all"?S:S.filter(Ue=>Ue.monthKey===J),Me={};de.forEach(Ue=>{var ct,ht,Et,ut,Lt;const Ke=`${(ct=Ue.employee)==null?void 0:ct.name}-${(ht=Ue.employee)==null?void 0:ht.phone}`;Me[Ke]||(Me[Ke]={name:((Et=Ue.employee)==null?void 0:Et.name)||"Unknown",phone:((ut=Ue.employee)==null?void 0:ut.phone)||"N/A",department:((Lt=Ue.employee)==null?void 0:Lt.department)||"Unknown",submissions:[],latestSubmission:null,averageScore:0,totalHours:0,performance:"Medium"}),Me[Ke].submissions.push(Ue)});const Te=Object.values(Me).map(Ue=>{Ue.submissions.sort((ct,ht)=>ht.monthKey.localeCompare(ct.monthKey)),Ue.latestSubmission=Ue.submissions[0];const Ke=Ue.submissions.reduce((ct,ht)=>{var Et;return ct+(((Et=ht.scores)==null?void 0:Et.overall)||0)},0);return Ue.averageScore=Ue.submissions.length?(Ke/Ue.submissions.length).toFixed(1):0,Ue.totalHours=Ue.submissions.reduce((ct,ht)=>ct+(ht.learning||[]).reduce((Et,ut)=>Et+(ut.durationMins||0),0)/60,0),Ue.performance=Ue.averageScore>=8?"High":Ue.averageScore>=6?"Medium":"Low",Ue.hasTestimonial=Ue.submissions.some(ct=>{var ht;return(ht=ct.manager)==null?void 0:ht.testimonialUrl}),Ue});let Ge=Te.filter(Ue=>{const Ke=!F||Ue.name.toLowerCase().includes(F.toLowerCase())||Ue.department.toLowerCase().includes(F.toLowerCase()),ct=R.department==="All"||Ue.department===R.department,ht=R.performance==="All"||Ue.performance===R.performance;return Ke&&ct&&ht});Ge.sort((Ue,Ke)=>{let ct,ht;switch(P.key){case"name":ct=Ue.name,ht=Ke.name;break;case"score":ct=parseFloat(Ue.averageScore),ht=parseFloat(Ke.averageScore);break;case"department":ct=Ue.department,ht=Ke.department;break;case"hours":ct=Ue.totalHours,ht=Ke.totalHours;break;default:ct=Ue.name,ht=Ke.name}return P.direction==="desc"?typeof ct=="string"?ht.localeCompare(ct):ht-ct:typeof ct=="string"?ct.localeCompare(ht):ct-ht});const it={totalEmployees:Z.totalEmployees||Te.length,totalSubmissions:Z.totalSubmissions||de.length,averageScore:Z.averageScore||(Te.length?(Te.reduce((Ue,Ke)=>Ue+parseFloat(Ke.averageScore),0)/Te.length).toFixed(1):0),highPerformers:Z.highPerformers||Te.filter(Ue=>Ue.performance==="High").length,needsAttention:Z.needsAttention||Te.filter(Ue=>Ue.performance==="Low").length,withPenalties:Z.withPenalties||Te.filter(Ue=>{var Ke,ct;return((ct=(Ke=Ue.latestSubmission)==null?void 0:Ke.discipline)==null?void 0:ct.penalty)>0}).length,missingLearning:Z.missingLearning||Te.filter(Ue=>{const Ke=Ue.latestSubmission;return Ke?(Ke.learning||[]).reduce((ht,Et)=>ht+(Et.durationMins||0),0)/60<C:!1}).length},Xe=[...new Set(Te.map(Ue=>Ue.department))].sort();return{employees:Ge,stats:it,departments:Xe,allEmployees:Te}},[S,J,F,R,P,C]),pe=E.useMemo(()=>{try{const de=new Set;return(Ie.employees||[]).forEach(Me=>{const Te=Me.latestSubmission;((Te==null?void 0:Te.clients)||[]).forEach(Ge=>(Ge.services||[]).forEach(it=>{const Xe=typeof it=="string"?it:it.service;Xe&&de.add(Xe)}))}),["All",...Array.from(de).sort()]}catch{return["All"]}},[Ie]),ee=de=>{var Me,Te,Ge,it,Xe,Ue,Ke,ct,ht,Et,ut,Lt;ue({isOpen:!0,submission:de,score:((Me=de.manager)==null?void 0:Me.score)||8,comments:((Te=de.manager)==null?void 0:Te.comments)||"",recommendations:((Ge=de.manager)==null?void 0:Ge.recommendations)||"",testimonialUrl:((it=de.manager)==null?void 0:it.testimonialUrl)||"",rubrics:{collaboration:((Ue=(Xe=de.manager)==null?void 0:Xe.rubrics)==null?void 0:Ue.collaboration)||7,ownership:((ct=(Ke=de.manager)==null?void 0:Ke.rubrics)==null?void 0:ct.ownership)||7,quality:((Et=(ht=de.manager)==null?void 0:ht.rubrics)==null?void 0:Et.quality)||7,communication:((Lt=(ut=de.manager)==null?void 0:ut.rubrics)==null?void 0:Lt.communication)||7}})},lt=async()=>{var de,Me,Te,Ge;if(!(!he.submission||!supabase||V.savingEvaluation)){oe(it=>({...it,savingEvaluation:!0}));try{console.log("Saving employee evaluation...");const it={...he.submission,manager:{score:he.score,comments:he.comments,recommendations:he.recommendations,testimonialUrl:he.testimonialUrl,rubrics:{collaboration:Number(((de=he.rubrics)==null?void 0:de.collaboration)||0),ownership:Number(((Me=he.rubrics)==null?void 0:Me.ownership)||0),quality:Number(((Te=he.rubrics)==null?void 0:Te.quality)||0),communication:Number(((Ge=he.rubrics)==null?void 0:Ge.communication)||0)},evaluatedAt:new Date().toISOString(),evaluatedBy:"Manager"}},{error:Xe}=await supabase.from("submissions").update(it).eq("id",he.submission.id);if(Xe)throw Xe;console.log("Refreshing submissions data..."),await updateSubmission(it),await refreshSubmissions(),ue({isOpen:!1,submission:null,score:8,comments:"",recommendations:""}),console.log("Evaluation saved successfully"),s({type:"success",title:"Evaluation saved",message:"Manager evaluation updated."}),o("Success","Employee evaluation saved successfully!",l)}catch(it){console.error("Failed to save evaluation:",it),s({type:"error",title:"Save failed",message:it.message}),o("Error","Failed to save evaluation. Please try again.",l)}finally{oe(it=>({...it,savingEvaluation:!1}))}}},Pe=async()=>{if(!V.refreshing){oe(de=>({...de,refreshing:!0}));try{console.log("Refreshing dashboard data..."),await _(!0),console.log("Dashboard data refreshed successfully")}catch(de){console.error("Failed to refresh data:",de),o("Error","Failed to refresh data. Please try again.",l)}finally{oe(de=>({...de,refreshing:!1}))}}},at=async()=>{if(!V.exporting){oe(de=>({...de,exporting:!0}));try{console.log("Exporting bulk data...");const Me=[["Employee Name","Department","Phone","Average Score","Total Hours","Performance","Latest Month","Reports Count"],...Ie.employees.map(Xe=>{var Ue;return[Xe.name,Xe.department,Xe.phone,Xe.averageScore,Xe.totalHours.toFixed(1),Xe.performance,((Ue=Xe.latestSubmission)==null?void 0:Ue.monthKey)||"N/A",Xe.submissions.length]})].map(Xe=>Xe.join(",")).join(`
`),Te=new Blob([Me],{type:"text/csv;charset=utf-8;"}),Ge=document.createElement("a"),it=URL.createObjectURL(Te);Ge.setAttribute("href",it),Ge.setAttribute("download",`employee-performance-${new Date().toISOString().split("T")[0]}.csv`),Ge.style.visibility="hidden",document.body.appendChild(Ge),Ge.click(),document.body.removeChild(Ge),URL.revokeObjectURL(it),console.log("Data exported successfully"),o("Success","Employee data exported successfully!",l)}catch(de){console.error("Failed to export data:",de),o("Error","Failed to export data. Please try again.",l)}finally{oe(de=>({...de,exporting:!1}))}}},qe=async de=>{const Me=de.submissions,Te=de.name;if(!Me||Me.length===0){o("No Data",`No submissions found for ${Te}`,l);return}try{s({type:"info",title:"Generating PDF",message:"Creating performance report..."});const Ge={employeeName:Te,department:de.department||"N/A",period:"Performance Summary",metrics:{"Average Score":`${de.averageScore}/10`,"Reports Submitted":Me.length,"Total Learning Hours":`${de.totalHours.toFixed(1)}h`,"Performance Level":de.performance},summary:`Comprehensive performance report for ${Te} covering ${Me.length} monthly submissions.`,performanceData:Me.map(Ue=>{var Ke,ct,ht,Et;return{month:Ue.monthKey,overallScore:((Ke=Ue.scores)==null?void 0:Ke.overall)||0,kpiScore:((ct=Ue.scores)==null?void 0:ct.kpiScore)||0,learningScore:((ht=Ue.scores)==null?void 0:ht.learningScore)||0,relationshipScore:((Et=Ue.scores)==null?void 0:Et.relationshipScore)||0,learningHours:((Ue.learning||[]).reduce((ut,Lt)=>ut+(Lt.durationMins||0),0)/60).toFixed(1)}}),kpiDetails:Me.flatMap(Ue=>Ue.kpis||[])},it=d0.generateFilename(`${Te.replace(/\s+/g,"_")}_Performance_Report`),Xe=await F2(Ge,"pdf","employeePerformance",it);if(Xe.success)s({type:"success",title:"PDF Generated",message:"Performance report downloaded successfully."});else throw new Error(Xe.message)}catch(Ge){console.error("Error generating PDF:",Ge),s({type:"error",title:"PDF Generation Failed",message:Ge.message||"Failed to generate PDF report. Please try again."})}},ft=async de=>{if(V.bulkOperations)return;if(console.log("Opening Report View for:",de.name),!de.submissions||de.submissions.length===0){o("No Data",`No submissions found for ${de.name}`,l);return}const Me=de.phone&&de.phone!=="N/A"?de.phone:"no-phone";console.log("Using phone number:",Me),console.log("Submissions count:",de.submissions.length),oe(Te=>({...Te,bulkOperations:!0}));try{e(de.name,Me),await new Promise(Te=>setTimeout(Te,100))}catch(Te){console.error("Failed to open report view:",Te),o("Error","Failed to open report view. Please try again.",l)}finally{setTimeout(()=>{oe(Te=>({...Te,bulkOperations:!1}))},500)}},rt=de=>{if(console.log("Opening Full Report for:",de.name),!de.submissions||de.submissions.length===0){o("No Data",`No submissions found for ${de.name}`,l);return}const Me=de.phone&&de.phone!=="N/A"?de.phone:"no-phone";console.log("Using phone number:",Me),console.log("Submissions count:",de.submissions.length),e(de.name,Me)},Pt=async de=>{if(!V.bulkOperations){if(console.log("Opening Report Editor for:",de.name),!de.latestSubmission){o("No Data",`No submissions found for ${de.name}`,l);return}oe(Me=>({...Me,bulkOperations:!0}));try{n(de.name,de.phone,de.latestSubmission),await new Promise(Me=>setTimeout(Me,100))}catch(Me){console.error("Failed to open report editor:",Me),o("Error","Failed to open report editor. Please try again.",l)}finally{setTimeout(()=>{oe(Me=>({...Me,bulkOperations:!1}))},500)}}};return b?i.jsx(pf,{show:!0,children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[i.jsx("div",{className:"flex items-center justify-center",children:i.jsx(gy,{size:"xl",showText:!0,text:`Loading team data... ${y==="syncing"?"(Syncing)":""}`})}),v&&i.jsxs("div",{className:"text-center mt-4 text-sm text-gray-500",children:["Last updated: ",new Date(v).toLocaleString()]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(lc,{}),i.jsx(lc,{}),i.jsx(lc,{}),i.jsx(lc,{})]}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:i.jsx(xy,{rows:8,columns:6})})]})}):x?i.jsx(pf,{show:!0,children:i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[i.jsx("div",{className:"text-red-600 text-lg mb-2",children:"Error Loading Data"}),i.jsx("div",{className:"text-red-700 mb-4",children:x}),i.jsx(Jy,{onClick:Pe,disabled:V.refreshing,variant:"danger",loading:V.refreshing,loadingText:"Retrying...",children:"Try Again"})]})}):i.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[i.jsx(g,{userRole:"manager"}),i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"space-y-6 p-6",children:[i.jsx("div",{className:"bg-gradient-to-br from-indigo-600 via-purple-600 to-blue-700 rounded-xl shadow-lg border p-8",children:i.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center text-3xl shadow-lg",children:"üë®‚Äçüíº"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold mb-2 bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent",children:"Manager Dashboard"}),i.jsx("p",{className:"text-blue-100 font-medium text-lg",children:"Monitor team performance and manage evaluations"})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[i.jsxs("button",{onClick:Pe,disabled:V.refreshing,className:"flex items-center gap-2 px-6 py-3 bg-white/10 backdrop-blur-sm text-white border border-white/20 rounded-xl hover:bg-white/20 disabled:bg-white/5 disabled:cursor-not-allowed disabled:text-white/50 transition-all duration-200 shadow-lg hover:shadow-xl",children:[V.refreshing?i.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white/50 border-t-white rounded-full"}):i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),i.jsx("span",{className:"font-medium",children:V.refreshing?"Refreshing...":"Refresh"})]}),i.jsxs("button",{onClick:at,disabled:V.exporting,className:"flex items-center gap-2 px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 disabled:bg-emerald-400 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl",children:[V.exporting?i.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),i.jsx("span",{className:"font-medium",children:V.exporting?"Exporting...":"Export CSV"})]})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border",children:i.jsx("div",{className:"px-6 py-0",children:i.jsxs("nav",{className:"flex space-x-8",children:[i.jsx("button",{onClick:()=>I("controlPanel"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${j==="controlPanel"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Control Panel"}),i.jsx("button",{onClick:()=>I("dashboard"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${j==="dashboard"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Employee Dashboard"}),i.jsx("button",{onClick:()=>I("clients"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${j==="clients"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Client Management"}),i.jsx("button",{onClick:()=>I("clientDashboard"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${j==="clientDashboard"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Client Progress"}),i.jsx("button",{onClick:()=>I("leaderboard"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${j==="leaderboard"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Leaderboard"}),i.jsx("button",{onClick:()=>I("hrManagement"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${j==="hrManagement"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"HR Management"}),i.jsx("button",{onClick:()=>I("kpiEditor"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${j==="kpiEditor"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"KPI Editor"})]})})}),j==="dashboard"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 rounded-full bg-blue-100",children:i.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Total Employees"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:Ie.stats.totalEmployees})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 rounded-full bg-green-100",children:i.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"High Performers"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:Ie.stats.highPerformers})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 rounded-full bg-yellow-100",children:i.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Needs Attention"}),i.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:Ie.stats.needsAttention})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 rounded-full bg-purple-100",children:i.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Avg Team Score"}),i.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[Ie.stats.averageScore,"/10"]})]})]})})]}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:i.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"relative",children:[i.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i.jsx("input",{type:"text",placeholder:"Search employees, departments...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:F,onChange:de=>T(de.target.value),autoComplete:"off"})]})}),i.jsxs("div",{className:"flex flex-wrap gap-3",children:[i.jsxs("select",{value:R.department,onChange:de=>A(Me=>({...Me,department:de.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"All",children:"All Departments"}),Ie.departments.map(de=>i.jsx("option",{value:de,children:de},de))]}),i.jsxs("select",{value:R.performance,onChange:de=>A(Me=>({...Me,performance:de.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"All",children:"All Performance"}),i.jsx("option",{value:"High",children:"High Performers"}),i.jsx("option",{value:"Medium",children:"Medium Performers"}),i.jsx("option",{value:"Low",children:"Needs Attention"})]}),i.jsxs("select",{value:J,onChange:de=>k(de.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"all",children:"All Months"}),(()=>{const de=new Set;return allSubmissions.forEach(Me=>{Me.monthKey&&de.add(Me.monthKey)}),Array.from(de).sort((Me,Te)=>Te.localeCompare(Me)).map(Me=>i.jsx("option",{value:Me,children:new Date(Me+"-01").toLocaleDateString("en-US",{year:"numeric",month:"long"})},Me))})()]})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Team Overview (",Ie.employees.length," employees)"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm text-gray-500",children:"Sort by:"}),i.jsxs("select",{value:P.key,onChange:de=>H(Me=>({...Me,key:de.target.value})),className:"text-sm border border-gray-300 rounded px-2 py-1",children:[i.jsx("option",{value:"name",children:"Name"}),i.jsx("option",{value:"score",children:"Score"}),i.jsx("option",{value:"department",children:"Department"}),i.jsx("option",{value:"hours",children:"Learning Hours"})]}),i.jsx("button",{onClick:()=>H(de=>({...de,direction:de.direction==="asc"?"desc":"asc"})),className:"p-1 hover:bg-gray-100 rounded",children:i.jsx("svg",{className:`w-4 h-4 transform ${P.direction==="desc"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{const de={};(Ie.employees||[]).forEach(Me=>{de[`${Me.name}-${Me.phone}`]=!0}),le(de)},className:"text-xs px-2 py-1 border rounded hover:bg-gray-50",children:"Expand All"}),i.jsx("button",{onClick:()=>le({}),className:"text-xs px-2 py-1 border rounded hover:bg-gray-50",children:"Collapse All"})]})]})}),i.jsxs("div",{className:"px-6 py-3 border-b border-gray-100 bg-gray-50 flex flex-wrap gap-2 text-xs",children:[i.jsxs("span",{className:"px-2 py-1 rounded-full bg-blue-100 text-blue-800",children:["Avg Score: ",Ie.stats.averageScore]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-green-100 text-green-800",children:["High Perf: ",Ie.stats.highPerformers]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-yellow-100 text-yellow-800",children:["Needs Attention: ",Ie.stats.needsAttention]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-red-100 text-red-800",children:["Penalties: ",Ie.stats.withPenalties]}),i.jsxs("span",{className:"px-2 py-1 rounded-full bg-purple-100 text-purple-800",children:[i.jsxs("span",{className:"hidden sm:inline",children:["Missing Learning (<",C,"h): "]}),Ie.stats.missingLearning]})]}),Ie.employees.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"Users"}),i.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"No employees found"}),i.jsx("div",{className:"text-gray-500",children:"Try adjusting your filters or search query"})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Score"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Learning Hours"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reports"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ie.employees.map((de,Me)=>{var Te,Ge,it,Xe,Ue;return i.jsxs(ar.Fragment,{children:[i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:de.name}),i.jsx("div",{className:"text-sm text-gray-500",children:de.phone})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:de.department})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${de.performance==="High"?"bg-green-100 text-green-800":de.performance==="Medium"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:de.performance})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsxs("div",{className:`text-lg font-semibold ${de.averageScore>=8?"text-green-600":de.averageScore>=6?"text-yellow-600":"text-red-600"}`,children:[de.averageScore,"/10"]}),((Ge=(Te=de.latestSubmission)==null?void 0:Te.discipline)==null?void 0:Ge.penalty)>0&&i.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Penalty: -",de.latestSubmission.discipline.penalty," ‚Ä¢ ",de.latestSubmission.discipline.lateDays," day(s) late"]})]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[de.totalHours.toFixed(1),"h"]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:de.submissions.length}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>le(Ke=>({...Ke,[`${de.name}-${de.phone}`]:!Ke[`${de.name}-${de.phone}`]})),className:"text-gray-600 hover:text-gray-900 hover:bg-gray-50 px-3 py-1 rounded",children:me[`${de.name}-${de.phone}`]?"Hide":"Progress"}),i.jsxs("button",{onClick:()=>ft(de),disabled:V.bulkOperations,className:"text-blue-600 hover:text-blue-900 hover:bg-blue-50 disabled:text-blue-300 disabled:bg-gray-50 disabled:cursor-not-allowed px-3 py-1 rounded transition-colors flex items-center gap-1",children:[V.bulkOperations?i.jsx("div",{className:"animate-spin w-3 h-3 border border-blue-300 border-t-transparent rounded-full"}):null,"View Report"]}),i.jsx("button",{onClick:()=>rt(de),className:"text-blue-600 hover:text-blue-900 hover:bg-blue-50 px-3 py-1 rounded transition-colors",children:"Full Report"}),i.jsx("button",{onClick:()=>qe(de),className:"text-green-600 hover:text-green-900 hover:bg-green-50 px-3 py-1 rounded transition-colors",children:"Download PDF"}),i.jsx("button",{onClick:()=>{V.bulkOperations||(oe(Ke=>({...Ke,bulkOperations:!0})),t(de.name,de.phone),setTimeout(()=>{oe(Ke=>({...Ke,bulkOperations:!1}))},500))},disabled:V.bulkOperations,className:"text-orange-600 hover:text-orange-900 hover:bg-orange-50 disabled:text-orange-300 disabled:bg-gray-50 disabled:cursor-not-allowed px-3 py-1 rounded transition-colors",children:"Edit Employee"}),de.latestSubmission&&i.jsxs("button",{onClick:()=>Pt(de),disabled:V.bulkOperations,className:"text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50 disabled:text-indigo-300 disabled:bg-gray-50 disabled:cursor-not-allowed px-3 py-1 rounded transition-colors flex items-center gap-1",children:[V.bulkOperations?i.jsx("div",{className:"animate-spin w-3 h-3 border border-indigo-300 border-t-transparent rounded-full"}):null,"Edit Report"]}),de.latestSubmission&&i.jsx("button",{onClick:()=>ee(de.latestSubmission),className:"text-purple-600 hover:text-purple-900 hover:bg-purple-50 px-3 py-1 rounded transition-colors",children:"Evaluate"}),((Xe=(it=de.latestSubmission)==null?void 0:it.manager)==null?void 0:Xe.testimonialUrl)&&i.jsx("a",{href:de.latestSubmission.manager.testimonialUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-purple-700 underline",children:"Testimonial"})]})})]}),me[`${de.name}-${de.phone}`]&&i.jsx("tr",{className:"bg-gray-50/50",children:i.jsx("td",{colSpan:7,className:"px-6 py-4",children:(Ue=de.latestSubmission)!=null&&Ue.clients&&de.latestSubmission.clients.length>0?i.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:de.latestSubmission.clients.map((Ke,ct)=>i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-sm font-semibold mb-2",children:Ke.name}),Array.isArray(Ke.services)&&Ke.services.length>0?i.jsx("div",{className:"space-y-2",children:Ke.services.map((ht,Et)=>{const ut=typeof ht=="string"?ht:ht.service,Lt=Xa(Ke,ut,{monthKey:de.latestSubmission.monthKey})||0,ma=h0(ut);return i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"flex justify-between mb-0.5",children:[i.jsxs("span",{className:"font-medium",children:[ut," ",i.jsxs("span",{className:"text-gray-500",children:["(w ",ma,")"]})]}),i.jsxs("span",{children:[Lt,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-200 h-1.5 rounded-full",children:i.jsx("div",{className:`${Lt>=100?"bg-green-500":Lt>=60?"bg-yellow-500":"bg-red-500"} h-1.5 rounded-full`,style:{width:`${Lt}%`}})})]},Et)})}):i.jsx("div",{className:"text-xs text-gray-500",children:"No services scoped"})]},ct))}):i.jsx("div",{className:"text-sm text-gray-600",children:"No client data in latest submission."})})})]},`${de.name}-${de.phone}`)})})]})})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 mt-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Underperforming Scopes"}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"text-xs text-gray-500",children:["Period: ",J==="all"?"All":new Date(J+"-01").toLocaleString(void 0,{month:"long",year:"numeric"})]}),i.jsx("select",{className:"text-xs border rounded px-2 py-1",value:xe,onChange:de=>we(de.target.value),children:pe.map(de=>i.jsx("option",{children:de},de))}),i.jsx("select",{className:"text-xs border rounded px-2 py-1",value:Oe,onChange:de=>ge(de.target.value),children:["All",...Ie.departments||[]].map(de=>i.jsx("option",{children:de},de))})]})]}),(()=>{try{const de=[];(Ie.employees||[]).forEach(Te=>{if(Oe!=="All"&&Te.department!==Oe)return;const Ge=Te.latestSubmission;!Ge||!Ge.clients||Ge.clients.forEach(it=>{(it.services||[]).forEach(Xe=>{const Ue=typeof Xe=="string"?Xe:Xe.service,Ke=Xa(it,Ue,{monthKey:Ge.monthKey})||0;Ke<60&&(xe==="All"||Ue===xe)&&de.push({employee:Te.name,client:it.name,service:Ue,pct:Ke})})})});const Me=de.sort((Te,Ge)=>Te.pct-Ge.pct).slice(0,10);return Me.length===0?i.jsx("div",{className:"text-sm text-gray-600",children:"No underperforming scopes found."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[i.jsx("th",{className:"py-2 pr-4",children:"Employee"}),i.jsx("th",{className:"py-2 pr-4",children:"Client"}),i.jsx("th",{className:"py-2 pr-4",children:"Service"}),i.jsx("th",{className:"py-2 pr-4",children:"Progress"})]})}),i.jsx("tbody",{children:Me.map((Te,Ge)=>i.jsxs("tr",{className:"border-b last:border-0",children:[i.jsx("td",{className:"py-2 pr-4",children:Te.employee}),i.jsx("td",{className:"py-2 pr-4",children:Te.client}),i.jsx("td",{className:"py-2 pr-4",children:Te.service}),i.jsxs("td",{className:"py-2 pr-4",children:[i.jsx("div",{className:"w-24 sm:w-32 md:w-40 bg-gray-200 h-2 rounded-full",children:i.jsx("div",{className:`${Te.pct>=100?"bg-green-500":Te.pct>=60?"bg-yellow-500":"bg-red-500"} h-2 rounded-full`,style:{width:`${Math.max(0,Math.min(100,Te.pct))}%`}})}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[Te.pct,"%"]})]})]},`${Te.employee}-${Te.client}-${Te.service}-${Ge}`))})]})})}catch{return i.jsx("div",{className:"text-sm text-gray-600",children:"Unable to compute scope analytics."})}})()]})]}),j==="clients"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-sm",children:"üë•"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Client Management"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Add and manage clients for your team"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>M(!D),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:D?"Cancel":"+ Add New Client"}),i.jsx("button",{onClick:()=>{d.navigateToHash("client-onboarding")},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:"üìã Client Onboarding"})]})]}),D&&i.jsx("div",{className:"mt-4 border-t pt-4",children:i.jsx(Oy,{onSuccess:()=>{M(!1),s("Client added successfully!","success")},onCancel:()=>M(!1)})})]}),i.jsx(V8,{})]}),j==="clientDashboard"&&i.jsx(P8,{}),j==="leaderboard"&&i.jsx(G8,{allSubmissions}),j==="hrManagement"&&i.jsx(vC,{}),j==="kpiEditor"&&i.jsx(yC,{submissions:S,onKPIUpdate:(de,Me)=>{refreshSubmissions(),s("KPIs updated successfully!","success")}}),j==="controlPanel"&&i.jsx(rC,{onNavigateToDashboard:de=>{switch(de){case"employee":d.navigateToEmployeeDirectory();break;case"agency":d.navigateToClientDirectory();break;case"intern":d.navigateToRoleDashboard("Intern");break;case"manager":d.navigateToRoleDashboard("Manager");break;case"freelancer":d.navigateToRoleDashboard("Freelancer");break;default:d.navigateToDashboard()}}}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 mt-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Top Improving Scopes"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Compared to previous month"})]}),(()=>{try{const de=[];(Ie.employees||[]).forEach(Te=>{const Ge=(Te.submissions||[]).sort((Ue,Ke)=>Ke.monthKey.localeCompare(Ue.monthKey));if(Ge.length<2)return;const it=Ge[0],Xe=Ge[1];(it.clients||[]).forEach(Ue=>{const Ke=(Xe.clients||[]).find(ct=>ct.name===Ue.name);Ke&&(Ue.services||[]).forEach(ct=>{const ht=typeof ct=="string"?ct:ct.service,Et=Xa(Ue,ht,{monthKey:it.monthKey})||0,ut=Xa(Ke,ht,{monthKey:Xe.monthKey})||0,Lt=Et-ut;Lt>0&&de.push({employee:Te.name,client:Ue.name,service:ht,delta:Lt,nowPct:Et,prevPct:ut})})})});const Me=de.sort((Te,Ge)=>Ge.delta-Te.delta).slice(0,10);return Me.length===0?i.jsx("div",{className:"text-sm text-gray-600",children:"No significant improvements detected."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[i.jsx("th",{className:"py-2 pr-4",children:"Employee"}),i.jsx("th",{className:"py-2 pr-4",children:"Client"}),i.jsx("th",{className:"py-2 pr-4",children:"Service"}),i.jsx("th",{className:"py-2 pr-4",children:"Œî%"})]})}),i.jsx("tbody",{children:Me.map((Te,Ge)=>i.jsxs("tr",{className:"border-b last:border-0",children:[i.jsx("td",{className:"py-2 pr-4",children:Te.employee}),i.jsx("td",{className:"py-2 pr-4",children:Te.client}),i.jsx("td",{className:"py-2 pr-4",children:Te.service}),i.jsxs("td",{className:"py-2 pr-4 text-green-700 font-semibold",children:["+",Math.round(Te.delta),"%"]})]},`${Te.employee}-${Te.client}-${Te.service}-${Ge}`))})]})})}catch{return i.jsx("div",{className:"text-sm text-gray-600",children:"Unable to compute improvements."})}})()]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 mt-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Top Improving Clients"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Average service improvement"})]}),(()=>{try{const de=[];(Ie.employees||[]).forEach(Te=>{const Ge=(Te.submissions||[]).sort((Ue,Ke)=>Ke.monthKey.localeCompare(Ue.monthKey));if(Ge.length<2)return;const it=Ge[0],Xe=Ge[1];(it.clients||[]).forEach(Ue=>{const Ke=(Xe.clients||[]).find(ht=>ht.name===Ue.name);if(!Ke)return;let ct=[];if((Ue.services||[]).forEach(ht=>{const Et=typeof ht=="string"?ht:ht.service,ut=Xa(Ue,Et,{monthKey:it.monthKey})||0,Lt=Xa(Ke,Et,{monthKey:Xe.monthKey})||0;ct.push(ut-Lt)}),ct.length){const ht=ct.reduce((Et,ut)=>Et+ut,0)/ct.length;ht>0&&de.push({employee:Te.name,client:Ue.name,delta:ht})}})});const Me=de.sort((Te,Ge)=>Ge.delta-Te.delta).slice(0,10);return Me.length===0?i.jsx("div",{className:"text-sm text-gray-600",children:"No significant improvements detected."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[i.jsx("th",{className:"py-2 pr-4",children:"Employee"}),i.jsx("th",{className:"py-2 pr-4",children:"Client"}),i.jsx("th",{className:"py-2 pr-4",children:"Œî%"})]})}),i.jsx("tbody",{children:Me.map((Te,Ge)=>i.jsxs("tr",{className:"border-b last:border-0",children:[i.jsx("td",{className:"py-2 pr-4",children:Te.employee}),i.jsx("td",{className:"py-2 pr-4",children:Te.client}),i.jsxs("td",{className:"py-2 pr-4 text-green-700 font-semibold",children:["+",Math.round(Te.delta),"%"]})]},`${Te.employee}-${Te.client}-${Ge}`))})]})})}catch{return i.jsx("div",{className:"text-sm text-gray-600",children:"Unable to compute improvements."})}})()]}),he.isOpen&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-xs sm:max-w-md md:max-w-lg lg:max-w-2xl max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[i.jsx("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Evaluate: ",(Ot=(xt=he.submission)==null?void 0:xt.employee)==null?void 0:Ot.name]}),i.jsx("button",{onClick:()=>ue(de=>({...de,isOpen:!1})),className:"text-gray-400 hover:text-gray-500",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),i.jsxs("div",{className:"px-3 sm:px-6 py-3 sm:py-4 space-y-4 sm:space-y-6",children:[((Tt=(kt=he.submission)==null?void 0:kt.discipline)==null?void 0:Tt.penalty)>0&&i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-800",children:["Late submission penalty applied: -",he.submission.discipline.penalty," (late by ",he.submission.discipline.lateDays," day(s))."]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Testimonial URL (optional)"}),i.jsx("input",{type:"url",value:he.testimonialUrl,onChange:de=>ue(Me=>({...Me,testimonialUrl:de.target.value})),placeholder:"https://... (video/review link)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Add a link to a client testimonial or video to award recognition."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rubric Ratings (1-10)"}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Collaboration"}),i.jsx("input",{type:"number",min:"1",max:"10",value:((zt=he.rubrics)==null?void 0:zt.collaboration)||0,onChange:de=>ue(Me=>({...Me,rubrics:{...Me.rubrics,collaboration:parseInt(de.target.value)||0}})),className:"w-full px-3 py-2 border rounded-lg"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ownership"}),i.jsx("input",{type:"number",min:"1",max:"10",value:((At=he.rubrics)==null?void 0:At.ownership)||0,onChange:de=>ue(Me=>({...Me,rubrics:{...Me.rubrics,ownership:parseInt(de.target.value)||0}})),className:"w-full px-3 py-2 border rounded-lg"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Quality"}),i.jsx("input",{type:"number",min:"1",max:"10",value:((wt=he.rubrics)==null?void 0:wt.quality)||0,onChange:de=>ue(Me=>({...Me,rubrics:{...Me.rubrics,quality:parseInt(de.target.value)||0}})),className:"w-full px-3 py-2 border rounded-lg"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Communication"}),i.jsx("input",{type:"number",min:"1",max:"10",value:((Ct=he.rubrics)==null?void 0:Ct.communication)||0,onChange:de=>ue(Me=>({...Me,rubrics:{...Me.rubrics,communication:parseInt(de.target.value)||0}})),className:"w-full px-3 py-2 border rounded-lg"})]})]})]}),((vt=he.submission)==null?void 0:vt.clients)&&he.submission.clients.length>0&&i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium mb-2",children:"Client Scope Progress (Submission Month)"}),i.jsx("div",{className:"space-y-3",children:he.submission.clients.map((de,Me)=>i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsx("div",{className:"text-sm font-semibold mb-2",children:de.name}),Array.isArray(de.services)&&de.services.length>0?i.jsx("div",{className:"space-y-2",children:de.services.map((Te,Ge)=>{const it=typeof Te=="string"?Te:Te.service,Xe=Xa(de,it,{monthKey:he.submission.monthKey})||0;return i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"flex justify-between mb-0.5",children:[i.jsx("span",{className:"font-medium",children:it}),i.jsxs("span",{children:[Xe,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-200 h-1.5 rounded-full",children:i.jsx("div",{className:`${Xe>=100?"bg-green-500":Xe>=60?"bg-yellow-500":"bg-red-500"} h-1.5 rounded-full`,style:{width:`${Xe}%`}})})]},Ge)})}):i.jsx("div",{className:"text-xs text-gray-500",children:"No services scoped"})]},Me))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Manager Score (1-10)"}),i.jsx("input",{type:"number",min:"1",max:"10",value:he.score,onChange:de=>ue(Me=>({...Me,score:parseInt(de.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comments"}),i.jsx("textarea",{rows:4,value:he.comments,onChange:de=>ue(Me=>({...Me,comments:de.target.value})),placeholder:"Add your feedback about the employee's performance...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recommendations"}),i.jsx("textarea",{rows:3,value:he.recommendations,onChange:de=>ue(Me=>({...Me,recommendations:de.target.value})),placeholder:"Provide recommendations for improvement...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),i.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>ue(de=>({...de,isOpen:!1})),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),i.jsxs("button",{onClick:lt,disabled:!supabase||V.savingEvaluation,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[V.savingEvaluation&&i.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),V.savingEvaluation?"Saving...":"Save Evaluation"]})]})]})})]})})]})});export{wj as $,Uj as A,Hj as B,Oy as C,Sy as D,Cj as E,mj as F,qj as G,Vu as H,$j as I,kj as J,jj as K,gy as L,Py as M,AC as N,pj as O,gj as P,xj as Q,Sj as R,en as S,xi as T,vj as U,mo as V,yj as W,bj as X,pf as Y,wd as Z,ti as _,Fn as a,XC as a0,ZC as a1,rj as a2,cj as a3,OC as a4,LC as a5,TC as a6,dj as a7,DC as a8,lj as a9,hj as aA,qC as aB,aj as aC,sj as aD,MC as aE,IC as aF,Al as aG,Op as aH,Mp as aI,xd as aJ,Hp as aK,tC as aL,Gv as aM,pl as aN,bC as aO,Nj as aP,_j as aQ,I5 as aR,P8 as aS,Wj as aT,nr as aU,YC as aa,WC as ab,nj as ac,jC as ad,PC as ae,uj as af,BC as ag,oj as ah,RC as ai,tj as aj,FC as ak,kC as al,JC as am,VC as an,$C as ao,ij as ap,fj as aq,KC as ar,d0 as as,F2 as at,GC as au,QC as av,zC as aw,ej as ax,UC as ay,HC as az,Ad as b,My as c,Iy as d,la as e,x0 as f,vy as g,lc as h,mf as i,i as j,go as k,Ya as l,Ej as m,fC as n,a1 as o,Ay as p,Aj as q,Xa as r,dt as s,n1 as t,ha as u,bo as v,jy as w,Ey as x,Mj as y,Bj as z};
