import{d as D,j as e}from"./manager-dashboard-BSBEKJka.js";import{r as n}from"./react-vendor-z5qVsTvS.js";import{c as G,v as T,a as V,b as B}from"./arcadeValidation-D-laYFZz.js";import"./shared-ui-DksRfdM8.js";import"./clients-Dg_kG3rU.js";import"./supabase-vendor-D6KV1zBy.js";import"./auth-out34swX.js";import"./employees-C0R0oL0z.js";import"./forms-F81hZsoD.js";const K=({currentUser:o,onNavigate:b})=>{var h,f,j;const x=D(),[r,S]=n.useState("client_engagement"),[i,p]=n.useState({activity_subtype:"",description:"",proof_url:""}),[v,l]=n.useState(!1),[A,c]=n.useState(!1),[y,a]=n.useState(""),P={whatsapp_appreciation:2,google_review:5,video_testimonial:10,client_referral:30,bp_reel:2,full_video:5,monthly_attendance:5,employee_referral:50,tactical_goals:5,strategic_goals:10,poll_first:3,poll_second:2,poll_third:1},d={client_engagement:{title:"🤝 Client Engagement",description:"Activities that enhance client relationships",activities:[{value:"whatsapp_appreciation",label:"WhatsApp Group Appreciation",points:2,description:"Client appreciation in WhatsApp group"},{value:"google_review",label:"Google Review on BP Page",points:5,description:"Client posts Google review"},{value:"video_testimonial",label:"Video Testimonial",points:10,description:"Client provides video testimonial"},{value:"client_referral",label:"Client Referral",points:30,description:"Client refers new business"}]},content_creation:{title:"🎬 Content Creation",description:"Creating content for Branding Pioneers",activities:[{value:"bp_reel",label:"BP Reel",points:2,description:"Create Instagram/social media reel"},{value:"full_video",label:"Full Video",points:5,description:"Create complete video content"}]},attendance:{title:"📅 Attendance & Referrals",description:"Attendance achievements and employee referrals",activities:[{value:"monthly_attendance",label:"100% Monthly Attendance",points:5,description:"Perfect attendance for the month"},{value:"employee_referral",label:"Employee Referral",points:50,description:"Successfully refer a new employee"}]},performance:{title:"🎯 Performance Goals",description:"Achieving tactical and strategic targets",activities:[{value:"tactical_goals",label:"Tactical Goals (Score above 8)",points:5,description:"Achieve tactical goals with score above 8"},{value:"strategic_goals",label:"Strategic Goals",points:10,description:"Complete strategic objectives"}]},polls:{title:"🏆 Poll Performance",description:"Performance in company polls and competitions",activities:[{value:"poll_first",label:"First Place",points:3,description:"First place in company poll"},{value:"poll_second",label:"Second Place",points:2,description:"Second place in company poll"},{value:"poll_third",label:"Third Place",points:1,description:"Third place in company poll"}]}},E=t=>{S(t),p({activity_subtype:"",description:"",proof_url:""}),a(""),c(!1)},m=(t,s)=>{p(g=>({...g,[t]:s})),a(""),c(!1)},k=async t=>{t.preventDefault(),l(!0),a("");try{const s=G(o);if(!s.isEligible){a(s.reason),l(!1);return}const g={activity_type:r,activity_subtype:i.activity_subtype,description:i.description,proof_url:i.proof_url},_=T(g,o);if(!_.isValid){a(_.errors.join(". ")),l(!1);return}const N=V(i.activity_subtype);if(!N.isValidTime){a(N.message),l(!1);return}const{data:R}=await x.from("arcade_activities").select("*").eq("employee_id",o.id).gte("created_at",new Date(Date.now()-24*60*60*1e3).toISOString()).order("created_at",{ascending:!1}),w=B(R||[],i.activity_subtype);if(!w.canSubmit){a(w.message),l(!1);return}const F=P[i.activity_subtype]||0,{data:I,error:C}=await x.from("arcade_activities").insert({employee_id:o.id,activity_type:r,activity_subtype:i.activity_subtype,points_earned:F,description:i.description.trim(),proof_url:i.proof_url.trim()||null,status:"pending"});if(C){console.error("Error submitting activity:",C),a("Failed to submit activity. Please try again.");return}c(!0),p({activity_subtype:"",description:"",proof_url:""}),setTimeout(()=>c(!1),3e3)}catch(s){console.error("Error:",s),a("An unexpected error occurred. Please try again.")}finally{l(!1)}},u=(h=d[r])==null?void 0:h.activities.find(t=>t.value===i.activity_subtype);return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"💰 Earn Points"}),e.jsx("p",{className:"text-gray-600",children:"Log your activities and earn Arcade points!"})]}),e.jsx("button",{onClick:()=>b("arcade"),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"← Back to Arcade"})]})}),A&&e.jsx("div",{className:"mb-6 bg-gray-100 border border-gray-400 text-gray-700 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"✅"}),e.jsx("span",{children:"Activity submitted successfully! It's now pending approval."})]})}),y&&e.jsx("div",{className:"mb-6 bg-gray-100 border border-gray-400 text-gray-700 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-red-500 mr-2",children:"❌"}),e.jsx("span",{children:y})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Select Category"}),e.jsx("div",{className:"space-y-3",children:Object.entries(d).map(([t,s])=>e.jsxs("button",{onClick:()=>E(t),className:`w-full text-left p-4 rounded-lg border-2 transition-all ${r===t?"border-green-500 bg-green-50 text-green-900":"border-gray-200 bg-white hover:border-green-300 hover:bg-green-25"}`,children:[e.jsx("div",{className:"font-medium text-sm",children:s.title}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:s.description})]},t))})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:(f=d[r])==null?void 0:f.title}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Activity"}),e.jsx("div",{className:"space-y-3",children:(j=d[r])==null?void 0:j.activities.map(t=>e.jsxs("label",{className:`flex items-center p-4 border-2 rounded-lg cursor-pointer transition-all ${i.activity_subtype===t.value?"border-green-500 bg-green-50":"border-gray-200 hover:border-green-300"}`,children:[e.jsx("input",{type:"radio",name:"activity_subtype",value:t.value,checked:i.activity_subtype===t.value,onChange:s=>m("activity_subtype",s.target.value),className:"sr-only"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:t.label}),e.jsxs("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-sm font-medium",children:["+",t.points," pts"]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]})]},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx("textarea",{id:"description",rows:4,value:i.description,onChange:t=>m("description",t.target.value),placeholder:"Provide details about your activity, including when it happened and any relevant context...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"proof_url",className:"block text-sm font-medium text-gray-700 mb-2",children:"Proof/Evidence URL (Optional)"}),e.jsx("input",{type:"url",id:"proof_url",value:i.proof_url,onChange:t=>m("proof_url",t.target.value),placeholder:"https://example.com/proof-screenshot",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Provide a link to screenshots, documents, or other evidence to support your claim"})]}),u&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"Points to be earned:"}),e.jsx("p",{className:"text-sm text-green-700",children:u.label})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["+",u.points," pts"]})]})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>b("arcade"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v||!i.activity_subtype||!i.description.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center",children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Submitting..."]}):"Submit Activity"})]})]})]})})]}),e.jsxs("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-blue-900 mb-3",children:"📋 Submission Guidelines"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-2",children:[e.jsx("li",{children:"• All activities must be submitted within 7 days of completion"}),e.jsx("li",{children:"• Provide clear and detailed descriptions to help with approval"}),e.jsx("li",{children:"• Include proof/evidence when possible to speed up approval"}),e.jsx("li",{children:"• Activities are reviewed by HR and may take 1-3 business days for approval"}),e.jsx("li",{children:"• False or misleading submissions may result in point deductions"}),e.jsx("li",{children:"• Only full-time employees (excluding HR and interns) are eligible"})]})]})]})})};export{K as default};
