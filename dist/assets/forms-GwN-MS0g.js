import{s as et,j as e,k as $e,n as st,a as vs,V as T,w as we,o as Se,m as H,p as he,q as tt,r as at,u as nt,b as rt,v as it,g as ot,E as Pe,t as ne,x as Ne,y as lt,z as ct,A as dt,B as mt,R as ut,G as ht,H as gt,I as xt,e as pt,J as Le,K as Oe,T as Ee,D as ft,M as bt}from"./manager-dashboard-BkEir6jh.js";import{r as c}from"./react-vendor-z5qVsTvS.js";import{u as yt,F as We}from"./agency-dashboard-C2XGnqnO.js";import{j as Ve,k as fs,T as vt,l as jt,X as bs}from"./employee-dashboard--UUznbXa.js";import{u as Nt}from"./auth-vNnhMft6.js";const ee={DRAFT_PREFIX:"codex_draft_",DRAFT_INDEX:"codex_draft_index",SESSION_ID:"codex_session_id",LAST_ACTIVITY:"codex_last_activity",CRASH_RECOVERY:"codex_crash_recovery"},wt=()=>`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Ue=(y,s,n)=>{var r;return`${(r=y==null?void 0:y.toLowerCase())==null?void 0:r.replace(/\s+/g,"_")}_${s}_${n}`};class St{constructor(){this.primaryStorage=null,this.fallbackStorage=null,this.memoryStorage=new Map,this.initializeStorage()}initializeStorage(){try{const s="__storage_test__";localStorage.setItem(s,"test"),localStorage.removeItem(s),this.primaryStorage=localStorage}catch{}try{const s="__storage_test__";sessionStorage.setItem(s,"test"),sessionStorage.removeItem(s),this.fallbackStorage=sessionStorage}catch{}}setItem(s,n){const r=JSON.stringify(n);if(this.primaryStorage)try{return this.primaryStorage.setItem(s,r),!0}catch{}if(this.fallbackStorage)try{return this.fallbackStorage.setItem(s,r),!0}catch{}return this.memoryStorage.set(s,r),!1}getItem(s){if(this.primaryStorage)try{const r=this.primaryStorage.getItem(s);if(r!==null)return JSON.parse(r)}catch{}if(this.fallbackStorage)try{const r=this.fallbackStorage.getItem(s);if(r!==null)return JSON.parse(r)}catch{}const n=this.memoryStorage.get(s);return n!==void 0?JSON.parse(n):null}removeItem(s){var n,r;try{(n=this.primaryStorage)==null||n.removeItem(s)}catch{}try{(r=this.fallbackStorage)==null||r.removeItem(s)}catch{}this.memoryStorage.delete(s)}clear(){var s,n;try{(s=this.primaryStorage)==null||s.clear()}catch{}try{(n=this.fallbackStorage)==null||n.clear()}catch{}this.memoryStorage.clear()}}class kt{constructor(){this.storage=new St,this.sessionId=this.initializeSession(),this.autoSaveTimer=null,this.pendingSaves=new Map,this.listeners=new Set,this.setupCrashRecovery(),this.setupActivityTracking()}initializeSession(){const n=this.storage.getItem(ee.SESSION_ID)||wt();return this.storage.setItem(ee.SESSION_ID,n),n}setupCrashRecovery(){this.markActivity(),setInterval(()=>this.markActivity(),3e4),window.addEventListener("beforeunload",()=>{this.storage.setItem(ee.CRASH_RECOVERY,{sessionId:this.sessionId,timestamp:Date.now(),graceful:!0})}),this.checkCrashedSessions()}setupActivityTracking(){const s=["click","keypress","scroll","mousemove"],n=this.throttle(()=>this.markActivity(),1e4);s.forEach(r=>document.addEventListener(r,n,{passive:!0}))}markActivity(){this.storage.setItem(ee.LAST_ACTIVITY,{sessionId:this.sessionId,timestamp:Date.now()})}checkCrashedSessions(){const s=this.storage.getItem(ee.CRASH_RECOVERY);return s&&!s.graceful?this.getCrashedDrafts():[]}getCrashedDrafts(){const s=this.getDraftIndex(),n=Date.now(),r=[];return Object.values(s).forEach(o=>{if(n-o.lastSaved<2*60*60*1e3){const x=this.storage.getItem(o.storageKey);x&&this.isSignificantDraft(x)&&r.push({...o,data:x})}}),r}saveDraft(s,n={}){const{name:r,phone:o,monthKey:x,currentStep:h=1,forceImmediate:E=!1}=s;if(!r||!o||!x)return;const K=Ue(r,o,x),$=ee.DRAFT_PREFIX+K,F=this.storage.getItem($)||{},v={...F,...s,currentStep:h,savedAt:Date.now(),sessionId:this.sessionId,version:(F.version||0)+1};if(E){this.storage.setItem($,v),this.updateDraftIndex(K,$),this.notify("save",v);return}this.pendingSaves.set($,v),this.scheduleAutoSave()}scheduleAutoSave(){this.autoSaveTimer||requestAnimationFrame(()=>{this.autoSaveTimer=setTimeout(()=>this.flushPendingSaves(),500)})}flushPendingSaves(){this.pendingSaves.forEach((s,n)=>{this.storage.setItem(n,s),this.notify("save",s)}),this.pendingSaves.clear(),this.autoSaveTimer=null}getDraft(s,n,r){const o=Ue(s,n,r);return this.storage.getItem(ee.DRAFT_PREFIX+o)}getUserDrafts(s,n){const r=this.getDraftIndex();return Object.values(r).filter(o=>{var x;return o.draftId.includes(`${(x=s==null?void 0:s.toLowerCase())==null?void 0:x.replace(/\s+/g,"_")}_${n}`)}).map(o=>{var x;return{...o,data:this.storage.getItem(o.storageKey),completionPercentage:this.calculateCompletionPercentage(this.storage.getItem(o.storageKey)),currentStep:((x=this.storage.getItem(o.storageKey))==null?void 0:x.currentStep)||1}}).filter(Boolean)}calculateCompletionPercentage(s){var o,x,h,E,K;if(!s)return 0;let n=0,r=5;return(o=s.employee)!=null&&o.name&&n++,(x=s.meta)!=null&&x.attendance&&n++,(h=s.clients)!=null&&h.length&&n++,(E=s.learning)!=null&&E.length&&n++,(K=s.feedback)!=null&&K.company&&n++,Math.round(n/r*100)}getAllDrafts(){const s=this.getDraftIndex();return Object.values(s).map(n=>({...n,data:this.storage.getItem(n.storageKey)})).filter(Boolean)}deleteDraft(s,n,r){const o=Ue(s,n,r),x=ee.DRAFT_PREFIX+o;this.storage.removeItem(x),this.removeFromDraftIndex(o),this.notify("delete",{id:o,storageKey:x})}clearAllDrafts(){const s=this.getDraftIndex();Object.values(s).forEach(n=>this.storage.removeItem(n.storageKey)),this.storage.removeItem(ee.DRAFT_INDEX),this.notify("clear",null)}getDraftIndex(){return this.storage.getItem(ee.DRAFT_INDEX)||{}}updateDraftIndex(s,n){const r=this.getDraftIndex();r[s]={draftId:s,storageKey:n,lastSaved:Date.now()},this.storage.setItem(ee.DRAFT_INDEX,r)}removeFromDraftIndex(s){const n=this.getDraftIndex();delete n[s],this.storage.setItem(ee.DRAFT_INDEX,n)}isSignificantDraft(s){return s?["employee","clients","learning","meta","feedback"].some(r=>s[r]&&(Array.isArray(s[r])?s[r].length>0:Object.keys(s[r]||{}).length>0)):!1}subscribe(s){return this.listeners.add(s),()=>this.listeners.delete(s)}notify(s,n){this.listeners.forEach(r=>{try{r({type:s,payload:n})}catch{}})}throttle(s,n){let r=0;return(...o)=>{const x=Date.now();x-r>=n&&(r=x,s(...o))}}}const ie=new kt;function Ct(y={}){const{name:s,phone:n,monthKey:r,model:o,onRestore:x}=y||{},[h,E]=c.useState({lastSaved:null,restored:!1}),K=c.useRef(o);return c.useEffect(()=>{const v=ie.checkCrashedSessions();v&&v.length&&x&&(x(v[0].data),E(S=>({...S,restored:!0})));const L=ie.subscribe(({type:S,payload:N})=>{S==="save"&&E(k=>({...k,lastSaved:Date.now()}))});return()=>L()},[x]),c.useEffect(()=>{if(!o)return;const v=JSON.stringify(o),L=JSON.stringify(K.current);v!==L&&(s&&n&&r&&requestAnimationFrame(()=>{ie.saveDraft({...o,name:s,phone:n,monthKey:r})}),K.current=o)},[o,s,n,r]),{status:h,restore:()=>{if(s&&n&&r){const v=ie.getDraft(s,n,r);v&&x&&x(v)}},clear:()=>{s&&n&&r&&ie.deleteDraft(s,n,r)}}}const ys={success:y=>{console.log("âœ… Success:",y)},error:y=>{console.error("âŒ Error:",y)},warning:y=>{console.warn("âš ï¸ Warning:",y)},info:y=>{console.info("â„¹ï¸ Info:",y)}},Dt=()=>{const[y,s]=c.useState(!1),[n,r]=c.useState(null),o=c.useCallback((N,k="info",l={})=>{const j={type:k,title:l.title||k.charAt(0).toUpperCase()+k.slice(1),message:N,duration:l.duration||(k==="error"?8e3:5e3),...l};typeof ys=="function"?ys(j):console.log(`${k.toUpperCase()}: ${N}`)},[]),x=c.useCallback(async(N,k={})=>{const{loadingMessage:l=null,successMessage:j=null,errorMessage:A="Operation failed",onSuccess:W=null,onError:M=null,showLoading:U=!0,retryCount:t=0,retryDelay:m=1e3}=k;let u=0;const I=t+1;for(;u<I;)try{U&&(s(!0),l&&o(l,"info",{duration:2e3})),r(null);const C=await N();return j&&o(j,"success"),W&&W(C),C}catch(C){if(console.error(`Operation failed (attempt ${u+1}/${I}):`,C),u<I-1){await new Promise(O=>setTimeout(O,m)),u++;continue}const P={message:C.message||A,code:C.code,details:C.details||C.hint,timestamp:new Date().toISOString()};r(P);const B=js(C,A);throw o(B,"error"),M&&M(P),P}finally{U&&s(!1)}},[o]),h=c.useCallback(async(N,k={})=>{const{fallbackData:l=null,errorMessage:j="Failed to load data",showErrorNotification:A=!0,retryCount:W=1}=k;try{return await x(N,{errorMessage:j,retryCount:W,showLoading:!0})}catch(M){if(l!==null)return A&&o("Using offline data due to connection issues","warning"),l;throw M}},[x,o]),E=c.useCallback(async(N,k,l={})=>{const{validationRules:j=null,successMessage:A="Form submitted successfully",errorMessage:W="Form submission failed",onSuccess:M=null,onValidationError:U=null,resetForm:t=null}=l;try{if(j){const u=Pt(k,j);if(u.length>0){const I=`Validation failed: ${u.join(", ")}`;return o(I,"warning"),U&&U(u),{success:!1,errors:u}}}return{success:!0,data:await x(N,{successMessage:A,errorMessage:W,onSuccess:u=>{t&&t(),M&&M(u)}})}}catch(m){return{success:!1,error:m}}},[x,o]),K=c.useCallback(async(N,k={})=>{const{operationName:l="database operation",context:j={},retryCount:A=1}=k;try{return await x(N,{errorMessage:`${l} failed`,retryCount:A})}catch(W){throw At(W,l,j)}},[x]),$=c.useCallback((N,k={})=>{o(N,"success",k)},[o]),F=c.useCallback((N,k={})=>{o(N,"error",k)},[o]),v=c.useCallback((N,k={})=>{o(N,"warning",k)},[o]),L=c.useCallback((N,k={})=>{o(N,"info",k)},[o]),S=c.useCallback(()=>{r(null)},[]);return{loading:y,error:n,setLoading:s,handleAsyncOperation:x,handleDataFetch:h,handleFormSubmission:E,handleDatabaseOperation:K,showSuccess:$,showError:F,showWarning:v,showInfo:L,showNotification:o,clearError:S}};function js(y,s){if(!y)return s;const n=y.message||y.toString();return n.includes("fetch")||n.includes("network")||n.includes("connection")?"Connection issue detected. Please check your internet connection and try again.":n.includes("auth")||n.includes("unauthorized")||n.includes("permission")?"Authentication required. Please log in and try again.":n.includes("validation")||n.includes("required")||n.includes("invalid")?"Please check your input and ensure all required fields are filled correctly.":n.includes("timeout")||n.includes("slow")?"The operation is taking longer than expected. Please try again.":n.includes("500")||n.includes("server error")?"Server error occurred. Please try again later or contact support.":n.includes("rate limit")||n.includes("too many requests")?"Too many requests. Please wait a moment and try again.":s||"An unexpected error occurred. Please try again."}function At(y,s,n){const r={...y,operationName:s,context:n,timestamp:new Date().toISOString(),userMessage:js(y,`${s} failed`)};return console.error(`Database Error in ${s}:`,{error:y.message,code:y.code,details:y.details,hint:y.hint,context:n}),r}function Pt(y,s){const n=[];for(const[r,o]of Object.entries(s)){const x=y[r];o.required&&(!x||x.toString().trim()==="")&&n.push(`${r} is required`),x&&o.minLength&&x.toString().length<o.minLength&&n.push(`${r} must be at least ${o.minLength} characters`),x&&o.maxLength&&x.toString().length>o.maxLength&&n.push(`${r} must be no more than ${o.maxLength} characters`),x&&o.pattern&&!o.pattern.test(x.toString())&&n.push(`${r} format is invalid`),x&&o.custom&&!o.custom(x)&&n.push(o.customMessage||`${r} is invalid`)}return n}class Et{constructor(){this.clientOnboardingCache=new Map,this.lastCacheUpdate=null,this.cacheTimeout=5*60*1e3}async getClientOnboardingData(){const s=Date.now();if(this.lastCacheUpdate&&s-this.lastCacheUpdate<this.cacheTimeout)return Array.from(this.clientOnboardingCache.values());try{const{data:n,error:r}=await et.from("client_onboarding").select("*").order("created_at",{ascending:!1});return r?(console.error("Error fetching client onboarding data:",r),[]):(this.clientOnboardingCache.clear(),n.forEach(o=>{this.clientOnboardingCache.set(o.client_name.toLowerCase(),o)}),this.lastCacheUpdate=s,n)}catch(n){return console.error("Failed to fetch client onboarding data:",n),[]}}async mergeClientDataWithPriority(s,n=[]){if(!s||!s.name)return s;const r=s.name.toLowerCase();await this.getClientOnboardingData();const o=this.clientOnboardingCache.get(r),x=n.find(E=>E.name.toLowerCase()===r),h={...s};return x&&(h.clientType=x.client_type||h.clientType,h.team=x.team||h.team,h.status=x.status||h.status,h.industry=x.industry||h.industry,h.contactEmail=x.contact_email||h.contactEmail,h.contactPhone=x.contact_phone||h.contactPhone,h.website=x.website_url||h.website,h.priorityLevel=x.priority_level||h.priorityLevel),o?(h.name=o.client_name||h.name,h.contactPerson=o.contact_person||h.contactPerson,h.email=o.email||h.email,h.phone=o.phone||h.phone,h.companySize=o.company_size||h.companySize,h.industry=o.industry||h.industry,h.website=o.website_url||h.website,h.serviceScope=o.service_scope||h.serviceScope,h.budgetRange=o.budget_range||h.budgetRange,h.timeline=o.timeline||h.timeline,h.targetAudience=o.target_audience||h.targetAudience,h.assignedTeam=o.assigned_team||h.assignedTeam,h.targetOccupation=o.target_occupation,h.topServices=o.top_services,h.customerLearningPoints=o.customer_learning_points,h.customerQuestions=o.customer_questions,h.educationTopics=o.education_topics,h.keywords=o.keywords,h.customerFears=o.customer_fears,h.customerPainPoints=o.customer_pain_points,h.customerProblems=o.customer_problems,h.customerDesires=o.customer_desires,h.dataSource="client_priority",h.hasClientOnboardingData=!0,h.clientOnboardingDate=o.created_at):(h.dataSource=x?"master_client":"employee_submission",h.hasClientOnboardingData=!1),h}async processClientListWithPriority(s=[],n=[]){return!Array.isArray(s)||s.length===0?s:await Promise.all(s.map(o=>this.mergeClientDataWithPriority(o,n)))}async getClientDataSummary(s){if(!s)return null;const n=s.toLowerCase();await this.getClientOnboardingData();const r=this.clientOnboardingCache.get(n);return{clientName:s,hasClientOnboardingData:!!r,clientOnboardingDate:r==null?void 0:r.created_at,submissionStatus:r==null?void 0:r.submission_status,assignedTeam:r==null?void 0:r.assigned_team,dataCompleteness:this.calculateDataCompleteness(r),prioritySource:r?"client_onboarding":"employee_submission"}}calculateDataCompleteness(s){if(!s)return 0;const n=["client_name","contact_person","email","phone","company_size","industry","service_scope","budget_range","timeline","target_audience"],r=["website_url","target_occupation","top_services","customer_learning_points","customer_questions","education_topics","keywords","customer_fears","customer_pain_points","customer_problems","customer_desires"],o=n.length+r.length;let x=0;return[...n,...r].forEach(h=>{const E=s[h];E&&E!==""&&(!Array.isArray(E)||E.length>0)&&x++}),Math.round(x/o*100)}clearCache(){this.clientOnboardingCache.clear(),this.lastCacheUpdate=null}getDataSourcePriority(){return{1:{source:"client_onboarding",description:"Client-filled onboarding forms (highest priority)",color:"green"},2:{source:"master_client",description:"Master client database records",color:"blue"},3:{source:"employee_submission",description:"Employee-filled submission data (lowest priority)",color:"gray"}}}}const $t=new Et,Tt=({clientName:y,className:s=""})=>{const[n,r]=c.useState(null),[o,x]=c.useState(!1),[h,E]=c.useState(!1);if(c.useEffect(()=>{if(!y){r(null);return}(async()=>{x(!0);try{const L=await $t.getClientDataSummary(y);r(L)}catch(L){console.error("Failed to fetch client data summary:",L),r(null)}finally{x(!1)}})()},[y]),!y||o)return null;if(!n)return e.jsx("div",{className:`text-xs text-gray-500 ${s}`,children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),"Employee data"]})});const K=v=>{switch(v){case"client_onboarding":return"bg-green-500";case"master_client":return"bg-blue-500";default:return"bg-gray-400"}},$=v=>{switch(v){case"client_onboarding":return"Client-filled data";case"master_client":return"Master client data";default:return"Employee data"}},F=v=>v?new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Unknown";return e.jsxs("div",{className:`text-xs ${s}`,children:[e.jsxs("button",{onClick:()=>E(!h),className:"inline-flex items-center gap-1 text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx("div",{className:`w-2 h-2 ${K(n.prioritySource)} rounded-full`}),e.jsx("span",{children:$(n.prioritySource)}),n.hasClientOnboardingData&&e.jsx("span",{className:"text-green-600 font-medium",children:"âœ“"}),e.jsx("svg",{className:`w-3 h-3 transition-transform ${h?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),h&&e.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg border text-xs space-y-2",children:[e.jsx("div",{className:"font-medium text-gray-700",children:"Data Source Priority"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:n.hasClientOnboardingData?"font-medium text-green-700":"text-gray-500",children:["Client-filled forms ",n.hasClientOnboardingData?"(Active)":"(Not available)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-gray-600",children:"Master client database"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-gray-600",children:"Employee submissions"})]})]}),n.hasClientOnboardingData&&e.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Onboarding Date:"}),e.jsx("span",{className:"font-medium",children:F(n.clientOnboardingDate)})]}),n.assignedTeam&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Assigned Team:"}),e.jsx("span",{className:"font-medium",children:n.assignedTeam})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Data Completeness:"}),e.jsxs("span",{className:"font-medium",children:[n.dataCompleteness,"%"]})]}),n.submissionStatus&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:`font-medium capitalize ${n.submissionStatus==="submitted"?"text-green-600":"text-yellow-600"}`,children:n.submissionStatus})]})]}),e.jsx("div",{className:"pt-2 border-t border-gray-200 text-gray-500",children:e.jsx("div",{className:"text-xs",children:"ðŸ’¡ Client-filled data always takes priority over employee-filled data when available."})})]})]})},It=({value:y="",onChange:s,onClientSelect:n,placeholder:r="Select or type client name...",allowCreate:o=!0,disabled:x=!1,className:h="",label:E="Client",required:K=!1,team:$=null})=>{const{clients:F,loading:v,addClient:L}=$e(),S=()=>F.filter(P=>P.status==="Active").map(P=>({value:P.name,label:P.name,name:P.name,id:P.id,services:P.services||[],team:P.team,client_type:P.client_type})),N=C=>{if(!C||!C.trim())return null;const P=C.trim().toLowerCase();return F.find(B=>B.name.toLowerCase().trim()===P)},[k,l]=c.useState(""),[j,A]=c.useState(null),[W,M]=c.useState(!1),U=S().filter(C=>{if(!$)return!0;const P=N(C.name);return P&&P.team===$}),t=U.filter(C=>C.label.toLowerCase().includes(k.toLowerCase())||C.name.toLowerCase().includes(k.toLowerCase())),m=c.useCallback(C=>{if(!C){A(null),n&&n(null),s&&s("");return}const P=N(C);P&&(A(P),l(P.name),n&&n(P),s&&s(P.name))},[N,n,s]),u=c.useCallback(C=>{l(C),s&&s(C);const P=F.find(B=>B.name.toLowerCase()===C.toLowerCase());P?(A(P),n&&n(P)):(A(null),n&&n(null))},[F,s,n]),I=c.useCallback(async C=>{if(!o||!C.trim())return null;M(!0);try{const P=await L({name:C.trim(),status:"Active",team:$||"General",client_type:"Standard"});return P&&(A(P),l(P.name),n&&n(P),s&&s(P.name)),P}catch(P){return console.error("Error creating client:",P),null}finally{M(!1)}},[o,L,n,s,$]);return c.useEffect(()=>{y!==k&&l(y||"")},[y]),c.useEffect(()=>{if(k&&!j){const C=F.find(P=>P.name.toLowerCase()===k.toLowerCase());C&&(A(C),n&&n(C))}},[k,j,F,n]),e.jsxs("div",{className:`space-y-2 ${h}`,children:[E&&e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[E,K&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(st,{options:t,value:j?j.name:k,onChange:C=>{typeof C=="string"&&!U.find(P=>P.value===C)?o&&I(C):m(C)},onInputChange:u,placeholder:r,disabled:x||v,searchable:!0,creatable:o,isLoading:v||W,className:"w-full",onCreateNew:o?I:void 0}),j&&e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:j.name}),e.jsxs("p",{className:"text-xs text-green-700",children:[j.team," â€¢ ",j.status]}),j.services&&j.services.length>0&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Services: ",Array.isArray(j.services)?j.services.join(", "):j.services]}),j.scope_of_work&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Scope: ",j.scope_of_work]})]}),e.jsx("div",{className:"text-xs text-green-500",children:"Auto-populated"})]})}),e.jsx(Tt,{clientName:j.name})]}),k&&!j&&o&&e.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsxs("p",{className:"text-xs text-yellow-700",children:['ðŸ’¡ New client "',k,'" will be created when form is submitted']})})]})]})},Rt=({currentSubmission:y,previousSubmission:s,comparisonSubmission:n,setModel:r,monthPrev:o,monthThis:x,monthComparison:h,openModal:E,closeModal:K})=>{const{clients:$,loading:F}=$e(),[v,L]=c.useState((y==null?void 0:y.clients)||[]),[S,N]=c.useState({name:"",services:[],deliverables:"",progress:0,challenges:"",achievements:""}),[k,l]=c.useState(!1);c.useEffect(()=>{r&&r(t=>({...t,clients:v}))},[v,r]);const j=()=>{if(!S.name.trim())return;const t={id:Date.now().toString(),name:S.name,services:S.services,deliverables:S.deliverables,progress:S.progress,challenges:S.challenges,achievements:S.achievements,monthKey:x};L(m=>[...m,t]),N({name:"",services:[],deliverables:"",progress:0,challenges:"",achievements:""}),l(!1)},A=t=>{L(m=>m.filter(u=>u.id!==t))},W=(t,m,u)=>{L(I=>I.map(C=>C.id===t?{...C,[m]:u}:C))},M=t=>{if(!t)return;if(v.some(u=>u.name.toLowerCase()===t.name.toLowerCase())){alert("This client is already added to your list.");return}N(u=>({...u,name:t.name,services:t.services||[]}))},U={totalClients:v.length,avgProgress:v.length>0?v.reduce((t,m)=>t+(m.progress||0),0)/v.length:0,completedProjects:v.filter(t=>(t.progress||0)>=100).length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5 text-blue-600"}),"Client Management & KPIs"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Track your client work, deliverables, and progress for ",x]})]}),e.jsxs("button",{onClick:()=>l(!k),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(fs,{className:"w-4 h-4"}),"Add Client"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ve,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Clients"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:U.totalClients})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(vt,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Avg Progress"})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[U.avgProgress.toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(jt,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Completed"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:U.completedProjects})]})]})]}),k&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Add New Client"}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(bs,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Client"}),e.jsx(It,{value:S.name,onChange:t=>N(m=>({...m,name:t})),onClientSelect:M,placeholder:"Select or create a new client...",allowCreate:!0,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Services Provided"}),e.jsx("input",{type:"text",value:Array.isArray(S.services)?S.services.join(", "):S.services,onChange:t=>N(m=>({...m,services:t.target.value.split(",").map(u=>u.trim()).filter(u=>u)})),placeholder:"e.g., SEO, Social Media, Web Development",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Key Deliverables"}),e.jsx("textarea",{value:S.deliverables,onChange:t=>N(m=>({...m,deliverables:t.target.value})),placeholder:"Describe the main deliverables and outcomes for this client...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Progress (",S.progress,"%)"]}),e.jsx("input",{type:"range",min:"0",max:"100",value:S.progress,onChange:t=>N(m=>({...m,progress:parseInt(t.target.value)})),className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0%"}),e.jsx("span",{children:"50%"}),e.jsx("span",{children:"100%"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{onClick:j,disabled:!S.name.trim(),className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Add Client"}),e.jsx("button",{onClick:()=>l(!1),className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"})]})]})]}),e.jsx("div",{className:"space-y-4",children:v.length===0?e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-8 text-center",children:[e.jsx(Ve,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Clients Added"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Add clients to track your work progress and deliverables for this month."}),e.jsxs("button",{onClick:()=>l(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(fs,{className:"w-4 h-4"}),"Add Your First Client"]})]}):v.map((t,m)=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:t.name}),t.services&&t.services.length>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Services: ",Array.isArray(t.services)?t.services.join(", "):t.services]})]}),e.jsx("button",{onClick:()=>A(t.id),className:"text-red-400 hover:text-red-600 transition-colors",children:e.jsx(bs,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.progress||0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${t.progress||0}%`}})}),e.jsx("input",{type:"range",min:"0",max:"100",value:t.progress||0,onChange:u=>W(t.id,"progress",parseInt(u.target.value)),className:"w-full mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Key Deliverables"}),e.jsx("textarea",{value:t.deliverables||"",onChange:u=>W(t.id,"deliverables",u.target.value),placeholder:"Describe the main deliverables and outcomes...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Achievements"}),e.jsx("textarea",{value:t.achievements||"",onChange:u=>W(t.id,"achievements",u.target.value),placeholder:"Key wins and successes...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Challenges"}),e.jsx("textarea",{value:t.challenges||"",onChange:u=>W(t.id,"challenges",u.target.value),placeholder:"Obstacles and difficulties faced...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]},t.id||m))}),v.length>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Monthly Summary"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsxs("p",{children:["â€¢ Working with ",U.totalClients," client",U.totalClients!==1?"s":""," this month"]}),e.jsxs("p",{children:["â€¢ Average project progress: ",U.avgProgress.toFixed(1),"%"]}),e.jsxs("p",{children:["â€¢ ",U.completedProjects," project",U.completedProjects!==1?"s":""," completed"]})]})]})]})},_t=({employeeId:y=null,isManager:s=!1,showProgress:n=!0,showRecommendations:r=!0,compact:o=!1})=>{const{user:x,role:h}=Nt(),{notify:E}=vs(),{employees:K}=$e(),[$,F]=c.useState({currentCourses:[],completedCourses:[],recommendations:[],skills:[],certifications:[],learningPath:null}),[v,L]=c.useState(y||(x==null?void 0:x.id)),[S,N]=c.useState("current"),[k,l]=c.useState(!1),j=[{id:"technical",name:"Technical Skills",icon:"ðŸ’»",color:"blue"},{id:"soft-skills",name:"Soft Skills",icon:"ðŸ¤",color:"green"},{id:"leadership",name:"Leadership",icon:"ðŸ‘‘",color:"purple"},{id:"marketing",name:"Marketing",icon:"ðŸ“ˆ",color:"orange"},{id:"design",name:"Design",icon:"ðŸŽ¨",color:"pink"},{id:"business",name:"Business",icon:"ðŸ’¼",color:"indigo"}];c.useEffect(()=>{A()},[v]);const A=()=>{l(!0),setTimeout(()=>{F({currentCourses:[{id:1,title:"Advanced React Development",provider:"Tech Academy",category:"technical",progress:65,duration:"8 weeks",deadline:"2024-03-15",instructor:"John Smith",rating:4.8,thumbnail:"ðŸ’»",description:"Master advanced React concepts including hooks, context, and performance optimization."},{id:2,title:"Digital Marketing Fundamentals",provider:"Marketing Pro",category:"marketing",progress:30,duration:"6 weeks",deadline:"2024-04-01",instructor:"Sarah Johnson",rating:4.6,thumbnail:"ðŸ“ˆ",description:"Learn the basics of digital marketing including SEO, social media, and analytics."},{id:3,title:"Team Leadership Skills",provider:"Leadership Institute",category:"leadership",progress:80,duration:"4 weeks",deadline:"2024-02-28",instructor:"Mike Wilson",rating:4.9,thumbnail:"ðŸ‘‘",description:"Develop essential leadership skills for managing and motivating teams."}],completedCourses:[{id:4,title:"JavaScript ES6+ Mastery",provider:"Code Academy",category:"technical",completedDate:"2024-01-15",grade:"A+",certificate:!0,rating:4.7,thumbnail:"âš¡",skills:["JavaScript","ES6","Async/Await","Modules"]},{id:5,title:"Project Management Basics",provider:"PM Institute",category:"business",completedDate:"2023-12-20",grade:"A",certificate:!0,rating:4.5,thumbnail:"ðŸ“‹",skills:["Project Planning","Risk Management","Team Coordination"]}],recommendations:[{id:6,title:"Advanced SEO Strategies",provider:"SEO Masters",category:"marketing",duration:"5 weeks",rating:4.8,price:"$199",thumbnail:"ðŸ”",reason:"Based on your role as SEO Specialist",skills:["Technical SEO","Content Strategy","Analytics"]},{id:7,title:"UI/UX Design Principles",provider:"Design School",category:"design",duration:"6 weeks",rating:4.9,price:"$249",thumbnail:"ðŸŽ¨",reason:"Recommended for your career growth",skills:["User Research","Wireframing","Prototyping"]}],skills:[{name:"JavaScript",level:85,category:"technical"},{name:"React",level:75,category:"technical"},{name:"SEO",level:90,category:"marketing"},{name:"Team Leadership",level:60,category:"leadership"},{name:"Project Management",level:70,category:"business"}],certifications:[{id:1,name:"Google Analytics Certified",issuer:"Google",date:"2024-01-10",expires:"2025-01-10",verified:!0,thumbnail:"ðŸ“Š"},{id:2,name:"React Developer Certification",issuer:"Meta",date:"2023-11-15",expires:"2025-11-15",verified:!0,thumbnail:"âš›ï¸"}],learningPath:{title:"Full-Stack Developer Path",progress:45,totalCourses:12,completedCourses:5,estimatedCompletion:"6 months",nextMilestone:"Backend Development Fundamentals"}}),l(!1)},500)},W=t=>t>=80?"bg-green-500":t>=60?"bg-blue-500":t>=40?"bg-yellow-500":"bg-red-500",M=t=>t>=80?"bg-green-100 text-green-800":t>=60?"bg-blue-100 text-blue-800":t>=40?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",U=t=>{E({title:"Enrollment Successful",message:"You have been enrolled in the course",type:"success"})};return K.find(t=>t.id===v),o?e.jsxs("div",{className:"card-brand p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-brand-text mb-4 flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ“š"}),e.jsx("span",{children:"Learning Progress"})]}),e.jsx("div",{className:"space-y-3",children:$.currentCourses.slice(0,3).map(t=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:t.thumbnail}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-brand-text",children:t.title}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:e.jsx("div",{className:`h-2 rounded-full ${W(t.progress)}`,style:{width:`${t.progress}%`}})})]}),e.jsxs("span",{className:"text-sm text-brand-text-secondary",children:[t.progress,"%"]})]},t.id))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"card-brand p-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-brand-text flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ“š"}),e.jsx("span",{children:"Learning & Development"})]}),e.jsx("p",{className:"text-brand-text-secondary mt-1",children:"Track progress and discover new learning opportunities"})]}),s&&e.jsxs("select",{value:v,onChange:t=>L(t.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Employee"}),K.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.role]},t.id))]})]})}),$.learningPath&&e.jsxs("div",{className:"card-brand p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-brand-text mb-4 flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ›¤ï¸"}),e.jsx("span",{children:"Learning Path"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"font-medium text-brand-text",children:$.learningPath.title}),e.jsxs("span",{className:"text-sm text-brand-text-secondary",children:[$.learningPath.completedCourses,"/",$.learningPath.totalCourses," courses"]})]}),e.jsx("div",{className:"w-full bg-white rounded-full h-3 mb-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-3 rounded-full transition-all duration-300",style:{width:`${$.learningPath.progress}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm text-brand-text-secondary",children:[e.jsxs("span",{children:["Next: ",$.learningPath.nextMilestone]}),e.jsxs("span",{children:["Est. completion: ",$.learningPath.estimatedCompletion]})]})]})]}),e.jsxs("div",{className:"card-brand p-6",children:[e.jsx("div",{className:"flex space-x-1 mb-6 bg-gray-100 p-1 rounded-lg",children:[{id:"current",label:"Current Courses",icon:"ðŸ“–"},{id:"completed",label:"Completed",icon:"âœ…"},{id:"recommendations",label:"Recommendations",icon:"ðŸ’¡"},{id:"skills",label:"Skills",icon:"ðŸŽ¯"},{id:"certifications",label:"Certifications",icon:"ðŸ†"}].map(t=>e.jsxs("button",{onClick:()=>N(t.id),className:`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-colors ${S===t.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx("span",{className:"mr-2",children:t.icon}),t.label]},t.id))}),k?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((t,m)=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]},m))}):e.jsxs("div",{children:[S==="current"&&e.jsx("div",{className:"space-y-4",children:$.currentCourses.map(t=>e.jsx("div",{className:"bg-slate-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("span",{className:"text-3xl",children:t.thumbnail}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-brand-text",children:t.title}),e.jsxs("p",{className:"text-sm text-brand-text-secondary",children:[t.provider," â€¢ ",t.instructor]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-brand-text-secondary",children:["Due: ",new Date(t.deadline).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx("span",{children:"â­"}),e.jsx("span",{children:t.rating})]})]})]}),e.jsx("p",{className:"text-sm text-brand-text-secondary mb-3",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[t.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${W(t.progress)}`,style:{width:`${t.progress}%`}})})]}),e.jsx("button",{className:"btn-brand-primary px-4 py-2 text-sm",children:"Continue"})]})]})]})},t.id))}),S==="completed"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:$.completedCourses.map(t=>e.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"text-2xl",children:t.thumbnail}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-brand-text",children:t.title}),e.jsxs("p",{className:"text-sm text-brand-text-secondary mb-2",children:[t.provider," â€¢ Completed ",new Date(t.completedDate).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:["Grade: ",t.grade]}),t.certificate&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"ðŸ“œ Certified"})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx("span",{children:"â­"}),e.jsx("span",{children:t.rating})]})]}),t.skills&&e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:t.skills.map(m=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:m},m))})})]})]})},t.id))}),S==="recommendations"&&r&&e.jsx("div",{className:"space-y-4",children:$.recommendations.map(t=>e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("span",{className:"text-3xl",children:t.thumbnail}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-brand-text",children:t.title}),e.jsxs("p",{className:"text-sm text-brand-text-secondary",children:[t.provider," â€¢ ",t.duration]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:t.price}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx("span",{children:"â­"}),e.jsx("span",{children:t.rating})]})]})]}),e.jsxs("p",{className:"text-sm text-blue-700 mb-2",children:["ðŸ’¡ ",t.reason]}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:t.skills.map(m=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:m},m))}),e.jsx("button",{onClick:()=>U(t.id),className:"btn-brand-primary px-4 py-2 text-sm",children:"Enroll Now"})]})]})},t.id))}),S==="skills"&&e.jsx("div",{className:"space-y-4",children:j.map(t=>{const m=$.skills.filter(u=>u.category===t.id);return m.length===0?null:e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-brand-text mb-3 flex items-center space-x-2",children:[e.jsx("span",{children:t.icon}),e.jsx("span",{children:t.name})]}),e.jsx("div",{className:"space-y-3",children:m.map(u=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-brand-text",children:u.name}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${W(u.level)}`,style:{width:`${u.level}%`}})}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${M(u.level)}`,children:[u.level,"%"]})]})]},u.name))})]},t.id)})}),S==="certifications"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:$.certifications.map(t=>e.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"text-2xl",children:t.thumbnail}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-brand-text",children:t.name}),e.jsxs("p",{className:"text-sm text-brand-text-secondary mb-2",children:["Issued by ",t.issuer]}),e.jsxs("div",{className:"text-xs text-brand-text-secondary space-y-1",children:[e.jsxs("div",{children:["Issued: ",new Date(t.date).toLocaleDateString()]}),e.jsxs("div",{children:["Expires: ",new Date(t.expires).toLocaleDateString()]})]}),t.verified&&e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:"âœ… Verified"})})]})]})},t.id))})]})]})]})};function re(y,s,n={}){const{model:r={},step:o=null}=n;r.employee,r.meta;try{switch(y){case"employee.name":return!s||!s.trim()?T.error("Full name is required for identification and reporting","critical"):s.trim().length<2?T.error("Name must be at least 2 characters long","error"):s.trim().length>100?T.error("Employee name is too long (max 100 characters)","error"):/^[a-zA-Z\s\-\.]+$/.test(s.trim())?T.success():T.warning("Name contains unusual characters. Please verify it's correct.");case"employee.phone":if(!s||!s.trim())return T.error("Phone number is required for contact purposes","critical");const x=s.replace(/\D/g,"");return x.length===0?T.error("Please enter a valid phone number","error"):x.length<10?T.error(`Phone number incomplete (${x.length}/10 digits)`,"error"):x.length>10?T.error("Phone number too long (max 10 digits)","error"):/^[6-9]/.test(x)?T.success():T.warning("Phone number should start with 6, 7, 8, or 9 for Indian mobile numbers.");case"employee.department":return s?T.success():T.error("Department selection is required for proper reporting structure","critical");case"employee.role":return!s||Array.isArray(s)&&s.length===0?T.error("At least one role must be selected for performance evaluation","critical"):T.success();case"monthKey":if(!s)return T.error("Report month is required to track performance timeline","critical");if(!/^\d{4}-\d{2}$/.test(s))return T.error("Month format should be YYYY-MM (e.g., 2024-01)","error");const[h,E]=s.split("-").map(Number);return E<1||E>12?T.error("Invalid month. Must be between 01-12","error"):h<2020||h>new Date().getFullYear()+1?T.warning("Month year seems unusual. Please verify it's correct."):T.success();case"meta.attendance.wfo":const K=Number(s||0),$=r!=null&&r.monthKey?we(r.monthKey):22,F=r!=null&&r.monthKey?Se(r.monthKey):31;return isNaN(K)?T.error("Work from Office days must be a valid number","error"):K<0?T.error("Work from Office days cannot be negative","error"):K>$?T.error(`Work from Office days cannot exceed ${$} working days for ${H(r==null?void 0:r.monthKey)} (${F} total days)`,"error"):K>0&&K<1?T.warning("Partial WFO days detected. Please verify this is correct."):T.success();case"meta.attendance.wfh":const v=Number(s||0),L=r!=null&&r.monthKey?we(r.monthKey):22,S=r!=null&&r.monthKey?Se(r.monthKey):31;return isNaN(v)?T.error("Work from Home days must be a valid number","error"):v<0?T.error("Work from Home days cannot be negative","error"):v>L?T.error(`Work from Home days cannot exceed ${L} working days for ${H(r==null?void 0:r.monthKey)} (${S} total days)`,"error"):v>0&&v<1?T.warning("Partial WFH days detected. Please verify this is correct."):T.success();case"meta.tasks.count":const N=Number(s||0);return isNaN(N)?T.error("Task count must be a valid number","error"):N<0?T.error("Task count cannot be negative","error"):N>200?T.error("Task count seems unrealistic (max 200)","error"):N>100?T.warning("Task count seems unusually high. Please verify."):N===0?T.warning("No tasks reported. Consider adding completed tasks."):T.success();default:return T.success()}}catch(x){return console.error(`Validation error for field ${y}:`,x),T.error("Validation failed due to an internal error","error")}}function Ft(y,s){const n={},r={},o=s||{},x=o.employee||{},h=o.meta||{};switch(y){case 1:const E=re("employee.name",x.name,{model:s});E.isValid||(n["employee.name"]=E.error);const K=re("employee.phone",x.phone,{model:s});K.isValid||(n["employee.phone"]=K.error);const $=re("employee.department",x.department,{model:s});$.isValid||(n["employee.department"]=$.error);const F=re("employee.role",x.role,{model:s});F.isValid||(n["employee.role"]=F.error);const v=re("monthKey",o.monthKey,{model:s});v.isValid||(n.monthKey=v.error);break;case 2:const L=h.attendance||{},S=re("meta.attendance.wfo",L.wfo,{model:s});S.isValid||(S.error&&(n["attendance.wfo"]=S.error),S.warning&&(r["attendance.wfo"]=S.warning));const N=re("meta.attendance.wfh",L.wfh,{model:s});N.isValid||(N.error&&(n["attendance.wfh"]=N.error),N.warning&&(r["attendance.wfh"]=N.warning));const k=Number(L.wfo||0),l=Number(L.wfh||0),j=we(o.monthKey),A=Se(o.monthKey);k+l>j&&(n["attendance.total"]=`Total attendance (${k+l} days) cannot exceed ${j} working days for ${H(o.monthKey)} (${A} total days)`);const W=h.tasks||{},M=re("meta.tasks.count",W.count,{model:s});M.isValid||(M.error&&(n["tasks.count"]=M.error),M.warning&&(r["tasks.count"]=M.warning)),Number(W.count||0)>0&&!W.aiTableLink&&!W.aiTableScreenshot&&(r["tasks.evidence"]="Consider adding task evidence (AI Table link or screenshot) for better tracking");break;case 4:const t=o.learning||[],m=t.reduce((u,I)=>u+(I.durationMins||0),0)/60;m<6&&(r["learning.hours"]=`Only ${m.toFixed(1)} hours logged. Target: 6+ hours for optimal development`),t.forEach((u,I)=>{(!u.title||!u.title.trim())&&(n[`learning.${I}.title`]=`Learning activity ${I+1}: Title is required`),(!u.durationMins||u.durationMins<=0)&&(n[`learning.${I}.duration`]=`Learning activity ${I+1}: Duration must be greater than 0`),u.durationMins>480&&(r[`learning.${I}.duration`]=`Learning activity ${I+1}: Duration seems unusually long (${u.durationMins} minutes)`)});break}return{errors:Object.values(n),warnings:Object.values(r)}}function Mt(y){const s=[],n=y||{},r=n.employee||{},o=r.department||"",x=n.monthKey||"",h=m=>!!m&&/^\d{4}-\d{2}-\d{2}$/.test(m),E=m=>!!m&&m.startsWith("http"),K=m=>!!m&&/^\d{10}$/.test(m);(!r.name||!r.name.trim())&&s.push("Enter your Name."),o||s.push("Select Department."),(!r.role||r.role.length===0)&&s.push("Select at least one Role."),x||s.push("Pick Report Month (YYYY-MM)."),(!r.phone||!K(r.phone))&&s.push("Enter a valid 10-digit Phone Number.");const $=n.meta||{},F=$.attendance||{wfo:0,wfh:0},v=Number(F.wfo||0),L=Number(F.wfh||0),S=we(x),N=Se(x);(v<0||v>S)&&s.push(`WFO days must be between 0 and ${S} working days (${N} total days).`),(L<0||L>S)&&s.push(`WFH days must be between 0 and ${S} working days (${N} total days).`),v+L>S&&s.push(`Attendance total (WFO+WFH) cannot exceed ${S} working days for ${H(x)} (${N} total days).`);const k=$.tasks||{},l=Number(k.count||0),j=k.aiTableLink||"",A=k.aiTableScreenshot||"";l>0&&!j&&!A&&s.push("If tasks were completed, please provide an AI table link or a Drive screenshot."),j&&!E(j)&&s.push("The AI table link must be a valid URL."),A&&!he(A)&&s.push("The AI table screenshot must be a valid Google Drive URL.");const W=n.clients||[],M=["HR","Accounts","Sales","Blended (HR + Sales)"].includes(o),U=o==="Web Head",t=o==="Operations Head";return!M&&W.length===0&&!U&&!t&&s.push("Add at least one Client for this department."),W.forEach((m,u)=>{var B;const I=`Client "${(m==null?void 0:m.name)||`#${u+1}`}"`;(!m.name||!m.name.trim())&&s.push(`${I}: name is required.`);const C=r.role.includes("Graphic Designer");if((!["Web","Web Head","Social Media"].includes(o)||o==="Social Media"&&!C)&&((!m.reports||m.reports.length===0)&&s.push(`${m.name||"Client"}: add at least one report/proof link (Drive/Genspark).`),(m.reports||[]).some(O=>!he(O.url)&&!tt(O.url))&&s.push(`${m.name||"Client"}: report/proof links must be Google Drive/Docs or Genspark URLs.`)),o==="SEO"){(m==null?void 0:m.seo_trafficThis)==null&&s.push(`${I}: enter Organic Traffic (this month).`);const O=(m==null?void 0:m.seo_keywordsWorked)||[];O.forEach((_,q)=>{(!_.keyword||!_.keyword.trim())&&s.push(`${I}: Keyword #${q+1} missing text.`),(_.searchVolume==null||Number.isNaN(Number(_.searchVolume)))&&s.push(`${I}: Keyword #${q+1} missing search volume.`)}),O.length>0&&O.some(_=>Number(_.rankNow)>0&&Number(_.rankNow)<=3),(m==null?void 0:m.seo_aiOverviewPrev)!=null^(m==null?void 0:m.seo_aiOverviewThis)!=null&&s.push(`${I}: AI overview traffic should have prev & this values for comparison.`)}else o==="Web"||o==="Web Head"?Number((m==null?void 0:m.web_saasUpsells)||0)>0&&(m!=null&&m.web_saasProof)&&!he(m.web_saasProof)&&s.push(`${I}: SaaS upsell proof must be a Google Drive/Docs URL.`):o==="Social Media"&&C||o==="Operations Head"&&((!m.op_clientScope||m.op_clientScope.length===0)&&s.push(`${I}: select at least one client scope.`),m.op_paymentDate&&!h(m.op_paymentDate)&&s.push(`${I}: enter client payment date.`),(m.op_clientStatus==="Upgraded"||m.op_clientStatus==="Left"||m.op_clientStatus==="Reduced")&&(!m.op_clientStatusReason||!m.op_clientStatusReason.trim())&&s.push(`${I}: provide a reason for the client status.`));if(!C&&!U){const O=m.relationship||{};O.roadmapSentDate&&!h(O.roadmapSentDate)&&s.push(`${m.name||"Client"}: Roadmap Sent Date is not a valid date.`),O.reportSentDate&&!h(O.reportSentDate)&&s.push(`${m.name||"Client"}: Report Sent Date is not a valid date.`),(B=O.meetings)!=null&&B.some(_=>_.notesLink&&!he(_.notesLink))&&s.push(`${m.name||"Client"}: Meeting notes links must be valid Google Drive URLs.`),O.paymentReceived&&!h(O.paymentDate)&&s.push(`${m.name||"Client"}: Payment date is required when payment is marked as received.`),O.clientSatisfaction&&(O.clientSatisfaction<1||O.clientSatisfaction>10)&&s.push(`${m.name||"Client"}: Client satisfaction must be between 1 and 10.`),(O.appreciations||[]).some(_=>_.url&&!he(_.url))&&s.push(`${m.name||"Client"}: Appreciation proof links must be valid Google Drive/Docs URLs.`),(O.escalations||[]).some(_=>_.url&&!he(_.url))&&s.push(`${m.name||"Client"}: Escalation proof links must be valid Google Drive/Docs URLs.`)}try{(Array.isArray(m.services)?m.services:[]).some(q=>{const ke=typeof q=="string"?q:q.service,de=at(m,ke,{monthKey:x});return de!=null&&de>0&&(!m.reports||m.reports.length===0)})&&s.push(`${m.name||"Client"}: add at least one report/proof link for tracked scope progress.`)}catch{}}),{ok:s.length===0,errors:s}}function Kt({onResume:y,onDiscard:s,draftData:n,isVisible:r=!0}){return!r||!n?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Resume Draft Found"}),e.jsx("p",{className:"text-sm text-gray-600",children:"You have unsaved changes from a previous session"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-700 mb-2",children:"Would you like to:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"â€¢ Resume editing your draft"}),e.jsx("li",{children:"â€¢ Start fresh and discard the draft"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:y,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Resume Draft"}),e.jsx("button",{onClick:s,className:"flex-1 bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Start Fresh"})]})]})})}function Lt({onRecover:y,onDiscard:s,recoveryData:n,isVisible:r=!0}){return!r||!n?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recovery Data Found"}),e.jsx("p",{className:"text-sm text-gray-600",children:"We found data from an unexpected session end"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-700 mb-2",children:"We detected that your previous session ended unexpectedly."}),e.jsx("p",{className:"text-sm text-gray-600",children:"Would you like to recover your unsaved work?"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:y,className:"flex-1 bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition-colors font-medium",children:"Recover Data"}),e.jsx("button",{onClick:s,className:"flex-1 bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Start Fresh"})]})]})})}function zt({currentUser:y=null,isManagerEdit:s=!1,onBack:n=null}){var ss,ts,as,ns,rs,is,os;const r=(...a)=>{},o=nt(),x=rt(),{openModal:h,closeModal:E}=it(),{notify:K}=vs(),$=yt(),{allSubmissions:F}=ot(),{handleFormSubmission:v}=Dt(),{addSubmission:L,updateSubmission:S,addClient:N,refreshAllData:k}=$e(),[l,j]=c.useState({...Pe,isDraft:!0}),[A,W]=c.useState(null),[M,U]=c.useState(null),[t,m]=c.useState(y),[u,I]=c.useState(1),[C,P]=c.useState(!1),[B,O]=c.useState(null),[_,q]=c.useState(!1),[ke,de]=c.useState(!1),[Ns,Ce]=c.useState(!1),[Ot,Ye]=c.useState([]),[Te,Wt]=c.useState(!0),De=Ct({name:t==null?void 0:t.name,phone:t==null?void 0:t.phone,monthKey:l==null?void 0:l.monthKey,model:l,onRestore:a=>{a&&(j(a),$.showInfo(We.DRAFT_LOAD_SUCCESS))}}),G=[{id:1,title:"Profile & Month",icon:"ðŸ‘¤",description:"Basic information and reporting period"},{id:2,title:"Attendance & Tasks",icon:"ðŸ“…",description:"Work attendance and task completion"},{id:3,title:"KPI & Clients",icon:"ðŸ“Š",description:"Department metrics, client work and achievements"},{id:4,title:"Learning & AI",icon:"ðŸŽ“",description:"Learning activities and AI usage"},{id:5,title:"Feedback & Review",icon:"ðŸ’¬",description:"Company feedback and final review"}],X=c.useCallback(()=>{var b,D,f,Y;const a=((D=(b=l.employee)==null?void 0:b.name)==null?void 0:D.trim())||"",i=((Y=(f=l.employee)==null?void 0:f.phone)==null?void 0:Y.trim())||"",d=(t==null?void 0:t.name)||(a.length>=2?a:"anonymous"),g=(t==null?void 0:t.phone)||(/^\d{10}$/.test(i)?i:"new"),p=l.monthKey||ne();return`autosave-${`${d}-${g}`}-${p}`},[t,(ss=l.employee)==null?void 0:ss.name,(ts=l.employee)==null?void 0:ts.phone,l.monthKey]),He=c.useCallback(()=>{var p,w,R,b;const a=((w=(p=l.employee)==null?void 0:p.name)==null?void 0:w.trim())||"",i=((b=(R=l.employee)==null?void 0:R.phone)==null?void 0:b.trim())||"",d=l.monthKey||ne(),g=[];if(g.push(X()),i&&i!=="new"){const D=(t==null?void 0:t.name)||(a.length>=2?a:"anonymous");g.push(`autosave-${D}-new-${d}`)}if(i&&i.length>0&&i.length<10){const D=(t==null?void 0:t.name)||(a.length>=2?a:"anonymous");g.push(`autosave-${D}-new-${d}`)}return[...new Set(g)]},[X,(as=l.employee)==null?void 0:as.name,(ns=l.employee)==null?void 0:ns.phone,l.monthKey,t]),ws=c.useMemo(()=>{const a={};return F.forEach(i=>{const d=`${i.employee.name}-${i.employee.phone}`;a[d]={name:i.employee.name,phone:i.employee.phone}}),Object.values(a).sort((i,d)=>i.name.localeCompare(d.name))},[F]),Q=c.useMemo(()=>!t||!l.monthKey?!1:!!F.find(i=>{var d,g;return((d=i.employee)==null?void 0:d.name)===t.name&&((g=i.employee)==null?void 0:g.phone)===t.phone&&i.monthKey===l.monthKey&&i.isDraft===!1}),[t,l.monthKey,F]),oe=c.useMemo(()=>{const a=ne(),i=l.monthKey;if(!i||!/^\d{4}-\d{2}$/.test(i))return!1;const[d,g]=i.split("-").map(Number);return g<1||g>12||d<2020||d>2030?!1:(new Date(a)-new Date(i))/(1e3*60*60*24*30)>2},[l.monthKey]);if(y&&Q&&l.monthKey===ne()&&!s)return e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-500 rounded-full flex items-center justify-center text-white text-2xl mx-auto mb-4",children:"âœ“"}),e.jsx("h2",{className:"text-xl font-bold text-green-800 mb-2",children:"Monthly Report Already Submitted!"}),e.jsxs("p",{className:"text-green-700 mb-4",children:["You have already submitted your report for ",H(l.monthKey),". Your submission is complete and locked."]}),e.jsx("p",{className:"text-green-600 text-sm mb-6",children:"Only managers can edit submitted reports. Check your dashboard to view your performance and manager feedback."}),e.jsx("button",{onClick:()=>{x.navigateToDashboard()},className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"View My Dashboard"})]})});c.useEffect(()=>{var a;y&&!((a=l.employee)!=null&&a.name)&&j(i=>({...i,employee:{name:y.name||"",phone:y.phone||"",department:y.department||"Web",role:y.role||[]},monthKey:i.monthKey||Ne(ne()),meta:{attendance:{wfo:0,wfh:0},tasks:{count:0,aiTableLink:"",aiTableScreenshot:""}}}))},[y]),c.useEffect(()=>{if(!t){W(null),U(null),j(g=>({...g,employee:{...g.employee,name:"",phone:""}}));return}const a=F.filter(g=>g.employee.phone===t.phone).sort((g,p)=>p.monthKey.localeCompare(g.monthKey)),i=a[0]||null;W(i);const d=a[1]||null;U(d),console.log("ðŸ“Š Comparative data loaded:",{current:l.monthKey,previous:(i==null?void 0:i.monthKey)||"None",comparison:(d==null?void 0:d.monthKey)||"None",totalSubmissions:a.length}),j(g=>{var w,R,b,D,f,Y,J;return!((w=g.employee)!=null&&w.name)&&!((R=g.employee)!=null&&R.phone)?{...Pe,employee:{name:t.name,phone:t.phone,department:((b=i==null?void 0:i.employee)==null?void 0:b.department)||"Web",role:((D=i==null?void 0:i.employee)==null?void 0:D.role)||[]},monthKey:Ne(ne())}:{...g,employee:{...g.employee,name:g.employee.name||t.name,phone:g.employee.phone||t.phone,department:g.employee.department||((f=i==null?void 0:i.employee)==null?void 0:f.department)||"Web",role:(Y=g.employee.role)!=null&&Y.length?g.employee.role:((J=i==null?void 0:i.employee)==null?void 0:J.role)||[]}}})},[t,F]);const se=c.useCallback(async()=>{var d,g,p,w;if(!Te){console.log("ðŸ’¾ Auto-save disabled");return}const a=((d=l.employee)==null?void 0:d.name)||((g=l.employee)==null?void 0:g.phone);if(!(l.monthKey||a)){console.log("ðŸ’¾ Skipping auto-save: no meaningful data to save");return}try{const R=((p=l.employee)==null?void 0:p.name)||(t==null?void 0:t.name),b=((w=l.employee)==null?void 0:w.phone)||(t==null?void 0:t.phone),D=l.monthKey||ne();if(!R||!b||!D){console.log("ðŸ’¾ Skipping auto-save: missing required identifiers");return}const f={...l,name:R,phone:b,monthKey:D,currentStep:u,sessionInfo:{userAgent:navigator.userAgent,timestamp:Date.now(),url:window.location.href}};if(r("ðŸ’¾ Auto-saving with enhanced persistence:",{name:R,phone:b,monthKey:D,step:u,fieldCount:ie.countFormFields?ie.countFormFields(f):0}),De.saveDraft(f,{forceImmediate:_&&u>1}))O(new Date),q(!1),r("âœ… Enhanced auto-save successful"),$.showInfo(We.DRAFT_SAVE_SUCCESS,{duration:2e3});else throw new Error("Enhanced auto-save returned false")}catch(R){console.error("âŒ Enhanced auto-save failed:",R),$.showError(We.DRAFT_SAVE_ERROR);try{const b=X(),D={...l,lastSaved:new Date().toISOString(),currentStep:u};localStorage.setItem(b,JSON.stringify(D)),console.log("ðŸ’¾ Fallback save successful")}catch(b){console.error("âŒ Fallback save also failed:",b)}}},[l,u,t,Te,_,X,De]),Ie=c.useRef(se);c.useEffect(()=>{Ie.current=se},[se]);const qe=c.useCallback(()=>{var a,i,d,g;try{const p=He();let w=null,R=null;for(const b of p){const D=localStorage.getItem(b);if(D)try{const f=JSON.parse(D);if(!f.employee&&!f.monthKey){console.log("ðŸ“„ Draft found but appears empty, skipping:",b);continue}if(((a=f.employee)==null?void 0:a.name)||((i=f.employee)==null?void 0:i.phone)||f.monthKey){w=f,R=b;break}}catch(f){console.warn("ðŸ“„ Failed to parse draft from key:",b,f);continue}}if(w&&R){console.log("ðŸ“„ Loading draft:",{key:R,employee:w.employee,step:w.currentStep,hasName:!!((d=w.employee)!=null&&d.name),hasPhone:!!((g=w.employee)!=null&&g.phone),monthKey:w.monthKey,lastSaved:w.lastSaved}),j(w),I(w.currentStep||1),w.lastSaved&&O(new Date(w.lastSaved)),q(!1);const b=X();if(R!==b){console.log("ðŸ“„ Migrating draft from",R,"to",b);try{localStorage.setItem(b,JSON.stringify({...w,lastSaved:new Date().toISOString(),migrated:!0})),localStorage.removeItem(R)}catch(D){console.warn("ðŸ“„ Draft migration failed:",D)}}return!0}console.log("ðŸ“„ No valid draft found in any of the keys:",p)}catch(p){console.error("âŒ Failed to load draft:",p)}return!1},[He,X]),Ss=c.useCallback(()=>{try{const a=X();localStorage.removeItem(a),r("ðŸ—‘ï¸ Cleared draft for key:",a),O(null),q(!1)}catch{}},[X]),ks=c.useCallback(()=>{const a=X(),i=localStorage.getItem(a);if(r("ðŸ” Auto-save debug:",{key:a,hasSavedData:!!i,savedDataSize:i?i.length:0,lastAutoSave:B,hasUnsavedChanges:_,currentSubmissionEmployee:l.employee}),i)try{const d=JSON.parse(i);r("ðŸ“‹ Saved data preview:",{employee:d.employee,monthKey:d.monthKey,lastSaved:d.lastSaved,currentStep:d.currentStep})}catch{}},[X,B,_,l.employee]),V=c.useCallback((a,i)=>{if(a==="meta.attendance.wfo"&&i===30&&typeof i=="number"){console.error("ðŸš¨ðŸš¨ðŸš¨ MULTIPLICATION BUG in updateCurrentSubmission! Received value 30 for WFO!"),console.error("This should probably be 3 instead of 30"),console.trace("Stack trace for multiplication bug in updateCurrentSubmission");debugger}j(d=>{var R;const g={...d};let p=g;const w=a.split(".");for(let b=0;b<w.length-1;b++){const D=w[b];p[D]||(p[D]={}),p=p[D]}return p[w[w.length-1]]=i,console.log("ðŸ’¾ Updated state:",{key:a,finalValue:p[w[w.length-1]],finalType:typeof p[w[w.length-1]],attendanceState:(R=g.meta)==null?void 0:R.attendance}),r(`ðŸ“‹ Form state after ${a} update:`,g.employee),g}),q(!0)},[]),Be=c.useCallback(a=>{typeof a=="function"?j(i=>{const d=a(i);return q(!0),d}):(j(a),q(!0)),requestAnimationFrame(()=>{setTimeout(()=>{Ie.current()},100)})},[]),te=c.useCallback((a,i)=>{const d=re(a,i,l);return Fs(g=>({...g,[a]:d})),d},[l]),Cs=c.useCallback(a=>{V("employee.name",a),te("employee.name",a)},[V,te]),Re=c.useCallback(a=>{const i=a.replace(/\D/g,"").slice(0,10);V("employee.phone",i),te("employee.phone",i),i.length===10||i.length>0&&r(`ðŸ“± Phone number in progress (${i.length}/10):`,i)},[V,te]),Ds=c.useCallback(a=>{if(console.log("ðŸ¢ WFO Change:",{value:a,type:typeof a}),a===30&&typeof a=="number"){console.error("ðŸš¨ðŸš¨ðŸš¨ MULTIPLICATION BUG in handleWFOChange! Received value 30!"),console.error("Check if this should be 3 instead of 30"),console.trace("Stack trace for multiplication bug");debugger}V("meta.attendance.wfo",a),te("meta.attendance.wfo",a)},[V,te]),As=c.useCallback(a=>{console.log("ðŸ  WFH Change:",{value:a,type:typeof a}),V("meta.attendance.wfh",a),te("meta.attendance.wfh",a)},[V,te]),Ps=c.useCallback(a=>{V("meta.tasks.count",a),te("meta.tasks.count",a)},[V,te]),Es=c.useCallback(a=>V("meta.tasks.aiTableLink",a),[V]),$s=c.useCallback(a=>V("meta.tasks.aiTableScreenshot",a),[V]);c.useCallback(a=>V("feedback.company",a),[V]),c.useCallback(a=>V("feedback.hr",a),[V]),c.useCallback(a=>V("feedback.challenges",a),[V]);const Ts=c.useCallback(a=>V("aiUsageNotes",a),[V]),Is=c.useRef(l),Rs=c.useRef(t),_s=c.useRef(u);c.useEffect(()=>{Is.current=l,Rs.current=t,_s.current=u});const Ge=c.useCallback(async()=>{var a,i,d,g;try{if(!(((a=l.employee)==null?void 0:a.name)||((i=l.employee)==null?void 0:i.phone)||l.monthKey)){h("Nothing to Save","Please enter some information before saving.",E);return}console.log("ðŸ’¾ Manual save triggered for section:",(d=G.find(R=>R.id===u))==null?void 0:d.title),await se();const w=((g=G.find(R=>R.id===u))==null?void 0:g.title)||`Step ${u}`;h("Section Saved",`${w} data has been saved successfully.`,E)}catch(p){console.error("âŒ Section save failed:",p),h("Save Error","Failed to save section data. Please try again.",E)}},[l,u,se,h,E]),[Z,_e]=c.useState({}),[Vt,Fe]=c.useState({}),[ae,Fs]=c.useState({}),le=c.useCallback(a=>{const i=Ft(a-1,l),d={},g={};return i.errors.forEach(p=>{p.includes("name")?d["employee.name"]=p:p.includes("phone")?d["employee.phone"]=p:p.includes("department")?d["employee.department"]=p:p.includes("role")?d["employee.role"]=p:p.includes("month")?d.monthKey=p:p.includes("WFO")?d["meta.attendance.wfo"]=p:p.includes("WFH")?d["meta.attendance.wfh"]=p:p.includes("task")&&(d["meta.tasks.count"]=p)}),i.warnings.forEach(p=>{p.includes("name")?g["employee.name"]=p:p.includes("phone")?g["employee.phone"]=p:p.includes("month")?g.monthKey=p:p.includes("attendance")?g["meta.attendance"]=p:p.includes("task")?g["meta.tasks.proof"]=p:p.includes("learning")?g["learning.hours"]=p:p.includes("client")&&(g.clients=p)}),{errors:d,warnings:g}},[l]),ze=c.useRef(u),ge=c.useRef(null),Je=c.useCallback(()=>{ge.current&&clearTimeout(ge.current),ge.current=setTimeout(()=>{if(t){const a=le(u);_e(a.errors),Fe(a.warnings)}},500)},[t,u,le]);c.useEffect(()=>{ze.current!==u&&(Je(),ze.current=u)},[u,Je]),c.useEffect(()=>()=>{ge.current&&clearTimeout(ge.current)},[]),c.useEffect(()=>{const a=()=>{try{const d=ie.checkCrashedSessions?ie.checkCrashedSessions():[];d.length>0&&(console.log("ðŸš¨ Found crashed drafts:",d),Ce(!0),Ye(d))}catch(d){console.error("Error checking for crashes:",d)}},i=()=>{if(!(!(t!=null&&t.name)||!(t!=null&&t.phone))){try{const d=De.getUserDrafts(t.name,t.phone);if(d.length>0)return console.log("ðŸ“„ Found existing drafts for user:",d),Ye(d),de(!0),!0}catch(d){console.error("Error checking for existing drafts:",d)}return!1}};t&&setTimeout(()=>{a(),i()||console.log("No existing drafts found, proceeding normally")},500)},[t,De]);const Xe=c.useRef(new Set);c.useEffect(()=>{var d,g,p,w;const a=X();if(Xe.current.has(a))return;(!!t||(((p=(g=(d=l.employee)==null?void 0:d.name)==null?void 0:g.trim())==null?void 0:p.length)||0)>=2&&/^\d{10}$/.test(((w=l.employee)==null?void 0:w.phone)||""))&&qe()&&(Xe.current.add(a),q(!1))},[X,qe,t,(rs=l.employee)==null?void 0:rs.name,(is=l.employee)==null?void 0:is.phone]);const xe=c.useRef(null);c.useEffect(()=>(_&&(xe.current&&clearTimeout(xe.current),xe.current=setTimeout(()=>{Ie.current(),console.log("ðŸ’¾ Auto-saved form data")},3e3)),()=>{xe.current&&clearTimeout(xe.current)}),[_]),c.useEffect(()=>{const a=d=>{if(t&&_){try{const g=X(),p={...l,lastSaved:new Date().toISOString(),currentStep:u,emergencySave:!0};localStorage.setItem(g,JSON.stringify(p)),console.log("ðŸ’¾ Emergency save on page unload")}catch(g){console.error("âŒ Emergency save failed:",g)}return d.preventDefault(),d.returnValue="You have unsaved changes. Are you sure you want to leave?","You have unsaved changes. Are you sure you want to leave?"}},i=()=>{document.hidden&&t&&_&&(se(),console.log("ðŸ’¾ Saved on tab switch"))};return window.addEventListener("beforeunload",a),document.addEventListener("visibilitychange",i),()=>{window.removeEventListener("beforeunload",a),document.removeEventListener("visibilitychange",i)}},[t,_,se,X,l,u]);const[z,Ms]=c.useState(l);c.useEffect(()=>{const a=setTimeout(()=>{Ms(l)},500);return()=>clearTimeout(a)},[l]);const pe=c.useMemo(()=>lt(z.employee,z.clients,{monthKey:z.monthKey}),[z.employee,z.clients,z.monthKey]),fe=c.useMemo(()=>ct(z.learning),[z.learning]),be=c.useMemo(()=>dt(z.clients),[z.employee,z.clients]),me=c.useMemo(()=>{var a;return mt(pe,fe,be,(a=z.manager)==null?void 0:a.score)},[pe,fe,be,(os=z.manager)==null?void 0:os.score]),[Ut,Qe]=c.useState(!1);c.useEffect(()=>{if(me>=8){Qe(!0);const a=setTimeout(()=>Qe(!1),3e3);return()=>clearTimeout(a)}},[me]);const Me=c.useMemo(()=>{const i=(z.learning||[]).reduce((p,w)=>p+(w.durationMins||0),0)<360,d=(z.clients||[]).some(p=>{var w;return(((w=p.relationship)==null?void 0:w.escalations)||[]).length>0}),g=(z.clients||[]).some(p=>(p.reports||[]).length===0);return{missingLearningHours:i,hasEscalations:d,missingReports:g}},[z]);c.useEffect(()=>{j(a=>{const i={kpiScore:pe,learningScore:fe,relationshipScore:be,overall:me},d=JSON.stringify(i)===JSON.stringify(a.scores||{}),g=JSON.stringify(Me)===JSON.stringify(a.flags||{});return d&&g?a:{...a,flags:Me,scores:i}})},[pe,fe,be,me,Me]);const Ks=(a,i)=>{const d=`
ðŸ“Š PERFORMANCE SUMMARY - ${i.monthKey.replace("-"," ").toUpperCase()}

${a.overview}

âœ… STRENGTHS:
${a.strengths.map(g=>`â€¢ ${g}`).join(`
`)||"â€¢ None"}

âš ï¸ WEAKNESSES:
${a.weaknesses.map(g=>`â€¢ ${g}`).join(`
`)||"â€¢ None"}

ðŸ“Œ MISSED TASKS:
${a.missed.map(g=>`â€¢ ${g}`).join(`
`)||"â€¢ None"}

ðŸ“ NEXT MONTH TIPS:
${a.tips.map(g=>`â€¢ ${g}`).join(`
`)||"â€¢ Keep up the great work"}
    `;h("Performance Summary",d,E,null,"","")};async function Ls(){var w,R;if(console.log("ðŸ” Submit Final called with:",{supabase:!!o,isSubmissionFinalized:Q,isPreviousMonth:oe,currentSubmission:l}),!o){console.error("âŒ No Supabase connection"),showErrorModal("Database connection not ready. Please wait a moment and try again.");return}if(Q){console.log("âŒ Submission already finalized"),showInfoModal("This month's submission has already been finalized and cannot be edited.","Submission Already Completed");return}if(oe&&!s){console.log("âŒ Historical month submission blocked"),showWarningModal("For data accuracy and audit purposes, submissions are limited to the current month and up to 2 months prior. Please select a more recent month for reporting.","Historical Data Not Allowed");return}console.log("ðŸ” Validating submission...");const a=Mt(l);console.log("ðŸ“‹ Validation result:",a);const i=[],d=[];if(a.errors.forEach(b=>{b.includes("Name")||b.includes("Phone")||b.includes("Department")||b.includes("Role")||b.includes("Report Month")?i.push(b):d.push(b)}),i.length>0){const b=i.length===1&&i[0].includes("Name")?`

Tip: Go back to Step 1 (Profile & Month) to enter your name.`:i.length<=2?`

Tip: These can be completed in Step 1 (Profile & Month).`:`

Tip: Most required fields are in Step 1 (Profile & Month). You can click on any step in the progress bar to navigate there.`;h("Required Information Missing",`Please complete these required fields before submitting:

${i.map((D,f)=>`${f+1}. ${D}`).join(`
`)}${b}

Your progress has been automatically saved, so you won't lose any other information you've entered.`,E);return}if(d.length>0&&(console.log("âš ï¸ Validation warnings:",d),!await new Promise(D=>{h("Review Before Submitting",`Please review these suggestions (submission will proceed):

${d.map((f,Y)=>`${Y+1}. ${f}`).join(`
`)}

Would you like to submit anyway?`,()=>D(!1),()=>D(!0),"Review & Fix","Submit Anyway")})))return;const g=`backup-${X()}-${Date.now()}`;try{localStorage.setItem(g,JSON.stringify(l))}catch(b){console.error("Failed to create backup:",b)}const p={...l,isDraft:!1,submittedAt:new Date().toISOString(),employee:{...l.employee,name:(((w=l.employee)==null?void 0:w.name)||"").trim(),phone:l.employee.phone}};try{const b=ht(p.monthKey,p.submittedAt),D=((R=p.scores)==null?void 0:R.overall)??me,f=Math.max(0,D-(b.penalty||0));p.scores={...p.scores,overall:f},p.discipline=b}catch(b){console.warn("Discipline penalty calculation failed:",b)}delete p.id,await v(async()=>{o&&l.clients&&l.clients.length>0&&(console.log("ðŸ¢ Auto-storing clients to repository..."),await gt(o,{updateClient:N,addClient:N}).storeClientsFromSubmission(l));const{data:b,error:D}=await o.from("submissions").upsert(p,{onConflict:"employee_phone,monthKey",ignoreDuplicates:!1}).select();if(D)throw new Error(`Database error: ${D.message}`);if(!b||b.length===0)throw new Error("Submission processed but no data returned. Please verify your submission was saved.");try{localStorage.removeItem(g)}catch(f){console.error("Failed to remove backup:",f)}console.log("ðŸ”„ Notifying DataSync of new submission...");try{if(b&&b.length>0){const f=b[0];F.find(J=>{var ve,je;return((ve=J.employee)==null?void 0:ve.phone)===((je=f.employee)==null?void 0:je.phone)&&J.monthKey===f.monthKey})?await S(f):await L(f)}setTimeout(()=>{k()},500)}catch(f){console.error("DataSync notification failed:",f)}return{final:p,data:b[0]}},{successCallback:({final:b,data:D})=>{const f=xt(b);showSuccessNotification("Report submitted",`${H(b.monthKey)} report saved.`),Ks(f,b),Ss(),j({...Pe,monthKey:Ne(ne())}),m(null)},errorCallback:b=>{showErrorModal(`Failed to save your report: ${b.message}

Your data has been backed up locally. Please try again or contact support if the problem persists.`,"Submission Failed")},validationRules:{required:["employee.name","employee.phone","monthKey"],custom:[b=>{var D,f;return(f=(D=b.employee)==null?void 0:D.name)!=null&&f.trim()?null:"Employee name is required"},b=>{var D;return(D=b.employee)!=null&&D.phone?null:"Employee phone is required"},b=>b.monthKey?null:"Report month is required"]}})}const ce=A?A.monthKey:Ne(l.monthKey),ue=l.monthKey,ye=M?M.monthKey:Ne(ce),Os=ut[l.employee.department]||[],Ws=!t,Ae=c.useCallback(async a=>{if(console.log(`ðŸŽ¯ goToStep called: ${u} -> ${a}`),u===a){console.log(`ðŸ‘ Already on step ${a}, no navigation needed`);return}if(a<1||a>G.length){console.error(`âŒ Invalid step ID: ${a}`);return}if(console.log(`ðŸ”„ Starting navigation from step ${u} to step ${a}...`),_){if(!await new Promise(g=>{h("Unsaved changes","We will auto-save your progress before switching steps. Continue?",()=>g(!1),()=>g(!0),"Stay","Continue")}))return;try{await se(),K({type:"success",title:"Saved",message:"Progress saved."})}catch(g){console.warn("Auto-save before navigation failed:",g)}}I(a);const i=le(a);_e(i.errors),Fe(i.warnings),console.log(`âœ… Navigation completed: ${u} -> ${a}`)},[u,_,se,le,h,K]),Vs=()=>{const a=u+1;if(a<=G.length){const i=le(u),d=Object.keys(i.errors).length>0,g=Object.keys(i.warnings).length>0;(d||g)&&(_e(i.errors),Fe(i.warnings),d&&u===1&&console.log("âš ï¸ Step 1 has validation errors, but allowing navigation:",i.errors)),Ae(a)}},Us=()=>{u>1&&Ae(u-1)},Ke=c.useCallback(a=>{var i,d;try{console.log("ðŸ“„ Resuming draft:",a.draftId),j(a),I(a.currentStep||1),a.name&&a.phone?m({name:a.name,phone:a.phone}):(i=a.employee)!=null&&i.name&&((d=a.employee)!=null&&d.phone)&&m({name:a.employee.name,phone:a.employee.phone}),a.lastSaved&&O(new Date(a.lastSaved)),q(!1),de(!1),Ce(!1),console.log("âœ… Draft resumed successfully")}catch(g){console.error("âŒ Error resuming draft:",g),h("Error","Failed to resume draft. Starting fresh.",E)}},[j,I,m,O,q,h,E]),Ys=c.useCallback(()=>{try{console.log("ðŸ†• Starting fresh form"),j({...Pe,isDraft:!0}),I(1),q(!1),O(null),de(!1),Ce(!1),console.log("âœ… Fresh form started")}catch(a){console.error("âŒ Error starting fresh:",a)}},[j,I,q,O]),Ze=c.useCallback(()=>{de(!1),Ce(!1)},[]),Hs=c.useCallback(a=>{console.log("ðŸš¨ Recovering from crash:",a),Ke(a.data||a)},[Ke]),qs=()=>{const a=Math.max(1,Math.min(u||1,G.length));return G.find(i=>i.id===a)||G[0]},es=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 mb-6",role:"navigation","aria-label":"Form progress navigation",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",id:"progress-heading",children:"Monthly Report Progress"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1","aria-describedby":"progress-heading",children:"ðŸ’¡ Click any step to navigate freely - no blocking!"})]}),B&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",role:"status","aria-live":"polite",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full","aria-hidden":"true"}),e.jsxs("span",{children:["Auto-saved ",B.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex justify-between",role:"tablist","aria-labelledby":"progress-heading",children:G.map((a,i)=>e.jsxs("div",{className:"flex flex-col items-center relative z-10",children:[e.jsx("button",{onClick:d=>{d.preventDefault(),d.stopPropagation(),console.log(`ðŸ–±ï¸ Step button clicked: step ${a.id}, currentStep: ${u}`),Ae(a.id)},className:`w-12 h-12 rounded-full border-2 flex items-center justify-center text-lg font-semibold transition-all duration-200 cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${u===a.id?"bg-blue-600 text-white border-blue-600":u>a.id?"bg-green-600 text-white border-green-600":"bg-gray-100 text-gray-400 border-gray-300 hover:border-gray-400 hover:bg-gray-200"}`,role:"tab","aria-selected":u===a.id,"aria-controls":`step-${a.id}-content`,"aria-label":`${a.title}: ${a.description}. ${u===a.id?"Current step":u>a.id?"Completed step":"Pending step"}`,tabIndex:u===a.id?0:-1,onKeyDown:d=>{var g,p;d.key==="Enter"||d.key===" "?(d.preventDefault(),Ae(a.id)):d.key==="ArrowLeft"&&i>0?(d.preventDefault(),(g=document.querySelector(`[aria-controls="step-${G[i-1].id}-content"]`))==null||g.focus()):d.key==="ArrowRight"&&i<G.length-1&&(d.preventDefault(),(p=document.querySelector(`[aria-controls="step-${G[i+1].id}-content"]`))==null||p.focus())},children:u>a.id?"âœ“":a.icon}),e.jsx("div",{className:"mt-2 text-center",children:e.jsx("div",{className:`text-xs font-medium ${u===a.id?"text-blue-600":u>a.id?"text-green-600":"text-gray-500"}`,children:a.title})})]},a.id))}),e.jsx("div",{className:"absolute top-6 left-6 right-6 h-0.5 bg-gray-200 -z-10",role:"progressbar","aria-valuenow":u,"aria-valuemin":1,"aria-valuemax":G.length,"aria-label":`Progress: Step ${u} of ${G.length}`,children:e.jsx("div",{className:"h-full bg-green-600 transition-all duration-500 ease-out",style:{width:`${(u-1)/(G.length-1)*100}%`}})})]})]}),Bs=()=>{switch(u){case 1:return zs();case 2:return Js();case 3:return Xs();case 4:return Qs();case 5:return Zs();default:return null}},Gs=()=>{const a=qs(),i=Q&&!s;return e.jsxs("div",{className:`bg-white rounded-xl shadow-sm border p-6 ${i?"opacity-75":""}`,role:"tabpanel",id:`step-${u}-content`,"aria-labelledby":`step-${u}-tab`,tabIndex:0,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center text-xl ${i?"bg-gray-200 text-gray-500":"bg-blue-100"}`,"aria-hidden":"true",children:a.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",id:`step-${u}-title`,children:a.title}),e.jsx("p",{className:"text-gray-600 text-sm","aria-describedby":`step-${u}-title`,children:a.description}),Q&&!s&&e.jsx("p",{className:"text-sm text-red-600 mt-1",role:"status","aria-live":"polite",children:"âœ“ Submission completed - form locked"}),s&&Q&&e.jsx("p",{className:"text-sm text-blue-600 mt-1",role:"status","aria-live":"polite",children:"âœï¸ Manager editing mode - submission can be modified"})]})]}),e.jsxs("div",{className:"text-right",children:[_?e.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 text-sm",children:[e.jsx("div",{className:"animate-spin w-3 h-3 border-2 border-yellow-600 border-t-transparent rounded-full"}),e.jsx("span",{children:"Saving..."})]}):B?e.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-green-600 rounded-full"}),e.jsxs("span",{children:["Saved ",new Date().getTime()-B.getTime()<1e4?"just now":"automatically"]})]}):e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-400 rounded-full"}),e.jsx("span",{children:"Ready"})]}),Te&&(t==null?void 0:t.name)&&(t==null?void 0:t.phone)&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Auto-save: ON"})]})]}),Bs()]})},zs=()=>{var d,g,p,w,R,b,D;const a=Q&&!s,i=le(1);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Le,{errors:i.errors,warnings:i.warnings,stepTitle:"Profile & Month Selection"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[y?e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-3",children:"Logged in as:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Name:"}),e.jsx("span",{className:"font-medium",children:y.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Phone:"}),e.jsx("span",{className:"font-medium",children:y.phone})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Department:"}),e.jsx("span",{className:"font-medium",children:y.department})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Employee"}),e.jsxs("select",{className:`w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${a?"bg-gray-100 text-gray-500 cursor-not-allowed":""}`,value:t?`${t.name}-${t.phone}`:"",onChange:f=>{if(!a)if(f.target.value==="")m(null),console.log("ðŸ”„ Employee deselected, preserving form data");else{const[Y,J]=f.target.value.split("-");m({name:Y,phone:J})}},disabled:a,children:[e.jsx("option",{value:"",children:"-- New Employee --"}),ws.map(f=>e.jsxs("option",{value:`${f.name}-${f.phone}`,children:[f.name," (",f.phone,")"]},`${f.name}-${f.phone}`))]})]}),Ws&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ee,{label:"Name",placeholder:"Your full name",value:l.employee.name||"",onChange:Cs,disabled:a,error:(d=ae["employee.name"])==null?void 0:d.error,warning:(g=ae["employee.name"])==null?void 0:g.warning,validateOnChange:!0}),e.jsx(Ee,{label:"Email",placeholder:"Your email address",value:l.employee.email||"",onChange:f=>V("employee.email",f),disabled:a,error:(p=ae["employee.email"])==null?void 0:p.error,warning:(w=ae["employee.email"])==null?void 0:w.warning,validateOnChange:!0,type:"email"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:["Phone Number",Z["employee.phone"]&&e.jsx("span",{className:"ml-2 text-red-500 text-xs",children:"âš ï¸ Required"})]}),e.jsx("input",{type:"tel",inputMode:"numeric",pattern:"[0-9]*",placeholder:"e.g., 9876543210",value:l.employee.phone||"",onChange:f=>Re(f.target.value),onInput:f=>Re(f.target.value),onKeyDown:f=>{!/[0-9]/.test(f.key)&&!["Backspace","Delete","Tab","Escape","Enter","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(f.key)&&f.preventDefault()},onPaste:f=>{f.preventDefault();const Y=f.clipboardData.getData("text");Re(Y)},disabled:a,className:`w-full border rounded-xl p-3 text-base focus:ring-2 transition-colors duration-200 ${Z["employee.phone"]?"border-red-300 focus:ring-red-500 focus:border-red-500 bg-red-50":a?"bg-gray-100 text-gray-500 cursor-not-allowed border-gray-300":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,autoComplete:"tel",maxLength:"10"}),Z["employee.phone"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:Z["employee.phone"]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Enter 10-digit number only (no spaces or dashes)"})]})]})]}),!y&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium mb-2",children:"Department"}),e.jsx("select",{id:"department",className:`w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${a?"bg-gray-100 text-gray-500 cursor-not-allowed":""}`,value:l.employee.department,onChange:f=>{if(a)return;const Y=f.target.value,J=l.employee.department;Y!==J&&(console.log(`ðŸ¢ Department changed from ${J} to ${Y} - clearing roles`),V("employee.role",[])),V("employee.department",Y)},disabled:a,children:ft.map(f=>e.jsx("option",{children:f},f))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 flex items-center",children:["Role(s)",Z["employee.role"]&&e.jsx("span",{className:"ml-2 text-red-500 text-xs",children:"âš ï¸ Required"})]}),e.jsx("div",{className:`${Z["employee.role"]?"ring-2 ring-red-300 rounded-xl":""}`,children:e.jsx(bt,{options:Os,selected:l.employee.role,onChange:f=>{if(console.log("ðŸŽ¯ Role selection onChange triggered:",f),a){console.log("âŒ Form is disabled, skipping role update");return}V("employee.role",f)},placeholder:"Select your roles",disabled:a,error:Z["employee.role"],allowCustom:!0,customPlaceholder:"Enter custom role..."})}),Z["employee.role"]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:Z["employee.role"]}),!1]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 flex items-center",children:["Report Month",Z.monthKey&&e.jsx("span",{className:"ml-2 text-red-500 text-xs",children:"âš ï¸ Required"})]}),e.jsx("input",{type:"month",className:`w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${Z.monthKey?"border-red-300 focus:ring-red-500 bg-red-50":a?"bg-gray-100 text-gray-500 cursor-not-allowed":""}`,value:l.monthKey,disabled:a,onChange:f=>{const Y=f.target.value,J=ne();Y===J?console.log("âš ï¸ User selected current month for reporting"):Y>J&&console.log("âš ï¸ User selected future month for reporting"),V("monthKey",Y)},max:ne()}),Z.monthKey&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:Z.monthKey}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"ðŸ’¡ Tip: Select the month you're reporting data for (typically the previous month for retrospective analysis)"}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-3 mt-3",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-2 flex items-center gap-1",children:"ðŸ“Š Three-Month Comparative Analysis"}),e.jsxs("div",{className:"text-xs text-blue-700 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"text-center p-2 bg-white/60 rounded",children:[e.jsx("div",{className:"font-medium",children:H(ye)}),e.jsx("div",{className:"text-gray-600",children:"Baseline"})]}),e.jsxs("div",{className:"text-center p-2 bg-white/60 rounded",children:[e.jsx("div",{className:"font-medium",children:H(ce)}),e.jsx("div",{className:"text-gray-600",children:"Previous"})]}),e.jsxs("div",{className:"text-center p-2 bg-white/80 rounded border border-blue-300",children:[e.jsx("div",{className:"font-medium text-blue-800",children:H(ue)}),e.jsx("div",{className:"text-blue-600",children:"Reporting"})]})]}),e.jsx("div",{className:"text-blue-600 text-center mt-2 font-medium",children:"ðŸŽ¯ Your performance trends will be analyzed across these three months"})]})]})]}),A&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-green-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-xs",children:"âœ“"}),"Previous Report Available for Comparison"]}),e.jsxs("div",{className:"text-sm text-green-700 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"ðŸ“… Report Month"}),e.jsx("div",{children:H(A.monthKey)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"â­ Overall Score"}),e.jsxs("div",{children:[((R=A.scores)==null?void 0:R.overall)||"N/A","/10"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"ðŸ¢ Department"}),e.jsx("div",{children:(b=A.employee)==null?void 0:b.department})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"ðŸ‘¥ Clients"}),e.jsxs("div",{children:[((D=A.clients)==null?void 0:D.length)||0," clients"]})]})]}),e.jsx("div",{className:"text-green-600 bg-green-100 p-2 rounded text-xs mt-3",children:"ðŸ’¡ This previous data will be used as a baseline for comparative analysis in your KPI and performance sections."})]})]}),!A&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-5",children:[e.jsxs("h4",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold",children:"ðŸŽ¯"}),"Welcome! This is Your First Performance Report"]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"bg-white/70 rounded-lg p-3",children:[e.jsx("p",{className:"text-blue-800 font-medium mb-2",children:"ðŸš€ What to Expect:"}),e.jsxs("ul",{className:"text-blue-700 space-y-1 text-xs",children:[e.jsx("li",{children:"â€¢ This report establishes your performance baseline"}),e.jsx("li",{children:"â€¢ Complete all sections to showcase your work and achievements"}),e.jsx("li",{children:"â€¢ Your data will be used for future month-over-month comparisons"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-3 border border-green-200",children:[e.jsx("p",{className:"text-green-800 font-medium mb-2",children:"ðŸ“ˆ Future Benefits:"}),e.jsxs("ul",{className:"text-green-700 space-y-1 text-xs",children:[e.jsx("li",{children:"â€¢ Next month: See your growth trends and improvements"}),e.jsx("li",{children:"â€¢ Track KPI improvements with visual comparisons"}),e.jsx("li",{children:"â€¢ Get detailed performance insights and recommendations"}),e.jsx("li",{children:"â€¢ Build a comprehensive performance history"})]})]}),e.jsxs("div",{className:"text-center bg-blue-100 rounded-lg p-3 mt-3",children:[e.jsx("p",{className:"text-blue-800 font-semibold text-sm",children:"ðŸ’¡ Pro Tip"}),e.jsx("p",{className:"text-blue-700 text-xs mt-1",children:"Be thorough with this first report - it sets the foundation for all future comparisons and growth tracking!"})]})]})]})]})]})]})},Js=()=>{var w,R,b,D,f,Y,J,ve,je,ls,cs,ds,ms,us,hs,gs,xs,ps;const a=le(2),i=((w=A==null?void 0:A.meta)==null?void 0:w.attendance)||{wfo:0,wfh:0},d=((R=M==null?void 0:M.meta)==null?void 0:R.attendance)||{wfo:0,wfh:0},g=(l.meta.attendance.wfo||0)+(l.meta.attendance.wfh||0),p=(i.wfo||0)+(i.wfh||0);return(d.wfo||0)+(d.wfh||0),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Le,{errors:a.errors,warnings:a.warnings,stepTitle:"Attendance & Tasks"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:"ðŸ“… Work Attendance"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Oe,{label:"Work from Office (WFO) Days",placeholder:"0-31",unit:" days",currentValue:l.meta.attendance.wfo,previousValue:i.wfo,comparisonValue:d.wfo,onChange:Ds,monthComparison:H(ye),monthPrev:H(ce),monthThis:H(ue),error:(b=ae["meta.attendance.wfo"])==null?void 0:b.error,warning:(D=ae["meta.attendance.wfo"])==null?void 0:D.warning,validateOnChange:!0}),e.jsx(Oe,{label:"Work from Home (WFH) Days",placeholder:"0-31",unit:" days",currentValue:l.meta.attendance.wfh,previousValue:i.wfh,comparisonValue:d.wfh,onChange:As,monthComparison:H(ye),monthPrev:H(ce),monthThis:H(ue),error:(f=ae["meta.attendance.wfh"])==null?void 0:f.error,warning:(Y=ae["meta.attendance.wfh"])==null?void 0:Y.warning,validateOnChange:!0})]}),e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:["ðŸ“ Working days in ",H(l.monthKey),": ",we(l.monthKey)," (of ",Se(l.monthKey)," total days)",e.jsx("br",{}),"Current total: ",g," days"]}),A&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-2",children:"ðŸ“Š Attendance Comparison"}),e.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:"WFO"}),e.jsxs("div",{children:[i.wfo||0," â†’ ",l.meta.attendance.wfo||0]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:"WFH"}),e.jsxs("div",{children:[i.wfh||0," â†’ ",l.meta.attendance.wfh||0]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:"Total"}),e.jsxs("div",{className:g>p?"text-green-600":g<p?"text-red-600":"text-gray-600",children:[p," â†’ ",g]})]})]}),e.jsxs("div",{className:"text-center text-blue-600 mt-2",children:["Comparing ",H(ce)," vs ",H(ue)]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:"âœ… Task Management"}),e.jsx(Oe,{label:"Tasks Completed",placeholder:"Number of tasks",unit:" tasks",currentValue:l.meta.tasks.count,previousValue:(ve=(J=A==null?void 0:A.meta)==null?void 0:J.tasks)==null?void 0:ve.count,comparisonValue:(ls=(je=M==null?void 0:M.meta)==null?void 0:je.tasks)==null?void 0:ls.count,onChange:Ps,monthComparison:H(ye),monthPrev:H(ce),monthThis:H(ue),error:(cs=ae["meta.tasks.count"])==null?void 0:cs.error,warning:(ds=ae["meta.tasks.count"])==null?void 0:ds.warning,validateOnChange:!0}),e.jsx(Ee,{label:"AI Table / PM link",placeholder:"Google Drive or project management URL",value:l.meta.tasks.aiTableLink,onChange:Es}),e.jsx(Ee,{label:"Screenshot proof",placeholder:"Google Drive URL for screenshot",value:l.meta.tasks.aiTableScreenshot,onChange:$s}),A&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsx("h5",{className:"text-sm font-medium text-green-800 mb-2",children:"ðŸ“Š Task Completion Comparison"}),e.jsxs("div",{className:"text-xs text-green-700",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{children:[H(ce),": ",((us=(ms=A.meta)==null?void 0:ms.tasks)==null?void 0:us.count)||0," tasks"]}),e.jsx("span",{className:"text-green-600",children:"â†’"}),e.jsxs("span",{className:"font-semibold",children:[H(ue),": ",l.meta.tasks.count||0," tasks"]})]}),(l.meta.tasks.count||0)>(((gs=(hs=A.meta)==null?void 0:hs.tasks)==null?void 0:gs.count)||0)&&e.jsx("div",{className:"text-green-600 mt-1 text-center",children:"ðŸ“ˆ Improved productivity!"}),(l.meta.tasks.count||0)<(((ps=(xs=A.meta)==null?void 0:xs.tasks)==null?void 0:ps.count)||0)&&e.jsx("div",{className:"text-yellow-600 mt-1 text-center",children:"ðŸ“‹ Consider reviewing task management strategies"})]})]})]})]})]})},Xs=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-xl p-5 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-bold text-lg flex-shrink-0",children:"ðŸŽ¯"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-2",children:"Key Performance Indicators (KPIs)"}),e.jsx("p",{className:"text-green-700 text-sm mb-3",children:"Evaluate your performance across key metrics that matter most to your role and department. Be honest and specific in your assessments."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Rate yourself objectively on each metric"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Provide specific examples and evidence"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Compare with previous month's performance"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Focus on measurable outcomes and results"})]})]})]})]})}),e.jsx(Rt,{currentSubmission:l,previousSubmission:A,comparisonSubmission:M,setModel:Be,monthPrev:ce,monthThis:ue,monthComparison:ye,openModal:h,closeModal:E})]}),Qs=()=>{const a=le(4),i=(l.learning||[]).reduce((d,g)=>d+(g.durationMins||0),0)/60;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Le,{errors:a.errors,warnings:a.warnings,stepTitle:"Learning & Development"}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-5 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold text-lg flex-shrink-0",children:"ðŸ“š"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-purple-900 mb-2",children:"Learning & Development Activities"}),e.jsx("p",{className:"text-purple-700 text-sm mb-3",children:"Document all learning activities including courses, training sessions, workshops, certifications, and self-study. Target: 6+ hours monthly."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-600",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{children:"Include online courses and certifications"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-purple-600",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{children:"Add workshops and training sessions"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-purple-600",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{children:"Document self-study and research time"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-purple-600",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{children:"Describe how learning applies to your role"})]})]})]})]})}),e.jsx(es,{current:i,target:6,label:"Learning Hours Progress",unit:"h",color:"green"}),e.jsx(_t,{model:l,setModel:Be,openModal:h}),e.jsxs("div",{className:"bg-white border rounded-xl p-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 flex items-center gap-2 mb-4",children:"ðŸ¤– AI Usage (Optional)"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Describe how you used AI tools to improve your work efficiency this month."}),e.jsx("textarea",{className:"w-full border border-gray-300 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",rows:4,placeholder:"List ways you used AI to work faster/better this month. Include links or examples.",value:l.aiUsageNotes,onChange:d=>Ts(d.target.value)})]})]})},Zs=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 border border-orange-200 rounded-xl p-5 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center text-white font-bold text-lg flex-shrink-0",children:"ðŸ’¬"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-orange-900 mb-2",children:"Employee Feedback & Challenges"}),e.jsx("p",{className:"text-orange-700 text-sm mb-3",children:"Your honest feedback helps improve our workplace. Share constructive thoughts about company processes, policies, and any challenges you're facing."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[e.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{children:"Be specific and constructive in your feedback"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[e.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{children:"Suggest improvements where possible"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[e.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{children:"Highlight both positive aspects and areas for growth"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[e.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{children:"Your feedback is confidential and valued"})]})]})]})]})}),e.jsxs("div",{className:"bg-white border rounded-xl p-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 flex items-center gap-2 mb-4",children:"ðŸ’¬ Employee Feedback & Self-Assessment"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Provide comprehensive feedback covering all aspects of your work experience and self-assessment."}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-3 flex items-center gap-2",children:"ðŸ“‹ Feedback Guidelines & Self-Assessment Scoring"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-blue-800 mb-2",children:"ðŸ“ What to Include:"}),e.jsxs("ul",{className:"space-y-1 text-blue-700",children:[e.jsx("li",{children:"â€¢ Company culture and work environment"}),e.jsx("li",{children:"â€¢ HR policies and communication"}),e.jsx("li",{children:"â€¢ Management support and guidance"}),e.jsx("li",{children:"â€¢ Challenges and obstacles faced"}),e.jsx("li",{children:"â€¢ Suggestions for improvement"}),e.jsx("li",{children:"â€¢ Personal achievements and growth"})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-blue-800 mb-2",children:"â­ Self-Assessment Scale (1-10):"}),e.jsxs("ul",{className:"space-y-1 text-blue-700",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"9-10:"})," Exceptional performance, exceeded expectations"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"7-8:"})," Strong performance, met most goals"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"5-6:"})," Satisfactory performance, room for improvement"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"3-4:"})," Below expectations, needs significant improvement"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"1-2:"})," Poor performance, requires immediate attention"]})]})]})]})]}),e.jsx(pt,{label:"Comprehensive Feedback & Self-Assessment",placeholder:"Please provide detailed feedback covering:\\n\\n1. COMPANY FEEDBACK: What's working well? What could be improved in company culture, processes, or policies?\\n\\n2. HR & MANAGEMENT: Thoughts on HR support, management guidance, and communication?\\n\\n3. CHALLENGES: Any obstacles or challenges hindering your work or growth?\\n\\n4. SELF-ASSESSMENT: Rate your overall performance this month (1-10) and explain your reasoning. Include specific achievements, areas where you excelled, and areas for improvement.\\n\\n5. SUGGESTIONS: Any recommendations for improving the work environment or processes?",rows:12,value:l.feedback.comprehensive||l.feedback.company||"",onChange:a=>{j(i=>({...i,feedback:{...i.feedback,comprehensive:a,company:a,hr:a,challenges:a}}))}})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border rounded-xl p-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 flex items-center gap-2 mb-4",children:"ðŸ“Š Performance Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[pe,"/10"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"KPI Score"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[fe,"/10"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Learning"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[be,"/10"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Client Relations"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[me,"/10"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Overall"})]})]}),me>=8&&e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸŽ‰"}),e.jsx("div",{className:"text-green-600 font-semibold",children:"Excellent performance!"})]})]})]});return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 mb-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-xl flex-shrink-0",children:"ðŸ“"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Monthly Performance Report"}),e.jsx("p",{className:"text-blue-700 text-sm mb-3",children:"Complete your monthly performance evaluation by filling out each section. Your progress is automatically saved as you navigate between steps."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Auto-saves when moving between sections"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("span",{children:["Complete all ",G.length," steps to submit"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Review your performance summary before submitting"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Submit by month-end for timely evaluation"})]})]})]})]})}),ke&&e.jsx(Kt,{currentUser:t,onResumeDraft:Ke,onStartFresh:Ys,onDismiss:Ze,isVisible:ke}),Ns&&e.jsx(Lt,{onRecover:Hs,onDismiss:Ze}),s&&n&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-lg",children:"âœï¸"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800",children:"Manager Edit Mode"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["Editing ",t==null?void 0:t.name,"'s submission for ",H(l.monthKey)]})]})]}),e.jsx("button",{onClick:async()=>{if(_){if(!await new Promise(i=>{h("Unsaved changes","We will auto-save your progress before leaving. Continue?",()=>i(!1),()=>i(!0),"Stay","Continue")}))return;try{await se()}catch{}}n()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Back to Dashboard"})]}),Q&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-bold text-lg",children:"âœ“"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800",children:s?"Editing Submitted Report":"Submission Complete"}),e.jsx("p",{className:"text-sm text-green-700",children:s?"This report has been submitted. As a manager, you can edit and re-submit it.":"This month's report has been successfully submitted and locked. No further edits are allowed."})]})]}),oe&&!Q&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4 mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center text-white font-bold text-lg",children:"ðŸ“…"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-orange-800",children:"Previous Month Selected"}),e.jsx("p",{className:"text-sm text-orange-700",children:"You can only edit the current month's submission. Please select the current month to make changes."})]})]}),_&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-4 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-yellow-800",children:"You have unsaved changes in this section."}),e.jsx("span",{className:"text-xs text-yellow-600 ml-2",children:"Auto-saves when you move to next section"})]}),e.jsx("button",{onClick:Ge,disabled:!t,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:"ðŸ’¾ Save Now"})]}),!_&&B&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"text-sm text-green-800",children:["âœ“ Section saved at ",B.toLocaleTimeString()]})]}),e.jsx("button",{onClick:ks,className:"text-xs text-green-600 hover:text-green-800 underline",title:"Click to see auto-save debug info in browser console",children:"Debug Info"})]}),e.jsx(es,{}),e.jsx(Gs,{}),e.jsxs("div",{className:"flex justify-between items-center mt-4 sm:mt-6 gap-3",children:[e.jsxs("button",{onClick:Us,disabled:u===1,className:"px-4 sm:px-6 py-2 sm:py-3 text-sm sm:text-base text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-50 active:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors touch-manipulation",children:[e.jsx("span",{className:"hidden sm:inline",children:"â† Previous"}),e.jsx("span",{className:"sm:hidden",children:"â† Back"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[_&&e.jsxs("button",{onClick:Ge,disabled:!t,className:"bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg text-xs font-medium transition-colors disabled:opacity-50 flex items-center gap-1",children:["ðŸ’¾ ",e.jsx("span",{className:"hidden sm:inline",children:"Save Section"})]}),e.jsxs("span",{className:"text-xs sm:text-sm text-gray-500",children:[e.jsx("span",{className:"hidden sm:inline",children:"Step "}),u," of ",G.length]})]}),u===G.length?e.jsxs("button",{onClick:Ls,disabled:!o||Q||oe,className:`rounded-xl px-4 sm:px-8 py-2 sm:py-3 text-sm sm:text-base font-semibold transition-colors touch-manipulation ${Q||oe?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-green-600 hover:bg-green-700 active:bg-green-800 text-white disabled:opacity-50"}`,title:Q?"Submission already completed":oe?"Can only edit current month":"",children:[e.jsx("span",{className:"hidden sm:inline",children:Q?"Already Submitted":oe?"Previous Month":"Submit Report"}),e.jsx("span",{className:"sm:hidden",children:Q?"Submitted":oe?"Locked":"Submit"})]}):e.jsxs("button",{onClick:Vs,className:"bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white rounded-xl px-4 sm:px-6 py-2 sm:py-3 text-sm sm:text-base transition-colors touch-manipulation",children:[e.jsx("span",{className:"hidden sm:inline",children:"Next â†’"}),e.jsx("span",{className:"sm:hidden",children:"Next"})]})]})]})}export{zt as E,Dt as a,Ct as u};
