const c=e=>(e==null?void 0:e.role)==="intern"||(e==null?void 0:e.userType)==="intern"?{isEligible:!1,reason:"Interns are not eligible for the Arcade Program"}:(e==null?void 0:e.department)==="HR"||(e==null?void 0:e.department)==="hr"?{isEligible:!1,reason:"HR department employees are not eligible for the Arcade Program"}:(e==null?void 0:e.employment_type)!=="full-time"&&(e==null?void 0:e.employment_type)!=="fulltime"?{isEligible:!1,reason:"Only full-time employees are eligible for the Arcade Program"}:{isEligible:!0,reason:"User is eligible for the Arcade Program"},p=(e,a)=>{const t=[],i=c(a);return i.isEligible||t.push(i.reason),e.activity_type||t.push("Activity category is required"),e.activity_subtype||t.push("Activity type is required"),(!e.description||e.description.trim().length<10)&&t.push("Description must be at least 10 characters long"),["google_review","video_testimonial","bp_reel","full_video"].includes(e.activity_subtype)&&!e.proof_url&&t.push("Proof URL is required for this activity type"),e.proof_url&&!d(e.proof_url)&&t.push("Please provide a valid URL for proof"),{isValid:t.length===0,errors:t}},u=(e,a,t)=>{const i=[],s=c(t);return s.isEligible||i.push(s.reason),e.reward_id||i.push("Reward selection is required"),(!e.points_required||e.points_required<=0)&&i.push("Invalid points requirement"),a<e.points_required&&i.push(`Insufficient points. You have ${a} points but need ${e.points_required}`),e.reward_type==="wfh"&&a-e.points_required<50&&i.push("WFH redemption requires maintaining a minimum balance of 50 points"),e.reward_type==="wfh"&&!e.manager_approval_requested&&i.push("Manager approval is required for WFH redemption"),{isValid:i.length===0,errors:i}},g=(e,a)=>{var o;const t=[];["hr","team_leader","manager","operations_head"].includes((o=a==null?void 0:a.role)==null?void 0:o.toLowerCase())||t.push("Only HR, Team Leaders, Managers, or Operations Head can create escalations"),e.employee_id||t.push("Employee selection is required"),e.escalation_type||t.push("Escalation type is required"),(!e.points_deducted||e.points_deducted<=0)&&t.push("Points deduction must be greater than 0"),(!e.reason||e.reason.trim().length<20)&&t.push("Reason must be at least 20 characters long");const n={client_complaint:30,missed_meeting:10,performance_issue:10,behavioral_issue:15,other:20}[e.escalation_type]||20;return e.points_deducted>n&&t.push(`Maximum ${n} points can be deducted for ${e.escalation_type}`),{isValid:t.length===0,errors:t}},f=e=>{const a=new Date;a.setFullYear(a.getFullYear()-1);const t=new Date;t.setDate(t.getDate()+30);let i=0,s=null;return e.forEach(n=>{const o=new Date(n.created_at),r=new Date(o);r.setFullYear(r.getFullYear()+1),r<=t&&r>new Date&&(i+=n.points_earned,(!s||r<s)&&(s=r))}),{hasExpiring:i>0,expiringPoints:i,expirationDate:s?s.toLocaleDateString():null}},m=e=>{const a=new Date,t=a.getHours(),i=a.getDay();if(["client_referral","tactical_goals","strategic_goals"].includes(e)){if(i===0||i===6)return{isValidTime:!1,message:"This activity can only be logged during business days (Monday-Friday)"};if(t<9||t>=18)return{isValidTime:!1,message:"This activity can only be logged during business hours (9 AM - 6 PM)"}}return{isValidTime:!0,message:"Activity can be logged at this time"}},d=e=>{try{return new URL(e),!0}catch{return!1}},h=(e,a)=>{const t=new Date,i=t.toDateString(),s=e.filter(r=>new Date(r.created_at).toDateString()===i&&r.activity_subtype===a),o={whatsapp_appreciation:3,google_review:1,video_testimonial:1,client_referral:2,bp_reel:5,full_video:3,monthly_attendance:1,employee_referral:1,tactical_goals:1,strategic_goals:1,poll_first:1,poll_second:1,poll_third:1}[a]||5;if(s.length>=o){const r=new Date(t);r.setDate(r.getDate()+1),r.setHours(0,0,0,0);const l=r.getTime()-t.getTime();return{canSubmit:!1,message:`Daily limit of ${o} submissions reached for this activity type. Try again tomorrow.`,waitTime:Math.ceil(l/36e5)}}return{canSubmit:!0,message:`You can submit ${o-s.length} more ${a} activities today`,waitTime:0}};export{m as a,h as b,c,u as d,f as e,g as f,p as v};
