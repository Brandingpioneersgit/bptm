import{d as $,j as e,L as k}from"./manager-dashboard-BSBEKJka.js";import{r as d}from"./react-vendor-z5qVsTvS.js";import{u as P}from"./shared-ui-DksRfdM8.js";import"./clients-Dg_kG3rU.js";import"./supabase-vendor-D6KV1zBy.js";import"./auth-out34swX.js";import"./employees-C0R0oL0z.js";import"./forms-F81hZsoD.js";const M=({onBack:w})=>{const C=$(),{notify:h}=P(),[c,A]=d.useState([]),[L,g]=d.useState(!0),[l,p]=d.useState(""),[i,u]=d.useState("all"),[o,j]=d.useState("grid");d.useEffect(()=>{S()},[]);const S=async()=>{try{g(!0);const{data:s,error:t}=await C.from("employees").select("*").order("name");if(t)throw t;A(s||[])}catch(s){console.error("Error fetching employees:",s),h("Failed to load employee directory","error")}finally{g(!1)}},x=s=>{if(!s)return null;const t=s.replace(/\D/g,"");return t.startsWith("971")?`+${t}`:t.startsWith("0")?`+971${t.substring(1)}`:t.length===9?`+971${t}`:`+${t}`},f=(s,t)=>{const r=x(s);if(!r){h("Phone number not available","error");return}const a=encodeURIComponent(`Hello ${t}, I'm reaching out from Branding Pioneers Agency.`),n=`https://wa.me/${r.replace("+","")}?text=${a}`;window.open(n,"_blank")},b=s=>{if(!s)return!1;const t=s.replace(/\D/g,"");return["971501234567","971521234567","971551234567"].some(a=>t.includes(a.substring(0,8)))},m=c.filter(s=>{var n,y,v;const t=Array.isArray(s.role)?s.role.join(" ").toLowerCase():(s.role||"").toLowerCase(),r=((n=s.name)==null?void 0:n.toLowerCase().includes(l.toLowerCase()))||((y=s.email)==null?void 0:y.toLowerCase().includes(l.toLowerCase()))||((v=s.department)==null?void 0:v.toLowerCase().includes(l.toLowerCase()))||t.includes(l.toLowerCase()),a=i==="all"||s.department===i;return r&&a}),N=[...new Set(c.map(s=>s.department).filter(Boolean))],E=({employee:s})=>{var a,n;const t=s.phone&&s.phone.trim()!=="",r=b(s.phone);return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-600 rounded-full flex items-center justify-center text-white font-semibold text-lg",children:((n=(a=s.name)==null?void 0:a.charAt(0))==null?void 0:n.toUpperCase())||"?"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:s.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-600",children:Array.isArray(s.role)?s.role.join(", "):s.role||"No role specified"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="active"&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Active"}),r&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Company"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"ðŸ“§"}),e.jsx("span",{className:"text-gray-700",children:s.email||"No email"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"ðŸ¢"}),e.jsx("span",{className:"text-gray-700",children:s.department||"No department"})]}),s.hire_date&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"ðŸ“…"}),e.jsxs("span",{className:"text-gray-700",children:["Joined ",new Date(s.hire_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"ðŸ“±"}),t?e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-gray-700",children:x(s.phone)}),r&&e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"(Official)"})]}):e.jsx("span",{className:"text-gray-400",children:"No phone number"})]})]}),t&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("button",{onClick:()=>f(s.phone,s.name),className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2 font-medium",children:[e.jsx("span",{children:"ðŸ’¬"}),"Chat on WhatsApp"]})})]})},D=({employee:s})=>{var a,n;const t=s.phone&&s.phone.trim()!=="",r=b(s.phone);return e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-full flex items-center justify-center text-white font-semibold",children:((n=(a=s.name)==null?void 0:a.charAt(0))==null?void 0:n.toUpperCase())||"?"}),e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-4 gap-2 md:gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:s.name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-600",children:Array.isArray(s.role)?s.role.join(", "):s.role||"No role"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700",children:s.department||"No department"}),e.jsx("p",{className:"text-xs text-gray-500",children:s.email||"No email"})]}),e.jsx("div",{children:t?e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700",children:x(s.phone)}),r&&e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Official Number"})]}):e.jsx("p",{className:"text-sm text-gray-400",children:"No phone"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="active"&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Active"}),r&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Company"})]})]})]}),t&&e.jsxs("button",{onClick:()=>f(s.phone,s.name),className:"ml-4 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-colors duration-200 flex items-center gap-2 font-medium",children:[e.jsx("span",{children:"ðŸ’¬"}),"WhatsApp"]})]})})};return L?e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(k,{size:"xl",showText:!0,text:"Loading employee directory..."})})}):e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Employee Directory"}),e.jsx("p",{className:"text-gray-600",children:"Contact information and WhatsApp integration for all team members"})]}),e.jsx("button",{onClick:w,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors duration-200 flex items-center gap-2",children:"â† Back to Admin"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 text-lg",children:"ðŸ‘¥"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Employees"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-gray-600 text-lg",children:"ðŸ“±"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.filter(s=>s.phone).length}),e.jsx("p",{className:"text-sm text-gray-600",children:"With Phone Numbers"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-gray-600 text-lg",children:"ðŸ’¬"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.filter(s=>s.phone&&s.phone.length>8).length}),e.jsx("p",{className:"text-sm text-gray-600",children:"WhatsApp Ready"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-gray-600 text-lg",children:"ðŸ¢"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Departments"})]})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search employees by name, email, department, or role...",value:l,onChange:s=>p(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsxs("select",{value:i,onChange:s=>u(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Departments"}),N.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>j("grid"),className:`px-3 py-2 rounded-lg transition-colors duration-200 ${o==="grid"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Grid"}),e.jsx("button",{onClick:()=>j("list"),className:`px-3 py-2 rounded-lg transition-colors duration-200 ${o==="list"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List"})]})]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-gray-600",children:["Showing ",m.length," of ",c.length," employees",i!=="all"&&` in ${i}`,l&&` matching "${l}"`]})}),m.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ‘¥"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No employees found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:l||i!=="all"?"Try adjusting your search criteria or filters.":"No employees have been added to the directory yet."}),(l||i!=="all")&&e.jsx("button",{onClick:()=>{p(""),u("all")},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200",children:"Clear Filters"})]}):e.jsx("div",{className:o==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:m.map(s=>e.jsx("div",{children:o==="grid"?e.jsx(E,{employee:s}):e.jsx(D,{employee:s})},s.id))})]})};export{M as default};
